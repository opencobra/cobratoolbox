<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Sparse Linear Optimisation</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.4px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { text-align: center; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { font-family: Helvetica, Arial, sans-serif; margin-left: 0px; margin-top: 10px; margin-bottom: 20px; margin-right: 0px;  }
.S7 { text-align: left; line-height: 21px; white-space: pre-wrap; white-space: pre-wrap; margin-left: 56px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { line-height: 20.576px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S9 { min-height: 0px; font-family: monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S11 { line-height: 15.5927px; min-height: 18px; white-space: nowrap; font-size: 12.6667px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S13 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S14 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S15 { min-height: 0px; white-space: pre; color: rgb(0, 0, 255); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S16 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S17 { min-height: 0px; white-space: pre; color: rgb(160, 32, 240); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S18 { min-height: 0px; white-space: pre; color: rgb(34, 139, 34); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S19 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S20 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S21 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S22 { min-height: 0px; white-space: pre; color: rgb(0, 0, 255); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Sparse Linear Optimisation</span></h1><h2 class = "S3"><span class = "S2">Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">INTRODUCTION</span></h2><p class = "S4"><span class = "S2">In this tutorial, we will show how to use the sparse LP solver. This solver aims to solve the following optimisation problem</span></p><p class = "S5"><span style="vertical-align:-38"><img src="data:image/png;base64,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" width="102.5" height="91" /></span></p><p class = "S4"><span class = "S2">It has been proved that zero-norm is a non-convex function and the minimisation of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively developed. For a complete study of non-convex approximations of zero-norm, the reader is referred to Le Thie et al. (2015)</span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAoCAYAAAD32nqhAAAAjUlEQVRIS+3VIQ7CUBBF0VN2gGAPCGxXUQUGj0UhWQK2ZSWoqi6EJYAAiSQkJUFAmvLln/FzJ7l5eVNInCJxXwaAKbY44v7N1y8HM+ywxwVz3MYAljjjgPIfwPtYjXUAwkFKDiY49Ulc4DomyitsUPVLHVo0eHyCMiiUwc4NB3J4LJGDQQORg5ei5D54At1+ICnPQ6rOAAAAAElFTkSuQmCC" width="8" height="20" /></span><span class = "S2">.</span></p><p class = "S4"><span class = "S2">The method is described in Le Thie et al. (2015)</span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAoCAYAAAD32nqhAAAAjUlEQVRIS+3VIQ7CUBBF0VN2gGAPCGxXUQUGj0UhWQK2ZSWoqi6EJYAAiSQkJUFAmvLln/FzJ7l5eVNInCJxXwaAKbY44v7N1y8HM+ywxwVz3MYAljjjgPIfwPtYjXUAwkFKDiY49Ulc4DomyitsUPVLHVo0eHyCMiiUwc4NB3J4LJGDQQORg5ei5D54At1+ICnPQ6rOAAAAAElFTkSuQmCC" width="8" height="20" /></span><span class = "S2">. The sparse LP solver contains one convex (one-norm) and 6 non-convex approximation of zero-norms</span></p><ul class = "S6"><li class = "S7"><span class = "S0">Capped-L1 norm</span></li><li class = "S7"><span class = "S0">Exponential function</span></li><li class = "S7"><span class = "S0">Logarithmic function</span></li><li class = "S7"><span class = "S0">SCAD (Smoothly Clipped Absolute Deviation) function</span></li><li class = "S7"><span class = "S0">p norm with </span><span class = "S0"> </span><span class = "S0">  </span><span class = "S0">p</span><span class = "S0">&lt;</span><span class = "S0">0</span><span class = "S0">  </span><span class = "S0"> </span><span class = "S0"> </span></li><li class = "S7"><span class = "S0">p norm with </span><span class = "S0"> </span><span class = "S0">  </span><span class = "S0">0</span><span class = "S0">&lt;</span><span class = "S0">p</span><span class = "S0">&lt;</span><span class = "S0">1</span><span class = "S0">  </span><span class = "S0"> </span></li></ul><p class = "S4"><span class = "S2">The tutorial consist of two parts. Part 1 shows a basic usage of the solver. In part 2 provides an application of the code for finding the minimal set of reactions subject to a LP objective. Ready-made scripts are provided for both parts.</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">EQUIPMENT SETUP</span></h2><h2 class = "S3"><span class = "S2">Initialize the COBRA Toolbox.</span></h2><p class = "S4"><span class = "S2">If necessary, initialize The Cobra Toolbox using the </span><span class = "S9">initCobraToolbox</span><span class = "S2"> function.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">initCobraToolbox</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">COBRA model. </span></h2><p class = "S4"><span class = "S2">In thi</span><span class = "S2">s tutorial, the model used</span><span class = "S2"> is the generic reconstruction of human metabolism, the Recon 2.04</span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAoCAYAAAD32nqhAAABGklEQVRIS+3UvytFcRjH8dfFZGDyDxhEKBaLYlDkf2AxUbesNqVsJsVEyUIpo7LIj52yGOwGdhakU1+6nc73e8/tDup2nvou3/N93ud5Ps+np6bNqLWZr4MBA1jCFLpwhnN85zUr0mAS9wXingboV+O3PCD72y2OwvnEPC5D0hyuUoARrGI9V8Ea9lHHXgowgVe85ADDeCoDiPlqEReYwV2qghhgFwsYRabLX5Rx4jgeMYTnMmNsfNOHB6zgpqi8VAU9uA6qn8R6iwGy+4Og/E4uuRfvv3cxwAa6sZ1LnkY20sMUYBnHwXEfyFrJoh+DGMNbDDAb+o61vIXNVseYXFplfFABkgro5LXepPPWFkplpMpITQ31/xvpBzY+JylMcpDRAAAAAElFTkSuQmCC" width="8" height="20" /></span><span class = "S2">, which is provided in the COBRA Toolbox. The Recon 2.04 model can also be downloaded from the </span><a href = 'https://www.vmh.life/#downloadview'><span class = "S0">Virtual Metabolic Human</span></a><span class = "S2"> webpage. You can also select your own model to work with. Before proceeding with the simulations, the path for the model needs to be set up:      </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">global </span><span class = "S12">CBTDIR</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">modelFileName = </span><span class = "S17">'Recon2.v04.mat'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">modelDirectory = getDistributedModelFolder(modelFileName); </span><span class = "S18">%Look up the folder for the distributed Models.</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">modelFileName= [modelDirectory filesep modelFileName]; </span><span class = "S18">% Get the full path. Necessary to be sure, that the right model is loaded</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">model = readCbModel(modelFileName);</span></p></div></div><p class = "S19"><span class = "S20">NOTE: The following text, code, and results are shown for the Recon 2.04 model</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">PROCEDUR</span><span class = "S2">E</span></h2><h2 class = "S3"><span class = "S2">Example of using</span><span class = "S2"> sparseLP solver on randomly generated data</span></h2><p class = "S4"><span class = "S2">One randomly generates a m</span><span class = "S2">atrix </span><span style="vertical-align:-3"><img src="data:image/png;base64,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" width="67.5" height="30" /></span><span class = "S2"> </span><span class = "S2">  and a vector </span><span style="vertical-align:-5"><img src="data:image/png;base64,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" width="52" height="30" /></span><span class = "S2"> </span><span class = "S2">. The right hand side vector</span><span class = "S2"> </span><span style="vertical-align:-5"><img src="data:image/png;base64,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" width="62.5" height="20" /></span><span class = "S2">. There are three optional inputs for the method.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">n = 100; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">m = 50; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">x0 = rand(n,1); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.A = rand(m,n); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.b = constraint.A*x0; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.lb = -1000*ones(n,1); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.ub = 1000*ones(n,1); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">constraint.csense = repmat(</span><span class = "S17">'E'</span><span class = "S12">, m, 1); </span></p></div></div><p class = "S19"><span class = "S2">The two first: maximum number of iterations (</span><span class = "S21">nbMaxIteration</span><span class = "S2">) and threshold (</span><span class = "S21">epsilon</span><span class = "S2">) are stopping criterion conditions. </span><span class = "S21">theta</span><span class = "S2"> is the parameter of zero-norm approximation. The greater the value of </span><span class = "S21">theta</span><span class = "S2">, the better the approximation of the zero-norm. However, the greater the value of </span><span class = "S21">theta</span><span class = "S2">, the more local solutions the problem has. If the value of </span><span class = "S21">theta </span><span class = "S2">is not given then the algorithm will use a default value and update it gradually.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">params.nbMaxIteration = 100;    </span><span class = "S18">% stopping criteria</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">params.epsilon = 1e-6; 		</span><span class = "S18">% stopping criteria</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">params.theta   = 2;    		 </span><span class = "S18">% parameter of l0 approximation </span></p></div></div><p class = "S19"><span class = "S2">Call the solver with a chosen approximation</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">solution = sparseLP(</span><span class = "S17">'cappedL1'</span><span class = "S12">,constraint,params); </span></p></div></div><p class = "S19"><span class = "S2">or with default parameter</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">%solution = sparseLP('cappedL1',constraint);</span></p></div></div><h2 class = "S3"><span class = "S2">Finding the minimal set of reactions subject to a LP objective</span></h2><p class = "S4"><span class = "S2">Set the tolerance to distinguish between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">feasTol = getCobraSolverParams(</span><span class = "S17">'LP'</span><span class = "S16">, </span><span class = "S17">'feasTol'</span><span class = "S12">);</span></p></div></div><p class = "S19"><span class = "S2">Select the biomass reaction to optimise</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">model.biomassBool=strcmp(model.rxns,</span><span class = "S17">'biomass_reaction'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">model.c(model.biomassBool)=1;</span></p></div></div><p class = "S19"><span class = "S2">We will firstly find the optimal value subject to a LP objective</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">%% Solve FBA  </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">% max c'v </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">% s.t   Sv = b </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">%       l &lt;= v &lt;= u</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">% Define the LP structure </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">[m,n] = size(S); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">LPproblem = struct(</span><span class = "S17">'c'</span><span class = "S16">,-c,</span><span class = "S17">'osense'</span><span class = "S16">,1,</span><span class = "S17">'A'</span><span class = "S16">,S,</span><span class = "S17">'csense'</span><span class = "S16">,csense,</span><span class = "S17">'b'</span><span class = "S16">,b,</span><span class = "S17">'lb'</span><span class = "S16">,lb,</span><span class = "S17">'ub'</span><span class = "S12">,ub);  </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">% Call solveCobraLP to solve the LP </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">LPsolution = solveCobraLP(LPproblem);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">vFBA = LPsolution.full;</span></p></div></div><p class = "S19"><span class = "S2">We will now find the minimum number of reactions needed to achieve the same max objective found previously. Then one will add one more constraint: </span><span style="vertical-align:-5"><img src="data:image/png;base64,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" width="122.5" height="22" /></span><span class = "S2">.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.A = [S ; c']; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.b = [b ; c'*vFBA]; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">constraint.csense = [csense;</span><span class = "S17">'E'</span><span class = "S12">];</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.lb = lb; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.ub = ub;</span></p></div></div><p class = "S19"><span class = "S2">Call the sparseLP solver to solve the problem</span></p><p class = "S5"><span style="vertical-align:-38"><img src="data:image/png;base64,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" width="98" height="90" /></span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S18">% Try all non-convex approximations of zero norm and take the best result </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">approximations = {</span><span class = "S17">'cappedL1'</span><span class = "S16">,</span><span class = "S17">'exp'</span><span class = "S16">,</span><span class = "S17">'log'</span><span class = "S16">,</span><span class = "S17">'SCAD'</span><span class = "S16">,</span><span class = "S17">'lp-'</span><span class = "S16">,</span><span class = "S17">'lp+'</span><span class = "S12">}; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">bestResult = n; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">bestAprox = </span><span class = "S17">''</span><span class = "S12">; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">for </span><span class = "S12">i=1:length(approximations)     </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">	solution = sparseLP(char(approximations(i)),constraint);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">	</span><span class = "S15">if </span><span class = "S12">solution.stat == 1         </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">		</span><span class = "S15">if </span><span class = "S12">bestResult &gt; length(find(abs(solution.x)&gt;eps))             </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">			bestResult=length(find(abs(solution.x)&gt;eps));             </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">			bestAprox = char(approximations(i));             </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">			solutionL0 = solution;         </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">		</span><span class = "S15">end</span><span class = "S12">     </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">	</span><span class = "S22">end </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S22">end </span></p></div></div><p class = "S19"><span class = "S2">Now we call the sparse linear step function approximations  </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">bestResult = n;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">bestAprox = </span><span class = "S17">''</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">for </span><span class = "S12">i=1:length(approximations)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    solution = sparseLP(char(approximations(i)),constraint);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S15">if </span><span class = "S12">solution.stat == 1</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">        nnzSol=nnz(abs(solution.x)&gt;feasTol);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">        fprintf(</span><span class = "S17">'%u%s%s'</span><span class = "S16">,nnzSol,</span><span class = "S17">' active reactions in the sparseFBA solution with '</span><span class = "S12">, char(approximations(i)))</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">        </span><span class = "S15">if </span><span class = "S12">bestResult &gt; nnzSol</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">            bestResult=nnzSol;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">            bestAprox = char(approximations(i));</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">            solutionL0 = solution;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">        </span><span class = "S22">end</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S22">end</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S22">end</span></p></div></div><p class = "S19"><span class = "S2">Select the most sparse flux vector, unless there is a numerical problem.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">if </span><span class = "S16">~isequal(bestAprox,</span><span class = "S17">''</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    vBest = solutionL0.x;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S22">else</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    vBest = [];</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    error(</span><span class = "S17">'Min L0 problem error !!!!'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S22">end</span></p></div></div><p class = "S19"><span class = "S2">Report the best approximation</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">display(strcat(</span><span class = "S17">'Best step function approximation: '</span><span class = "S12">,bestAprox))</span></p></div></div><p class = "S19"><span class = "S2">Report the number of active reactions in the most sparse flux vector</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">fprintf(</span><span class = "S17">'%u%s'</span><span class = "S16">,nnz(abs(vBest)&gt;feasTol),</span><span class = "S17">' active reactions in the best sparse flux balance analysis solution.'</span><span class = "S12">)</span></p></div></div><p class = "S19"><span class = "S2">Warn if there might be a numerical issue with the solution</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">feasError=norm(constraint.A * solutionL0.x - constraint.b,2);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">if </span><span class = "S12">feasError&gt;feasTol</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    fprintf(</span><span class = "S17">'%g\t%s\n'</span><span class = "S16">,feasError, </span><span class = "S17">' feasibily error.'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    warning(</span><span class = "S17">'Numerical issue with the sparseLP solution'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S22">end</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">REFERENCES</span></h2><p class = "S4"><span class = "S21"> </span><span class = "S2">[1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span class = "S2"> </span><span class = "S2">optimization</span><span class = "S2">. European Journal of Operational Research 244, 2646.</span></p><p class = "S4"><span class = "S2">[2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). A community-driven global reconstruction of human metabolism. Nat Biotechnol 31, 419-425.</span></p></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Sparse Linear Optimisation
%% Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.
%% Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.
%% INTRODUCTION
% In this tutorial, we will show how to use the sparse LP solver. This solver 
% aims to solve the following optimisation problem
% 
% $$\begin{array}{ll}\min & \Vert x\Vert_{0}\\s.t & A_{eq}x=b_{eq}\\ & A_{ieq}x\leq 
% b_{ieq}\\ & l\leq x\leq u\end{array}$$
% 
% It has been proved that zero-norm is a non-convex function and the minimisation 
% of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively 
% developed. For a complete study of non-convex approximations of zero-norm, the 
% reader is referred to Le Thie et al. (2015)$^1$.
% 
% The method is described in Le Thie et al. (2015)$^1$. The sparse LP solver 
% contains one convex (one-norm) and 6 non-convex approximation of zero-norms
% 
% * Capped-L1 norm
% * Exponential function
% * Logarithmic function
% * SCAD (Smoothly Clipped Absolute Deviation) function
% * p norm with    p<0    
% * p norm with    0<p<1   
% 
% The tutorial consist of two parts. Part 1 shows a basic usage of the solver. 
% In part 2 provides an application of the code for finding the minimal set of 
% reactions subject to a LP objective. Ready-made scripts are provided for both 
% parts.
%% EQUIPMENT SETUP
%% *Initialize the COBRA Toolbox.*
% If necessary, initialize The Cobra Toolbox using the |initCobraToolbox| function.

initCobraToolbox
%% COBRA model. 
% In this tutorial, the model used is the generic reconstruction of human metabolism, 
% the Recon 2.04$^2$, which is provided in the COBRA Toolbox. The Recon 2.04 model 
% can also be downloaded from the <https://www.vmh.life/#downloadview Virtual 
% Metabolic Human> webpage. You can also select your own model to work with. Before 
% proceeding with the simulations, the path for the model needs to be set up:      

global CBTDIR
modelFileName = 'Recon2.v04.mat';
modelDirectory = getDistributedModelFolder(modelFileName); %Look up the folder for the distributed Models.
modelFileName= [modelDirectory filesep modelFileName]; % Get the full path. Necessary to be sure, that the right model is loaded
model = readCbModel(modelFileName);
%% 
% *NOTE: The following text, code, and results are shown for the Recon 2.04 
% model*
%% PROCEDURE
%% Example of using sparseLP solver on randomly generated data
% One randomly generates a matrix $A\in\mathcal{R}^{^{m\times n}}$   and a vector 
% $x_{0}\in\mathcal{R}^{^{n}}$ . The right hand side vector $b=A\cdot x_{0}$. 
% There are three optional inputs for the method.

n = 100; 
m = 50; 
x0 = rand(n,1); 
constraint.A = rand(m,n); 
constraint.b = constraint.A*x0; 
constraint.lb = -1000*ones(n,1); 
constraint.ub = 1000*ones(n,1); 
constraint.csense = repmat('E', m, 1); 
%% 
% The two first: maximum number of iterations (_nbMaxIteration_) and threshold 
% (_epsilon_) are stopping criterion conditions. _theta_ is the parameter of zero-norm 
% approximation. The greater the value of _theta_, the better the approximation 
% of the zero-norm. However, the greater the value of _theta_, the more local 
% solutions the problem has. If the value of _theta _is not given then the algorithm 
% will use a default value and update it gradually.

params.nbMaxIteration = 100;    % stopping criteria
params.epsilon = 1e-6; 		% stopping criteria
params.theta   = 2;    		 % parameter of l0 approximation 
%% 
% Call the solver with a chosen approximation

solution = sparseLP('cappedL1',constraint,params); 
%% 
% or with default parameter

%solution = sparseLP('cappedL1',constraint);
%% Finding the minimal set of reactions subject to a LP objective
% Set the tolerance to distinguish between zero and non-zero flux, based on 
% the numerical tolerance of the currently installed optimisation solver.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% 
% Select the biomass reaction to optimise

model.biomassBool=strcmp(model.rxns,'biomass_reaction');
model.c(model.biomassBool)=1;
%% 
% We will firstly find the optimal value subject to a LP objective

%% Solve FBA  
% max c'v 
% s.t   Sv = b 
%       l <= v <= u
% Define the LP structure 
[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); 
[m,n] = size(S); 
LPproblem = struct('c',-c,'osense',1,'A',S,'csense',csense,'b',b,'lb',lb,'ub',ub);  
% Call solveCobraLP to solve the LP 
LPsolution = solveCobraLP(LPproblem);
vFBA = LPsolution.full;
%% 
% We will now find the minimum number of reactions needed to achieve the 
% same max objective found previously. Then one will add one more constraint: 
% $$c^{T}v=c^{T}v_{FBA}=:f_{FBA}$$.

constraint.A = [S ; c']; 
constraint.b = [b ; c'*vFBA]; 
constraint.csense = [csense;'E'];
constraint.lb = lb; 
constraint.ub = ub;
%% 
% Call the sparseLP solver to solve the problem
% 
% $$\begin{array}{ll}\min & \Vert v\Vert_{0}\\s.t & Sv=b\\ & c^{T}v=f_{FBA}\\ 
% & l\leq v\leq u\end{array}$$

% Try all non-convex approximations of zero norm and take the best result 
approximations = {'cappedL1','exp','log','SCAD','lp-','lp+'}; 
bestResult = n; 
bestAprox = ''; 
for i=1:length(approximations)     
	solution = sparseLP(char(approximations(i)),constraint);
	if solution.stat == 1         
		if bestResult > length(find(abs(solution.x)>eps))             
			bestResult=length(find(abs(solution.x)>eps));             
			bestAprox = char(approximations(i));             
			solutionL0 = solution;         
		end     
	end 
end 
%% 
% Now we call the sparse linear step function approximations  

bestResult = n;
bestAprox = '';
for i=1:length(approximations)
    solution = sparseLP(char(approximations(i)),constraint);
    if solution.stat == 1
        nnzSol=nnz(abs(solution.x)>feasTol);
        fprintf('%u%s%s',nnzSol,' active reactions in the sparseFBA solution with ', char(approximations(i)))
        if bestResult > nnzSol
            bestResult=nnzSol;
            bestAprox = char(approximations(i));
            solutionL0 = solution;
        end
    end
end
%% 
% Select the most sparse flux vector, unless there is a numerical problem.

if ~isequal(bestAprox,'')
    vBest = solutionL0.x;
else
    vBest = [];
    error('Min L0 problem error !!!!')
end
%% 
% Report the best approximation

display(strcat('Best step function approximation: ',bestAprox))
%% 
% Report the number of active reactions in the most sparse flux vector

fprintf('%u%s',nnz(abs(vBest)>feasTol),' active reactions in the best sparse flux balance analysis solution.')
%% 
% Warn if there might be a numerical issue with the solution

feasError=norm(constraint.A * solutionL0.x - constraint.b,2);
if feasError>feasTol
    fprintf('%g\t%s\n',feasError, ' feasibily error.')
    warning('Numerical issue with the sparseLP solution')
end
%% REFERENCES
% _ _[1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation 
% approaches for sparse optimization. European Journal of Operational Research 
% 244, 2646.
% 
% [2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, 
% M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). 
% A community-driven global reconstruction of human metabolism. Nat Biotechnol 
% 31, 419-425.
##### SOURCE END #####
--></body></html>