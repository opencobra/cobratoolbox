<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>OptKnock Tutorial</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { font-family: Helvetica, Arial, sans-serif; margin-left: 0px; margin-top: 10px; margin-bottom: 20px; margin-right: 0px;  }
.S7 { text-align: left; line-height: 21px; white-space: pre-wrap; white-space: pre-wrap; margin-left: 56px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S10 { line-height: 15.5926666259766px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S11 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S13 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S14 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S15 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S16 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S17 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S18 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S19 { color: rgb(64, 64, 64); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S20 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
.outputGroup {margin: 2px 0 2px 0; padding: 2px 2px 2px 4px;}
.outputRegion {}
.outputParagraph {color: rgba(64, 64, 64, 1); padding: 10px 0 6px 17px; background: white; overflow-x: hidden;}
.inlineWrapper:last-child .outputParagraph {border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}
.outputParagraph:empty {margin: 0;}
.inlineElement .symbolicElement {}
.embeddedOutputsSymbolicElement .MathEquation {margin-top: 5px; margin-bottom: 5px;}
.embeddedOutputsSymbolicElement .MathEquation.displaySymbolicElement {margin-left: 15px;}
.embeddedOutputsSymbolicElement .MathEquation.inlineSymbolicElement {margin-left: 5px;}
.embeddedOutputsSymbolicElement {overflow-x: auto; overflow-y: hidden;}
.embeddedOutputsSymbolicElement { overflow: initial !important;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement { max-height: none !important; overflow: initial !important;}
.veSpecifier {}
.veContainer {}
.veSpecifierBox {height: 400px; width: 500px;}
.veSpecifier .veTable {padding-top: 3px; padding-bottom: 4px;}
.veSpecifierBox .veSpecifier .veContainer {position: relative; width: 100%; height: 370px;}
.veSpecifierBox .dijitDialogPaneContent {width: 97% !important; height: 88% !important;}
.veSpecifier .veTable .rowHeadersWrapper {padding-bottom: 0;}
.veSpecifier .veTable .scroller .variableEditorRenderers {padding-right: 3px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;}
.veVariableValueSummary {display: inline-block;}
.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {visibility: hidden; z-index: 0;}
.veMetaSummary {font-style: italic;}
.veSpecifier .veTable .scroller {overflow: hidden;}
.veSpecifier .veTable:hover .scroller {overflow: auto;}
.veSpecifier .veVariableName,.veSpecifier .veDimensionFont {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.veSpecifier .veVariableName {padding-top: 3px;}
.veSpecifier .veDimensionFont {font-style: italic; color: #9A9A9A;}
.veSpecifier .scroller::-webkit-scrollbar-track {background-color: white;}
.veSpecifier .scroller::-webkit-scrollbar-corner {background-color: white;}
.veSpecifier .veTable .topRowHeaderWrapper {border: none; background-color: #F8F9FA;}
.veSpecifier .mw_type_ListBase.showCellBorders,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper,.veSpecifier .veTable .verticalScrollSpacer,.veSpecifier .veTable .horizontalScrollSpacer {border: none;}
.veSpecifier .veTable .dataScrollerNode {border: 1px solid #BFBFBF;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode,.veSpecifier .veTable .dataBody {font-family: Arial; font-size: 13px;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode {color: #7F7F7F;}
.veSpecifier .veTable .dataBody {color: #000000;}
.veSpecifier .veTable .columnHeaderNode .cell .drag,.veSpecifier .veTable .columnHeaderNode .cell .header,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {background-color: #F8F9FA;}
.veSpecifier .veTable .columnHeaderNode .cell .dragBorder {border-right: 1px solid #F8F9FA;}
.veSpecifier .veTable .rowHeaderNode .cell {padding-top: 3px; text-align: center; border-bottom: 1px solid #F8F9FA;}
.veSpecifier .veTable .dataBody .cell .plainText {text-align: right;}
.veSpecifier .veTable .dataBody .row .cell {border-bottom: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.embeddedOutputsVariableElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement {min-height: 18px; box-sizing: border-box; font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.embeddedOutputsMatrixElement.inlineElement .veVariableName {padding-top: 0;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer {white-space: nowrap; padding-top: 10px; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.matrixElement { max-height: none !important; }
.dijitTooltipDialog .dijitTooltipContainer .dijitTooltipContents .alertPlugin-alertMessage {min-width: 12px; max-width: 400px; max-height: 300px; overflow: auto;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar {width: 11px; height: 11px;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-track {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-corner {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {border-radius: 7px; background-color: rgba(0, 0, 0, 0.1); border: 2px solid rgba(0, 0, 0, 0); background-clip: padding-box;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.1);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.alertPlugin-alertLine {position: absolute; display: initial; width: 40px; text-align: right; cursor: text;}
.alertPlugin-onTextLine {visibility: hidden;}
.alertPlugin-hasTooltip .alertPlugin-warningImg,.alertPlugin-hasTooltip .alertPlugin-errorImg {cursor: pointer;}
.alertPlugin-isStale {-webkit-filter: opacity(0.4) grayscale(80%); filter: opacity(0.4) grayscale(80%);}
.alertPlugin-alertLine .alertPlugin-errorElement {display: inline-block; margin-right: 4px;}
.alertPlugin-errorImg {position: relative; display: inline-block; background-color: rgb(204, 55, 41); width: 14px; height: 14px; margin-top: 1px; -webkit-border-radius: 7px;}
.alertPlugin-alertLine .alertPlugin-warningElement {display: inline-block; margin-right: 3px;}
.alertPlugin-warningImg {position: relative; display: inline-block; width: 16px; height: 15px; overflow: hidden;}
.diagnosticMessage-wrapper {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.alertPlugin-warningImg {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAPCAYAAADUFP50AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3wgUDS0rRPm/rwAAAAd0RVh0QXV0aG9yAKmuzEgAAAAMdEVYdERlc2NyaXB0aW9uABMJISMAAAAKdEVYdENvcHlyaWdodACsD8w6AAAADnRFWHRDcmVhdGlvbiB0aW1lADX3DwkAAAAJdEVYdFNvZnR3YXJlAF1w/zoAAAALdEVYdERpc2NsYWltZXIAt8C0jwAAAAh0RVh0V2FybmluZwDAG+aHAAAAB3RFWHRTb3VyY2UA9f+D6wAAAAh0RVh0Q29tbWVudAD2zJa/AAAABnRFWHRUaXRsZQCo7tInAAAA80lEQVQokY2SPQrCQBCF3yaChUXS2eoNbOwschSPojfQG8QT6BEExcbKEyiCgYiSWFhIIs9iXONm488Hw+7OzOPNsguSsOI0JVe+xGnKqh5FEgZ5SqzbwD2Vs+sD3S1Q89V7m4My0agQAbKPRlabOUKWyHgL8MUCkssSY2TTsez2xbUQ5ilxGNsizWEsPZZwP6h2e3fdD0uOeUrEk88iTRy+XEWo78ZvKhh3VcwS891+8XxXB8fQFP3jegzh4DwzC/p/9ChRxXkGB/mfI5aowQuA68auLJWd0zQ6z08eh8RlDtx2RfF+kdX1ily9BXgB0OyrB6CCtdLfhGTSAAAAAElFTkSuQmCC)}
.alertPlugin-errorImg {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3wgUDSwzTo4WuAAAAAd0RVh0QXV0aG9yAKmuzEgAAAAMdEVYdERlc2NyaXB0aW9uABMJISMAAAAKdEVYdENvcHlyaWdodACsD8w6AAAADnRFWHRDcmVhdGlvbiB0aW1lADX3DwkAAAAJdEVYdFNvZnR3YXJlAF1w/zoAAAALdEVYdERpc2NsYWltZXIAt8C0jwAAAAh0RVh0V2FybmluZwDAG+aHAAAAB3RFWHRTb3VyY2UA9f+D6wAAAAh0RVh0Q29tbWVudAD2zJa/AAAABnRFWHRUaXRsZQCo7tInAAABJ0lEQVQokZWSsWqDUBSG/3stQgpKxcU6OYl0FUI3hzrVxUfo3jeQOlXyBt37CC7pZAe3ECrdQpsuTkkXsWhoQJDbpTfExEDyjeecn/9wzk8YY+C0dcWKlxg/6St+5x8AgHPTwoVzA/XWhyDJhM8SLqyzKcujAM1ygT7ESx3GwwiSPSQbYZ1N2fz+rjNoT2YAgOz6qlM3n54h2UNC27pieRT0uvSRRwHaumK0GMcH1+ujWS5QjGPQMk2OFnHKNAFd/1/vFNZfn6AnqwCAMZwNTAur97e93u41txmYFqjiuCcbKo4Lqno+RE3fa9qT2eaX24iaDtXzQQVJJkY4OtrNCEcQJJl0I/cYoPk+EDlNhxHuRI7T1hUrxjHKNAF/08C0oDguVK8b8j+a03ZrT40rwQAAAABJRU5ErkJggg==)}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">OptKnock Tutorial</span></h1><h2 class = "S3"><span class = "S2">Author: Sebastián N. Mendoza,  Center for Mathematical Modeling, University of Chile. snmendoz@uc.cl</span></h2><h2 class = "S3"><span class = "S2">Reviewer(s): Thomas Pfau, Sylvian Arreckx, Laurent Heirendt &amp; Ronan Fleming</span></h2><h2 class = "S3"><span class = "S2">INTRODUCTION:</span></h2><p class = "S4"><span class = "S2">In this tutorial we will run optKnock. For a detailed description of the procedure, please see [1]. Briefly, the problem is to find a set of reactions of size "numDel" such that when these reactions are deleted from the network, the mutant created will produce a particular target of interest in a higher rate than the wild-type strain. </span></p><p class = "S4"><span class = "S2">For example, imagine that we would like to increase the production of succinate or lactate in Escherichia coli. Which are the knock-outs needed to increase the production of these products? We will approach these problems in this tutorial.</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2">MATERIALS</span></h2><h2 class = "S3"><span class = "S2">EQUIPMENT</span></h2><ol class = "S6"><li class = "S7"><span class = "S0">MATLAB</span></li><li class = "S7"><span class = "S0">A solver for Mixed Integer Linear Programming (MILP) problems. For example, Gurobi.</span></li></ol><h2 class = "S3"><span class = "S2">EQUIPMENT SETUP</span></h2><p class = "S4"><span class = "S2">Use changeCobraSolver to choose the solver for MILP problems. </span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2">PROCEDURE</span></h2><p class = "S4"><span class = "S2">The proceduce consists on the following steps</span></p><p class = "S4"><span class = "S2">1) Define contraints</span></p><p class = "S4"><span class = "S2">2) Define a set of reactions to search knockouts. Only reactions in this set will be deleted. </span></p><p class = "S4"><span class = "S2">3) Define the number of reactions to be deleter, the target reaction and some constraints to be accomplish</span></p><p class = "S4"><span class = "S2">4) Run optKnock. </span><span class = "S8">TIMING: </span><span class = "S2">This task should take from a few seconds to a few hours depending on the size of your reconstruction</span></p><p class = "S4"><span class = "S2">We verify that cobratoolbox has been initialized and that the solver has been set.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">global </span><span class = "S12">TUTORIAL_INIT_CB;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">if </span><span class = "S12">~isempty(TUTORIAL_INIT_CB) &amp;&amp; TUTORIAL_INIT_CB==1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    initCobraToolbox</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    changeCobraSolver(</span><span class = "S14">'gurobi'</span><span class = "S13">,</span><span class = "S14">'all'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">fullPath = which(</span><span class = "S14">'optKnockTutorial'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">folder = fileparts(fullPath);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">currectDirectory = pwd;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">cd(folder);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">We load the model of E. coli [2]</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = readCbModel(</span><span class = "S14">'iJO1366.mat'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">biomass = </span><span class = "S14">'BIOMASS_Ec_iJO1366_core_53p95M'</span><span class = "S12">;</span></p></div></div><p class = "S17"><span class = "S2">We define the maximum number of solutions to find</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">threshold = 5;</span></p></div></div><p class = "S17"><span class = "S2">First, we define the set for reactions which could be deleted from the network. Reactions not in this list are not going to be deleted.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">selectedRxnList = {</span><span class = "S14">'GLCabcpp'</span><span class = "S13">; </span><span class = "S14">'GLCptspp'</span><span class = "S13">; </span><span class = "S14">'HEX1'</span><span class = "S13">; </span><span class = "S14">'PGI'</span><span class = "S13">; </span><span class = "S14">'PFK'</span><span class = "S13">; </span><span class = "S14">'FBA'</span><span class = "S13">; </span><span class = "S14">'TPI'</span><span class = "S13">; </span><span class = "S14">'GAPD'</span><span class = "S13">; </span><span class = "S14">'PGK'</span><span class = "S13">; </span><span class = "S14">'PGM'</span><span class = "S13">; </span><span class = "S14">'ENO'</span><span class = "S13">; </span><span class = "S14">'PYK'</span><span class = "S13">; </span><span class = "S14">'LDH_D'</span><span class = "S13">; </span><span class = "S14">'PFL'</span><span class = "S13">; </span><span class = "S14">'ALCD2x'</span><span class = "S13">; </span><span class = "S14">'PTAr'</span><span class = "S13">; </span><span class = "S14">'ACKr'</span><span class = "S13">; </span><span class = "S14">'G6PDH2r'</span><span class = "S13">; </span><span class = "S14">'PGL'</span><span class = "S13">; </span><span class = "S14">'GND'</span><span class = "S13">; </span><span class = "S14">'RPI'</span><span class = "S13">; </span><span class = "S14">'RPE'</span><span class = "S13">; </span><span class = "S14">'TKT1'</span><span class = "S13">; </span><span class = "S14">'TALA'</span><span class = "S13">; </span><span class = "S14">'TKT2'</span><span class = "S13">; </span><span class = "S14">'FUM'</span><span class = "S13">; </span><span class = "S14">'FRD2'</span><span class = "S13">; </span><span class = "S14">'SUCOAS'</span><span class = "S13">; </span><span class = "S14">'AKGDH'</span><span class = "S13">; </span><span class = "S14">'ACONTa'</span><span class = "S13">; </span><span class = "S14">'ACONTb'</span><span class = "S13">; </span><span class = "S14">'ICDHyr'</span><span class = "S13">; </span><span class = "S14">'CS'</span><span class = "S13">; </span><span class = "S14">'MDH'</span><span class = "S13">; </span><span class = "S14">'MDH2'</span><span class = "S13">; </span><span class = "S14">'MDH3'</span><span class = "S13">; </span><span class = "S14">'ACALD'</span><span class = "S12">};</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div><p class = "S17"><span class = "S2">Then, we define some constraints</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% prespecified amount of glucose uptake 10 mmol/grDW*hr</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_glc__D_e'</span><span class = "S13">, -10, </span><span class = "S14">'b'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% Unconstrained uptake routes for inorganic phosphate, sulfate and</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% ammonia</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_o2_e'</span><span class = "S13">, 0, </span><span class = "S14">'l'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_pi_e'</span><span class = "S13">, -1000, </span><span class = "S14">'l'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_so4_e'</span><span class = "S13">, -1000, </span><span class = "S14">'l'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_nh4_e'</span><span class = "S13">, -1000, </span><span class = "S14">'l'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% The optimization step could opt for or against the phosphotransferase</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% system, glucokinase, or both mechanisms for the uptake of glucose</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'GLCabcpp'</span><span class = "S13">, -1000, </span><span class = "S14">'l'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'GLCptspp'</span><span class = "S13">, -1000, </span><span class = "S14">'l'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'GLCabcpp'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'GLCptspp'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'GLCt2pp'</span><span class = "S13">, 0, </span><span class = "S14">'b'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% Secretion routes  for acetate, carbon dioxide, ethanol, formate, lactate</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% and succinate are enabled</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_ac_e'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_co2_e'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_etoh_e'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_for_e'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">model = changeRxnBounds(model, </span><span class = "S14">'EX_succ_e'</span><span class = "S13">, 1000, </span><span class = "S14">'u'</span><span class = "S12">);</span></p></div></div><p class = "S17"><span class = "S2">Then, we calculates the production of metabolites before running optKnock</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% determine succinate production and growth rate before optimizacion</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">fbaWT = optimizeCbModel(model);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">succFluxWT = fbaWT.x(strcmp(model.rxns, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">etohFluxWT = fbaWT.x(strcmp(model.rxns, </span><span class = "S14">'EX_etoh_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">formFluxWT = fbaWT.x(strcmp(model.rxns, </span><span class = "S14">'EX_for_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">lactFluxWT = fbaWT.x(strcmp(model.rxns, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">acetFluxWT = fbaWT.x(strcmp(model.rxns, </span><span class = "S14">'EX_ac_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">growthRateWT = fbaWT.f;</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'The production of succinate before optimization is %.1f \n'</span><span class = "S12">, succFluxWT);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate before optimization is 0.1 </div></div></div></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'The growth rate before optimization is %.1f \n'</span><span class = "S12">, growthRateWT);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate before optimization is 0.2 </div></div></div></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'The production of other products such as ethanol, formate, lactate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n'</span><span class = "S12">, etohFluxWT, formFluxWT, lactFluxWT, acetFluxWT);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 8.1, 17.3, 0.0 and 8.2, respectively. </div></div></div></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S8">I) SUCCINATE OVERPRODUCTION</span></p><p class = "S4"><span class = "S8">EXAMPLE 1:</span><span class = "S2"> </span><span class = "S8">finding optKnock reactions sets of large 2 for increasing production of succinate</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'\n...EXAMPLE 1: Finding optKnock sets of large 2 or less...\n\n'</span><span class = "S12">)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...EXAMPLE 1: Finding optKnock sets of large 2 or less...</div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% Set optKnock options</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% The exchange of succinate will be the objective of the outer problem</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">options = struct(</span><span class = "S14">'targetRxn'</span><span class = "S13">, </span><span class = "S14">'EX_succ_e'</span><span class = "S13">, </span><span class = "S14">'numDel'</span><span class = "S12">, 2);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will impose that biomass be at least 50% of the biomass of wild-type</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">constrOpt = struct(</span><span class = "S14">'rxnList'</span><span class = "S13">, {{biomass}},</span><span class = "S14">'values'</span><span class = "S13">, 0.5*fbaWT.f, </span><span class = "S14">'sense'</span><span class = "S13">, </span><span class = "S14">'G'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will try to find 10 optKnock sets of a maximun length of 2</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">previousSolutions = cell(10, 1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">contPreviousSolutions = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">nIter = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">while </span><span class = "S12">nIter &lt; threshold</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'...Performing optKnock analysis...\n'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">isempty(previousSolutions{1})</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions, 1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S18">% determine succinate production and growth rate after optimizacion</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns, biomass));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_etoh_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_for_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_ac_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    setM1 = optKnockSol.rxnList;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">~isempty(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        previousSolutions{contPreviousSolutions} = setM1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        contPreviousSolutions = contPreviousSolutions + 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S18">%printing results</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'optKnock found a optKnock set of large %d composed by '</span><span class = "S12">, length(setM1));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">for </span><span class = "S12">j = 1:length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">if </span><span class = "S12">j == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">'%s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">elseif </span><span class = "S12">j == length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">' and %s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">', %s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of succinate after optimization is %.2f \n'</span><span class = "S12">, succFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The growth rate after optimization is %.2f \n'</span><span class = "S12">, growthRateM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of other products such as ethanol, formate, lactate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n'</span><span class = "S12">, etohFluxM1, formFluxM1, lactFluxM1, acetFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'...Performing coupling analysis...\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The solution is of type: %s\n'</span><span class = "S12">, type);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun growth rate given the optKnock set is %.2f\n'</span><span class = "S12">, maxGrowth);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun and minimun production of succinate given the optKnock set is %.2f and %.2f, respectively \n\n'</span><span class = "S12">, minProd, maxProd);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">if </span><span class = "S13">strcmp(type, </span><span class = "S14">'growth coupled'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            singleProductionEnvelope(model, setM1, </span><span class = "S14">'EX_succ_e'</span><span class = "S13">, biomass, </span><span class = "S14">'savePlot'</span><span class = "S13">, 1, </span><span class = "S14">'showPlot'</span><span class = "S13">, 1, </span><span class = "S14">'fileName'</span><span class = "S13">, [</span><span class = "S14">'succ_ex1_' </span><span class = "S13">num2str(nIter)], </span><span class = "S14">'outputFolder'</span><span class = "S13">, </span><span class = "S14">'OptKnockResults'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">end</span><span class = "S12">,</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">if </span><span class = "S12">nIter == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found an optKnock set\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found additional optKnock sets\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">break</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    nIter = nIter + 1;</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 2 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and TKT2</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 1.68 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.22 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 14.9, 0.0, -0.0 and -0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.18</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 0.06 and 1.41, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="697" style="width: 708px;"><div class="textElement">MILP problem with 8398 constraints 63 integer variables and 8370 continuous variables<br>Optimize a model with 8398 rows, 8370 columns and 34671 nonzeros<br>Variable types: 8307 continuous, 63 integer (63 binary)<br>Coefficient statistics:<br>&nbsp;&nbsp;Matrix range&nbsp;&nbsp;&nbsp;&nbsp; [2e-06, 1e+03]<br>&nbsp;&nbsp;Objective range&nbsp;&nbsp;[1e+00, 1e+00]<br>&nbsp;&nbsp;Bounds range&nbsp;&nbsp;&nbsp;&nbsp; [1e+00, 1e+03]<br>&nbsp;&nbsp;RHS range&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1e-02, 1e+03]<br>Presolve removed 5079 rows and 3321 columns<br>Presolve time: 0.28s<br>Presolved: 3319 rows, 5049 columns, 21617 nonzeros<br>Variable types: 5012 continuous, 37 integer (37 binary)<br><br>Root relaxation: objective 1.230321e+01, 3505 iterations, 0.79 seconds<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Nodes&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Current Node&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; Objective Bounds&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; Work<br> Expl Unexpl |&nbsp;&nbsp;Obj&nbsp;&nbsp;Depth IntInf | Incumbent&nbsp;&nbsp;&nbsp;&nbsp;BestBd&nbsp;&nbsp; Gap | It/Node Time<br><br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>H&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0915893&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp;81&nbsp;&nbsp;&nbsp;&nbsp;71&nbsp;&nbsp;&nbsp;&nbsp;5.47336&nbsp;&nbsp; 24&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;64.2&nbsp;&nbsp;&nbsp;&nbsp;5s<br>*&nbsp;&nbsp; 91&nbsp;&nbsp;&nbsp;&nbsp;62&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.1718801&nbsp;&nbsp; 12.30321&nbsp;&nbsp;7058%&nbsp;&nbsp;73.0&nbsp;&nbsp;&nbsp;&nbsp;5s<br>*&nbsp;&nbsp;167&nbsp;&nbsp;&nbsp;&nbsp;71&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.2411614&nbsp;&nbsp; 12.30321&nbsp;&nbsp;5002%&nbsp;&nbsp;81.0&nbsp;&nbsp;&nbsp;&nbsp;8s<br>H&nbsp;&nbsp;170&nbsp;&nbsp;&nbsp;&nbsp;71&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.2864668&nbsp;&nbsp; 12.30321&nbsp;&nbsp;4195%&nbsp;&nbsp;79.6&nbsp;&nbsp;&nbsp;&nbsp;8s<br>&nbsp;&nbsp; 194&nbsp;&nbsp;&nbsp;&nbsp;77&nbsp;&nbsp; 12.30321&nbsp;&nbsp; 19&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;0.28647&nbsp;&nbsp; 12.30321&nbsp;&nbsp;4195%&nbsp;&nbsp;82.5&nbsp;&nbsp; 10s<br>*&nbsp;&nbsp;242&nbsp;&nbsp;&nbsp;&nbsp;89&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.2019176&nbsp;&nbsp; 12.30321&nbsp;&nbsp; 924%&nbsp;&nbsp;80.7&nbsp;&nbsp; 10s<br>*&nbsp;&nbsp;292&nbsp;&nbsp;&nbsp;&nbsp;91&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.4425937&nbsp;&nbsp; 12.29845&nbsp;&nbsp; 753%&nbsp;&nbsp;81.0&nbsp;&nbsp; 12s<br>&nbsp;&nbsp; 339&nbsp;&nbsp;&nbsp;&nbsp;37 infeasible&nbsp;&nbsp; 17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.44259&nbsp;&nbsp; 10.09393&nbsp;&nbsp; 600%&nbsp;&nbsp;84.7&nbsp;&nbsp; 15s<br>*&nbsp;&nbsp;361&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.7454999&nbsp;&nbsp;&nbsp;&nbsp;8.37613&nbsp;&nbsp; 205%&nbsp;&nbsp;84.5&nbsp;&nbsp; 15s<br><br>Explored 398 nodes (39947 simplex iterations) in 17.01 seconds<br>Thread count was 4 (of 4 available processors)<br><br>Solution count 7: 2.7455 1.44259 1.20192 ... 0.0915893<br>Pool objective bound 2.7455<br><br>Optimal solution found (tolerance 1.00e-12)<br>Warning: max constraint violation (4.4603e-09) exceeds tolerance<br>Best objective 2.745499915504e+00, best bound 2.745499915504e+00, gap 0.0000%</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 2 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and RPI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 2.75 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.14 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 0.0, 0.0, 9.4 and -0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.12</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 0.04 and 2.31, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="697" style="width: 708px;"><div class="textElement">MILP problem with 8399 constraints 63 integer variables and 8370 continuous variables<br>Optimize a model with 8399 rows, 8370 columns and 34674 nonzeros<br>Variable types: 8307 continuous, 63 integer (63 binary)<br>Coefficient statistics:<br>&nbsp;&nbsp;Matrix range&nbsp;&nbsp;&nbsp;&nbsp; [2e-06, 1e+03]<br>&nbsp;&nbsp;Objective range&nbsp;&nbsp;[1e+00, 1e+00]<br>&nbsp;&nbsp;Bounds range&nbsp;&nbsp;&nbsp;&nbsp; [1e+00, 1e+03]<br>&nbsp;&nbsp;RHS range&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1e-02, 1e+03]<br>Presolve removed 5079 rows and 3321 columns<br>Presolve time: 0.27s<br>Presolved: 3320 rows, 5049 columns, 21619 nonzeros<br>Variable types: 5012 continuous, 37 integer (37 binary)<br><br>Root relaxation: objective 1.230321e+01, 3899 iterations, 1.28 seconds<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Nodes&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Current Node&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; Objective Bounds&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; Work<br> Expl Unexpl |&nbsp;&nbsp;Obj&nbsp;&nbsp;Depth IntInf | Incumbent&nbsp;&nbsp;&nbsp;&nbsp;BestBd&nbsp;&nbsp; Gap | It/Node Time<br><br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>H&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0915893&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;3s<br>*&nbsp;&nbsp; 75&nbsp;&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.2864668&nbsp;&nbsp; 12.30321&nbsp;&nbsp;4195%&nbsp;&nbsp;41.7&nbsp;&nbsp;&nbsp;&nbsp;4s<br>&nbsp;&nbsp;&nbsp;&nbsp;91&nbsp;&nbsp;&nbsp;&nbsp;62&nbsp;&nbsp;&nbsp;&nbsp;8.49366&nbsp;&nbsp; 22&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;0.28647&nbsp;&nbsp; 12.30321&nbsp;&nbsp;4195%&nbsp;&nbsp;41.9&nbsp;&nbsp;&nbsp;&nbsp;5s<br>*&nbsp;&nbsp;307&nbsp;&nbsp;&nbsp;&nbsp;74&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.2019176&nbsp;&nbsp; 12.29845&nbsp;&nbsp; 923%&nbsp;&nbsp;58.1&nbsp;&nbsp;&nbsp;&nbsp;8s<br>&nbsp;&nbsp; 359&nbsp;&nbsp;&nbsp;&nbsp;46&nbsp;&nbsp; 12.28821&nbsp;&nbsp; 17&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;1.20192&nbsp;&nbsp; 12.28821&nbsp;&nbsp; 922%&nbsp;&nbsp;65.3&nbsp;&nbsp; 10s<br>*&nbsp;&nbsp;412&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.4425937&nbsp;&nbsp;&nbsp;&nbsp;9.52490&nbsp;&nbsp; 560%&nbsp;&nbsp;68.1&nbsp;&nbsp; 11s<br><br>Explored 435 nodes (37087 simplex iterations) in 12.97 seconds<br>Thread count was 4 (of 4 available processors)<br><br>Solution count 4: 1.44259 1.20192 0.286467 0.0915893 <br>Pool objective bound 1.44259<br><br>Optimal solution found (tolerance 1.00e-12)<br>Best objective 1.442593734178e+00, best bound 1.442593734178e+00, gap 0.0000%</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 2 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and RPE</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 1.44 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.22 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 15.2, 0.0, -0.0 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.18</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 0.06 and 1.22, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="697" style="width: 708px; max-height: 504px;"><div class="textElement">MILP problem with 8400 constraints 63 integer variables and 8370 continuous variables<br>Optimize a model with 8400 rows, 8370 columns and 34677 nonzeros<br>Variable types: 8307 continuous, 63 integer (63 binary)<br>Coefficient statistics:<br>&nbsp;&nbsp;Matrix range&nbsp;&nbsp;&nbsp;&nbsp; [2e-06, 1e+03]<br>&nbsp;&nbsp;Objective range&nbsp;&nbsp;[1e+00, 1e+00]<br>&nbsp;&nbsp;Bounds range&nbsp;&nbsp;&nbsp;&nbsp; [1e+00, 1e+03]<br>&nbsp;&nbsp;RHS range&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1e-02, 1e+03]<br>Presolve removed 5079 rows and 3321 columns<br>Presolve time: 0.26s<br>Presolved: 3321 rows, 5049 columns, 21621 nonzeros<br>Variable types: 5012 continuous, 37 integer (37 binary)<br><br>Root relaxation: objective 1.230321e+01, 3442 iterations, 1.00 seconds<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Nodes&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;Current Node&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; Objective Bounds&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp; Work<br> Expl Unexpl |&nbsp;&nbsp;Obj&nbsp;&nbsp;Depth IntInf | Incumbent&nbsp;&nbsp;&nbsp;&nbsp;BestBd&nbsp;&nbsp; Gap | It/Node Time<br><br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>H&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0915893&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>H&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0915893&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;0.09159&nbsp;&nbsp; 12.30321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;2s<br>*&nbsp;&nbsp; 73&nbsp;&nbsp;&nbsp;&nbsp;61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.2411614&nbsp;&nbsp; 12.30321&nbsp;&nbsp;5002%&nbsp;&nbsp;39.7&nbsp;&nbsp;&nbsp;&nbsp;4s<br>*&nbsp;&nbsp;122&nbsp;&nbsp;&nbsp;&nbsp;77&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.2019176&nbsp;&nbsp; 12.30321&nbsp;&nbsp; 924%&nbsp;&nbsp;44.1&nbsp;&nbsp;&nbsp;&nbsp;4s<br>&nbsp;&nbsp; 133&nbsp;&nbsp;&nbsp;&nbsp;84&nbsp;&nbsp; 12.27798&nbsp;&nbsp; 14&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;1.20192&nbsp;&nbsp; 12.30321&nbsp;&nbsp; 924%&nbsp;&nbsp;47.0&nbsp;&nbsp;&nbsp;&nbsp;5s<br><br>Explored 371 nodes (26895 simplex iterations) in 8.23 seconds<br>Thread count was 4 (of 4 available processors)<br><br>Solution count 4: 1.20192 0.241161 0.0915893 0.0915893 <br>Pool objective bound 1.20192<br><br>Optimal solution found (tolerance 1.00e-12)<br>Best objective 1.201917633440e+00, best bound 1.201917633440e+00, gap 0.0000%</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 2 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and TKT1</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 1.20 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.22 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 0.0, 0.0, 15.4 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.19</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 0.06 and 1.01, respectively </div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div><p class = "S17"><span class = "S8">TROUBLESHOOTING 1</span><span class = "S2">:  "The algorithm takes a long time to find a solution"</span></p><p class = "S4"><span class = "S8">TROUBLESHOOTING 2</span><span class = "S2">:  "The algorithm finds a set of knockouts too big"</span></p><p class = "S4"><span class = "S8">TROUBLESHOOTING 3</span><span class = "S2">:  "The algorithm found a solution that is not useful for me"</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S8">EXAMPLE 2:</span><span class = "S2"> </span><span class = "S8">finding optKnock reactions sets of large 3 for increasing production of succinate</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% Set optKnock options</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% The exchange of succinate will be the objective of the outer problem</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">options = struct(</span><span class = "S14">'targetRxn'</span><span class = "S13">, </span><span class = "S14">'EX_succ_e'</span><span class = "S13">, </span><span class = "S14">'numDel'</span><span class = "S12">, 3);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will impose that biomass be at least 50% of the biomass of wild-type</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">constrOpt = struct(</span><span class = "S14">'rxnList'</span><span class = "S13">, {{biomass}}, </span><span class = "S14">'values'</span><span class = "S13">, 0.5*fbaWT.f, </span><span class = "S14">'sense'</span><span class = "S13">, </span><span class = "S14">'G'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will try to find 10 optKnock sets of a maximun length of 3</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">nIter = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">while </span><span class = "S12">nIter &lt; threshold</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'...Performing optKnock analysis...'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">isempty(previousSolutions{1})</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S18">% determine succinate production and growth rate after optimizacion</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns, biomass));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_etoh_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_for_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_ac_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    setM1 = optKnockSol.rxnList;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">~isempty(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        previousSolutions{contPreviousSolutions} = setM1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        contPreviousSolutions=contPreviousSolutions + 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S18">%printing results</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'optKnock found a optKnock set of large %d composed by '</span><span class = "S12">,length(setM1));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">for </span><span class = "S12">j = 1:length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">if </span><span class = "S12">j == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">'%s'</span><span class = "S12">,setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">elseif </span><span class = "S12">j == length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">' and %s'</span><span class = "S12">,setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">', %s'</span><span class = "S12">,setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of succinate after optimization is %.2f \n'</span><span class = "S12">, succFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The growth rate after optimization is %.2f \n'</span><span class = "S12">, growthRateM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of other products such as ethanol, formate, lactate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n'</span><span class = "S12">, etohFluxM1, formFluxM1, lactFluxM1, acetFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'...Performing coupling analysis...\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The solution is of type: %s\n'</span><span class = "S12">, type);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun growth rate given the optKnock set is %.2f\n'</span><span class = "S12">, maxGrowth);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun and minimun production of succinate given the optKnock set is %.2f and %.2f, respectively \n\n'</span><span class = "S12">, minProd, maxProd);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">if </span><span class = "S13">strcmp(type,</span><span class = "S14">'growth coupled'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            singleProductionEnvelope(model, setM1, </span><span class = "S14">'EX_succ_e'</span><span class = "S13">, biomass, </span><span class = "S14">'savePlot'</span><span class = "S13">, 1, </span><span class = "S14">'showPlot'</span><span class = "S13">, 1, </span><span class = "S14">'fileName'</span><span class = "S13">, [</span><span class = "S14">'succ_ex2_' </span><span class = "S13">num2str(nIter)], </span><span class = "S14">'outputFolder'</span><span class = "S13">, </span><span class = "S14">'OptKnockResults'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">if </span><span class = "S12">nIter == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found an optKnock set\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found additional optKnock sets\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">break</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    nIter = nIter + 1;</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ALCD2x</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, LDH_D</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 8.81 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.15 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 0.0, 0.0, -0.0 and 4.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.11</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 9.11 and 9.11, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ACALD</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, LDH_D</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 8.81 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.15 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 0.0, 0.0, -0.0 and 4.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.11</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 4.23 and 9.11, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">LDH_D</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and TALA</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 1.20 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.22 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 15.4, 0.0, -0.0 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.19</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 0.06 and 1.01, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">GLCabcpp</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and TALA</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of succinate after optimization is 1.20 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.22 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, lactate and acetate are 0.0, 0.0, 15.4 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.19</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of succinate given the optKnock set is 0.06 and 1.01, respectively </div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S8">II) LACTATE OVERPRODUCTION</span></p><p class = "S4"><span class = "S8">EXAMPLE 1: finding optKnock reactions sets of large 3 for increasing production of lactate</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'\n...EXAMPLE 1: Finding optKnock sets of large 3...\n\n'</span><span class = "S12">)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...EXAMPLE 1: Finding optKnock sets of large 3...</div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% Set optKnock options</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% The exchange of lactate will be the objective of the outer problem</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">options = struct(</span><span class = "S14">'targetRxn'</span><span class = "S13">, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S13">, </span><span class = "S14">'numDel'</span><span class = "S12">, 3);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will impose that biomass be at least 50% of the biomass of wild-type</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">constrOpt = struct(</span><span class = "S14">'rxnList'</span><span class = "S13">, {{biomass}}, </span><span class = "S14">'values'</span><span class = "S13">, 0.5*fbaWT.f, </span><span class = "S14">'sense'</span><span class = "S13">, </span><span class = "S14">'G'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will try to find 10 optKnock sets of a maximun length of 6</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">previousSolutions = cell(100, 1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">contPreviousSolutions = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">nIter = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">while </span><span class = "S12">nIter &lt; threshold</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'...Performing optKnock analysis...'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">isempty(previousSolutions{1})</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S18">% determine lactate production and growth rate after optimizacion</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns, biomass));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_etoh_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_for_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_ac_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    setM1 = optKnockSol.rxnList;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">~isempty(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        previousSolutions{contPreviousSolutions} = setM1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        contPreviousSolutions=contPreviousSolutions + 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S18">%printing results</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'optKnock found a optKnock set of large %d composed by '</span><span class = "S12">,length(setM1));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">for </span><span class = "S12">j = 1:length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">if </span><span class = "S12">j == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">'%s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">elseif </span><span class = "S12">j == length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">' and %s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">', %s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of lactate after optimization is %.2f \n'</span><span class = "S12">, lactFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The growth rate after optimization is %.2f \n'</span><span class = "S12">, growthRateM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of other products such as ethanol, formate, succinate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n'</span><span class = "S12">, etohFluxM1, formFluxM1, succFluxM1, acetFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'...Performing coupling analysis...\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The solution is of type: %s\n'</span><span class = "S12">, type);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun growth rate given the optKnock set is %.2f\n'</span><span class = "S12">, maxGrowth);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun and minimun production of lactate given the optKnock set is %.2f and %.2f, respectively \n\n'</span><span class = "S12">, minProd, maxProd);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        singleProductionEnvelope(model, setM1, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S13">, biomass, </span><span class = "S14">'savePlot'</span><span class = "S13">, 1, </span><span class = "S14">'showPlot'</span><span class = "S13">, 1, </span><span class = "S14">'fileName'</span><span class = "S13">, [</span><span class = "S14">'lact_ex1_' </span><span class = "S13">num2str(nIter)], </span><span class = "S14">'outputFolder'</span><span class = "S13">, </span><span class = "S14">'OptKnockResults'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">if </span><span class = "S12">nIter == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found an optKnock set\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found additional optKnock sets\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">break</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    nIter = nIter + 1;</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">GLCabcpp</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and PGI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 18.13 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.0, 0.0 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.08</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.72, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">FBA</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and PGI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 18.13 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.0, 0.0 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.08</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.72, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 2 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">PFL</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and PGI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 18.13 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.0, 0.0 and 0.0, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.08</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.72, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 3 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ACKr</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, GND</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and PGI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 18.01 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.6, 0.0 and 0.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.09</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.64, respectively </div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div><p class = "S17"><span class = "S2"></span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S8">EXAMPLE 2: finding optKnock reactions sets of large 6 for increasing production of lactate</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'...EXAMPLE 3: Finding optKnock sets of large 6...\n'</span><span class = "S12">)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...EXAMPLE 3: Finding optKnock sets of large 6...</div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% Set optKnock options</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% The exchange of lactate will be the objective of the outer problem</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">options = struct(</span><span class = "S14">'targetRxn'</span><span class = "S13">, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S13">, </span><span class = "S14">'numDel'</span><span class = "S12">, 6);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will impose that biomass be at least 50% of the biomass of wild-type</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">constrOpt = struct(</span><span class = "S14">'rxnList'</span><span class = "S13">, {{biomass}}, </span><span class = "S14">'values'</span><span class = "S13">, 0.5*fbaWT.f, </span><span class = "S14">'sense'</span><span class = "S13">, </span><span class = "S14">'G'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S18">% We will try to find 10 optKnock sets of a maximun length of 2</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">nIter = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">while </span><span class = "S12">nIter &lt; threshold</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'...Performing optKnock analysis...'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">isempty(previousSolutions{1})</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S18">% determine lactate production and growth rate after optimizacion</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns,biomass));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_etoh_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_for_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_succ_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, </span><span class = "S14">'EX_ac_e'</span><span class = "S12">));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    setM1 = optKnockSol.rxnList;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    </span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">~isempty(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        previousSolutions{contPreviousSolutions} = setM1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        contPreviousSolutions = contPreviousSolutions + 1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S18">%printing results</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'optKnock found a optKnock set of large %d composed by '</span><span class = "S12">, length(setM1));</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">for </span><span class = "S12">j = 1:length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">if </span><span class = "S12">j == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">'%s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S11">elseif </span><span class = "S12">j == length(setM1)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">' and %s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">                fprintf(</span><span class = "S14">', %s'</span><span class = "S12">, setM1{j});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of lactate after optimization is %.2f \n'</span><span class = "S12">, lactFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The growth rate after optimization is %.2f \n'</span><span class = "S12">, growthRateM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The production of other products such as ethanol, formate, succinate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n'</span><span class = "S12">, etohFluxM1, formFluxM1, succFluxM1, acetFluxM1);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'...Performing coupling analysis...\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The solution is of type: %s\n'</span><span class = "S12">, type);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun growth rate given the optKnock set is %.2f\n'</span><span class = "S12">, maxGrowth);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'The maximun and minimun production of lactate given the optKnock set is %.2f and %.2f, respectively \n\n'</span><span class = "S12">, minProd, maxProd);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        singleProductionEnvelope(model, setM1, </span><span class = "S14">'EX_lac__D_e'</span><span class = "S13">, biomass, </span><span class = "S14">'savePlot'</span><span class = "S13">, 1, </span><span class = "S14">'showPlot'</span><span class = "S13">, 1, </span><span class = "S14">'fileName'</span><span class = "S13">, [</span><span class = "S14">'lact_ex2_' </span><span class = "S13">num2str(nIter)], </span><span class = "S14">'outputFolder'</span><span class = "S13">, </span><span class = "S14">'OptKnockResults'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">if </span><span class = "S12">nIter == 1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found an optKnock set\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">            fprintf(</span><span class = "S14">'optKnock was not able to found additional optKnock sets\n'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        </span><span class = "S11">break</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    nIter = nIter + 1;</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 4 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ACKr</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, MDH2, PGI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and RPE</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 17.96 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.9, 0.0 and 0.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.09</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.60, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 5 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ACKr</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, GLCabcpp, PGI, RPE</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and TALA</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 17.96 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.9, 0.0 and 0.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.09</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.60, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 6 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ALCD2x</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, MDH2, MDH3, PGI, PTAr</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and RPE</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 17.96 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.9, 0.0 and 0.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: growth coupled non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.09</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 10.07 and 18.60, respectively </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing optKnock analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">optKnock found a optKnock set of large 5 composed by </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">ACKr</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">, GLCabcpp, MDH3, PGI</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"> and RPE</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement"></div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The production of lactate after optimization is 17.96 </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The growth rate after optimization is 0.12 </div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The production of other products such as ethanol, formate, succinate and acetate are 0.0, 0.9, 0.0 and 0.1, respectively. </div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">...Performing coupling analysis...</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The solution is of type: non unique</div></div><div class="inlineElement embeddedOutputsTextElement" data-width="708" style="width: 708px;"><div class="textElement">The maximun growth rate given the optKnock set is 0.09</div></div><div class="inlineElement embeddedOutputsTextElement scrollableOutput" data-width="708" style="width: 708px;"><div class="textElement">The maximun and minimun production of lactate given the optKnock set is 0.00 and 18.60, respectively </div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">cd(currectDirectory);</span></p></div></div><h2 class = "S3"><span class = "S2">TIMING</span></h2><ol class = "S6"><li class = "S7"><span class = "S0">Example 1 ~ 1-2 minutes</span></li><li class = "S7"><span class = "S0">Example 2 ~ 1-2 minutes</span></li><li class = "S7"><span class = "S0">Example 3 ~ 1-2 minutes</span></li><li class = "S7"><span class = "S0">Example 3 ~ 1-2 minutes</span></li><li class = "S7"><span class = "S0">Example 5 ~ 1-2 minutes</span></li><li class = "S7"><span class = "S0">Example 6 ~ 1-2 minutes</span></li></ol><h2 class = "S3"><span class = "S2">TROUBLESHOOTING</span></h2><p class = "S4"><span class = "S2">1) If the algorithm takes a long time to find a solution, it is possible that the seach space is too long. You can reduce the seach space using a smaller set of reactions in the input variable "selectedRxnList" </span></p><p class = "S4"><span class = "S2">2) The default number of deletions used by optKnock is 5. If the algorithm is returning more deletions than what you want, you can change the number of deletions using the input variable "numDel"</span></p><p class = "S4"><span class = "S2">3) optKnock could find a solution that it is not useful for you. For example, you may think that a solution is very obvious or that it breaks some important biological contraints. If optKnock found a solution that you don't want to find, use the input variable "prevSolutions" to prevent that solution to be found. </span></p><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">The optKnock algorithm will find sets of reactions that, when removed from the model, will improve the production of succinate and lactate respectively. In this tutorial, once optKnock finds a solution, then the type of solution is determined (if the product is coupled with biomass formation or not). Some of the sets will generate a coupled solution, i.e., the production rate will increase as biomass formation increases. For these kind of reactions a plot will be generated using the function singleProductionEnvelope and will be saved in the folder tutoriales/optKnock/optKnockResults</span></p><p class = "S4"><span class = "S2">When you find a solution with OptKnock, you should always verify the minumum and maximum production rate using the function analizeOptKnock. </span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2">References</span></h2><p class = "S4"><span class = "S2">[1] Burgard, A. P., Pharkya, P. &amp; Maranas, C. D. (2003). OptKnock: A Bilevel Programming Framework for Identifying Gene Knockout Strategies for Microbial Strain Optimization. Biotechnology and Bioengineering, 84(6), 647–657. http://doi.org/10.1002/bit.10803.</span></p><p class = "S4"><span class = "S2">[2] Orth, J. D., Conrad, T. M., Na, J., Lerman, J. A., Nam, H., Feist, A. M., &amp; Palsson, B. Ø. (2011). A comprehensive genome‐scale reconstruction of Escherichia coli metabolism—2011.</span><span class = "S2"> </span><span class = "S20">Molecular systems biology</span><span class = "S2">,</span><span class = "S2"> </span><span class = "S20">7</span><span class = "S2">(1), 535.</span></p></div></div>
<!-- 
##### SOURCE BEGIN #####
%% OptKnock Tutorial
%% Author: Sebastián N. Mendoza,  Center for Mathematical Modeling, University of Chile. snmendoz@uc.cl
%% *Reviewer(s): Thomas Pfau, Sylvian Arreckx, Laurent Heirendt & Ronan Fleming*
%% *INTRODUCTION:*
% In this tutorial we will run optKnock. For a detailed description of the procedure, 
% please see [1]. Briefly, the problem is to find a set of reactions of size "numDel" 
% such that when these reactions are deleted from the network, the mutant created 
% will produce a particular target of interest in a higher rate than the wild-type 
% strain. 
% 
% For example, imagine that we would like to increase the production of succinate 
% or lactate in Escherichia coli. Which are the knock-outs needed to increase 
% the production of these products? We will approach these problems in this tutorial.
%% MATERIALS
%% EQUIPMENT
% # MATLAB
% # A solver for Mixed Integer Linear Programming (MILP) problems. For example, 
% Gurobi.
%% *EQUIPMENT SETUP*
% Use changeCobraSolver to choose the solver for MILP problems. 
%% PROCEDURE
% The proceduce consists on the following steps
% 
% 1) Define contraints
% 
% 2) Define a set of reactions to search knockouts. Only reactions in this 
% set will be deleted. 
% 
% 3) Define the number of reactions to be deleter, the target reaction and 
% some constraints to be accomplish
% 
% 4) Run optKnock. *TIMING: *This task should take from a few seconds to 
% a few hours depending on the size of your reconstruction
% 
% We verify that cobratoolbox has been initialized and that the solver has 
% been set.

global TUTORIAL_INIT_CB;
if ~isempty(TUTORIAL_INIT_CB) && TUTORIAL_INIT_CB==1
    initCobraToolbox
    changeCobraSolver('gurobi','all');
end

fullPath = which('optKnockTutorial');
folder = fileparts(fullPath);
currectDirectory = pwd;
cd(folder);

%% 
% We load the model of E. coli [2]

model = readCbModel('iJO1366.mat')
biomass = 'BIOMASS_Ec_iJO1366_core_53p95M';
%% 
% We define the maximum number of solutions to find

threshold = 5;
%% 
% First, we define the set for reactions which could be deleted from the 
% network. Reactions not in this list are not going to be deleted.

selectedRxnList = {'GLCabcpp'; 'GLCptspp'; 'HEX1'; 'PGI'; 'PFK'; 'FBA'; 'TPI'; 'GAPD'; 'PGK'; 'PGM'; 'ENO'; 'PYK'; 'LDH_D'; 'PFL'; 'ALCD2x'; 'PTAr'; 'ACKr'; 'G6PDH2r'; 'PGL'; 'GND'; 'RPI'; 'RPE'; 'TKT1'; 'TALA'; 'TKT2'; 'FUM'; 'FRD2'; 'SUCOAS'; 'AKGDH'; 'ACONTa'; 'ACONTb'; 'ICDHyr'; 'CS'; 'MDH'; 'MDH2'; 'MDH3'; 'ACALD'};

%% 
% Then, we define some constraints


% prespecified amount of glucose uptake 10 mmol/grDW*hr
model = changeRxnBounds(model, 'EX_glc__D_e', -10, 'b');

% Unconstrained uptake routes for inorganic phosphate, sulfate and
% ammonia
model = changeRxnBounds(model, 'EX_o2_e', 0, 'l');
model = changeRxnBounds(model, 'EX_pi_e', -1000, 'l');
model = changeRxnBounds(model, 'EX_so4_e', -1000, 'l');
model = changeRxnBounds(model, 'EX_nh4_e', -1000, 'l');

% The optimization step could opt for or against the phosphotransferase
% system, glucokinase, or both mechanisms for the uptake of glucose
model = changeRxnBounds(model, 'GLCabcpp', -1000, 'l');
model = changeRxnBounds(model, 'GLCptspp', -1000, 'l');
model = changeRxnBounds(model, 'GLCabcpp', 1000, 'u');
model = changeRxnBounds(model, 'GLCptspp', 1000, 'u');
model = changeRxnBounds(model, 'GLCt2pp', 0, 'b');

% Secretion routes  for acetate, carbon dioxide, ethanol, formate, lactate
% and succinate are enabled
model = changeRxnBounds(model, 'EX_ac_e', 1000, 'u');
model = changeRxnBounds(model, 'EX_co2_e', 1000, 'u');
model = changeRxnBounds(model, 'EX_etoh_e', 1000, 'u');
model = changeRxnBounds(model, 'EX_for_e', 1000, 'u');
model = changeRxnBounds(model, 'EX_lac__D_e', 1000, 'u');
model = changeRxnBounds(model, 'EX_succ_e', 1000, 'u');
%% 
% Then, we calculates the production of metabolites before running optKnock

% determine succinate production and growth rate before optimizacion
fbaWT = optimizeCbModel(model);
succFluxWT = fbaWT.x(strcmp(model.rxns, 'EX_succ_e'));
etohFluxWT = fbaWT.x(strcmp(model.rxns, 'EX_etoh_e'));
formFluxWT = fbaWT.x(strcmp(model.rxns, 'EX_for_e'));
lactFluxWT = fbaWT.x(strcmp(model.rxns, 'EX_lac__D_e'));
acetFluxWT = fbaWT.x(strcmp(model.rxns, 'EX_ac_e'));
growthRateWT = fbaWT.f;
fprintf('The production of succinate before optimization is %.1f \n', succFluxWT);
fprintf('The growth rate before optimization is %.1f \n', growthRateWT);
fprintf('The production of other products such as ethanol, formate, lactate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n', etohFluxWT, formFluxWT, lactFluxWT, acetFluxWT);
%% 
% *I) SUCCINATE OVERPRODUCTION*
% 
% *EXAMPLE 1:* *finding optKnock reactions sets of large 2 for increasing 
% production of succinate*

fprintf('\n...EXAMPLE 1: Finding optKnock sets of large 2 or less...\n\n')
% Set optKnock options
% The exchange of succinate will be the objective of the outer problem
options = struct('targetRxn', 'EX_succ_e', 'numDel', 2);
% We will impose that biomass be at least 50% of the biomass of wild-type
constrOpt = struct('rxnList', {{biomass}},'values', 0.5*fbaWT.f, 'sense', 'G');
% We will try to find 10 optKnock sets of a maximun length of 2
previousSolutions = cell(10, 1);
contPreviousSolutions = 1;
nIter = 1;
while nIter < threshold
    fprintf('...Performing optKnock analysis...\n')
    if isempty(previousSolutions{1})
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);
    else
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions, 1);
    end
    
    % determine succinate production and growth rate after optimizacion
    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_succ_e'));
    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns, biomass));
    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_etoh_e'));
    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_for_e'));
    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_lac__D_e'));
    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_ac_e'));
    setM1 = optKnockSol.rxnList;
    
    if ~isempty(setM1)
        previousSolutions{contPreviousSolutions} = setM1;
        contPreviousSolutions = contPreviousSolutions + 1;
        %printing results
        fprintf('optKnock found a optKnock set of large %d composed by ', length(setM1));
        for j = 1:length(setM1)
            if j == 1
                fprintf('%s', setM1{j});
            elseif j == length(setM1)
                fprintf(' and %s', setM1{j});
            else
                fprintf(', %s', setM1{j});
            end
        end
        fprintf('\n');
        fprintf('The production of succinate after optimization is %.2f \n', succFluxM1);
        fprintf('The growth rate after optimization is %.2f \n', growthRateM1);
        fprintf('The production of other products such as ethanol, formate, lactate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n', etohFluxM1, formFluxM1, lactFluxM1, acetFluxM1);
        fprintf('...Performing coupling analysis...\n');
        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, 'EX_succ_e');
        fprintf('The solution is of type: %s\n', type);
        fprintf('The maximun growth rate given the optKnock set is %.2f\n', maxGrowth);
        fprintf('The maximun and minimun production of succinate given the optKnock set is %.2f and %.2f, respectively \n\n', minProd, maxProd);
        if strcmp(type, 'growth coupled')
            singleProductionEnvelope(model, setM1, 'EX_succ_e', biomass, 'savePlot', 1, 'showPlot', 1, 'fileName', ['succ_ex1_' num2str(nIter)], 'outputFolder', 'OptKnockResults');
        end,
    else
        if nIter == 1
            fprintf('optKnock was not able to found an optKnock set\n');
        else
            fprintf('optKnock was not able to found additional optKnock sets\n');
        end
        break;
    end
    nIter = nIter + 1;
end


%% 
% *TROUBLESHOOTING 1*:  "The algorithm takes a long time to find a solution"
% 
% *TROUBLESHOOTING 2*:  "The algorithm finds a set of knockouts too big"
% 
% *TROUBLESHOOTING 3*:  "The algorithm found a solution that is not useful 
% for me"
% 
% *EXAMPLE 2:* *finding optKnock reactions sets of large 3 for increasing 
% production of succinate*


% Set optKnock options
% The exchange of succinate will be the objective of the outer problem
options = struct('targetRxn', 'EX_succ_e', 'numDel', 3);
% We will impose that biomass be at least 50% of the biomass of wild-type
constrOpt = struct('rxnList', {{biomass}}, 'values', 0.5*fbaWT.f, 'sense', 'G');
% We will try to find 10 optKnock sets of a maximun length of 3
nIter = 1;
while nIter < threshold
    fprintf('...Performing optKnock analysis...')
    if isempty(previousSolutions{1})
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);
    else
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions);
    end
    
    % determine succinate production and growth rate after optimizacion
    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_succ_e'));
    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns, biomass));
    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_etoh_e'));
    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_for_e'));
    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_lac__D_e'));
    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_ac_e'));
    setM1 = optKnockSol.rxnList;
    
    if ~isempty(setM1)
        previousSolutions{contPreviousSolutions} = setM1;
        contPreviousSolutions=contPreviousSolutions + 1;
        %printing results
        fprintf('optKnock found a optKnock set of large %d composed by ',length(setM1));
        for j = 1:length(setM1)
            if j == 1
                fprintf('%s',setM1{j});
            elseif j == length(setM1)
                fprintf(' and %s',setM1{j});
            else
                fprintf(', %s',setM1{j});
            end
        end
        fprintf('\n');
        fprintf('The production of succinate after optimization is %.2f \n', succFluxM1);
        fprintf('The growth rate after optimization is %.2f \n', growthRateM1);
        fprintf('The production of other products such as ethanol, formate, lactate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n', etohFluxM1, formFluxM1, lactFluxM1, acetFluxM1);
        fprintf('...Performing coupling analysis...\n');
        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, 'EX_succ_e');
        fprintf('The solution is of type: %s\n', type);
        fprintf('The maximun growth rate given the optKnock set is %.2f\n', maxGrowth);
        fprintf('The maximun and minimun production of succinate given the optKnock set is %.2f and %.2f, respectively \n\n', minProd, maxProd);
        if strcmp(type,'growth coupled')
            singleProductionEnvelope(model, setM1, 'EX_succ_e', biomass, 'savePlot', 1, 'showPlot', 1, 'fileName', ['succ_ex2_' num2str(nIter)], 'outputFolder', 'OptKnockResults');
        end
    else
        if nIter == 1
            fprintf('optKnock was not able to found an optKnock set\n');
        else
            fprintf('optKnock was not able to found additional optKnock sets\n');
        end
        break;
    end
    nIter = nIter + 1;
end

%% 
% *II) LACTATE OVERPRODUCTION*
% 
% *EXAMPLE 1: finding optKnock reactions sets of large 3 for increasing production 
% of lactate*

fprintf('\n...EXAMPLE 1: Finding optKnock sets of large 3...\n\n')
% Set optKnock options
% The exchange of lactate will be the objective of the outer problem
options = struct('targetRxn', 'EX_lac__D_e', 'numDel', 3);
% We will impose that biomass be at least 50% of the biomass of wild-type
constrOpt = struct('rxnList', {{biomass}}, 'values', 0.5*fbaWT.f, 'sense', 'G');
% We will try to find 10 optKnock sets of a maximun length of 6
previousSolutions = cell(100, 1);
contPreviousSolutions = 1;
nIter = 1;
while nIter < threshold
    fprintf('...Performing optKnock analysis...')
    if isempty(previousSolutions{1})
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);
    else
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions);
    end
    
    % determine lactate production and growth rate after optimizacion
    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_lac__D_e'));
    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns, biomass));
    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_etoh_e'));
    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_for_e'));
    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_succ_e'));
    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_ac_e'));
    setM1 = optKnockSol.rxnList;
    
    if ~isempty(setM1)
        previousSolutions{contPreviousSolutions} = setM1;
        contPreviousSolutions=contPreviousSolutions + 1;
        %printing results
        fprintf('optKnock found a optKnock set of large %d composed by ',length(setM1));
        for j = 1:length(setM1)
            if j == 1
                fprintf('%s', setM1{j});
            elseif j == length(setM1)
                fprintf(' and %s', setM1{j});
            else
                fprintf(', %s', setM1{j});
            end
        end
        fprintf('\n');
        fprintf('The production of lactate after optimization is %.2f \n', lactFluxM1);
        fprintf('The growth rate after optimization is %.2f \n', growthRateM1);
        fprintf('The production of other products such as ethanol, formate, succinate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n', etohFluxM1, formFluxM1, succFluxM1, acetFluxM1);
        fprintf('...Performing coupling analysis...\n');
        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, 'EX_lac__D_e');
        fprintf('The solution is of type: %s\n', type);
        fprintf('The maximun growth rate given the optKnock set is %.2f\n', maxGrowth);
        fprintf('The maximun and minimun production of lactate given the optKnock set is %.2f and %.2f, respectively \n\n', minProd, maxProd);
        singleProductionEnvelope(model, setM1, 'EX_lac__D_e', biomass, 'savePlot', 1, 'showPlot', 1, 'fileName', ['lact_ex1_' num2str(nIter)], 'outputFolder', 'OptKnockResults');
    else
        if nIter == 1
            fprintf('optKnock was not able to found an optKnock set\n');
        else
            fprintf('optKnock was not able to found additional optKnock sets\n');
        end
        break;
    end
    nIter = nIter + 1;
end

%% 
% 
% 
% *EXAMPLE 2: finding optKnock reactions sets of large 6 for increasing production 
% of lactate*

fprintf('...EXAMPLE 3: Finding optKnock sets of large 6...\n')
% Set optKnock options
% The exchange of lactate will be the objective of the outer problem
options = struct('targetRxn', 'EX_lac__D_e', 'numDel', 6);
% We will impose that biomass be at least 50% of the biomass of wild-type
constrOpt = struct('rxnList', {{biomass}}, 'values', 0.5*fbaWT.f, 'sense', 'G');
% We will try to find 10 optKnock sets of a maximun length of 2
nIter = 1;
while nIter < threshold
    fprintf('...Performing optKnock analysis...')
    if isempty(previousSolutions{1})
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt);
    else
        optKnockSol = OptKnock(model, selectedRxnList, options, constrOpt, previousSolutions);
    end
    
    % determine lactate production and growth rate after optimizacion
    lactFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_lac__D_e'));
    growthRateM1 = optKnockSol.fluxes(strcmp(model.rxns,biomass));
    etohFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_etoh_e'));
    formFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_for_e'));
    succFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_succ_e'));
    acetFluxM1 = optKnockSol.fluxes(strcmp(model.rxns, 'EX_ac_e'));
    setM1 = optKnockSol.rxnList;
    
    if ~isempty(setM1)
        previousSolutions{contPreviousSolutions} = setM1;
        contPreviousSolutions = contPreviousSolutions + 1;
        %printing results
        fprintf('optKnock found a optKnock set of large %d composed by ', length(setM1));
        for j = 1:length(setM1)
            if j == 1
                fprintf('%s', setM1{j});
            elseif j == length(setM1)
                fprintf(' and %s', setM1{j});
            else
                fprintf(', %s', setM1{j});
            end
        end
        fprintf('\n');
        fprintf('The production of lactate after optimization is %.2f \n', lactFluxM1);
        fprintf('The growth rate after optimization is %.2f \n', growthRateM1);
        fprintf('The production of other products such as ethanol, formate, succinate and acetate are %.1f, %.1f, %.1f and %.1f, respectively. \n', etohFluxM1, formFluxM1, succFluxM1, acetFluxM1);
        fprintf('...Performing coupling analysis...\n');
        [type, maxGrowth, maxProd, minProd] = analyzeOptKnock(model, setM1, 'EX_lac__D_e');
        fprintf('The solution is of type: %s\n', type);
        fprintf('The maximun growth rate given the optKnock set is %.2f\n', maxGrowth);
        fprintf('The maximun and minimun production of lactate given the optKnock set is %.2f and %.2f, respectively \n\n', minProd, maxProd);
        singleProductionEnvelope(model, setM1, 'EX_lac__D_e', biomass, 'savePlot', 1, 'showPlot', 1, 'fileName', ['lact_ex2_' num2str(nIter)], 'outputFolder', 'OptKnockResults');
    else
        if nIter == 1
            fprintf('optKnock was not able to found an optKnock set\n');
        else
            fprintf('optKnock was not able to found additional optKnock sets\n');
        end
        break;
    end
    nIter = nIter + 1;
end

cd(currectDirectory);
%% TIMING
% # Example 1 ~ 1-2 minutes
% # Example 2 ~ 1-2 minutes
% # Example 3 ~ 1-2 minutes
% # Example 3 ~ 1-2 minutes
% # Example 5 ~ 1-2 minutes
% # Example 6 ~ 1-2 minutes
%% TROUBLESHOOTING
% 1) If the algorithm takes a long time to find a solution, it is possible that 
% the seach space is too long. You can reduce the seach space using a smaller 
% set of reactions in the input variable "selectedRxnList" 
% 
% 2) The default number of deletions used by optKnock is 5. If the algorithm 
% is returning more deletions than what you want, you can change the number of 
% deletions using the input variable "numDel"
% 
% 3) optKnock could find a solution that it is not useful for you. For example, 
% you may think that a solution is very obvious or that it breaks some important 
% biological contraints. If optKnock found a solution that you don't want to find, 
% use the input variable "prevSolutions" to prevent that solution to be found. 
%% ANTICIPATED RESULTS
% The optKnock algorithm will find sets of reactions that, when removed from 
% the model, will improve the production of succinate and lactate respectively. 
% In this tutorial, once optKnock finds a solution, then the type of solution 
% is determined (if the product is coupled with biomass formation or not). Some 
% of the sets will generate a coupled solution, i.e., the production rate will 
% increase as biomass formation increases. For these kind of reactions a plot 
% will be generated using the function singleProductionEnvelope and will be saved 
% in the folder tutoriales/optKnock/optKnockResults
% 
% When you find a solution with OptKnock, you should always verify the minumum 
% and maximum production rate using the function analizeOptKnock. 
%% References
% [1] Burgard, A. P., Pharkya, P. & Maranas, C. D. (2003). OptKnock: A Bilevel 
% Programming Framework for Identifying Gene Knockout Strategies for Microbial 
% Strain Optimization. Biotechnology and Bioengineering, 84(6), 647–657. http://doi.org/10.1002/bit.10803.
% 
% [2] Orth, J. D., Conrad, T. M., Na, J., Lerman, J. A., Nam, H., Feist, 
% A. M., & Palsson, B. Ø. (2011). A comprehensive genome‐scale reconstruction 
% of Escherichia coli metabolism—2011. _Molecular systems biology_, _7_(1), 535.
##### SOURCE END #####
--></body></html>