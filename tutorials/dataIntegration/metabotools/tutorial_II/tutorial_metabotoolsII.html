<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Metabotools tutorial II - Integration of quantitative metabolomic data</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234001159668px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15.0000009536743px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S5 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S6 { line-height: 15.5926675796509px; min-height: 18px; white-space: nowrap; font-size: 12.6666660308838px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S7 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S8 { color: rgb(64, 64, 64); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S11 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S13 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S14 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S15 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
.outputGroup {margin: 2px 0 2px 0; padding: 2px 2px 2px 4px;}
.outputRegion {}
.outputParagraph {color: rgba(64, 64, 64, 1); padding: 10px 0 6px 17px; background: white; overflow-x: hidden;}
.inlineWrapper:last-child .outputParagraph {border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}
.outputParagraph:empty {margin: 0;}
.inlineElement .symbolicElement {margin-top: 1px; margin-bottom: 1px;}
.embeddedOutputsSymbolicElement .MathEquation {margin-top: 4px; margin-bottom: 4px;}
.embeddedOutputsSymbolicElement .MathEquation.displaySymbolicElement {margin-left: 15px;}
.embeddedOutputsSymbolicElement .MathEquation.inlineSymbolicElement {margin-left: 5px;}
.embeddedOutputsSymbolicElement {overflow-x: auto; overflow-y: hidden;}
.embeddedOutputsSymbolicElement { overflow: initial !important;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement { max-height: none !important; overflow: initial !important;}
.veSpecifier {}
.veContainer {}
.veSpecifierBox {height: 400px; width: 500px;}
.veSpecifier .veTable {padding-top: 3px; padding-bottom: 4px;}
.veSpecifierBox .veSpecifier .veContainer {position: relative; width: 100%; height: 370px;}
.veSpecifierBox .dijitDialogPaneContent {width: 97% !important; height: 88% !important;}
.veSpecifier .veTable .rowHeadersWrapper {padding-bottom: 0;}
.veSpecifier .veTable .scroller .variableEditorRenderers {padding-right: 3px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;}
.veVariableValueSummary {display: inline-block;}
.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {visibility: hidden; z-index: 0;}
.veMetaSummary {font-style: italic;}
.veSpecifier .veTable .scroller {overflow: hidden;}
.veSpecifier .veTable:hover .scroller {overflow: auto;}
.veSpecifier .veVariableName,.veSpecifier .veDimensionFont {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.veSpecifier .veVariableName {padding-top: 2px;}
.veSpecifier .veDimensionFont {font-style: italic; color: #9A9A9A;}
.veSpecifier .scroller::-webkit-scrollbar-track {background-color: white;}
.veSpecifier .scroller::-webkit-scrollbar-corner {background-color: white;}
.veSpecifier .veTable .topRowHeaderWrapper {border: none; background-color: #F8F9FA;}
.veSpecifier .mw_type_ListBase.showCellBorders,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper,.veSpecifier .veTable .verticalScrollSpacer,.veSpecifier .veTable .horizontalScrollSpacer {border: none;}
.veSpecifier .veTable .dataScrollerNode {border: 1px solid #BFBFBF;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode,.veSpecifier .veTable .dataBody {font-family: Arial; font-size: 13px;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode {color: #7F7F7F;}
.veSpecifier .veTable .dataBody {color: #000000;}
.veSpecifier .veTable .columnHeaderNode .cell .drag,.veSpecifier .veTable .columnHeaderNode .cell .header,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {background-color: #F8F9FA;}
.veSpecifier .veTable .columnHeaderNode .cell .dragBorder {border-right: 1px solid #F8F9FA;}
.veSpecifier .veTable .rowHeaderNode .cell {padding-top: 3px; text-align: center; border-bottom: 1px solid #F8F9FA;}
.veSpecifier .veTable .dataBody .cell .plainText {text-align: right;}
.veSpecifier .veTable .dataBody .row .cell {border-bottom: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.embeddedOutputsVariableElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement {min-height: 18px; box-sizing: border-box; font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.embeddedOutputsMatrixElement .matrixElement{position: relative;}
.matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.embeddedOutputsMatrixElement.inlineElement .veVariableName {padding-top: 0;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer {white-space: nowrap; padding-top: 10px; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.matrixElement { max-height: none !important; }
.dijitTooltipDialog .dijitTooltipContainer .dijitTooltipContents .alertPlugin-alertMessage {min-width: 12px; max-width: 400px; max-height: 300px; overflow: auto;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar {width: 11px; height: 11px;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-track {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-corner {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {border-radius: 7px; background-color: rgba(0, 0, 0, 0.1); border: 2px solid rgba(0, 0, 0, 0); background-clip: padding-box;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.1);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.alertPlugin-alertLine {position: absolute; display: initial; width: 40px; text-align: right; cursor: text;}
.alertPlugin-onTextLine {visibility: hidden;}
.alertPlugin-hasTooltip .alertPlugin-warningImg,.alertPlugin-hasTooltip .alertPlugin-errorImg {cursor: pointer;}
.alertPlugin-alertLine .alertPlugin-warningElement,.alertPlugin-alertLine .alertPlugin-errorElement {display: inline-block; margin-right: 4px;}
.alertPlugin-isStale {-webkit-filter: opacity(0.4) grayscale(80%); filter: opacity(0.4) grayscale(80%);}
.diagnosticMessage-wrapper {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
</style></head><body><div class = "content"><div class = 'SectionBlock containment'><h1 class = "S1"><span class = "S2">Metabotools tutorial II - Integration of quantitative metabolomic data</span></h1><p class = "S3"><span class = "S4">Maike Aurich</span></p><p class = "S3"><span class = "S2">In this tutorial we ...</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment active'><p class = "S3"><span class = "S2">Clear workspace and initialize the COBRA Toolbox</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">clear</span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S7">initCobraToolbox</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="466952FE" data-testid="output_0" data-width="1922" style="width: 1952px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_____&nbsp;&nbsp; _____&nbsp;&nbsp; _____&nbsp;&nbsp; _____&nbsp;&nbsp;&nbsp;&nbsp; _____&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp; /&nbsp;&nbsp;___| /&nbsp;&nbsp;_&nbsp;&nbsp;\ |&nbsp;&nbsp;_&nbsp;&nbsp;\ |&nbsp;&nbsp;_&nbsp;&nbsp;\&nbsp;&nbsp; / ___ \&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp; COnstraint-Based Reconstruction and Analysis<br>&nbsp;&nbsp;&nbsp;&nbsp; | |&nbsp;&nbsp;&nbsp;&nbsp; | | | | | |_| | | |_| |&nbsp;&nbsp;| |___| |&nbsp;&nbsp; |&nbsp;&nbsp; The COBRA Toolbox - 2017<br>&nbsp;&nbsp;&nbsp;&nbsp; | |&nbsp;&nbsp;&nbsp;&nbsp; | | | | |&nbsp;&nbsp;_&nbsp;&nbsp;{ |&nbsp;&nbsp;_&nbsp;&nbsp;/&nbsp;&nbsp;|&nbsp;&nbsp;___&nbsp;&nbsp;|&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp; | |___&nbsp;&nbsp;| |_| | | |_| | | | \ \&nbsp;&nbsp;| |&nbsp;&nbsp; | |&nbsp;&nbsp; |&nbsp;&nbsp; Documentation:<br>&nbsp;&nbsp;&nbsp;&nbsp; \_____| \_____/ |_____/ |_|&nbsp;&nbsp;\_\ |_|&nbsp;&nbsp; |_|&nbsp;&nbsp; |&nbsp;&nbsp; <a href="http://opencobra.github.io/cobratoolbox">http://opencobra.github.io/cobratoolbox</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <br><br> &gt; Checking if git is installed ...&nbsp;&nbsp;Done.<br> &gt; Checking if the repository is tracked using git ...&nbsp;&nbsp;Done.<br> &gt; Checking if curl is installed ...&nbsp;&nbsp;Done.<br> &gt; Checking if remote can be reached ...&nbsp;&nbsp;Done.<br> &gt; Initializing and updating submodules ... Done.<br> &gt; Adding all the files of The COBRA Toolbox ...&nbsp;&nbsp;Done.<br> &gt; Define CB map output... set to svg.<br> &gt; Retrieving models ...&nbsp;&nbsp; Done.<br> &gt; TranslateSBML is installed and working properly.<br> &gt; Configuring solver environment variables ...<br>&nbsp;&nbsp; - [----] ILOG_CPLEX_PATH: /opt/ibm/ILOG/CPLEX_Studio1271/cplex/matlab/x86-64_linux<br>&nbsp;&nbsp; - [----] GUROBI_PATH: /home/syarra/Dropbox/software/gurobi/gurobi652/linux64/matlab<br>&nbsp;&nbsp; - [----] TOMLAB_PATH :&nbsp;&nbsp;--&gt; set this path manually after installing the solver ( see <a href="https://opencobra.github.io/cobratoolbox/docs/solvers.html">instructions</a> )<br>&nbsp;&nbsp; - [----] MOSEK_PATH: /home/syarra/Dropbox/software/mosek/linux/8/<br>&nbsp;&nbsp; Done.<br> &gt; Checking available solvers and solver interfaces ... Done.<br> &gt; Setting default solvers ... Done.<br> &gt; Saving the MATLAB path ... Done.<br>&nbsp;&nbsp; - The MATLAB path was saved as ~/pathdef.m.<br><br> &gt; Summary of available solvers and solver interfaces<br><br>			Support 	&nbsp;&nbsp; LP 	 MILP 	&nbsp;&nbsp; QP 	 MIQP 	&nbsp;&nbsp;NLP<br>	----------------------------------------------------------------------<br>	cplex_direct 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	dqqMinos&nbsp;&nbsp;&nbsp;&nbsp; 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	glpk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	gurobi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	ibm_cplex&nbsp;&nbsp;&nbsp;&nbsp;	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	matlab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;1<br>	mosek&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	pdco&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	quadMinos&nbsp;&nbsp;&nbsp;&nbsp;	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;1<br>	tomlab_cplex 	full&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	qpng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	experimental&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	tomlab_snopt 	experimental&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;0<br>	gurobi_mex&nbsp;&nbsp; 	legacy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	lindo_old&nbsp;&nbsp;&nbsp;&nbsp;	legacy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	lindo_legacy 	legacy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	lp_solve&nbsp;&nbsp;&nbsp;&nbsp; 	legacy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;- 	&nbsp;&nbsp;&nbsp;&nbsp;-<br>	opti&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	legacy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0 	&nbsp;&nbsp;&nbsp;&nbsp;0<br>	----------------------------------------------------------------------<br>	Total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	&nbsp;&nbsp;&nbsp;&nbsp;9 	&nbsp;&nbsp;&nbsp;&nbsp;4 	&nbsp;&nbsp;&nbsp;&nbsp;5 	&nbsp;&nbsp;&nbsp;&nbsp;1 	&nbsp;&nbsp;&nbsp;&nbsp;2<br><br> + Legend: - = not applicable, 0 = solver not compatible or not installed, 1 = solver installed.<br><br><br> &gt; You can solve LP problems using: 'dqqMinos' - 'glpk' - 'gurobi' - 'ibm_cplex' - 'matlab' - 'mosek' - 'pdco' - 'quadMinos' - 'lp_solve' <br> &gt; You can solve MILP problems using: 'glpk' - 'gurobi' - 'ibm_cplex' - 'mosek' <br> &gt; You can solve QP problems using: 'gurobi' - 'ibm_cplex' - 'mosek' - 'pdco' - 'qpng' <br> &gt; You can solve MIQP problems using: 'gurobi' <br> &gt; You can solve NLP problems using: 'matlab' - 'quadMinos' <br><br> &gt; Checking for available updates ...<br>ssh: /usr/local/MATLAB/R2016a/bin/glnxa64/libcrypto.so.1.0.0: no version information available (required by ssh)<br>ssh: /usr/local/MATLAB/R2016a/bin/glnxa64/libcrypto.so.1.0.0: no version information available (required by ssh)<br>OpenSSL version mismatch. Built against 1000207f, you have 100010bf<br>fatal: Could not read from remote repository.<br><br>Please make sure you have the correct access rights<br>and the repository exists.<br> &gt; The changes of The COBRA Toolbox could not be fetched. &gt; There are 169 new commit(s) on &lt;master&gt; and 0 new commit(s) on &lt;develop&gt; [1b1125 @ metabotools_mlx]<br> &gt; You can update The COBRA Toolbox by running updateCobraToolbox() (from within MATLAB).</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">global </span><span class = "S7">CBTDIR</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">tol = 1e-6;</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S3"><span class = "S2">set and check solver</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">solver = </span><span class = "S11">'gurobi'</span><span class = "S10">;  </span><span class = "S12">% can be gurobi or tomlab_cplex</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">solverQuant = </span><span class = "S11">'ibm_cplex'</span><span class = "S7">;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">outputPath = pwd;  </span><span class = "S12">% output is saved to this location, can be the same as pathToCOBRA 'C: ... \cobratoolbox\metabotools\tutorial_II\';</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">set and check solver</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S10">solverOK = changeCobraSolver(solverQuant, </span><span class = "S11">'LP'</span><span class = "S7">);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="8026C536" data-testid="output_1" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement"> &gt; IBM ILOG CPLEX interface added to MATLAB path.</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">if </span><span class = "S7">solverOK == 1</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    </span><span class = "S10">display</span><span class = "S10">(</span><span class = "S11">'The solverQuant is set.'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    error(</span><span class = "S11">'The solverQuant is not set.'</span><span class = "S7">)</span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S14">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="3BED9470" data-testid="output_2" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement">The solverQuant is set.</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S10">solverOK = changeCobraSolver(solver, </span><span class = "S11">'LP'</span><span class = "S7">);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="8FC0A85F" data-testid="output_3" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement"> &gt; Gurobi interface added to MATLAB path.</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">if </span><span class = "S7">solverOK == 1</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    </span><span class = "S10">display</span><span class = "S10">(</span><span class = "S11">'The LP solver is set.'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    error(</span><span class = "S11">'The LP solver is not set.'</span><span class = "S7">)</span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S14">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="632B84A7" data-testid="output_4" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement">The LP solver is set.</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S10">solverOK = changeCobraSolver(solver, </span><span class = "S11">'QP'</span><span class = "S7">);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="5B127AD7" data-testid="output_5" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement"> &gt; Gurobi interface added to MATLAB path.</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">if </span><span class = "S7">solverOK == 1</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    </span><span class = "S10">display</span><span class = "S10">(</span><span class = "S11">'The QP solver is set.'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    error(</span><span class = "S11">'The QP solver is not set.'</span><span class = "S7">)</span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S14">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="D7A0933A" data-testid="output_6" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement">The QP solver is set.</div></div></div></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">load and check tutorial input is loaded correctly</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">tutorialPath = [CBTDIR filesep </span><span class = "S11">'tutorials' </span><span class = "S10">filesep </span><span class = "S11">'metabotools' </span><span class = "S10">filesep </span><span class = "S11">'tutorial_II'</span><span class = "S7">];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">if </span><span class = "S10">exist([tutorialPath filesep </span><span class = "S11">'starting_model.mat'</span><span class = "S10">], </span><span class = "S11">'file'</span><span class = "S10">) == 2  </span><span class = "S12">% 2 means it's a file.</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    load([tutorialPath filesep </span><span class = "S11">'starting_model.mat'</span><span class = "S7">]);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    </span><span class = "S10">display</span><span class = "S10">(</span><span class = "S11">'The model is loaded.'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    error(</span><span class = "S11">'The ''starting_model'' could not be loaded.'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper outputs'><p class = "S6 lineNode"><span class = "S14">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement scrollableOutput" uid="9A3F4710" data-testid="output_7" data-width="1922" style="width: 1952px; max-height: 29px;"><div class="textElement">The model is loaded.</div></div></div></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S12">% Check output path and writing permission</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">if </span><span class = "S10">~</span><span class = "S10">exist</span><span class = "S7">(outputPath) == 7</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    error(</span><span class = "S11">'Output directory in ''outputPath'' does not exist. Verify that you type it correctly or create the directory.'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S12">% make and save dummy file to test writing to output directory</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">A = rand(1);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">try</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    save([outputPath filesep </span><span class = "S11">'A'</span><span class = "S7">]);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S9">catch </span><span class = "S7">ME</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">    error(</span><span class = "S11">'Files cannot be saved to the provided location: %s\nObtain rights to write into %s directory or set ''outputPath'' to a different directory.'</span><span class = "S7">, outputPath, outputPath);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S14">end</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 1 - Define the model bounds using setMediumConstraints</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">set_inf = 2000;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">current_inf = 1000;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">medium_composition = {};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">met_Conc_mM = [];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">cellConc = [];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">t = [];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">cellWeight = [];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">mediumCompounds = {</span><span class = "S11">'EX_h(e)'</span><span class = "S10">, </span><span class = "S11">'EX_h2o(e)'</span><span class = "S10">, </span><span class = "S11">'EX_hco3(e)'</span><span class = "S10">, </span><span class = "S11">'EX_nh4(e)'</span><span class = "S10">, </span><span class = "S11">'EX_o2(e)'</span><span class = "S10">, </span><span class = "S11">'EX_pi(e)'</span><span class = "S10">, </span><span class = "S11">'EX_so4(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">ions = {</span><span class = "S11">'EX_ca2(e)'</span><span class = "S10">, </span><span class = "S11">'EX_cl(e)'</span><span class = "S10">, </span><span class = "S11">'EX_co(e)'</span><span class = "S10">, </span><span class = "S11">'EX_fe2(e)'</span><span class = "S10">, </span><span class = "S11">'EX_fe3(e)'</span><span class = "S10">, </span><span class = "S11">'EX_k(e)'</span><span class = "S10">, </span><span class = "S11">'EX_na1(e)'</span><span class = "S10">, </span><span class = "S11">'EX_i(e)'</span><span class = "S10">, </span><span class = "S11">'EX_sel(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">mediumCompounds = [ions mediumCompounds];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">mediumCompounds_lb = -100;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">customizedConstraints = {</span><span class = "S11">'EX_co2(e)'</span><span class = "S10">, </span><span class = "S11">'EX_o2(e)'</span><span class = "S10">, </span><span class = "S11">'EX_his_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_ile_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_leu_L(e)'</span><span class = "S10">, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">                         </span><span class = "S11">'EX_lys_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_phe_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_thr_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_trp_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_val_L(e)'</span><span class = "S10">, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">                         </span><span class = "S11">'EX_met_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_ascb_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_btn(e)'</span><span class = "S10">, </span><span class = "S11">'EX_chol(e)'</span><span class = "S10">, </span><span class = "S11">'EX_fol(e)'</span><span class = "S10">, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">                         </span><span class = "S11">'EX_pnto_R(e)'</span><span class = "S10">, </span><span class = "S11">'EX_retn(e)'</span><span class = "S10">, </span><span class = "S11">'EX_thm(e)'</span><span class = "S10">, </span><span class = "S11">'EX_vitd2(e)'</span><span class = "S10">, </span><span class = "S11">'EX_vitd3(e)'</span><span class = "S10">, </span><span class = "S11">'EX_retinol(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">customizedConstraints_ub = [2000, 0, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">                            2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">customizedConstraints_lb = [-100, -1000, -10, -10, -10, -10, -10, -10, -10, -10, -10, -1, -1, -1, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">                            -1, -1, -1, -1, -1, -1, -1];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">close_exchanges = 0;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">[modelMedium, basisMedium] = setMediumConstraints(starting_model, set_inf, current_inf, medium_composition, met_Conc_mM, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">                                                  cellConc, t, cellWeight, mediumCompounds, mediumCompounds_lb, customizedConstraints, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">                                                  customizedConstraints_ub, customizedConstraints_lb, close_exchanges);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium tol solver outputPath tutorialPath solverQuant</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 2 - Generate an individual exchange profiles for each sample</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">load([tutorialPath filesep </span><span class = "S11">'tutorial_II_data.mat'</span><span class = "S7">]);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">model = modelMedium;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">test_max = 500;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">test_min = 0.0001;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">variation = 20;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">prepIntegrationQuant(model, metData, exchanges, samples, test_max, test_min, outputPath, tol, variation);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium samples tol solver outputPath tutorialPath solverQuant</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 2B - Prepare table to check exchange profiles</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">nmets = 70;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[mapped_exchanges, minMax, mapped_uptake, mapped_secretion] = checkExchangeProfiles(samples, outputPath, nmets);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S11">-EXCEPT modelMedium samples tol solver mapped_exchanges</span><span class = "S10">  </span><span class = "S15">outputPath tutorialPath solverQuant</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">save([outputPath filesep </span><span class = "S11">'Result_checkExchangeProfiles'</span><span class = "S7">]);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 3 - Generate contextualized models</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">changeCobraSolver(solverQuant, </span><span class = "S11">'LP'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">minGrowth = 0.008;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">obj = </span><span class = "S11">'biomass_reaction2'</span><span class = "S7">;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">no_secretion = {</span><span class = "S11">'EX_o2(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">no_uptake = {</span><span class = "S11">'EX_o2s(e)'</span><span class = "S10">, </span><span class = "S11">'EX_h2o2(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">medium = {};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">tol = 1e-6;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">model = modelMedium;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">epsilon = 1e-4;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">addExtraExch = {</span><span class = "S11">'EX_tdchola(e)'</span><span class = "S10">, </span><span class = "S11">'Ex_5hoxindoa[e]'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">addExtraExch_value = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">[ResultsAllCellLines, OverViewResults] = setQuantConstraints(model, samples, tol, minGrowth, obj, no_secretion, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">                                                             no_uptake, medium, addExtraExch, addExtraExch_value, outputPath);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium samples ResultsAllCellLines OverViewResults tol solver mapped_exchanges outputPath tutorialPath</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 4 - Analyze added exchanges</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">changeCobraSolver(solver, </span><span class = "S11">'LP'</span><span class = "S7">);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[Ex_added_all_unique] = statisticsAddedExchanges(ResultsAllCellLines, samples);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique tol solver mapped_exchanges outputPath tutorialPath</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[Added_all] = mkTableOfAddedExchanges(ResultsAllCellLines, samples, Ex_added_all_unique);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">save([outputPath filesep </span><span class = "S11">'statistics'</span><span class = "S7">]);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium samples ResultsAllCellLines OverViewResults tol solver mapped_exchanges outputPath tutorialPath</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 5 - Analyze the sets of essential genes</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">cutoff = 0.05;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[genes, ResultsAllCellLines, OverViewResults] = analyzeSingleGeneDeletion(ResultsAllCellLines, outputPath, samples, cutoff, OverViewResults);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique genes tol solver mapped_exchanges outputPath tutorialPath</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 6 - Check which individual gene-associated reaction makes the model infeasible</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">samples_to_test = samples;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">fill = </span><span class = "S11">'NAN'</span><span class = "S7">;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">genes_to_test = {</span><span class = "S11">'55293.1'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[FBA_Rxns_KO, ListResults] = checkEffectRxnKO(samples_to_test, fill, genes_to_test, samples, ResultsAllCellLines);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S15">-EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique genes FBA_Rxns_KO ListResults tol solver mapped_exchanges outputPath tutorialPath</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 7 - Make intersect and union model</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">mk_union = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">mk_intersect = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">mk_reactionDiff = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">load([tutorialPath filesep </span><span class = "S11">'starting_model.mat'</span><span class = "S7">]);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">model = starting_model;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[unionModel, intersectModel, diffRxns, diffExRxns] = makeSummaryModels(ResultsAllCellLines, samples, model, mk_union, mk_intersect, mk_reactionDiff);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clearvars </span><span class = "S11">-EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique genes FBA_Rxns_KO ListResults unionModel intersectModel</span><span class = "S10">  </span><span class = "S15">diffRxns diffExRxns tol solver mapped_exchanges outputPath model tutorialPath</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">save([outputPath filesep </span><span class = "S11">'summary'</span><span class = "S7">]);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 8 - Predict differences in metabolite production or consumption</span></h2></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 8A ATP production</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">obj = </span><span class = "S11">'DM_atp_c_'</span><span class = "S7">;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">carbon_source = {</span><span class = "S11">'EX_glc(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">samples = samples(1:4, 1);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">dir = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S12">% ATP production</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S12">% exclude transport reactions from flux split analysis</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">transportRxns = {</span><span class = "S11">'ATPtm'</span><span class = "S10">; </span><span class = "S11">'ATPtn'</span><span class = "S10">; </span><span class = "S11">'ATPtx'</span><span class = "S10">; </span><span class = "S11">'ATP1ter'</span><span class = "S10">; </span><span class = "S11">'ATP2ter'</span><span class = "S10">; </span><span class = "S11">'EX_atp(e)'</span><span class = "S10">; </span><span class = "S11">'DNDPt13m'</span><span class = "S10">;</span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">                 </span><span class = "S11">'DNDPt2m'</span><span class = "S10">; </span><span class = "S11">'DNDPt31m'</span><span class = "S10">; </span><span class = "S11">'DNDPt56m'</span><span class = "S10">; </span><span class = "S11">'DNDPt32m'</span><span class = "S10">; </span><span class = "S11">'DNDPt57m'</span><span class = "S10">; </span><span class = "S11">'DNDPt20m'</span><span class = "S10">;</span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">                 </span><span class = "S11">'DNDPt44m'</span><span class = "S10">; </span><span class = "S11">'DNDPt19m'</span><span class = "S10">; </span><span class = "S11">'DNDPt43m'</span><span class = "S10">; </span><span class = "S11">'ADK1'</span><span class = "S10">; </span><span class = "S11">'ADK1m'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">ATPprod = {</span><span class = "S11">'ATPS4m'</span><span class = "S10">; </span><span class = "S11">'PGK'</span><span class = "S10">; </span><span class = "S11">'PYK'</span><span class = "S10">; </span><span class = "S11">'SUCOASm'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">met2test = {</span><span class = "S11">'atp[c]'</span><span class = "S10">, </span><span class = "S11">'atp[m]'</span><span class = "S10">, </span><span class = "S11">'atp[n]'</span><span class = "S10">, </span><span class = "S11">'atp[r]'</span><span class = "S10">, </span><span class = "S11">'atp[x]'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">[</span><span class = "S10">BMall</span><span class = "S10">, ResultsAllCellLines, </span><span class = "S10">metRsall</span><span class = "S10">, maximum_contributing_rxn, maximum_contributing_flux, ATPyield] = predictFluxSplits(model, obj, met2test, samples, </span><span class = "S14">...</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">                                                                                                                          ResultsAllCellLines, dir,  transportRxns, ATPprod, carbon_source);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">PHs = [samples maximum_contributing_rxn(:, 1)];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">maximum_contributing_flux_ATP = maximum_contributing_flux;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clear </span><span class = "S15">ATPprod transportRxns met2test maximum_contributing_rxn</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 8B NADH production</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">met2test = {</span><span class = "S11">'nadh[c]'</span><span class = "S10">, </span><span class = "S11">'nadh[m]'</span><span class = "S10">, </span><span class = "S11">'nadh[n]'</span><span class = "S10">, </span><span class = "S11">'nadh[x]'</span><span class = "S10">, </span><span class = "S11">'nadh[r]'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">transportRxns = {</span><span class = "S11">'NADHtpu'</span><span class = "S10">; </span><span class = "S11">'NADHtru'</span><span class = "S10">; </span><span class = "S11">'NADtpu'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">[</span><span class = "S10">BMall</span><span class = "S10">, ResultsAllCellLines, </span><span class = "S10">metRsall</span><span class = "S7">, maximum_contributing_rxn, maximum_contributing_flux_NADH] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir, transportRxns);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">PHs = [PHs maximum_contributing_rxn(:, 1)];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clear </span><span class = "S15">transportRxns met2test maximum_contributing_rxn</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 8C FADH2 production</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">transportRxns = {</span><span class = "S11">'FADH2tru'</span><span class = "S10">; </span><span class = "S11">'FADH2tx'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">met2test = {</span><span class = "S11">'fadh2[c]'</span><span class = "S10">, </span><span class = "S11">'fadh2[m]'</span><span class = "S10">, </span><span class = "S11">'fadh2[n]'</span><span class = "S10">, </span><span class = "S11">'fadh2[x]'</span><span class = "S10">, </span><span class = "S11">'fadh2[r]'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">[</span><span class = "S10">BMall</span><span class = "S10">, ResultsAllCellLines, </span><span class = "S10">metRsall</span><span class = "S7">, maximum_contributing_rxn, maximum_contributing_flux_FADH2] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir,  transportRxns);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clear </span><span class = "S15">transportRxns met2test</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">PHs = [PHs maximum_contributing_rxn(:, 1)];</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 8D NADPH production</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">transportRxns = {</span><span class = "S11">'NADPHtru'</span><span class = "S10">; </span><span class = "S11">'NADPHtxu'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">met2test = {</span><span class = "S11">'nadph[c]'</span><span class = "S10">, </span><span class = "S11">'nadph[m]'</span><span class = "S10">, </span><span class = "S11">'nadph[n]'</span><span class = "S10">, </span><span class = "S11">'nadph[x]'</span><span class = "S10">, </span><span class = "S11">'nadph[r]'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[BMall, ResultsAllCellLines, metRsall, maximum_contributing_rxn, maximum_contributing_flux_NADPH] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir, transportRxns);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">clear </span><span class = "S15">transportRxns met2test</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">PHs = [PHs maximum_contributing_rxn(:, 1)];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">save([outputPath filesep </span><span class = "S11">'fluxSplits'</span><span class = "S7">]);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 8E illustrate the phenotypes (PHs) on 3Dplot</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">diff_view = 1;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">fonts = 18;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">make3Dplot(PHs, maximum_contributing_flux_ATP, fonts, outputPath, diff_view);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 9 Perform phase Plane Analysis</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">mets = {</span><span class = "S11">'EX_glc(e)'</span><span class = "S10">, </span><span class = "S11">'EX_o2(e)'</span><span class = "S10">; </span><span class = "S11">'EX_gln_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_o2(e)'</span><span class = "S10">; </span><span class = "S11">'EX_lac_L(e)'</span><span class = "S10">, </span><span class = "S11">'EX_o2(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">step_size = [40, 40; 20, 40; 40, 40];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">step_num = [28, 26; 21, 26; 42, 26];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">direct = [-1, -1; -1, -1; 1, -1];</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">[ResultsAllCellLines] = performPPP(ResultsAllCellLines, mets, step_size, samples, step_num, direct);</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7"></span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">save([outputPath filesep </span><span class = "S11">'PPP'</span><span class = "S7">]);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S13"><span class = "S2">Section 9b illustrate phase plane analysis results</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">label = {</span><span class = "S11">'Glucose uptake (fmol/cell/hr)'</span><span class = "S10">; </span><span class = "S11">'Oxygen uptake (fmol/cell/hr)'</span><span class = "S10">; </span><span class = "S11">'Growth rate (hr-1)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">mets = {</span><span class = "S11">'EX_glc(e)'</span><span class = "S10">; </span><span class = "S11">'EX_o2(e)'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">fonts = 12;</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S10">samples = {</span><span class = "S11">'IGROV1'</span><span class = "S7">};</span></p></div><div class = 'inlineWrapper'><p class = "S6 lineNode"><span class = "S7">illustrate_ppp(ResultsAllCellLines, mets, outputPath, samples, label, fonts, tol);</span></p></div></div></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Metabotools tutorial II - Integration of quantitative metabolomic data
% *Maike Aurich*
% 
% In this tutorial we ...
% 
% Clear workspace and initialize the COBRA Toolbox

clear
initCobraToolbox
global CBTDIR

tol = 1e-6;
%% 
% set and check solver

solver = 'gurobi';  % can be gurobi or tomlab_cplex
solverQuant = 'ibm_cplex';
outputPath = pwd;  % output is saved to this location, can be the same as pathToCOBRA 'C: ... \cobratoolbox\metabotools\tutorial_II\';
%% set and check solver

solverOK = changeCobraSolver(solverQuant, 'LP');
if solverOK == 1
    display('The solverQuant is set.');
else
    error('The solverQuant is not set.')
end

solverOK = changeCobraSolver(solver, 'LP');
if solverOK == 1
    display('The LP solver is set.');
else
    error('The LP solver is not set.')
end

solverOK = changeCobraSolver(solver, 'QP');
if solverOK == 1
    display('The QP solver is set.');
else
    error('The QP solver is not set.')
end
%% load and check tutorial input is loaded correctly

tutorialPath = [CBTDIR filesep 'tutorials' filesep 'metabotools' filesep 'tutorial_II'];
if exist([tutorialPath filesep 'starting_model.mat'], 'file') == 2  % 2 means it's a file.
    load([tutorialPath filesep 'starting_model.mat']);
    display('The model is loaded.');
else
    error('The ''starting_model'' could not be loaded.');
end

% Check output path and writing permission
if ~exist(outputPath) == 7
    error('Output directory in ''outputPath'' does not exist. Verify that you type it correctly or create the directory.');
end

% make and save dummy file to test writing to output directory
A = rand(1);
try
    save([outputPath filesep 'A']);
catch ME
    error('Files cannot be saved to the provided location: %s\nObtain rights to write into %s directory or set ''outputPath'' to a different directory.', outputPath, outputPath);
end
%% Section 1 - Define the model bounds using setMediumConstraints

set_inf = 2000;
current_inf = 1000;
medium_composition = {};
met_Conc_mM = [];
cellConc = [];
t = [];
cellWeight = [];

mediumCompounds = {'EX_h(e)', 'EX_h2o(e)', 'EX_hco3(e)', 'EX_nh4(e)', 'EX_o2(e)', 'EX_pi(e)', 'EX_so4(e)'};
ions = {'EX_ca2(e)', 'EX_cl(e)', 'EX_co(e)', 'EX_fe2(e)', 'EX_fe3(e)', 'EX_k(e)', 'EX_na1(e)', 'EX_i(e)', 'EX_sel(e)'};

mediumCompounds = [ions mediumCompounds];
mediumCompounds_lb = -100;

customizedConstraints = {'EX_co2(e)', 'EX_o2(e)', 'EX_his_L(e)', 'EX_ile_L(e)', 'EX_leu_L(e)', ...
                         'EX_lys_L(e)', 'EX_phe_L(e)', 'EX_thr_L(e)', 'EX_trp_L(e)', 'EX_val_L(e)', ...
                         'EX_met_L(e)', 'EX_ascb_L(e)', 'EX_btn(e)', 'EX_chol(e)', 'EX_fol(e)', ...
                         'EX_pnto_R(e)', 'EX_retn(e)', 'EX_thm(e)', 'EX_vitd2(e)', 'EX_vitd3(e)', 'EX_retinol(e)'};
customizedConstraints_ub = [2000, 0, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, ...
                            2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000];
customizedConstraints_lb = [-100, -1000, -10, -10, -10, -10, -10, -10, -10, -10, -10, -1, -1, -1, ...
                            -1, -1, -1, -1, -1, -1, -1];

close_exchanges = 0;

[modelMedium, basisMedium] = setMediumConstraints(starting_model, set_inf, current_inf, medium_composition, met_Conc_mM, ...
                                                  cellConc, t, cellWeight, mediumCompounds, mediumCompounds_lb, customizedConstraints, ...
                                                  customizedConstraints_ub, customizedConstraints_lb, close_exchanges);

clearvars -EXCEPT modelMedium tol solver outputPath tutorialPath solverQuant
%% Section 2 - Generate an individual exchange profiles for each sample

load([tutorialPath filesep 'tutorial_II_data.mat']);
model = modelMedium;
test_max = 500;
test_min = 0.0001;
variation = 20;

prepIntegrationQuant(model, metData, exchanges, samples, test_max, test_min, outputPath, tol, variation);

clearvars -EXCEPT modelMedium samples tol solver outputPath tutorialPath solverQuant
%% Section 2B - Prepare table to check exchange profiles

nmets = 70;
[mapped_exchanges, minMax, mapped_uptake, mapped_secretion] = checkExchangeProfiles(samples, outputPath, nmets);

clearvars -EXCEPT modelMedium samples tol solver mapped_exchanges  outputPath tutorialPath solverQuant

save([outputPath filesep 'Result_checkExchangeProfiles']);
%% Section 3 - Generate contextualized models

changeCobraSolver(solverQuant, 'LP');

minGrowth = 0.008;
obj = 'biomass_reaction2';
no_secretion = {'EX_o2(e)'};
no_uptake = {'EX_o2s(e)', 'EX_h2o2(e)'};
medium = {};
tol = 1e-6;
model = modelMedium;
epsilon = 1e-4;

addExtraExch = {'EX_tdchola(e)', 'Ex_5hoxindoa[e]'};
addExtraExch_value = 1;
[ResultsAllCellLines, OverViewResults] = setQuantConstraints(model, samples, tol, minGrowth, obj, no_secretion, ...
                                                             no_uptake, medium, addExtraExch, addExtraExch_value, outputPath);
clearvars -EXCEPT modelMedium samples ResultsAllCellLines OverViewResults tol solver mapped_exchanges outputPath tutorialPath
%% Section 4 - Analyze added exchanges

changeCobraSolver(solver, 'LP');

[Ex_added_all_unique] = statisticsAddedExchanges(ResultsAllCellLines, samples);
clearvars -EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique tol solver mapped_exchanges outputPath tutorialPath


[Added_all] = mkTableOfAddedExchanges(ResultsAllCellLines, samples, Ex_added_all_unique);

save([outputPath filesep 'statistics']);

clearvars -EXCEPT modelMedium samples ResultsAllCellLines OverViewResults tol solver mapped_exchanges outputPath tutorialPath
%% Section 5 - Analyze the sets of essential genes

cutoff = 0.05;

[genes, ResultsAllCellLines, OverViewResults] = analyzeSingleGeneDeletion(ResultsAllCellLines, outputPath, samples, cutoff, OverViewResults);

clearvars -EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique genes tol solver mapped_exchanges outputPath tutorialPath
%% Section 6 - Check which individual gene-associated reaction makes the model infeasible

samples_to_test = samples;
fill = 'NAN';
genes_to_test = {'55293.1'};

[FBA_Rxns_KO, ListResults] = checkEffectRxnKO(samples_to_test, fill, genes_to_test, samples, ResultsAllCellLines);

clearvars -EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique genes FBA_Rxns_KO ListResults tol solver mapped_exchanges outputPath tutorialPath
%% Section 7 - Make intersect and union model

mk_union = 1;
mk_intersect = 1;
mk_reactionDiff = 1;
load([tutorialPath filesep 'starting_model.mat']);
model = starting_model;

[unionModel, intersectModel, diffRxns, diffExRxns] = makeSummaryModels(ResultsAllCellLines, samples, model, mk_union, mk_intersect, mk_reactionDiff);
clearvars -EXCEPT modelMedium samples ResultsAllCellLines OverViewResults Ex_added_all_unique genes FBA_Rxns_KO ListResults unionModel intersectModel  diffRxns diffExRxns tol solver mapped_exchanges outputPath model tutorialPath

save([outputPath filesep 'summary']);
%% Section 8 - Predict differences in metabolite production or consumption
%% Section 8A ATP production

obj = 'DM_atp_c_';
carbon_source = {'EX_glc(e)'};
samples = samples(1:4, 1);
dir = 1;

% ATP production
% exclude transport reactions from flux split analysis
transportRxns = {'ATPtm'; 'ATPtn'; 'ATPtx'; 'ATP1ter'; 'ATP2ter'; 'EX_atp(e)'; 'DNDPt13m';...
                 'DNDPt2m'; 'DNDPt31m'; 'DNDPt56m'; 'DNDPt32m'; 'DNDPt57m'; 'DNDPt20m';...
                 'DNDPt44m'; 'DNDPt19m'; 'DNDPt43m'; 'ADK1'; 'ADK1m'};

ATPprod = {'ATPS4m'; 'PGK'; 'PYK'; 'SUCOASm'};

met2test = {'atp[c]', 'atp[m]', 'atp[n]', 'atp[r]', 'atp[x]'};
[BMall, ResultsAllCellLines, metRsall, maximum_contributing_rxn, maximum_contributing_flux, ATPyield] = predictFluxSplits(model, obj, met2test, samples, ...
                                                                                                                          ResultsAllCellLines, dir,  transportRxns, ATPprod, carbon_source);

PHs = [samples maximum_contributing_rxn(:, 1)];

maximum_contributing_flux_ATP = maximum_contributing_flux;

clear ATPprod transportRxns met2test maximum_contributing_rxn
%% Section 8B NADH production

met2test = {'nadh[c]', 'nadh[m]', 'nadh[n]', 'nadh[x]', 'nadh[r]'};

transportRxns = {'NADHtpu'; 'NADHtru'; 'NADtpu'};

[BMall, ResultsAllCellLines, metRsall, maximum_contributing_rxn, maximum_contributing_flux_NADH] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir, transportRxns);
PHs = [PHs maximum_contributing_rxn(:, 1)];

clear transportRxns met2test maximum_contributing_rxn
%% Section 8C FADH2 production

transportRxns = {'FADH2tru'; 'FADH2tx'};

met2test = {'fadh2[c]', 'fadh2[m]', 'fadh2[n]', 'fadh2[x]', 'fadh2[r]'};
[BMall, ResultsAllCellLines, metRsall, maximum_contributing_rxn, maximum_contributing_flux_FADH2] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir,  transportRxns);

clear transportRxns met2test

PHs = [PHs maximum_contributing_rxn(:, 1)];
%% Section 8D NADPH production

transportRxns = {'NADPHtru'; 'NADPHtxu'};

met2test = {'nadph[c]', 'nadph[m]', 'nadph[n]', 'nadph[x]', 'nadph[r]'};
[BMall, ResultsAllCellLines, metRsall, maximum_contributing_rxn, maximum_contributing_flux_NADPH] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir, transportRxns);
clear transportRxns met2test

PHs = [PHs maximum_contributing_rxn(:, 1)];

save([outputPath filesep 'fluxSplits']);
%% Section 8E illustrate the phenotypes (PHs) on 3Dplot

diff_view = 1;
fonts = 18;

make3Dplot(PHs, maximum_contributing_flux_ATP, fonts, outputPath, diff_view);
%% Section 9 Perform phase Plane Analysis

mets = {'EX_glc(e)', 'EX_o2(e)'; 'EX_gln_L(e)', 'EX_o2(e)'; 'EX_lac_L(e)', 'EX_o2(e)'};
step_size = [40, 40; 20, 40; 40, 40];
step_num = [28, 26; 21, 26; 42, 26];
direct = [-1, -1; -1, -1; 1, -1];

[ResultsAllCellLines] = performPPP(ResultsAllCellLines, mets, step_size, samples, step_num, direct);

save([outputPath filesep 'PPP']);
%% Section 9b illustrate phase plane analysis results

label = {'Glucose uptake (fmol/cell/hr)'; 'Oxygen uptake (fmol/cell/hr)'; 'Growth rate (hr-1)'};
mets = {'EX_glc(e)'; 'EX_o2(e)'};
fonts = 12;
samples = {'IGROV1'};
illustrate_ppp(ResultsAllCellLines, mets, outputPath, samples, label, fonts, tol);
##### SOURCE END #####
--></body></html>