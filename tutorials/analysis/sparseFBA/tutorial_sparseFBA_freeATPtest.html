<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234001159668px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { text-align: center; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S7 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { text-decoration: underline; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S10 { line-height: 15.5926675796509px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S11 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S13 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S14 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S15 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S16 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S17 { color: rgb(64, 64, 64); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S18 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S19 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
.outputGroup {margin: 2px 0 2px 0; padding: 2px 2px 2px 4px;}
.outputRegion {}
.outputParagraph {color: rgba(64, 64, 64, 1); padding: 10px 0 6px 17px; background: white; overflow-x: hidden;}
.inlineWrapper:last-child .outputParagraph {border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}
.outputParagraph:empty {margin: 0;}
.inlineElement .symbolicElement {margin-top: 1px; margin-bottom: 1px;}
.embeddedOutputsSymbolicElement .MathEquation {margin-top: 4px; margin-bottom: 4px;}
.embeddedOutputsSymbolicElement .MathEquation.displaySymbolicElement {margin-left: 15px;}
.embeddedOutputsSymbolicElement .MathEquation.inlineSymbolicElement {margin-left: 5px;}
.embeddedOutputsSymbolicElement {overflow-x: auto; overflow-y: hidden;}
.embeddedOutputsSymbolicElement { overflow: initial !important;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement { max-height: none !important; overflow: initial !important;}
.veSpecifier {}
.veContainer {}
.veSpecifierBox {height: 400px; width: 500px;}
.veSpecifier .veTable {padding-top: 3px; padding-bottom: 4px;}
.veSpecifierBox .veSpecifier .veContainer {position: relative; width: 100%; height: 370px;}
.veSpecifierBox .dijitDialogPaneContent {width: 97% !important; height: 88% !important;}
.veSpecifier .veTable .rowHeadersWrapper {padding-bottom: 0;}
.veSpecifier .veTable .scroller .variableEditorRenderers {padding-right: 3px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;}
.veVariableValueSummary {display: inline-block;}
.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {visibility: hidden; z-index: 0;}
.veMetaSummary {font-style: italic;}
.veSpecifier .veTable .scroller {overflow: hidden;}
.veSpecifier .veTable:hover .scroller {overflow: auto;}
.veSpecifier .veVariableName,.veSpecifier .veDimensionFont {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.veSpecifier .veVariableName {padding-top: 2px;}
.veSpecifier .veDimensionFont {font-style: italic; color: #9A9A9A;}
.veSpecifier .scroller::-webkit-scrollbar-track {background-color: white;}
.veSpecifier .scroller::-webkit-scrollbar-corner {background-color: white;}
.veSpecifier .veTable .topRowHeaderWrapper {border: none; background-color: #F8F9FA;}
.veSpecifier .mw_type_ListBase.showCellBorders,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper,.veSpecifier .veTable .verticalScrollSpacer,.veSpecifier .veTable .horizontalScrollSpacer {border: none;}
.veSpecifier .veTable .dataScrollerNode {border: 1px solid #BFBFBF;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode,.veSpecifier .veTable .dataBody {font-family: Arial; font-size: 13px;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode {color: #7F7F7F;}
.veSpecifier .veTable .dataBody {color: #000000;}
.veSpecifier .veTable .columnHeaderNode .cell .drag,.veSpecifier .veTable .columnHeaderNode .cell .header,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {background-color: #F8F9FA;}
.veSpecifier .veTable .columnHeaderNode .cell .dragBorder {border-right: 1px solid #F8F9FA;}
.veSpecifier .veTable .rowHeaderNode .cell {padding-top: 3px; text-align: center; border-bottom: 1px solid #F8F9FA;}
.veSpecifier .veTable .dataBody .cell .plainText {text-align: right;}
.veSpecifier .veTable .dataBody .row .cell {border-bottom: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.embeddedOutputsVariableElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement {min-height: 18px; box-sizing: border-box; font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.embeddedOutputsMatrixElement .matrixElement{position: relative;}
.matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.embeddedOutputsMatrixElement.inlineElement .veVariableName {padding-top: 0;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer {white-space: nowrap; padding-top: 10px; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.matrixElement { max-height: none !important; }
.dijitTooltipDialog .dijitTooltipContainer .dijitTooltipContents .alertPlugin-alertMessage {min-width: 12px; max-width: 400px; max-height: 300px; overflow: auto;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar {width: 11px; height: 11px;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-track {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-corner {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {border-radius: 7px; background-color: rgba(0, 0, 0, 0.1); border: 2px solid rgba(0, 0, 0, 0); background-clip: padding-box;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.1);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.alertPlugin-alertLine {position: absolute; display: initial; width: 40px; text-align: right; cursor: text;}
.alertPlugin-onTextLine {visibility: hidden;}
.alertPlugin-hasTooltip .alertPlugin-warningImg,.alertPlugin-hasTooltip .alertPlugin-errorImg {cursor: pointer;}
.alertPlugin-alertLine .alertPlugin-warningElement,.alertPlugin-alertLine .alertPlugin-errorElement {display: inline-block; margin-right: 4px;}
.alertPlugin-isStale {-webkit-filter: opacity(0.4) grayscale(80%); filter: opacity(0.4) grayscale(80%);}
.diagnosticMessage-wrapper {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis</span></h1><h2 class = "S3"><span class = "S2">Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">Reviewer:</span></h2><h2 class = "S3"><span class = "S2">INTRODUCTION</span></h2><p class = "S4"><span class = "S2">We consider a biochemical network of </span><span class = "S2"> </span><span class = "S2">m</span><span class = "S2"> </span><span class = "S2"> molecular species and </span><span class = "S2"> </span><span class = "S2">n</span><span class = "S2"> </span><span class = "S2"> biochemical reactions. The biochemical network is mathematically represented by a stoichiometric matrix </span><span style="vertical-align:-3"><img src="data:image/png;base64,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" width="68.5" height="27" /></span><span class = "S2">. In standard notation, flux balance analysis (FBA) is the linear optimisation problem</span></p><p class = "S5"><span style="vertical-align:-30"><img src="data:image/png;base64,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" width="115" height="73" /></span></p><p class = "S4"><span class = "S2">where </span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAAAoCAYAAADnujR9AAAGZklEQVRoQ+2aBYwsRRCGv4e7BHeCJbi7Q3AJGgju7q4Bgj4IEtwhQIJrCBAkuAUPwd3d3cmXqwl982b2dmd3Xpa8qeRyu3Pd1T31d1X9VX3DaKTvLDCs73bUbIgGlD48BA0oDSh9aIE+3FLjKQ0ofWiBPtxS4ykNKH1ogfq2tDVweaJ+NmBtYHdgJuBtYD/gzvwWGk8ZsMhiwPbAwsCEwCfA/cB5wOc5o40HHA4sDxwAPFGC69zAgsDJwCTAFcC4Md51XO9rYCrgz1THqA6KAJwE7Ar8E4YZLTHQx8CqwEvxbF7gGmCu+P4rsCVwQwkwYwI/AmMAuwEXJONeAOYDZgA+bEAZsIDGvwuYGDgEeBL4A1gSOCW8x3GvA/MD28ap1zNmBgxHmRwInJoAmz133vPAc8BCOeAeB5YAJgB+akAZsMAWwD7A0sBvOYMZZgRJz1DeijBmyHkFGAc4N4DKpp4P7JkLRdsAlwFHAsfl1vg0vk+d97JROXzdFzmjLPRsDFwXBtNbDFl/JQbUdscDhybPjgaOSb6fAewNLAc8nDyfEvgMuBtYrQHlPwuYwFcHns0bJb6bgLPT7O9pSsZdCGwHCMiJOeAeCEBM9N8n8wXC0CkJOLgqKMZdXXdNQFYxGWCS+wB4BrgduLUgDJS8R188/iJyh4YpkzeBWYG/gbFyBh87vGJ9YKsId3k93wTDUkcq5jAB3Ay4ugoonoLTIiG+HAh/CRgL1wNmDKW6o9Ty/R6YXLYi9Rw9mIu/M5E+un638hCwSJxUqe8gWhrKpcUrxOdpgyr71VxzZSTwvYAfCjYjGXgHuBHYKPd3GdwmERLNUYNkqJxyZiQvY6lJ8ZwcwzAhPggsGi8lxdSDqogxe4/g/7MD0skikZ7OU2WB3JxNk1MqO9o/apN0mPlmw3hgbSGT2hc4IUDZocU+PLA3lyT5V6OAnD4o8yCi0QoUC6SMMbgRk1aRrBuhS969QEVj7QKcHZ7xbYQCXf/3CIlS1ayOsLAzwXYrvrvv5EnP5J5gVB/FA+uKneKz1bhjrVsUaayH492SjZhjjgLWifCeDTMC6FlZPWRauDTVUQaK/PrpCB2eDjl2ZpT8HjzVshMVu0CnkrUjBFVvNKwYw0eWLBMnf9lY0Pe1ElesV6zaFSm0AJgPBEi5GNix1xstA8U4uEEsZhIzfpaJCXCpiJ/vdbjB6YDXog+kUb7rcH6vhmuHtaIVoidKZhTDVEZ5DXfXApNGzWLe+xkw1/R030WgSAVtL+hexrrJI+71ygCpHt1bN/e0PlrHAh3oNIc9FYzKXKCcHt7rZ3PLTfHc+mKV+GwS9xD3TIpAsZdj80x5BMjcumeLJoqk03J4WxZl4bGOdYt0evJNzmkxeUnUII63thAM5VjgiPh8Vi4vdb3fIlDs4dhSVkyEJvm6xC6pNdAvHSwghZTtjQxJw7h5VZampNV+UV+rq70VgZJxaBVLUaXBdYnx2z6SHtOumGxbUdF29bQzzqQv6bGGmSg5PNL3rHNsCWBTMW3BtKO7dEwRKFbm0lzFUHZVVyu0nmwbwkJshDuFGtdsV7XhTOrqoTGXZPWK86W1aWd3DuCNdhUPNa4IlKxgdK63ZHZDy0RKaCdUb7Lx1qkcBAzPJdFOddQ1fmXg3vAAw2UWurL17GDYWFRstdzSq40UgbIGcEcsoJfoLUUiDbbzaV6QQuZv6NrZo25vONL1rZgHXfa0o6BHY+xMmLxtTtqLknRYBlibWJd4cPLiu8saFesZD1hPpAgUnz0WFzBW0rad81eeKwUN1I0tpKyEq0qWNL8KUuGJK+olVdU/1Dybq7dFreXY6wHvRvQSbyUPK1GQ1jCGMru+9uis77pikmXFo81G7xtMaNYqshCbkb6ATUcvhqxlNgfMC92Kei6KO2y95kXAdouHwlaLz7IXteGZtka6WXuW+McFc0JebMJazZcZePHcYZW0mHe8UexKWvW+bE3bk7I4mjOoq5WrBvM0m08GXWN2tZOB+wrXWxGYIpLp+IA/JttMetWQVJ/1kQfPA2iYthzwAOxc1FIveD/b/l4FC4SACEzXMlSXuOsF/mcKbDBKcb1HaVfMrVL6/JVyu/NHGNeAUtl09U1sQKnPtpU1N6BUNl19ExtQ6rNtZc0NKJVNV9/EBpT6bFtZcwNKZdPVN7EBpT7bVtb8L7/tOjjO/xeCAAAAAElFTkSuQmCC" width="50.5" height="20" /></span><span class = "S2"> is a parameter vector that linearly combines one or more reaction fluxes to form what is termed the objective function,  and where a </span><span style="vertical-align:-5"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFcAAAAqCAYAAADGdMdzAAAFj0lEQVRoQ+2adahlVRTGf2MrdndiK2J3NyZioQhii92Bon+InSOKMYyoiCCiomKgYoOBiYpdGNiJYssP1pHzLvfEvu9ueL53FgzzZnacvb+99re+tfabRGfZEJiUbeZuYjpwMzpBB24HbkYEMk7deW4HbkYEMk5d5bnTAj8BM/d8eyfg3ozrGWtT7wgcCKwFzAd8DbwC3Ajc1rTYKnDnAc6MwdsCK8TPCwBfNk06DtpnAm4C9gB+DyDfBpYC9g6neyB+/qFqv2049xlgXeDDmHwcYFe7BTHRK3cHvgG2Al4ujVgOeAxYCHgY2B74s9+MTeBOF/TgSfrBvcY7ssA+wC2xz/2DAnq3vStwZ/zn0cCVg4C7WunUTgQuGefg6mzvAksDXwCLAH9V7Pm96CcPLwr81tuvyXMl8ykxaGPgqXEO7gbA07HHqRHMqrZ8KXBcNO4M3JMK7tXA4cEpcwCzAEcAXoslgRnipL1GlwF/jBHw14u1PZG4nvOAU2PMYcC1NeMNbLdG+/XAIangPgesHfLj+NJkrwLy8ToBuPM+DmwT0TVxT0Pp7i3cOsDZPLzq8sSZ74sA5TAD2SM145Vnz0e7OBn0R1gdLUwfwWxG4KXgH09Vjfd3zDJ36N7149/Kt3MSNzTa7mry3YDTgNVjbQbfMwB5McXeLymiFYE3awarFj6LdnOC2VPAdaEvxgBJfbuQHr1zrAroydrnwGI1QSBlo019PfT9gJOBZYOSPPgLgqqaxvdr/x6Q/jSD1Kc1k8wG/Fhq9yaPCH51nnsQIJdoco8cVGWCumA0LgPoAbnMTclv0tTCwC+xPpVMHRht1qNe9SZo84bOrRrnzTbBKGwuwMP5z+rAvQY4NHouD5ihVNlrwMrRuFnwb5vNpPQx/Twq/swZG1FfTo60NGWuqr563jQtwfUQysmDFPldW3Ala0n7dWCVhpV/HHRgt41KcmYYG14ivPTgSDvVn8ogD798LYfxLVPZgjubaGHWiEnFd/XkEZlalecqsVy4vOYmlGNVZnHn59KJy7mfRGe18R3A+QMmIGZL8qh89hFwIXAD8OswkOwzxwchMW1KCWjuX7oaYVXgrgG8ED3lt4J7++1JT30yGoyeZjWFGVwMOCeEt6ViojpRe2pXBLhFhE6dq03/+yNw2zdFinnLlaWtwBXQQkBvATxas7KzgbOiXa86oNTXq7MSoA4cxORWb82xwPwRQMycLsoUNAdNIsxipa1W4ApskXFYBXqnAhk9/62QQnbJlSJLPRZRTgodauAxO/JmGEyHZRuWUvyU9HcX4O624EoJUoNm8abQsb3jrXcWRWNTzU2jgxx7SvxsQUMP7luWS0RF7vWbzu26tLuCOga9HeUlZC/cGMzMOPxbOybkTi8O6lqTDDMVtaZp8hvRSTCNugYhD2bNRBCbuguCSY2cvEl0trZ6btRa/2maoKY9a8mxnDNbIVLjWjMwBS5M8r4ZkDL0SL1JDypbUa7s5eFR7LvvUFNvQbYypT0bIPscVaTpKd/sLZZvGbWVYg73bAwygbH24CG3LpabOCi/NK+5tQIVgV6qxrQaZpDSvorisl7Ta6amPpVYlkstoKSAUfR1TSqTfUO6HQlcNchEgI8DOo+vEcUzj7HFOm/xzPNgPB4kPfNcV4p8Zh1ypoFkT0BBrzeYrVmJN0OqEvIXhwRrUhsD7r9y2OKRdJj81EnINt/1Qbb8QOmzj08+xQNlLf00FcvbLKCqz0OhFX3s/HY0E/1fx+YEVwqxeG4aOSEtF7gqCStlFp93mJDIQrbfcvR3HXzXN+M5vQN3uAgYtc2erAnfDlRG1OF+dmzNlosWfLBUjGumzmrDCWe5wJ1wQPbbcAduRjfowO3AzYhAxqk7z+3AzYhAxqk7z80I7r/fThM6JovtcgAAAABJRU5ErkJggg==" width="43.5" height="21" /></span><span class = "S2">, or  </span><span style="vertical-align:-5"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFcAAAAqCAYAAADGdMdzAAAFiElEQVRoQ+2aZ6gsRRBGzzMr5hwxYVbMignFLEYwIopiDmDOIPpDUTGiIiYUFRVEzBgwJxCzomJOGDBnwSznUaNzx53Zmd1pld2pP+/e2901XV9XV31V/SbRSTIEJiXT3CmmAzehE3TgduAmRCCh6s5zO3ATIpBQdZnnTgl8B0xf+PbWwB0J9/N/U70VsDewGjAX8DnwAnAVcEO/zZaBOwdwYizeDFg6fp4H+LSf0hEYnw64GtgR+DmAfB1YFNglnO7u+PmbMnvrxNwngDWBd0P5CGBXaYKY6JU7AF8AGwPP51YsCTwEzAfcB2wB/NpLYz9wp4rw4En6wZ1HHVlgV+DasHPPCAFFs7cDbo4/HgJcMAi4K+ZO7Sjg7BEHV2d7E1gM+ARYAPitxOa3Yp5xeEHgp+K8fp5rML88Fq0HPDbi4K4NPB42XhHJrMzkc4DDY3Ab4Pam4F4EHBgxZRZgBuBgwGuxCDBNnLTX6Fzgl5bB3xD4Fni6Zb1l6k4DjovBA4BLKr5rYrs+xi8D9msK7pPA6kE/jsgpexEwHq8RgKv3YWDTyK5tYaGhGnwvcDrwIPBHW8p76LkzEpRDJrL7K74lPXsqxsXJpD9BqsLC1JHMpgWei/ijsXK830PL7MF714rfpW+ntGi8mflUYHuY3GTSGMG+NbeHFj/H2zlGtAzwaoVy2cJHMW5NMHMTcFcGno0FBvXNg3oUdawA6MnKx8BCFUlgUCDk2ccCu8WN0egzgOtavilfA4Y/xST1YcWGZ4qQlU3xJk9IflWeuw9gLFGMPcagMhHUeWNwcZjsASlkYUDW4t6khx8AZ0XS/aGFD8pXrU6VOYPnlqn1ZltgZDIb4OH8JVXgXgzsHzOXAqxQyuQlYLkY3CDibwu2lqqYGzgskqvXUbJ/PnAh8OUQH9bzpqgJroeQLx4MkV/VBdf4ZtB+GVi+z4bfj3DgtHVzdGYIO2stnRU4KCiRnqb3esukSVVXuky5pWwWO/uFhRkjJ2W69OQJlVqZ50qxpEAmMz1YOlYmNne+z524MdfrqsiNb4pMn7IAkSIaKo6OWCkltNK6sdYR/T3pnaCY/qVJQtN+Y/AEKQN3FeCZmCl/y2Jvr73qqY/GgNnTqiYTk84xwJHhTQ1tbTRdTzs+PNmFEvzzGmmAuyJxu6wJFfOWS0trgSugGYGWyMsvy+Rk4KQYvBLYKzfRq7MsIA9MJUvEAe4BeDVNrhY07t/b10QGLSKsYvetC64byyoOueYbJTvU818DNFD5N0vklaKasi1oEnKPZ0ar8B91fk2E18mV+E3K322B2+qCa0gwNCg2bzIeW1yvYVnT+BFg/ZhgNSUvVTRUD+7ZlqtpdH6aAHj9t4w/ule/Z5eqrMlS9zPJGzcmMysO/1UODZpT3KC81iLDSuXHKJNfiUmCadZ9Lw5m1brWVdyQTYATcgf4QFRrlqhtlsRJW475mtkOkRzXnoElcCYG72sAQ4YeqQffUgAma1cW43ATnL3uNokE1QMSRNmHiTKr65voqzO32CzfKHor2VptNgfNH70HK9fazXILB+mX4jW3VyAj0EvtcdoNM0kpnwXlsSNflN0j/g2StTNdsgwrMKmVzy7GVGN8arH603l8jcieefyufd7smeeeeDxo9MxzaS7zWXUYM+WPOwGWnzZtrNaMcXbgyzKyoAhOP7ZRBZTtTd+tzP6DFAXDHoIPsvkHSitBn3yyB8rKcNSvWT7M5mwTyhV97BymJB1mD//p2pTgGkK8zpL7sZRU4MokJPM2nzPKNHYApwLX/+vgu74Vj5l+LCUVuPYTpEs2U2yelGbUUUY9Fbg+WErGFctSueHYSSpwxw7IXgZ34CZ0gw7cDtyECCRU3XluB25CBBKq7jw3Ibh/ApRZFzovdq9GAAAAAElFTkSuQmCC" width="43.5" height="21" /></span><span class = "S2">, represents some fixed output, or input, of the ith molecular species. A typical application of flux balance analysis is to predict an optimal non-equilibrium steady-state flux vector that optimises a linear objective function, such biomass production rate, subject to bounds on certain reaction rates. </span></p><p class = "S4"><span class = "S2">In this tutorial, we demonstrate how to predict the minimal number of active reactions that are still consistent with an optimal objective derived from the result of a standard flux balance analysis problem. In each case, the corresponding problem is a cardinality minimisation problem that we term </span><span class = "S6">sparse flux balance analysis</span></p><p class = "S5"><span style="vertical-align:-40"><img src="data:image/png;base64,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" width="103" height="94" /></span></p><p class = "S4"><span class = "S2">where the last constraint is optional and represents the requirement to satisfy an optimal objective value </span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAoCAYAAAB0HkOaAAACjElEQVRYR+3YW6iNaRzH8c82IWVERCmaRjmmTI5TinJBUZRDFHKDSFOKixmZEdNQTklcjBKKHC+kcSElKeQYORTlcCFxgXJKGvSvZ9Xb6n23vdbea+19sZ+b1Xqfd/1/3/f5H9/VoA2thjbEoh2myBvtJ9N+MpVmar1ipiM+fw+uXjAr8S/eNwZUL5gb2IhjrQUzFz+hM9bhMk7iK47gSTlYLU+mO/ZgVkb0NRbjRN4J1RKmpHcPQ9KX+TjYWnWmHx5hCybjDha2NMxgDMcPuI/bKRbKdWbgJS6iE37HP0VpXqmbRmMbxpepRrYsQLik6tVUmCham1Pw7cUzTMGEjPIL/ILn1dI0BeZHnMKoJH49I7YW6zPft2JVrWAC9jDmYElK1axWB1zByHQx3DSsVjCzcRTv0AcfcoSioP2Vrke571ormHDPNPyXPvN0JuFs2niDHrWACaMRlBG8f2JDgchEnEt74bKxtYCZiePJcBSsMwUi83Ao7W1KtaQqnsayaSdWJKs98apAYQ3+TnsjcKsqEhp9VYnSHZnxEAMLBOJh7qbecxpTqwWJ3xWdTO8UL3FPzCCR2nkrKvGFNDRFdY7WUPUqgom2XxqEwl2/5ShECl/DoDQm5I4FlZAVwezC8mToJuKp/88Y7oYDmJ4muD8qES26twgm4mAo3iLaQWRVBOkX/IoQ749oB9GFY3pr9sqDycbLvjQeRpXNrvNYjavNJsgYyIOJYI0ZNdYi7McAjMEnhNsetyREyVYezG4sSzfEQP20FsJ5NvNgSjNrPP3P9QIJnXKYvmlwir146VramjBRT3YkgFK3rhtP+clcwrg0t/TCx7qRlLmpC7Yn8Qdp8K4nS/t/eoWn/Q0gA24pXAxudAAAAABJRU5ErkJggg==" width="17.5" height="20" /></span><span class = "S2"> </span><span class = "S2"> </span><span class = "S2">derived from any solution to a flux balance analysis (FBA) problem. This approach is used to check for minimal sets of reactions that either should be active, or should not be active in a flux balance model that is representative of a biochemical network.</span></p><p class = "S4"><span class = "S2">In particular, we use sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis, which should never appear in any flux balance analysis model where constraints arising from ATP demands are being implemented, since a stoichiometrically balanced cycle involving ATP hydrolysis might create artefactual energy metabolism predictions. In order to mimic the requirement for energy, for maintenance of cellular integrity, many flux balance models contain a cytoplasmic adenosine triphosphate (atp[c]) hydrolysis reaction where the products are adenosine diphosphate (adp[c]) and orthophosphate (pi[c]). In Recon 3D, the full corresponding reaction formula is </span></p><p class = "S4"><span class = "S2">                                                            h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]  </span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#eq_ATPhydrolysis'><span class = "S8">(1)</span></a><span class = "S2"> </span></p><p class = "S4"><span class = "S2">In a flux balance model, a maintenance requirement for synthesis of adenosine triphosphate can be represented with a lower bound on reaction </span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#eq_ATPhydrolysis'><span class = "S8">(1)</span></a><span class = "S2"> or inclusion of reaction </span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#eq_ATPhydrolysis'><span class = "S8">(1)</span></a><span class = "S2"> within a composite biomass reaction, when cellular growth is being modelled [</span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#LyXCite-feist_biomass_2010'><span class = "S8">feist_biomass_2010</span></a><span class = "S2">]. In order for either of these approaches to result in a constraint on energy metabolism within the model, no stoichiometrically balanced set of internal reactions that include reaction </span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#eq_ATPhydrolysis'><span class = "S8">(1)</span></a><span class = "S2"> should admit isolated hydrolysis of ATP, given the reaction bounds supplied with the model. If such a set exists, sparse flux balance analysis can be used to find one such minimal cardinality set. </span></p><h2 class = "S3"><span class = "S2">EQUIPMENT SETUP</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">global </span><span class = "S12">TUTORIAL_INIT_CB;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">if </span><span class = "S12">~isempty(TUTORIAL_INIT_CB) &amp;&amp; TUTORIAL_INIT_CB==1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    initCobraToolbox</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    changeCobraSolver(</span><span class = "S14">'gurobi'</span><span class = "S13">,</span><span class = "S14">'all'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S15">end</span></p></div></div><h2 class = "S3"><span class = "S2">TIMING</span></h2><p class = "S4"><span class = "S2">A minimal solution to sparse flux balance analysis problem can be obtained in &lt; 10 seconds. The time consuming part is comparing the predictions with the biochemical literature to assess whether the predictions are consistent with biochemical network funcion or not, as such, the process of refining a model to increase its biochemical fidelity can take days or weeks.</span></p><h2 class = "S3"><span class = "S2">PROCEDURE</span></h2><h2 class = "S3"><span class = "S2">Setting the numerical tolerance</span></h2><p class = "S4"><span class = "S2">Implementation of sparse flux balance analysis with any numerical optimisation solver, requires a tolerance to be set that distinguished between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver. Typically 1e-6 will suffice, except for multiscale models.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">feasTol = getCobraSolverParams(</span><span class = "S14">'LP'</span><span class = "S13">, </span><span class = "S14">'feasTol'</span><span class = "S12">);</span></p></div></div><h2 class = "S3"><span class = "S2">Loading and examining the properties of Recon3.0model</span></h2><p class = "S4"><span class = "S2">We are going to focus here on testing the biochemical fidelity of Recon3.0model, so load it, unless it is already loaded into the workspace</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">clear </span><span class = "S16">%model</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">if </span><span class = "S13">~exist(</span><span class = "S14">'modelOrig'</span><span class = "S13">,</span><span class = "S14">'var'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    filename=</span><span class = "S14">'Recon1.0'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='Recon2.0';</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='Recon2.0model';</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='Recon2.04model';</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='HMR2.0'</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='Recon2.2model';</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='Recon3.0';</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S16">%filename='Recon3.0model';</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    directory=</span><span class = "S14">'~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    model = loadIdentifiedModel(filename,directory);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    model.csense(1:size(model.S,1),1)=</span><span class = "S14">'E'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    modelOrig = model;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    model=modelOrig;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S15">end</span></p></div></div><h2 class = "S3"><span class = "S2">Testing for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><p class = "S4"><span class = "S2">There are two options: A: sparse flux balance analysis using zero norm minimisation, and B: one norm minimisation.</span></p><h2 class = "S3"><span class = "S2">A: Sparse flux balance analysis test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><p class = "S4"><span class = "S2">Detect the ATP maintenance reaction and if there is none already, add one.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">atpMaintenanceBool=strcmp(model.rxns,</span><span class = "S14">'DM_atp_c_'</span><span class = "S13">) | strcmp(model.rxns,</span><span class = "S14">'DM_atp(c)'</span><span class = "S13">) | strcmp(model.rxns,</span><span class = "S14">'ATPM'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">if </span><span class = "S12">~any(atpMaintenanceBool)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'Could not find ATP maintenance reaction, adding one.'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S13">~strcmp(filename,</span><span class = "S14">'HMR2.0'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        model = addReaction(model, </span><span class = "S14">'ATPMnew'</span><span class = "S13">, </span><span class = "S14">'h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        model = addReaction(model, </span><span class = "S14">'ATPMnew'</span><span class = "S13">, </span><span class = "S14">'m02040c + m01371c -&gt; m02039c + m01285c + m02751c'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    atpMaintenanceBool=strcmp(model.rxns,</span><span class = "S14">'ATPMnew'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'%s %s\n'</span><span class = "S13">,model.rxns{atpMaintenanceBool},</span><span class = "S14">' is the ATP maintenance reaction'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S15">else</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    fprintf(</span><span class = "S14">'%s %s\n'</span><span class = "S13">,model.rxns{atpMaintenanceBool},</span><span class = "S14">' is the ATP maintenance reaction:'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="9F2644C4" data-testid="output_0" data-width="1465" style="width: 1495px;"><div class="textElement">Could not find ATP maintenance reaction, adding one.</div></div><div class="inlineElement embeddedOutputsTextElement" uid="DDD33BC1" data-testid="output_1" data-width="1465" style="width: 1495px;"><div class="textElement">ATPMnew	atp[c] + h2o[c] 	-&gt;	adp[c] + h[c] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="CAE55D20" data-testid="output_2" data-width="1465" style="width: 1495px;"><div class="textElement">ATPMnew&nbsp;&nbsp;is the ATP maintenance reaction</div></div></div></div></div><p class = "S18"><span class = "S2">Display the size of the  model</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">[nMet,nRxn] = size(model.S);</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'%6s\t%6s\n'</span><span class = "S13">,</span><span class = "S14">'#mets'</span><span class = "S13">,</span><span class = "S14">'#rxns'</span><span class = "S13">); fprintf(</span><span class = "S14">'%6u\t%6u\t%s%s\n'</span><span class = "S13">,nMet,nRxn,</span><span class = "S14">' totals in '</span><span class = "S12">, model.modelID)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="B9268EFC" data-testid="output_3" data-width="1465" style="width: 1495px;"><div class="textElement"> #mets	 #rxns<br>&nbsp;&nbsp;2766	&nbsp;&nbsp;3743	 totals in Recon1</div></div></div></div></div><p class = "S18"><span class = "S2">Display the constraints</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">minInf = -1000;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">maxInf =  1000;</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S12">printConstraints(model, minInf, maxInf);</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="953C851A" data-testid="output_4" data-width="1465" style="width: 1495px;"><div class="textElement">MinConstraints:<br>maxConstraints:</div></div></div></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Identify the exchange reactions(s) heuristically</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">if </span><span class = "S13">~isfield(model,</span><span class = "S14">'SIntRxnBool'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">    model = findSExRxnInd(model,size(model.S,1),1);</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="C611D2F0" data-testid="output_5" data-width="1465" style="width: 1495px;"><div class="textElement">Assuming biomass reaction is: S6T14g</div></div></div></div></div><p class = "S18"><span class = "S2">Maximise the atp maintenance reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">model.c(:)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">model.c(atpMaintenanceBool)=1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">osenseStr=</span><span class = "S14">'max'</span><span class = "S12">;</span></p></div></div><p class = "S18"><span class = "S2">Choose to minimize the zero norm of the optimal flux vector</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">minNorm=</span><span class = "S14">'zero'</span><span class = "S12">;</span></p></div></div><p class = "S18"><span class = "S2">Allow thermodynamically infeasible fluxes</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">allowLoops=1;</span></p></div></div><p class = "S18"><span class = "S2">Select the approximate step functions when minimising the zero norm of the flux vector</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S16">% zeroNormApprox='cappedL1';% : Capped-L1 norm</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S16">% zeroNormApprox='exp';%Exponential function</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S16">% zeroNormApprox='log';%Logarithmic function</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S16">% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S16">% zeroNormApprox='lp-';%L_p norm with p&lt;0</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S16">% zeroNormApprox='lp+';%L_p norm with 0&lt;p&lt;1</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">zeroNormApprox=</span><span class = "S14">'all'</span><span class = "S13">;</span><span class = "S16">% test all approximations avialable and return the best one</span></p></div></div><p class = "S18"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S18"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">tic</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S12">toc</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="D472CE34" data-testid="output_6" data-width="1465" style="width: 1495px;"><div class="textElement">Elapsed time is 0.953216 seconds.</div></div></div></div></div><p class = "S18"><span class = "S2">Check to see if there is a non-zero flux through the ATP maintenance reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'%g%s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(atpMaintenanceBool),</span><span class = "S14">' flux through the ATP maintenance reaction'</span><span class = "S12">)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="D07F2065" data-testid="output_7" data-width="1465" style="width: 1495px;"><div class="textElement">1000 flux through the ATP maintenance reaction</div></div></div></div></div><p class = "S18"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">cutoff=0.1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">for </span><span class = "S12">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'%10g%15s\t%-60s\n'</span><span class = "S12">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="6BF0BA1F" data-testid="output_8" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-333.333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3HCO3_NAt	3 hco3[e] + na1[e]&nbsp;&nbsp;-&gt; 3 hco3[c] + na1[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="E6333825" data-testid="output_9" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 111.111&nbsp;&nbsp;&nbsp;&nbsp; ASNCYSNaEx	asn-L[e] + cys-L[c] + na1[e]&nbsp;&nbsp;-&gt; asn-L[c] + cys-L[e] + na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="FF30D2E6" data-testid="output_10" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp; -1000&nbsp;&nbsp;&nbsp;&nbsp; BILDGLCURt	bildglcur[e] + hco3[c]&nbsp;&nbsp;-&gt; bildglcur[c] + hco3[e]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="4F355E68" data-testid="output_11" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp; -1000&nbsp;&nbsp;&nbsp;&nbsp;BILDGLCURte	atp[c] + bildglcur[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + bildglcur[e] + h[c] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="EAE15C5F" data-testid="output_12" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 111.111&nbsp;&nbsp;&nbsp;&nbsp; CYSGLNNaEx	cys-L[e] + gln-L[c] + na1[e]&nbsp;&nbsp;-&gt; cys-L[c] + gln-L[e] + na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="EF81F3C9" data-testid="output_13" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 111.111&nbsp;&nbsp;&nbsp;&nbsp; GLNASNNaEx	asn-L[c] + gln-L[e] + na1[e]&nbsp;&nbsp;-&gt; asn-L[e] + gln-L[c] + na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="8F170638" data-testid="output_14" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATPMnew	atp[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + h[c] + pi[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div></div></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">When all external reactions are blocked, i.e., when all external reaction bounds are set to zero, then the only net flux admissible is within a stoichiometrically balanced cycle, if and only if, the bounds on each reaction in the stoichiometrically balanced cycle simultaneously admit net flux in one direction around the cycle. Net flux around a stoichiometrically balanced cycle is thermodynamically infeasible [</span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#LyXCite-fleming_variational_2012'><span class = "S8">fleming_variational_2012</span></a><span class = "S2">], but steady state mass balance constraints do not enforce thermodynamic constraints. In lieu of such constraints, the bounds on reactions can be set based on the biochemical literature to eliminate net flux around a stoichiometrically balanced cycle. In Recon3.0, with all external reactions blocked (bounds are set to zero), maximising reaction </span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#eq_ATPhydrolysis'><span class = "S8">(1)</span></a><span class = "S2"> while minimising the cardinality of all internal reactions, using sparse flux balance analysis was used to find one such minimal cycle. The optimal solution involves reaction </span><a href = 'https://localhost:61415/toolbox/matlab/codetools/liveeditor/index.html?id=2123510217&file=%2Fhome%2Frfleming%2Fwork%2FsbgCloud%2Fcode%2Ffork-cobratoolbox%2Ftutorials%2FsparseFBA%2Ftutorial_sparseFBA_freeATPtest.mlx&showLineNumbers=true&clipboardtempdirpath=/tmp/ConnectorClipboard8461570144481489503&snc=E19A28#eq_ATPhydrolysis'><span class = "S8">(1)</span></a><span class = "S2"> in a set of nine stoichiometrically balanced reactions, with bounds that admit an arbitrary amount of isolated ATP hydrolysis. Recon3.0model contains no set of reactions that admit an arbitrary amount of isolated ATP hydrolysis.</span></p><h2 class = "S3"><span class = "S2">TROUBLESHOOTING</span></h2><p class = "S4"><span class = "S2">By further constraining the bounds to convert one reversible reaction in each such stoichiometrically balanced cycle to an irreversible reaction, isolated ATP hydrolysis can be eliminated, e.g., though there are important exceptions, a reactions hydrolyses ATP does not generally operate in a reverse direction at biochemically realistic metabolite concentrations. </span></p><h2 class = "S3"><span class = "S2">B: One norm minimisation test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><p class = "S4"><span class = "S2">Run flux balance analysis on the same model and minimise the sum total of all reaction rates (minimium one norm)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">minMorm</span><span class = "S13">=</span><span class = "S14">'one'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">oneNormFBASolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S18"><span class = "S2">Display the one norm flux balance analysis solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">for </span><span class = "S12">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">abs(oneNormFBASolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'%10g%15s\t%-60s\n'</span><span class = "S12">,oneNormFBASolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="FF04BBF7" data-testid="output_15" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-333.333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3HCO3_NAt	3 hco3[e] + na1[e]&nbsp;&nbsp;-&gt; 3 hco3[c] + na1[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="246185BA" data-testid="output_16" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 111.111&nbsp;&nbsp;&nbsp;&nbsp; ASNCYSNaEx	asn-L[e] + cys-L[c] + na1[e]&nbsp;&nbsp;-&gt; asn-L[c] + cys-L[e] + na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="4E3DFE61" data-testid="output_17" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp; -1000&nbsp;&nbsp;&nbsp;&nbsp; BILDGLCURt	bildglcur[e] + hco3[c]&nbsp;&nbsp;-&gt; bildglcur[c] + hco3[e]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="79F316FA" data-testid="output_18" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp; -1000&nbsp;&nbsp;&nbsp;&nbsp;BILDGLCURte	atp[c] + bildglcur[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + bildglcur[e] + h[c] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="118BF6DD" data-testid="output_19" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 111.111&nbsp;&nbsp;&nbsp;&nbsp; CYSGLNNaEx	cys-L[e] + gln-L[c] + na1[e]&nbsp;&nbsp;-&gt; cys-L[c] + gln-L[e] + na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="2F477210" data-testid="output_20" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 111.111&nbsp;&nbsp;&nbsp;&nbsp; GLNASNNaEx	asn-L[c] + gln-L[e] + na1[e]&nbsp;&nbsp;-&gt; asn-L[e] + gln-L[c] + na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="E8526E9F" data-testid="output_21" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATPMnew	atp[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + h[c] + pi[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div></div></div></div><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">Depending on the model, minimising the one norm may give as good an approximation of a minimal stoichiometrically balanced cycle as minimising the zero norm, but experience suggests this is less likely for large cycles or large models.</span></p><h2 class = "S3"><span class = "S2">Testing for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><p class = "S4"><span class = "S2">There are two options: A: sparse flux balance analysis using zero norm minimisation, and B: one norm minimisation.</span></p><h2 class = "S3"><span class = "S2">A: Sparse flux balance analysis test for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><p class = "S4"><span class = "S2">Fully open all internal reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">model.lb(model.SIntRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">model.ub(model.SIntRxnBool)=1000;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12"></span></p></div></div><p class = "S18"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed and all internal reactions reversible</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S18"><span class = "S2">Check to see if there is a non-zero flux through the ATP maintenance reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S13">fprintf(</span><span class = "S14">'%g%s\n'</span><span class = "S13">,sparseFBAsolutionUnBounded.v(atpMaintenanceBool),</span><span class = "S14">' flux through the ATP maintenance reaction'</span><span class = "S12">)</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="8B2A61F1" data-testid="output_22" data-width="1465" style="width: 1495px;"><div class="textElement">1000 flux through the ATP maintenance reaction</div></div></div></div></div><p class = "S18"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">cutoff=0.1;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">for </span><span class = "S12">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">abs(sparseFBAsolutionUnBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'%10g%15s\t%-60s\n'</span><span class = "S12">,sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="52A2DD4C" data-testid="output_23" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-181.818&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CAATPS	atp[c] + 2 ca2[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + 2 ca2[e] + h[e] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="363D8D81" data-testid="output_24" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 363.636&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAt7r	ca2[c] + 3 na1[e]&nbsp;&nbsp;-&gt; ca2[e] + 3 na1[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="1625024D" data-testid="output_25" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-454.545&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLUVESSEC	atp[c] + glu-L[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + glu-L[e] + h[c] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="30A0F9A4" data-testid="output_26" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-454.545&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLUt6	glu-L[e] + h[e] + k[c] + 3 na1[e]&nbsp;&nbsp;-&gt; glu-L[c] + h[c] + k[e] + 3 na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="7B83910F" data-testid="output_27" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-272.727&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKt	atp[c] + h2o[c] + k[e]&nbsp;&nbsp;-&gt; adp[c] + h[e] + k[c] + pi[c]&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="BE7BB596" data-testid="output_28" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-90.9091&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NaKt	atp[c] + h2o[c] + 2 k[e] + 3 na1[c]&nbsp;&nbsp;-&gt; adp[c] + h[c] + 2 k[c] + 3 na1[e] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="BC49262A" data-testid="output_29" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATPMnew	atp[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + h[c] + pi[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div></div></div></div><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">When all reactions are reversible, in a genome-scale model, it should be anticipated to find a stoichiometrically balanced cycle of reactions that admit an arbitrary amount of isolated ATP hydrolysis. It is important nevertheless to realise that these cycles are latent in the network and could become active with inadvertent relaxation of model bounds.</span></p><h2 class = "S3"><span class = "S2">B: One norm minimisation test for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><p class = "S4"><span class = "S2">Run flux balance analysis on the samemodel and minimise the sum total of all reaction rates (minimium one norm)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">minMorm=</span><span class = "S14">'one'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">oneNormFBASolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S18"><span class = "S2">Display the one norm flux balance analysis solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S11">for </span><span class = "S12">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S11">if </span><span class = "S12">abs(oneNormFBASolutionUnBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S12">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">        fprintf(</span><span class = "S14">'%10g%15s\t%-60s\n'</span><span class = "S12">,oneNormFBASolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S10 lineNode"><span class = "S13">    </span><span class = "S15">end</span></p></div><div class = 'inlineWrapper outputs'><p class = "S10 lineNode"><span class = "S15">end</span></p><div class="outputParagraph"><div class="inlineElement embeddedOutputsTextElement" uid="B0293FFC" data-testid="output_30" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-181.818&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CAATPS	atp[c] + 2 ca2[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + 2 ca2[e] + h[e] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="E66476FE" data-testid="output_31" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp; 363.636&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAt7r	ca2[c] + 3 na1[e]&nbsp;&nbsp;-&gt; ca2[e] + 3 na1[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="835D4DE8" data-testid="output_32" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-454.545&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLUVESSEC	atp[c] + glu-L[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + glu-L[e] + h[c] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="CB5FAA67" data-testid="output_33" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-454.545&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLUt6	glu-L[e] + h[e] + k[c] + 3 na1[e]&nbsp;&nbsp;-&gt; glu-L[c] + h[c] + k[e] + 3 na1[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="F0DA8A40" data-testid="output_34" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-272.727&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HKt	atp[c] + h2o[c] + k[e]&nbsp;&nbsp;-&gt; adp[c] + h[e] + k[c] + pi[c]&nbsp;&nbsp;&nbsp;&nbsp; </div></div><div class="inlineElement embeddedOutputsTextElement" uid="2C0F9EBF" data-testid="output_35" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;-90.9091&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NaKt	atp[c] + h2o[c] + 2 k[e] + 3 na1[c]&nbsp;&nbsp;-&gt; adp[c] + h[c] + 2 k[c] + 3 na1[e] + pi[c] </div></div><div class="inlineElement embeddedOutputsTextElement" uid="ACF7549F" data-testid="output_36" data-width="1465" style="width: 1495px;"><div class="textElement">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATPMnew	atp[c] + h2o[c]&nbsp;&nbsp;-&gt; adp[c] + h[c] + pi[c]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div></div></div></div></div><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">When all reactions are reversible, in a genome-scale model, it should be anticipated to find a stoichiometrically balanced cycle of reactions that admit an arbitrary amount of isolated ATP hydrolysis. It is important nevertheless to realise that these cycles are latent in the network and could become active with inadvertent relaxation of model bounds.</span></p><h2 class = "S3"><span class = "S6">Acknowledgments</span></h2><h2 class = "S3"><span class = "S2">REFERENCES</span></h2><p class = "S4"><span class = "S6">(TBC)</span></p><p class = "S4"><span class = "S6"></span></p></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis
%% Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.
%% Reviewer:
%% INTRODUCTION
% We consider a biochemical network of  m  molecular species and  n  biochemical 
% reactions. The biochemical network is mathematically represented by a stoichiometric 
% matrix $S\in\mathcal{Z}^{m\times n}$. In standard notation, flux balance analysis 
% (FBA) is the linear optimisation problem
% 
% $$\begin{array}{ll}\min\limits _{v} & \rho(v)\equiv c^{T}v\\\text{s.t.} 
% & Sv=b,\\ & l\leq v\leq u,\end{array}$$
% 
% where $$c\in\Re^{n}$$ is a parameter vector that linearly combines one 
% or more reaction fluxes to form what is termed the objective function,  and 
% where a $$b_{i}<0$$, or  $$b_{i}>0$$, represents some fixed output, or input, 
% of the ith molecular species. A typical application of flux balance analysis 
% is to predict an optimal non-equilibrium steady-state flux vector that optimises 
% a linear objective function, such biomass production rate, subject to bounds 
% on certain reaction rates. 
% 
% In this tutorial, we demonstrate how to predict the minimal number of active 
% reactions that are still consistent with an optimal objective derived from the 
% result of a standard flux balance analysis problem. In each case, the corresponding 
% problem is a cardinality minimisation problem that we term _sparse flux balance 
% analysis_
% 
% $$\begin{array}{ll}\min\limits _{v} & \Vert v\Vert_{0}\\\text{s.t.} & Sv=b\\ 
% & l\leq v\leq u\\ & c^{T}v=\rho^{\star}\end{array}$$
% 
% where the last constraint is optional and represents the requirement to 
% satisfy an optimal objective value $\rho^{\star}$  derived from any solution 
% to a flux balance analysis (FBA) problem. This approach is used to check for 
% minimal sets of reactions that either should be active, or should not be active 
% in a flux balance model that is representative of a biochemical network.
% 
% In particular, we use sparse flux balance analysis test for a minimial 
% stoichiometrically balanced cycle involving ATP hydrolysis, which should never 
% appear in any flux balance analysis model where constraints arising from ATP 
% demands are being implemented, since a stoichiometrically balanced cycle involving 
% ATP hydrolysis might create artefactual energy metabolism predictions. In order 
% to mimic the requirement for energy, for maintenance of cellular integrity, 
% many flux balance models contain a cytoplasmic adenosine triphosphate (atp[c]) 
% hydrolysis reaction where the products are adenosine diphosphate (adp[c]) and 
% orthophosphate (pi[c]). In Recon 3D, the full corresponding reaction formula 
% is 
% 
%                                                             h2o[c] + atp[c] 
% -> h[c] + adp[c] + pi[c]  <#eq_ATPhydrolysis (1)> 
% 
% In a flux balance model, a maintenance requirement for synthesis of adenosine 
% triphosphate can be represented with a lower bound on reaction <#eq_ATPhydrolysis 
% (1)> or inclusion of reaction <#eq_ATPhydrolysis (1)> within a composite biomass 
% reaction, when cellular growth is being modelled [<#LyXCite-feist_biomass_2010 
% feist_biomass_2010>]. In order for either of these approaches to result in a 
% constraint on energy metabolism within the model, no stoichiometrically balanced 
% set of internal reactions that include reaction <#eq_ATPhydrolysis (1)> should 
% admit isolated hydrolysis of ATP, given the reaction bounds supplied with the 
% model. If such a set exists, sparse flux balance analysis can be used to find 
% one such minimal cardinality set. 
%% EQUIPMENT SETUP

global TUTORIAL_INIT_CB;
if ~isempty(TUTORIAL_INIT_CB) && TUTORIAL_INIT_CB==1
    initCobraToolbox
    changeCobraSolver('gurobi','all');
end
%% TIMING
% A minimal solution to sparse flux balance analysis problem can be obtained 
% in < 10 seconds. The time consuming part is comparing the predictions with the 
% biochemical literature to assess whether the predictions are consistent with 
% biochemical network funcion or not, as such, the process of refining a model 
% to increase its biochemical fidelity can take days or weeks.
%% PROCEDURE
%% Setting the numerical tolerance
% Implementation of sparse flux balance analysis with any numerical optimisation 
% solver, requires a tolerance to be set that distinguished between zero and non-zero 
% flux, based on the numerical tolerance of the currently installed optimisation 
% solver. Typically 1e-6 will suffice, except for multiscale models.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% Loading and examining the properties of Recon3.0model
% We are going to focus here on testing the biochemical fidelity of Recon3.0model, 
% so load it, unless it is already loaded into the workspace

clear %model
if ~exist('modelOrig','var')
    filename='Recon1.0';
    %filename='Recon2.0';
    %filename='Recon2.0model';
    %filename='Recon2.04model';
    %filename='HMR2.0'
    %filename='Recon2.2model';
    %filename='Recon3.0';
    %filename='Recon3.0model';
    directory='~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels';
    model = loadIdentifiedModel(filename,directory);
    model.csense(1:size(model.S,1),1)='E';
    modelOrig = model;
else
    model=modelOrig;
end
%% Testing for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% There are two options: A: sparse flux balance analysis using zero norm minimisation, 
% and B: one norm minimisation.
%% A: Sparse flux balance analysis test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% Detect the ATP maintenance reaction and if there is none already, add one.

atpMaintenanceBool=strcmp(model.rxns,'DM_atp_c_') | strcmp(model.rxns,'DM_atp(c)') | strcmp(model.rxns,'ATPM');
if ~any(atpMaintenanceBool)
    fprintf('Could not find ATP maintenance reaction, adding one.')
    if ~strcmp(filename,'HMR2.0')
        model = addReaction(model, 'ATPMnew', 'h2o[c] + atp[c] -> h[c] + adp[c] + pi[c]');
    else
        model = addReaction(model, 'ATPMnew', 'm02040c + m01371c -> m02039c + m01285c + m02751c');
    end
    atpMaintenanceBool=strcmp(model.rxns,'ATPMnew');
    fprintf('%s %s\n',model.rxns{atpMaintenanceBool},' is the ATP maintenance reaction')
else
    fprintf('%s %s\n',model.rxns{atpMaintenanceBool},' is the ATP maintenance reaction:')
end
%% 
% Display the size of the  model

[nMet,nRxn] = size(model.S);
fprintf('%6s\t%6s\n','#mets','#rxns'); fprintf('%6u\t%6u\t%s%s\n',nMet,nRxn,' totals in ', model.modelID)
%% 
% Display the constraints

minInf = -1000;
maxInf =  1000;
printConstraints(model, minInf, maxInf);
%% 
% Identify the exchange reactions(s) heuristically

if ~isfield(model,'SIntRxnBool')
    model = findSExRxnInd(model,size(model.S,1),1);
end
%% 
% Maximise the atp maintenance reaction

model.c(:)=0;
model.c(atpMaintenanceBool)=1;
osenseStr='max';
%% 
% Choose to minimize the zero norm of the optimal flux vector

minNorm='zero';
%% 
% Allow thermodynamically infeasible fluxes

allowLoops=1;
%% 
% Select the approximate step functions when minimising the zero norm of 
% the flux vector

% zeroNormApprox='cappedL1';% : Capped-L1 norm
% zeroNormApprox='exp';%Exponential function
% zeroNormApprox='log';%Logarithmic function
% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function
% zeroNormApprox='lp-';%L_p norm with p<0
% zeroNormApprox='lp+';%L_p norm with 0<p<1
zeroNormApprox='all';% test all approximations avialable and return the best one
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed

tic
sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
toc
%% 
% Check to see if there is a non-zero flux through the ATP maintenance reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpMaintenanceBool),' flux through the ATP maintenance reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=0.1;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end

%% ANTICIPATED RESULTS
% When all external reactions are blocked, i.e., when all external reaction 
% bounds are set to zero, then the only net flux admissible is within a stoichiometrically 
% balanced cycle, if and only if, the bounds on each reaction in the stoichiometrically 
% balanced cycle simultaneously admit net flux in one direction around the cycle. 
% Net flux around a stoichiometrically balanced cycle is thermodynamically infeasible 
% [<#LyXCite-fleming_variational_2012 fleming_variational_2012>], but steady state 
% mass balance constraints do not enforce thermodynamic constraints. In lieu of 
% such constraints, the bounds on reactions can be set based on the biochemical 
% literature to eliminate net flux around a stoichiometrically balanced cycle. 
% In Recon3.0, with all external reactions blocked (bounds are set to zero), maximising 
% reaction <#eq_ATPhydrolysis (1)> while minimising the cardinality of all internal 
% reactions, using sparse flux balance analysis was used to find one such minimal 
% cycle. The optimal solution involves reaction <#eq_ATPhydrolysis (1)> in a set 
% of nine stoichiometrically balanced reactions, with bounds that admit an arbitrary 
% amount of isolated ATP hydrolysis. Recon3.0model contains no set of reactions 
% that admit an arbitrary amount of isolated ATP hydrolysis.
%% TROUBLESHOOTING
% By further constraining the bounds to convert one reversible reaction in each 
% such stoichiometrically balanced cycle to an irreversible reaction, isolated 
% ATP hydrolysis can be eliminated, e.g., though there are important exceptions, 
% a reactions hydrolyses ATP does not generally operate in a reverse direction 
% at biochemically realistic metabolite concentrations. 
%% B: One norm minimisation test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% Run flux balance analysis on the same model and minimise the sum total of 
% all reaction rates (minimium one norm)

minMorm='one';
oneNormFBASolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Display the one norm flux balance analysis solution, but only the non-zero 
% fluxes, above a specified cutoff.

for n=1:nRxn
    if abs(oneNormFBASolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',oneNormFBASolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% Depending on the model, minimising the one norm may give as good an approximation 
% of a minimal stoichiometrically balanced cycle as minimising the zero norm, 
% but experience suggests this is less likely for large cycles or large models.
%% Testing for production of ATP with all external reactions blocked and all internal reactions reversible
% There are two options: A: sparse flux balance analysis using zero norm minimisation, 
% and B: one norm minimisation.
%% A: Sparse flux balance analysis test for production of ATP with all external reactions blocked and all internal reactions reversible
% Fully open all internal reactions

model.lb(model.SIntRxnBool)=-1000;
model.ub(model.SIntRxnBool)=1000;

%% 
% Run sparse flux balance analysis on the model with all exchanges closed 
% and all internal reactions reversible

sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP maintenance reaction

fprintf('%g%s\n',sparseFBAsolutionUnBounded.v(atpMaintenanceBool),' flux through the ATP maintenance reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=0.1;
for n=1:nRxn
    if abs(sparseFBAsolutionUnBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all reactions are reversible, in a genome-scale model, it should be anticipated 
% to find a stoichiometrically balanced cycle of reactions that admit an arbitrary 
% amount of isolated ATP hydrolysis. It is important nevertheless to realise that 
% these cycles are latent in the network and could become active with inadvertent 
% relaxation of model bounds.
%% B: One norm minimisation test for production of ATP with all external reactions blocked and all internal reactions reversible
% Run flux balance analysis on the samemodel and minimise the sum total of all 
% reaction rates (minimium one norm)

minMorm='one';
oneNormFBASolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Display the one norm flux balance analysis solution, but only the non-zero 
% fluxes, above a specified cutoff.

for n=1:nRxn
    if abs(oneNormFBASolutionUnBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',oneNormFBASolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all reactions are reversible, in a genome-scale model, it should be anticipated 
% to find a stoichiometrically balanced cycle of reactions that admit an arbitrary 
% amount of isolated ATP hydrolysis. It is important nevertheless to realise that 
% these cycles are latent in the network and could become active with inadvertent 
% relaxation of model bounds.
%% _Acknowledgments_
%% REFERENCES
% _(TBC)_
% 
% __
##### SOURCE END #####
--></body></html>