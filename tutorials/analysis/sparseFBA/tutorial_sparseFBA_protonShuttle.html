<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Proton shuttle testing with sparse flux balance analysis</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234001159668px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999977111816px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { text-align: center; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S7 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S8 { line-height: 15.5926675796509px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S11 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S13 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S14 { line-height: 15.5926685333252px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S15 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S16 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S17 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S18 { text-decoration: underline; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Proton shuttle testing with sparse flux balance analysis</span></h1><h2 class = "S3"><span class = "S2">Author: Ronan Fleming, Ines Thiele, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">Reviewer:</span></h2><h2 class = "S3"><span class = "S2">INTRODUCTION</span></h2><p class = "S4"><span class = "S2">We consider a biochemical network of </span><span class = "S2"> </span><span class = "S2">m</span><span class = "S2"> </span><span class = "S2"> molecular species and </span><span class = "S2"> </span><span class = "S2">n</span><span class = "S2"> </span><span class = "S2"> biochemical reactions. The biochemical network is mathematically represented by a stoichiometric matrix </span><span style="vertical-align:-3"><img src="data:image/png;base64,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" width="66" height="27" /></span><span class = "S2">. In standard notation, flux balance analysis (FBA) is the linear optimisation problem</span></p><p class = "S5"><span style="vertical-align:-30"><img src="data:image/png;base64,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" width="104.5" height="66.5" /></span></p><p class = "S4"><span class = "S2">where </span><span style="vertical-align:-3"><img src="data:image/png;base64,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" width="48.5" height="21" /></span><span class = "S2"> is a parameter vector that linearly combines one or more reaction fluxes to form what is termed the objective function,  and where a </span><span style="vertical-align:-5"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAhCAYAAACYyvasAAAE40lEQVRoQ+2Zaaj1UxTGf6+hDFGGRJQx81TIWGSICMmYIcIH8yyKMiXzPH1AKLNChpAhQzIms6L4QGQoMqTM/Wrt2u+2z//89zn3vjqvs7/cc+7dw1rPXvtZz1p3DtMxMgJzRl45XcgUvDGCoAW8xYFfxjhrvlvaBd42wDrAKsABwGrA+sAH8xkKawE7hH+/Ae8BzwDfDvOzC7wjgO2BA2OTTwO8X4dtOiF/Xwy4FtBPx5nAcsAp8f0Q4M4uX4Y924WBN4ENgeuAE4G/JwScLjMXAB4E9gQMiq2Ar2OBn1+Oz3vHvOpew8BbNTZ3cedGEwbofsB9YfOWwKuF/ScBVwHfABsDX9X8GwbePsADsXD1DMgJw2ouc018rwPrAh8HFf1eOLQG8En87jzg3FbwBPZ64JiOQyYRxPxZngpcWXHCZ/0IsFsEjNH3UzmvK/LyG7okCLUPWD6JKwCj9rU+C+bxHBPDRXGmoLwz4HyTyfEdT7tTJG8AvBuLdwGeAtaM7Gt6V/PdG2k9nb9IAGaCuRswY/01S+BsGhf6JHBLzzO070Vgs5jvTxNibagy7oo/HAvc2BJ5RwE3ZaS56wAj89DPn7q35rOfybEUoB3nhy5z7+OAG3oeojx5I/jOJV3g5XzfBJ4gPBSp3IQhwV4G+CRfAnYGbs8MzpPJQqGXzFAzJWsk98OA0ysg7Q481hO8/GWYSRX9g8RwDt6jwF7An/k5gzhv2agkFI0OyXIL4MNs8cXAGT3Cv6df/5pmlOwY/CR4+XgOuBx4HmgR7SV4awPfDzAwB096OqikoEHgbRuGpX0tXzQ4HwrMhzPw3gaWBFYGlgGeHTHyLAPlypo8OAe4J5MRrRczKnhNkZdnJHnrhAoQVhtXh/V+vibzxGRxcCN4Jig5dusCETnqwriMn1vRKuaX4K0HfNcj8qrVVS3y5CyfQ3KiJo5dJxdadcgdhr9Z9YcwZA/A22oZPouyltwEeKtlkyFzZz1h2EX5LIwQcaOuHHZbEv+ZQGwgLA98Hvzojfq5ZchvTxcL5NqzI3m17lc720u/DTg0o5tBUiWpDafWaKuq80ouKzfP5YgbJ6GphHg8srFg/tGCXMxdAlBTmozkvnzcH5LkFaAsp1qOOjrTbF1SRfljdeUFVoOh9myTsrbbYITZ48pHXt6otyRxx6UhJQaVPC0OOncj4MjQcfnaFI3SRrVgH3JQ3uwYVDnZTbKzIrgGhAE1l0zxjBK8nBNqIChhLLmMCjffKaRCvq7rNlsBdP7SgByqo0k6pX2MxguA9xs2zvn6i2i3lXIlB7j6ZGvg5SVZqdyVIXZYBeeJEMwp+5kwPgI0xhD/scGZvlMXjLPlosRZrh0l0vOuSa1CSRo28XmVgsrI2xfwNh15SFtH2v8y4vy9JJ5vqPqXiG+Np7YS8OUs1rUrxOUplU6LRkTfS0jzNs/6eCcDd8RLPDyqKVWEfg9MVCV4ft8/hGhpjKDajVAMlyORqyFuj+yFedSyXxQwIkfVf0bgzcB2hUMKdJuhnS9oUIWhQUaPxhlhCsmk4Urg8k7FWSFojdAkd1oj4r+YL5fK22Zx/ez1X8JhneS+jiSOMBP6X7fUyuq7fiLnzRR4RuqKwXOj6Lv/NXgT6fy4Rs9U5I1rx0Sun4I3xrVNwZuCNwYCYyz9B2A5DzEckrF1AAAAAElFTkSuQmCC" width="39.5" height="16.5" /></span><span class = "S2">, or  </span><span style="vertical-align:-5"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAhCAYAAACYyvasAAAE60lEQVRoQ+2ZacitUxiGr2PIQflj6IgyZnbyg4xFJCLzPOWEH+YxQ1GGkinz9AOhzDJEkkKGyJxZKH6QuciQMnfVs2qd1Xrf/b773Wif9vrz7e/ba3ruda/7udfzzWHWxkZgztgjZwOZgTeABH3AWxb4ZcBai9zQNvC2AdYHVgcOBNYENgLeW8RQWBfYIeL7DXgHeBL4dlScbeAdCWwPHByTfBLg/Tpq0in5fhngGsA4bWcBKwGnxu+HAXe0xTLq2i4JvAbMB64FTgL+nhJw2ra5GPAgsAcgKbYCvo4Bfn4hPu8T/apzjQJvjZjcwa0TTRmg+wP3xp63BF4q9n8ycCXwDbAJ8GUtvlHg7QvcHwPXyoCcMqwW2q6J7xVgA+CjkKLfi4DWBj6Ov50PnNcXPIG9Dji2ZZFpBDG/lqcBV1SC8Fo/AuwahJF9P5X92piXn9AlIahdwPJKXA7I2pe7DPiP+5gYLoo1BeWthvVNJie0XO1Wk7wx8HYM3hl4Algnsq/pXc93T6T1tP7cAMwEcxdgxvqrIzh7AkcDXpNXgT86juvTzf09B2wWg/xpQqw1Xcad8cVxwA19mGcgN2aiuQtwc2WVnPr5VffUvPZdWy7iXhFF+9EufqvrAoD2xINR72xt4OV63ws8QXgoUrkJQ4G9DDDA54GdgNuyTefJZInwS2aoPrZmW+CZChBapFviFvSZr4ZpfjPMpJr+JjOcg+ch7gX8mU/apHkrxEtC02iTCVsA72eDLwbO7HCCPYjBUsDWwbrdioEGe3zIxPd9Js36luCtBzTNlYOnPB1SSlATeCULfL48XWxYg/lwBt6bwHLAasDywFM9mVfioceU6R5S2UxgtwIf9gRxXPB6MS/PSOrWiRUgfG1cFZv389VZICaLQweCl6ZbGtgOOCN+5ni9EVaqa1YvwdsQ+K7hAHLmVV9XNeapWWqP18dWM8eOUwt9dXidpL9Z9YcYs3uIfU9ijOxusO8WvZq8Wm2yfz1hWEX5NFYWcVlXNqstSf9MIBYQ5gGfhT4apJ8n1VYGtDI6/aTDae6DwjJ1WctD97ofnslNk1VJbsOuNdmq+rxSy8rJczvixMloamUei2wsmEN9mjdg0/B+KdgEkGyXca7XN3kck3m2NqtyfUiCybJKhtq1Tc7aaoMMs8aVt/x5cwFwbnx5KXB6BFV78nRhhn1WBPYGnLtkmfbIoF4foKd5saPp5WQ1ycqK4HpAEmohm+JGS/ByTahpiRZGcbYw6uQ7Atb38nFtp9kGoI/xc7Irlfp68loifedXXU+gpV+u159Hua1kbw5w9crWwMufZHoqTzk1bYgVVsF5PGzEz/GlCeMDwM1I8R/HCFIflRcfH4hi5YsTkIByO3nVpIzTvsnDJj2vSlDJvP2A+2KlnNJqj/UvGeffZUg+4YIQYl8CRwGrAl/0eNe6ZAJPm6TVmWTCqZ3l5lkd7xTg9riJR8RrSl017sZ9lOD5+wHA3ZXVBNVqhGa4bElcpbg1smfHKNnr5xYHEpvHIG/vITLwpop/NKtbDG29QU0vDIOQPQYkwzSSycOVO8wrFWcDFwZDk93pHdH/MMDEpG5bFDXOTv8lHFVJ7hpH0gjF3f+6pVJW1/FT2W9S4MnUVULnhvq7qQFyUuBNTcCT3OgMvAFozsCbgTcAgQFDZ8wbAN4/7QsVMUcxx3oAAAAASUVORK5CYII=" width="39.5" height="16.5" /></span><span class = "S2">, represents some fixed output, or input, of the ith molecular species. A typical application of flux balance analysis is to predict an optimal non-equilibrium steady-state flux vector that optimises a linear objective function, such biomass production rate, subject to bounds on certain reaction rates. </span></p><p class = "S4"><span class = "S2">In this tutorial, we demonstrate how to predict the minimal number of active reactions that are still consistent with an optimal objective derived from the result of a standard flux balance analysis problem. In each case, the corresponding problem is a cardinality minimisation problem that we term </span><span class = "S6">sparse flux balance analysis</span></p><p class = "S5"><span style="vertical-align:-40"><img src="data:image/png;base64,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" width="93" height="85.5" /></span></p><p class = "S4"><span class = "S2">where the last constraint is optional and represents the requirement to satisfy an optimal objective value </span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAqCAYAAADWFImvAAACdUlEQVRYR+3XS+hNURTH8c8/BiLERCIDAyGiZMJAMfKISAaSx4SBEaWkPJKJMpY8BxgZSMJEEpl4JAaeRWEgA4SJt1btW7vjnnuce+//+g/+e3IfZ9/1+7bWb629b58BsvoGCIdBkGIlBjMymJGq7hz0yP/wSGR9GS62Kk8vSjMWdzAV38tg+hNkCSZiAvZgOz7jGW70sjTjcQFzM9GT2IZPvQQJrTF4n0RftCpPf5Ym9BfhKDan1yjX02Y+6W+QcfiAbxiJoenzXyztggzBsBTtK35UTc6q53VBpmETdhQCn8AhPKkS7LR9h2M3duId1uE15uBMFnwWHrYD8y8ZGYWrqQ2vYA2+ZGJrcTZ9vomF7ZSqCiSen8KGlImYjmG+fAXofUxOX07B87pZqQJZjMspaLTgsSYCYdqYlI3BFa93uwkSrXYd89Nono43TQTyffG46yBRhsdJOE7OlfhZkpF7CNA4S8LAXS3NxuSP0N6KwyXpzj0SGWsA1apOmUdyk1alex5uJdXw0Bb8rkVB6R+sYie0qvte7EvCcbZcqwsR+8syMrMwmMpARuB2KkfcM2a0uvy0AiwDiTEed4fGWtDsMoPVOJc2zcaDdrJRlpGiP2LfJawodE2cO4+S8HqcbheiDKToj0b8XTiCX1iajfVVON8JRBlI7o/9KfVx5WuM8IZmdMgBvOoUogwk98fy7G/AJES24u7xFh+7AdCIUTRr7o+YknGsv+ymYFmsIkjuj47asS58EST3x8F0Eaobs639RZAyf7QVvM6PcpB4H20Y8yJWdElP/FHsmgCJwTQ6Da7jiBt6T1bVDa0nEGVzpGfiudAfK8txKxFkkHwAAAAASUVORK5CYII=" width="17" height="21" /></span><span class = "S2"> </span><span class = "S2"> </span><span class = "S2">derived from any solution to a flux balance analysis (FBA) problem. This approach is used to check for minimal sets of reactions that either should be active, or should not be active in a flux balance model that is representative of a biochemical network.</span></p><p class = "S4"><span class = "S2">In particular, this tutoriall illustrates the use of sparse flux balance analysis to compute the minimal set of reactions that must be active to produce ATP</span></p><h2 class = "S3"><span class = "S2">TIMING</span></h2><p class = "S4"><span class = "S2">A minimal solution to sparse flux balance analysis problem can be obtained in &lt; 10 seconds. The time consuming part is comparing the predictions with the biochemical literature to assess whether the predictions are consistent with biochemical network funcion or not, as such, the process of refining a model to increase its biochemical fidelity can take days or weeks.</span></p><h2 class = "S3"><span class = "S2">PROCEDURE</span></h2><h2 class = "S3"><span class = "S2">Loading and examining the properties of Recon3.0model</span></h2><p class = "S4"><span class = "S2">We are going to focus here on testing the biochemical fidelity of Recon3.0model, so load it, unless it is already loaded into the workspace</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">clear </span><span class = "S10">%model</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">if </span><span class = "S9">~exist(</span><span class = "S12">'modelOrig'</span><span class = "S9">,</span><span class = "S12">'var'</span><span class = "S13">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='Recon1.0';</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='Recon2.0';</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='Recon2.0model';</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='Recon2.04model';</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='HMR2.0'</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='Recon2.2model';</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S10">%filename='Recon3.0';</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    filename=</span><span class = "S12">'Recon3.0model'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    directory=</span><span class = "S12">'~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">    model = loadIdentifiedModel(filename,directory);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    model.csense(1:size(model.S,1),1)=</span><span class = "S12">'E'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">    modelOrig = model;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">    model=modelOrig;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">Setting the numerical tolerance</span></h2><p class = "S4"><span class = "S2">Implementation of sparse flux balance analysis with any numerical optimisation solver, requires a tolerance to be set that distinguished between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver. Typically 1e-6 will suffice, except for multiscale models.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">feasTol = getCobraSolverParams(</span><span class = "S12">'LP'</span><span class = "S9">, </span><span class = "S12">'feasTol'</span><span class = "S13">);</span></p></div></div><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed</span></h2><p class = "S4"><span class = "S2">Detect the ATP synthase reaction and if there is none already, add one.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">atpsynthaseBool=strcmp(model.rxns,</span><span class = "S12">'ATPS4mi'</span><span class = "S9">) | strcmp(model.rxns,</span><span class = "S12">'ATPS4m'</span><span class = "S9">);</span><span class = "S10">% | strcmp(model.rxns,'ATPM');</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">if </span><span class = "S13">~any(atpsynthaseBool)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    fprintf(</span><span class = "S12">'Could not find ATP synthase reaction, adding one.'</span><span class = "S13">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S9">~strcmp(filename,</span><span class = "S12">'HMR2.0'</span><span class = "S13">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        </span><span class = "S10">%model = addReaction(model, 'ATPMnew', 'h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]');</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        model = addReaction(model, </span><span class = "S12">'ATPS4m'</span><span class = "S9">, </span><span class = "S12">'4.0 h[c] + adp[m] + pi[m] -&gt; h2o[m] + 3.0 h[m] + atp[m]'</span><span class = "S13">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        </span><span class = "S10">%model = addReaction(model, 'ATPMnew', 'm02040c + m01371c -&gt; m02039c + m01285c + m02751c');</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        model = addReaction(model, </span><span class = "S12">'ATPS4m'</span><span class = "S9">, </span><span class = "S12">'4.0 m02039c + m01285m + m02751m -&gt; m02040m + 3.0 m02039m + m01371m'</span><span class = "S13">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    atpsynthaseBool=strcmp(model.rxns,</span><span class = "S12">'ATPS4m'</span><span class = "S13">);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    fprintf(</span><span class = "S12">'%s %s\n'</span><span class = "S9">,model.rxns{atpsynthaseBool},</span><span class = "S12">' is the ATP synthase reaction'</span><span class = "S13">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">else</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    fprintf(</span><span class = "S12">'%s %s\n'</span><span class = "S9">,model.rxns{atpsynthaseBool},</span><span class = "S12">' is the ATP synthase reaction'</span><span class = "S13">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><p class = "S15"><span class = "S2">Display the size of the  model</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">[nMet,nRxn] = size(model.S);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%6s\t%6s\n'</span><span class = "S9">,</span><span class = "S12">'#mets'</span><span class = "S9">,</span><span class = "S12">'#rxns'</span><span class = "S9">); fprintf(</span><span class = "S12">'%6u\t%6u\t%s%s\n'</span><span class = "S9">,nMet,nRxn,</span><span class = "S12">' totals in '</span><span class = "S13">, model.modelID)</span></p></div></div><p class = "S15"><span class = "S2">Display the constraints</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">minInf = -1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">maxInf =  1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">printConstraints(model, minInf, maxInf);</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><p class = "S4"><span class = "S2">Identify the exchange reactions(s) heuristically</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">if </span><span class = "S9">~isfield(model,</span><span class = "S12">'SIntRxnBool'</span><span class = "S13">)</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">    model = findSExRxnInd(model,size(model.S,1),1);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><p class = "S15"><span class = "S2">Maximise the atp synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.c(:)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.c(atpsynthaseBool)=1;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">osenseStr=</span><span class = "S12">'max'</span><span class = "S13">;</span></p></div></div><p class = "S15"><span class = "S2">Choose to minimize the zero norm of the optimal flux vector</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">minNorm=</span><span class = "S12">'zero'</span><span class = "S13">;</span></p></div></div><p class = "S15"><span class = "S2">Allow thermodynamically infeasible fluxes</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">allowLoops=1;</span></p></div></div><p class = "S15"><span class = "S2">Select the approximate step functions when minimising the zero norm of the flux vector</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S10">% zeroNormApprox='cappedL1';% : Capped-L1 norm</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S10">% zeroNormApprox='exp';%Exponential function</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S10">% zeroNormApprox='log';%Logarithmic function</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S10">% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S10">% zeroNormApprox='lp-';%L_p norm with p&lt;0</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S10">% zeroNormApprox='lp+';%L_p norm with 0&lt;p&lt;1</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">zeroNormApprox=</span><span class = "S12">'all'</span><span class = "S9">;</span><span class = "S10">% test all approximations avialable and return the best one</span></p></div></div><p class = "S15"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">In a model for flux balance analysis, there should be zero flux through the ATP synthase reaction if all external reaction bounds are zero.</span></p><h2 class = "S3"><span class = "S2">TROUBLESHOOTING</span></h2><p class = "S4"><span class = "S2">If there is non-zero flux through the ATP synthase reaction, with all external reaction bounds zero, then the bounds on one of the reactions in each of the minimal sets needs to be set to eliminate flux in one direction. Each of the minimal sets corresponds to net flux around a stoichiometrically balanced cycle, which is thermodynamically infeasible [</span><a href = 'https://localhost:61416/toolbox/matlab/codetools/liveeditor/index.html?id=612890842&file=%2FUsers%2Flaurent.heirendt%2FDropbox%2FUNI.LU%2Fgit%2Fhub%2Fcobratoolbox%2Ftutorials%2Fanalysis%2FsparseFBA%2Ftutorial_sparseFBA_protonShuttle.mlx&showLineNumbers=true&clipboardtempdirpath=/private/var/folders/j8/mc1y8q4s1y3_v2glx3wbhgm052jh7s/T/ConnectorClipboard5204724717005515585&snc=10437C#LyXCite-fleming_variational_2012'><span class = "S18">fleming_variational_2012</span></a><span class = "S2">]. Steady-state mass balance constraints do not enforce thermodynamic constraints. In lieu of such constraints, the bounds on reactions can be set based on the biochemical literature to eliminate net flux around a stoichiometrically balanced cycle. In a model, with all external reactions blocked (bounds are set to zero), maximising the ATP synthase reaction while minimising the cardinality of all internal reactions, using sparse flux balance analysis can be used to find any such cycle of minimal cardinality (minimal number of active reactions). By further constraining the bounds to convert one reversible reaction in each such cycle to an irreversible reaction, thermodynamically infeasible flux around cycles, such as those involving the ATP synthase reaction, can be eliminated. The following sections of this tutorial illustrate how to test different parts of the model for thermodynamically infeasible flux through the ATP synthase reaction.</span></p><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed and all internal reactions reversible</span></h2><p class = "S4"><span class = "S2">Fully open all internal reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(model.SIntRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(model.SIntRxnBool)=1000;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed and all internal reactions reversible</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionUnBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionUnBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">ANTICIPATED RESULTS</span></h2><p class = "S4"><span class = "S2">In a model for flux balance analysis, there might be non-zero flux through the ATP synthase reaction if all external reaction bounds are zero and all internal reactions reversible. This indicates the imporance of appropriately constrained internal reaction bounds.</span></p><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed and all transport reactions reversible</span></h2><p class = "S4"><span class = "S2">Identify all of the transport reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">allTransportRxnBool=transportReactionBool(model);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%u%s\n'</span><span class = "S9">,nnz(allTransportRxnBool),</span><span class = "S12">' transport reactions in total.'</span><span class = "S13">);</span></p></div></div><p class = "S15"><span class = "S2">Revert to original Recon3.0model reaction bounds</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb=modelOrig.lb;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub=modelOrig.ub;</span></p></div></div><p class = "S15"><span class = "S2">Open all transport reactions (which might include an external reaction, e.g., a  biomass reaction)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(allTransportRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(allTransportRxnBool)=1000;</span></p></div></div><p class = "S15"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed and all mitochondrial transport reactions reversible</span></h2><p class = "S4"><span class = "S2">Identify all of the transport reactions involving the cytoplasm and mitochondrial matrix</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">originCompartment=</span><span class = "S12">'c'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">destinationCompartment=</span><span class = "S12">'m'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">unidirectionalBool=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cmTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%u%s\n'</span><span class = "S9">,nnz(cmTransportRxnBool),</span><span class = "S12">' transport reactions involving the cytoplasm and mitochondrial matrix.'</span><span class = "S13">);</span></p></div></div><p class = "S15"><span class = "S2">Revert to original Recon3.0model reaction bounds</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb=modelOrig.lb;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub=modelOrig.ub;</span></p></div></div><p class = "S15"><span class = "S2">Open all transport reactions (which might include an external reaction, e.g., a  biomass reaction)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(cmTransportRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(cmTransportRxnBool)=1000;</span></p></div></div><p class = "S15"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed and all plasma membrane transport reactions reversible</span></h2><p class = "S4"><span class = "S2">Identify all of the transport reactions across the plasma membrane</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">originCompartment=</span><span class = "S12">'e'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">destinationCompartment=</span><span class = "S12">'c'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">unidirectionalBool=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">ecTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%u%s\n'</span><span class = "S9">,nnz(ecTransportRxnBool),</span><span class = "S12">' transport reactions across the plasma membrane.'</span><span class = "S13">);</span></p></div></div><p class = "S15"><span class = "S2">Revert to original Recon3.0model reaction bounds</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb=modelOrig.lb;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub=modelOrig.ub;</span></p></div></div><p class = "S15"><span class = "S2">Open all transport reactions (which might include an external reaction, e.g., a  biomass reaction)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(ecTransportRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(ecTransportRxnBool)=1000;</span></p></div></div><p class = "S15"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed and peroxisomal transport reactions reversible</span></h2><p class = "S4"><span class = "S2">Identify all of the transport reactions across the plasma membrane</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">originCompartment=</span><span class = "S12">'c'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">destinationCompartment=</span><span class = "S12">'x'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">unidirectionalBool=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cxTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%u%s\n'</span><span class = "S9">,nnz(cxTransportRxnBool),</span><span class = "S12">' transport reactions across the peroxisome membrane.'</span><span class = "S13">);</span></p></div></div><p class = "S15"><span class = "S2">Revert to original Recon3.0model reaction bounds</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb=modelOrig.lb;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub=modelOrig.ub;</span></p></div></div><p class = "S15"><span class = "S2">Open all transport reactions (which might include an external reaction, e.g., a  biomass reaction)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(cxTransportRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(cxTransportRxnBool)=1000;</span></p></div></div><p class = "S15"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">Testing for activity of ATP synthase with all exchanges closed and lysosomal transport reactions reversible</span></h2><p class = "S4"><span class = "S2">Identify all of the transport reactions across the plasma membrane</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">originCompartment=</span><span class = "S12">'c'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">destinationCompartment=</span><span class = "S12">'l'</span><span class = "S13">;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">unidirectionalBool=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">clTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%u%s\n'</span><span class = "S9">,nnz(clTransportRxnBool),</span><span class = "S12">' transport reactions across the lysosomal membrane.'</span><span class = "S13">);</span></p></div></div><p class = "S15"><span class = "S2">Revert to original Recon3.0model reaction bounds</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb=modelOrig.lb;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub=modelOrig.ub;</span></p></div></div><p class = "S15"><span class = "S2">Open all transport reactions (which might include an external reaction, e.g., a  biomass reaction)</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(clTransportRxnBool)=-1000;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(clTransportRxnBool)=1000;</span></p></div></div><p class = "S15"><span class = "S2">Close all external reactions</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.lb(~model.SIntRxnBool)=0;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">model.ub(~model.SIntRxnBool)=0;</span></p></div></div><p class = "S15"><span class = "S2">Run sparse flux balance analysis on the model </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></p></div></div><p class = "S15"><span class = "S2">Check to see if there is a non-zero flux through the ATP synthase reaction</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">fprintf(</span><span class = "S12">'%g%s\n'</span><span class = "S9">,sparseFBAsolutionBounded.v(atpsynthaseBool),</span><span class = "S12">' flux through the ATP synthase reaction'</span><span class = "S13">)</span></p></div></div><p class = "S15"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">cutoff=feasTol;</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S11">for </span><span class = "S13">n=1:nRxn</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S11">if </span><span class = "S13">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S13">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">        fprintf(</span><span class = "S12">'%10g%15s\t%-60s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S9">    </span><span class = "S14">end</span></p></div><div class = 'inlineWrapper'><p class = "S8 lineNode"><span class = "S14">end</span></p></div></div><h2 class = "S3"><span class = "S2">REFERENCES</span></h2><p class = "S4"><span class = "S2">[fleming_cardinality_nodate] Fleming, R.M.T., et al., Cardinality optimisation in constraint-based modelling: illustration with Recon 3D (submitted), 2017.</span></p><p class = "S4"><span class = "S2">[</span><a href = 'https://localhost:61416/toolbox/matlab/codetools/liveeditor/index.html?id=612890842&file=%2FUsers%2Flaurent.heirendt%2FDropbox%2FUNI.LU%2Fgit%2Fhub%2Fcobratoolbox%2Ftutorials%2Fanalysis%2FsparseFBA%2Ftutorial_sparseFBA_protonShuttle.mlx&showLineNumbers=true&clipboardtempdirpath=/private/var/folders/j8/mc1y8q4s1y3_v2glx3wbhgm052jh7s/T/ConnectorClipboard5204724717005515585&snc=10437C#LyXCite-sparsePaper'><span class = "S18">sparsePaper</span></a><span class = "S2">] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span class = "S2"> </span><span class = "S2">optimization</span><span class = "S2">. European Journal of Operational Research 244, 2646.</span></p><p class = "S4"><span class = "S6"></span></p><p class = "S4"><span class = "S6"></span></p></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Proton shuttle testing with sparse flux balance analysis
%% Author: Ronan Fleming, Ines Thiele, University of Luxembourg.
%% Reviewer:
%% INTRODUCTION
% We consider a biochemical network of  m  molecular species and  n  biochemical 
% reactions. The biochemical network is mathematically represented by a stoichiometric 
% matrix $S\in\mathcal{Z}^{m\times n}$. In standard notation, flux balance analysis 
% (FBA) is the linear optimisation problem
% 
% $$\begin{array}{ll}\min\limits _{v} & \rho(v)\equiv c^{T}v\\\text{s.t.} 
% & Sv=b,\\ & l\leq v\leq u,\end{array}$$
% 
% where $$c\in\Re^{n}$$ is a parameter vector that linearly combines one 
% or more reaction fluxes to form what is termed the objective function,  and 
% where a $$b_{i}<0$$, or  $$b_{i}>0$$, represents some fixed output, or input, 
% of the ith molecular species. A typical application of flux balance analysis 
% is to predict an optimal non-equilibrium steady-state flux vector that optimises 
% a linear objective function, such biomass production rate, subject to bounds 
% on certain reaction rates. 
% 
% In this tutorial, we demonstrate how to predict the minimal number of active 
% reactions that are still consistent with an optimal objective derived from the 
% result of a standard flux balance analysis problem. In each case, the corresponding 
% problem is a cardinality minimisation problem that we term _sparse flux balance 
% analysis_
% 
% $$\begin{array}{ll}\min\limits _{v} & \Vert v\Vert_{0}\\\text{s.t.} & Sv=b\\ 
% & l\leq v\leq u\\ & c^{T}v=\rho^{\star}\end{array}$$
% 
% where the last constraint is optional and represents the requirement to 
% satisfy an optimal objective value $\rho^{\star}$  derived from any solution 
% to a flux balance analysis (FBA) problem. This approach is used to check for 
% minimal sets of reactions that either should be active, or should not be active 
% in a flux balance model that is representative of a biochemical network.
% 
% In particular, this tutoriall illustrates the use of sparse flux balance 
% analysis to compute the minimal set of reactions that must be active to produce 
% ATP
%% TIMING
% A minimal solution to sparse flux balance analysis problem can be obtained 
% in < 10 seconds. The time consuming part is comparing the predictions with the 
% biochemical literature to assess whether the predictions are consistent with 
% biochemical network funcion or not, as such, the process of refining a model 
% to increase its biochemical fidelity can take days or weeks.
%% PROCEDURE
%% Loading and examining the properties of Recon3.0model
% We are going to focus here on testing the biochemical fidelity of Recon3.0model, 
% so load it, unless it is already loaded into the workspace

clear %model
if ~exist('modelOrig','var')
    %filename='Recon1.0';
    %filename='Recon2.0';
    %filename='Recon2.0model';
    %filename='Recon2.04model';
    %filename='HMR2.0'
    %filename='Recon2.2model';
    %filename='Recon3.0';
    filename='Recon3.0model';
    directory='~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels';
    model = loadIdentifiedModel(filename,directory);
    model.csense(1:size(model.S,1),1)='E';
    modelOrig = model;
else
    model=modelOrig;
end
%% Setting the numerical tolerance
% Implementation of sparse flux balance analysis with any numerical optimisation 
% solver, requires a tolerance to be set that distinguished between zero and non-zero 
% flux, based on the numerical tolerance of the currently installed optimisation 
% solver. Typically 1e-6 will suffice, except for multiscale models.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% Testing for activity of ATP synthase with all exchanges closed
% Detect the ATP synthase reaction and if there is none already, add one.

atpsynthaseBool=strcmp(model.rxns,'ATPS4mi') | strcmp(model.rxns,'ATPS4m');% | strcmp(model.rxns,'ATPM');
if ~any(atpsynthaseBool)
    fprintf('Could not find ATP synthase reaction, adding one.')
    if ~strcmp(filename,'HMR2.0')
        %model = addReaction(model, 'ATPMnew', 'h2o[c] + atp[c] -> h[c] + adp[c] + pi[c]');
        model = addReaction(model, 'ATPS4m', '4.0 h[c] + adp[m] + pi[m] -> h2o[m] + 3.0 h[m] + atp[m]');
    else
        %model = addReaction(model, 'ATPMnew', 'm02040c + m01371c -> m02039c + m01285c + m02751c');
        model = addReaction(model, 'ATPS4m', '4.0 m02039c + m01285m + m02751m -> m02040m + 3.0 m02039m + m01371m');
    end
    atpsynthaseBool=strcmp(model.rxns,'ATPS4m');
    fprintf('%s %s\n',model.rxns{atpsynthaseBool},' is the ATP synthase reaction')
else
    fprintf('%s %s\n',model.rxns{atpsynthaseBool},' is the ATP synthase reaction')
end
%% 
% Display the size of the  model

[nMet,nRxn] = size(model.S);
fprintf('%6s\t%6s\n','#mets','#rxns'); fprintf('%6u\t%6u\t%s%s\n',nMet,nRxn,' totals in ', model.modelID)
%% 
% Display the constraints

minInf = -1000;
maxInf =  1000;
printConstraints(model, minInf, maxInf);
%% 
% Identify the exchange reactions(s) heuristically

if ~isfield(model,'SIntRxnBool')
    model = findSExRxnInd(model,size(model.S,1),1);
end
%% 
% Maximise the atp synthase reaction

model.c(:)=0;
model.c(atpsynthaseBool)=1;
osenseStr='max';
%% 
% Choose to minimize the zero norm of the optimal flux vector

minNorm='zero';
%% 
% Allow thermodynamically infeasible fluxes

allowLoops=1;
%% 
% Select the approximate step functions when minimising the zero norm of 
% the flux vector

% zeroNormApprox='cappedL1';% : Capped-L1 norm
% zeroNormApprox='exp';%Exponential function
% zeroNormApprox='log';%Logarithmic function
% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function
% zeroNormApprox='lp-';%L_p norm with p<0
% zeroNormApprox='lp+';%L_p norm with 0<p<1
zeroNormApprox='all';% test all approximations avialable and return the best one
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed

sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% In a model for flux balance analysis, there should be zero flux through the 
% ATP synthase reaction if all external reaction bounds are zero.
%% TROUBLESHOOTING
% If there is non-zero flux through the ATP synthase reaction, with all external 
% reaction bounds zero, then the bounds on one of the reactions in each of the 
% minimal sets needs to be set to eliminate flux in one direction. Each of the 
% minimal sets corresponds to net flux around a stoichiometrically balanced cycle, 
% which is thermodynamically infeasible [<#LyXCite-fleming_variational_2012 fleming_variational_2012>]. 
% Steady-state mass balance constraints do not enforce thermodynamic constraints. 
% In lieu of such constraints, the bounds on reactions can be set based on the 
% biochemical literature to eliminate net flux around a stoichiometrically balanced 
% cycle. In a model, with all external reactions blocked (bounds are set to zero), 
% maximising the ATP synthase reaction while minimising the cardinality of all 
% internal reactions, using sparse flux balance analysis can be used to find any 
% such cycle of minimal cardinality (minimal number of active reactions). By further 
% constraining the bounds to convert one reversible reaction in each such cycle 
% to an irreversible reaction, thermodynamically infeasible flux around cycles, 
% such as those involving the ATP synthase reaction, can be eliminated. The following 
% sections of this tutorial illustrate how to test different parts of the model 
% for thermodynamically infeasible flux through the ATP synthase reaction.
%% Testing for activity of ATP synthase with all exchanges closed and all internal reactions reversible
% Fully open all internal reactions

model.lb(model.SIntRxnBool)=-1000;
model.ub(model.SIntRxnBool)=1000;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed 
% and all internal reactions reversible

sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionUnBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionUnBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% In a model for flux balance analysis, there might be non-zero flux through 
% the ATP synthase reaction if all external reaction bounds are zero and all internal 
% reactions reversible. This indicates the imporance of appropriately constrained 
% internal reaction bounds.
%% Testing for activity of ATP synthase with all exchanges closed and all transport reactions reversible
% Identify all of the transport reactions

allTransportRxnBool=transportReactionBool(model);
fprintf('%u%s\n',nnz(allTransportRxnBool),' transport reactions in total.');
%% 
% Revert to original Recon3.0model reaction bounds

model.lb=modelOrig.lb;
model.ub=modelOrig.ub;
%% 
% Open all transport reactions (which might include an external reaction, 
% e.g., a  biomass reaction)

model.lb(allTransportRxnBool)=-1000;
model.ub(allTransportRxnBool)=1000;
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed

sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% Testing for activity of ATP synthase with all exchanges closed and all mitochondrial transport reactions reversible
% Identify all of the transport reactions involving the cytoplasm and mitochondrial 
% matrix

originCompartment='c';
destinationCompartment='m';
unidirectionalBool=0;
cmTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);
fprintf('%u%s\n',nnz(cmTransportRxnBool),' transport reactions involving the cytoplasm and mitochondrial matrix.');
%% 
% Revert to original Recon3.0model reaction bounds

model.lb=modelOrig.lb;
model.ub=modelOrig.ub;
%% 
% Open all transport reactions (which might include an external reaction, 
% e.g., a  biomass reaction)

model.lb(cmTransportRxnBool)=-1000;
model.ub(cmTransportRxnBool)=1000;
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model 

sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% Testing for activity of ATP synthase with all exchanges closed and all plasma membrane transport reactions reversible
% Identify all of the transport reactions across the plasma membrane

originCompartment='e';
destinationCompartment='c';
unidirectionalBool=0;
ecTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);
fprintf('%u%s\n',nnz(ecTransportRxnBool),' transport reactions across the plasma membrane.');
%% 
% Revert to original Recon3.0model reaction bounds

model.lb=modelOrig.lb;
model.ub=modelOrig.ub;
%% 
% Open all transport reactions (which might include an external reaction, 
% e.g., a  biomass reaction)

model.lb(ecTransportRxnBool)=-1000;
model.ub(ecTransportRxnBool)=1000;
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model 

sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% Testing for activity of ATP synthase with all exchanges closed and peroxisomal transport reactions reversible
% Identify all of the transport reactions across the plasma membrane

originCompartment='c';
destinationCompartment='x';
unidirectionalBool=0;
cxTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);
fprintf('%u%s\n',nnz(cxTransportRxnBool),' transport reactions across the peroxisome membrane.');
%% 
% Revert to original Recon3.0model reaction bounds

model.lb=modelOrig.lb;
model.ub=modelOrig.ub;
%% 
% Open all transport reactions (which might include an external reaction, 
% e.g., a  biomass reaction)

model.lb(cxTransportRxnBool)=-1000;
model.ub(cxTransportRxnBool)=1000;
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model 

sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% Testing for activity of ATP synthase with all exchanges closed and lysosomal transport reactions reversible
% Identify all of the transport reactions across the plasma membrane

originCompartment='c';
destinationCompartment='l';
unidirectionalBool=0;
clTransportRxnBool=transportReactionBool(model,originCompartment,destinationCompartment,unidirectionalBool);
fprintf('%u%s\n',nnz(clTransportRxnBool),' transport reactions across the lysosomal membrane.');
%% 
% Revert to original Recon3.0model reaction bounds

model.lb=modelOrig.lb;
model.ub=modelOrig.ub;
%% 
% Open all transport reactions (which might include an external reaction, 
% e.g., a  biomass reaction)

model.lb(clTransportRxnBool)=-1000;
model.ub(clTransportRxnBool)=1000;
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool)=0;
model.ub(~model.SIntRxnBool)=0;
%% 
% Run sparse flux balance analysis on the model 

sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP synthase reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpsynthaseBool),' flux through the ATP synthase reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=feasTol;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% REFERENCES
% [fleming_cardinality_nodate] Fleming, R.M.T., et al., Cardinality optimisation 
% in constraint-based modelling: illustration with Recon 3D (submitted), 2017.
% 
% [<#LyXCite-sparsePaper sparsePaper>] Le Thi, H.A., Pham Dinh, T., Le, H.M., 
% and Vo, X.T. (2015). DC approximation approaches for sparse optimization. European 
% Journal of Operational Research 244, 2646.
% 
% __
% 
% __
##### SOURCE END #####
--></body></html>