<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of createGroupContributionStruct</title>
  <meta name="keywords" content="createGroupContributionStruct">
  <meta name="description" content="Generates a matlab structure out of the tab delimited group contribuion data">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html groupContribution -->
<h1>createGroupContributionStruct
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Generates a matlab structure out of the tab delimited group contribuion data</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function metGroupCont=createGroupContributionStruct(primaryFile,pH,secondaryFile) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Generates a matlab structure out of the tab delimited group contribuion data

 The matlab structure with the group contibution data for each
 metabolite uses the primaryFile file in preference to the secondaryFile file but
 these can be any first and second preference files as long as they are
 in the correct format see webCGMtoTabDelimitedFile.m

INPUT
 primaryFile    tab delimited text file with group contribution data 
                (Janowski et al Biophysical Journal 95:1487-1499 (2008))
                i.e. output such as webCGM.txt from
                webCGMtoTabDelimitedFile.m

OPTIONAL INPUT
 pH             ph at which group contribution data given for, default=7

 secondaryFile  tab delimited text file with group contribution data 
                (Janowski et al Biophysical Journal 95:1487-1499 (2008))
                i.e. output such as webCGM.txt from
                webCGMtoTabDelimitedFile.m
                If the same metabolite abbreviation occurs in both files,
                then the data in the primary file takes precedence.


INPUT FILE FORMAT
 the first two text columns in both files should correspond to:
 abbreviation   
 formulaMarvin

 the next three columns in both files should correspond to:
 delta_G_formation
 delta_G_formation_Uncertainty
 chargeMarvin

OUTPUT
 metGroupCont(m).abbreviation                      metabolite abbreviation
 metGroupCont(m).formulaMarvin                     metabolite formula (Marvin)
 metGroupCont(m).delta_G_formation                     
 metGroupCont(m).delta_G_formation_uncertainty
 metGroupCont(m).chargeMarvin                      metabolite charge (Marvin)
 metGroupCont(m).pH
 metGroupCont(m).file                              file data came from

 Ronan M. T. Fleming 9 July 2009</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function metGroupCont=createGroupContributionStruct(primaryFile,pH,secondaryFile)</a>
0002 <span class="comment">% Generates a matlab structure out of the tab delimited group contribuion data</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% The matlab structure with the group contibution data for each</span>
0005 <span class="comment">% metabolite uses the primaryFile file in preference to the secondaryFile file but</span>
0006 <span class="comment">% these can be any first and second preference files as long as they are</span>
0007 <span class="comment">% in the correct format see webCGMtoTabDelimitedFile.m</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%INPUT</span>
0010 <span class="comment">% primaryFile    tab delimited text file with group contribution data</span>
0011 <span class="comment">%                (Janowski et al Biophysical Journal 95:1487-1499 (2008))</span>
0012 <span class="comment">%                i.e. output such as webCGM.txt from</span>
0013 <span class="comment">%                webCGMtoTabDelimitedFile.m</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%OPTIONAL INPUT</span>
0016 <span class="comment">% pH             ph at which group contribution data given for, default=7</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% secondaryFile  tab delimited text file with group contribution data</span>
0019 <span class="comment">%                (Janowski et al Biophysical Journal 95:1487-1499 (2008))</span>
0020 <span class="comment">%                i.e. output such as webCGM.txt from</span>
0021 <span class="comment">%                webCGMtoTabDelimitedFile.m</span>
0022 <span class="comment">%                If the same metabolite abbreviation occurs in both files,</span>
0023 <span class="comment">%                then the data in the primary file takes precedence.</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%INPUT FILE FORMAT</span>
0027 <span class="comment">% the first two text columns in both files should correspond to:</span>
0028 <span class="comment">% abbreviation</span>
0029 <span class="comment">% formulaMarvin</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% the next three columns in both files should correspond to:</span>
0032 <span class="comment">% delta_G_formation</span>
0033 <span class="comment">% delta_G_formation_Uncertainty</span>
0034 <span class="comment">% chargeMarvin</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%OUTPUT</span>
0037 <span class="comment">% metGroupCont(m).abbreviation                      metabolite abbreviation</span>
0038 <span class="comment">% metGroupCont(m).formulaMarvin                     metabolite formula (Marvin)</span>
0039 <span class="comment">% metGroupCont(m).delta_G_formation</span>
0040 <span class="comment">% metGroupCont(m).delta_G_formation_uncertainty</span>
0041 <span class="comment">% metGroupCont(m).chargeMarvin                      metabolite charge (Marvin)</span>
0042 <span class="comment">% metGroupCont(m).pH</span>
0043 <span class="comment">% metGroupCont(m).file                              file data came from</span>
0044 <span class="comment">%</span>
0045 <span class="comment">% Ronan M. T. Fleming 9 July 2009</span>
0046 
0047 <span class="keyword">if</span> ~exist(<span class="string">'pH'</span>,<span class="string">'var'</span>)
0048     pH=7;
0049 <span class="keyword">end</span>
0050 
0051 fid=fopen(primaryFile,<span class="string">'r'</span>);
0052 <span class="keyword">if</span> fid==-1
0053     error([<span class="string">'Cannot open '</span> primaryFile]);
0054 <span class="keyword">else</span>
0055     fprintf(<span class="string">'%s\n'</span>,[<span class="string">'Reading primary metabolite group contribution data from: '</span> primaryFile]);
0056 <span class="keyword">end</span>
0057 C = textscan(fid,<span class="string">'%s %s %f %f %f'</span>);
0058 primaryAbbr=C{1};
0059 C2=C{2};
0060 C3=C{3};
0061 C4=C{4};
0062 C5=C{5};
0063 
0064 <span class="comment">%</span>
0065 <span class="keyword">for</span> m=1:length(primaryAbbr)
0066     metGroupCont(m,1).abbreviation=primaryAbbr{m};
0067     metGroupCont(m,1).formulaMarvin=C2{m};
0068     metGroupCont(m,1).delta_G_formation=C3(m,1);
0069     metGroupCont(m,1).delta_G_formation_uncertainty=C4(m,1);
0070     metGroupCont(m,1).chargeMarvin=C5(m);
0071     metGroupCont(m,1).pH=pH;
0072     metGroupCont(m,1).file=primaryFile;
0073 <span class="keyword">end</span>
0074 
0075 <span class="keyword">if</span> exist(<span class="string">'secondaryFile'</span>,<span class="string">'var'</span>)
0076     fid=fopen(secondaryFile,<span class="string">'r'</span>);
0077     <span class="keyword">if</span> fid==-1
0078         error([<span class="string">'Cannot open '</span> secondaryFile]);
0079     <span class="keyword">else</span>
0080         fprintf(<span class="string">'%s\n'</span>,[<span class="string">'Reading secondary metabolite group contribution data from: '</span> secondaryFile]);
0081     <span class="keyword">end</span>
0082     C = textscan(fid,<span class="string">'%s %s %f %f %f'</span>);
0083     secondaryAbbr=C{1};
0084     C2=C{2};
0085     C3=C{3};
0086     C4=C{4};
0087     C5=C{5};
0088 
0089     m=length(primaryAbbr)+1;
0090     <span class="keyword">for</span> n=1:length(secondaryAbbr)
0091         ind=strcmp(secondaryAbbr{n},primaryAbbr);
0092         <span class="comment">%add the data from the secondary group contribution file if missing from</span>
0093         <span class="comment">%the primary file</span>
0094         <span class="keyword">if</span> ~any(ind)
0095             metGroupCont(m,1).abbreviation=secondaryAbbr{n};
0096             metGroupCont(m,1).formulaMarvin=C2{n};
0097             metGroupCont(m,1).delta_G_formation=C3(n);
0098             metGroupCont(m,1).delta_G_formation_uncertainty=C4(n);
0099             metGroupCont(m,1).chargeMarvin=C5(n);
0100             metGroupCont(m,1).pH=pH;
0101             metGroupCont(m,1).file=secondaryFile;
0102             m=m+1;
0103         <span class="keyword">end</span>
0104     <span class="keyword">end</span>
0105 <span class="keyword">end</span>
0106 
0107 
0108 
0109 
0110 
0111 
0112</pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>