<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of inchi2mol</title>
  <meta name="keywords" content="inchi2mol">
  <meta name="description" content="successbool = inchi2mol(inchis,filenames,outputdir,overwrite)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html external -->
<h1>inchi2mol
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>successbool = inchi2mol(inchis,filenames,outputdir,overwrite)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function successbool = inchi2mol(inchis,filenames,outputdir,overwrite) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> successbool = inchi2mol(inchis,filenames,outputdir,overwrite)
 
 Convert InChI strings to mol files using OpenBabel. Compatible with
 Windows and Unix.

 INPUTS
 inchis        nx1 Cell array of InChI strings
 filenames     nx1 Cell array of mol file names without file extension.
               Default is {'1';'2';...}
 outputdir     Directory for mol files. Default is
               'CurrentDirectory\molfiles'.
 overwrite     0, [1]. Specify whether to overwrite existing mol files
               in outputdir.

 OUTPUTS
 successbool   nx1 logical vector with 1 at indices corresponding to
               inchis that were successfully converted to mol files and 0
               elsewhere.
 
 Hulda SH  Feb. 2011</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function successbool = inchi2mol(inchis,filenames,outputdir,overwrite)</a>
0002 
0003 <span class="comment">% successbool = inchi2mol(inchis,filenames,outputdir,overwrite)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Convert InChI strings to mol files using OpenBabel. Compatible with</span>
0006 <span class="comment">% Windows and Unix.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% INPUTS</span>
0009 <span class="comment">% inchis        nx1 Cell array of InChI strings</span>
0010 <span class="comment">% filenames     nx1 Cell array of mol file names without file extension.</span>
0011 <span class="comment">%               Default is {'1';'2';...}</span>
0012 <span class="comment">% outputdir     Directory for mol files. Default is</span>
0013 <span class="comment">%               'CurrentDirectory\molfiles'.</span>
0014 <span class="comment">% overwrite     0, [1]. Specify whether to overwrite existing mol files</span>
0015 <span class="comment">%               in outputdir.</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% OUTPUTS</span>
0018 <span class="comment">% successbool   nx1 logical vector with 1 at indices corresponding to</span>
0019 <span class="comment">%               inchis that were successfully converted to mol files and 0</span>
0020 <span class="comment">%               elsewhere.</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% Hulda SH  Feb. 2011</span>
0023 
0024 <span class="comment">% Format input and set defaults</span>
0025 <span class="keyword">if</span> ~iscell(inchis) &amp;&amp; size(inchis,1) == 1 <span class="comment">% If a single InChI is input as string</span>
0026     inchis = {inchis};
0027 <span class="keyword">end</span>
0028 
0029 <span class="keyword">if</span> ~exist(<span class="string">'filenames'</span>,<span class="string">'var'</span>) || isempty(filenames) <span class="comment">% Create cell array of default filenames</span>
0030     filenames = 1:length(inchis);
0031     filenames = filenames';
0032     filenames = num2str(filenames);
0033     filenames = mat2cell(filenames,ones(1,size(filenames,1)),size(filenames,2));
0034     filenames = deblank(filenames);
0035 <span class="keyword">end</span>
0036 
0037 <span class="keyword">if</span> ~iscell(filenames) &amp;&amp; size(filenames,1) == 1 <span class="comment">% If a single file name is input as string</span>
0038     filenames = {filenames};
0039 <span class="keyword">end</span>
0040 
0041 <span class="keyword">if</span> size(inchis) ~= size(filenames)
0042     error(<span class="string">'inchis and filenames should be the same size.'</span>);
0043 <span class="keyword">end</span>
0044 
0045 <span class="comment">% Set other defaults</span>
0046 <span class="keyword">if</span> ~exist(<span class="string">'outputdir'</span>,<span class="string">'var'</span>) || isempty(outputdir)
0047     <span class="keyword">if</span> ~exist([pwd <span class="string">'\molfiles'</span>],<span class="string">'dir'</span>)
0048         mkdir(pwd,<span class="string">'molfiles'</span>)
0049     <span class="keyword">end</span>
0050     outputdir = [pwd <span class="string">'\molfiles'</span>];
0051 <span class="keyword">end</span>
0052 
0053 <span class="keyword">if</span> ~exist(<span class="string">'overwrite'</span>,<span class="string">'var'</span>) || isempty(overwrite)
0054     overwrite = 0;
0055 <span class="keyword">end</span>
0056 
0057 <span class="comment">% Begin conversion</span>
0058 <span class="keyword">if</span> ~exist(<span class="string">'outputdir'</span>,<span class="string">'dir'</span>) <span class="comment">% Create output directory</span>
0059     mkdir(outputdir)
0060 <span class="keyword">end</span>
0061 
0062 system([<span class="string">'cd '</span> outputdir]); <span class="comment">% Make OS cd to outputdir</span>
0063 cd(outputdir); <span class="comment">% Make Matlab cd to outputdir</span>
0064 
0065 <span class="comment">% List existing mol files in outputdir</span>
0066 d = dir(outputdir);
0067 existingMolFiles = cat(2,d.name);
0068 existingMolFiles = [<span class="string">'.mol'</span> existingMolFiles];
0069 
0070 nInchis = length(inchis);
0071 successbool = false(nInchis,1);
0072 
0073 <span class="keyword">for</span> n = 1:nInchis
0074     <span class="keyword">if</span> ~isempty(inchis{n})
0075         <span class="keyword">if</span> isempty(strfind(existingMolFiles,[<span class="string">'.mol'</span> filenames{n} <span class="string">'.mol'</span>])) || overwrite == 1 <span class="comment">% If mol file of same name does not already exist or if it should be overwritten</span>
0076             system([<span class="string">'echo '</span> inchis{n} <span class="string">' &gt; inchi.inchi'</span>]); <span class="comment">% Temporary place holder for inchi. Overwritten in each loop.</span>
0077             system([<span class="string">'babel inchi.inchi '</span> filenames{n} <span class="string">'.mol'</span>]); <span class="comment">% Convert InChI to mol file</span>
0078             
0079             f = dir([outputdir <span class="string">'\'</span> filenames{n} <span class="string">'.mol'</span>]);
0080             <span class="keyword">if</span> f.bytes &gt; eps <span class="comment">% If mol file is empty the conversion failed</span>
0081                 successbool(n) = true;
0082             <span class="keyword">else</span>
0083                 delete([outputdir <span class="string">'\'</span> filenames{n} <span class="string">'.mol'</span>]) <span class="comment">% Delete empty mol files</span>
0084             <span class="keyword">end</span>
0085         <span class="keyword">end</span>
0086     <span class="keyword">end</span>
0087 <span class="keyword">end</span>
0088 
0089 delete([outputdir <span class="string">'\inchi.inchi'</span>])</pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>