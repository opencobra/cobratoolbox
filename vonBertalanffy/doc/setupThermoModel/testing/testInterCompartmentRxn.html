<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of testInterCompartmentRxn</title>
  <meta name="keywords" content="testInterCompartmentRxn">
  <meta name="description" content="Calculates the transformed Gibbs energy for a reaction and">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html testing -->
<h1>testInterCompartmentRxn
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Calculates the transformed Gibbs energy for a reaction and</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [dGt,dGt0,dGft,dGft0,SpH,aveHbound,aveZi,pHVec,isVec,chiVec]=testInterCompartmentRxn(model,rxnAbbr,PHmin,PHmax,ISmin,ISmax,CHImin,CHImax,N) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">Calculates the transformed Gibbs energy for a reaction and
standard transformend Gibbs energy for a reaction as a function of
pH, ionic strength and electrical potential. The reaction may involve
multiple compartments.

 model     COBRA model structure
 rxnAbbr   Abbreviation of a reaction in the model.rxns field to be tested
 PHmin     Minimum glass electrode pH
 PHmax     Maximum glass electrode pH
 ISmin     Ionic strength minimum
 ISmax     Ionic strength maximum
 CHImin    Electrical potential minimum
 CHImax    Electrical potential maximum
 N         Number of data points to interpolate between each min and max
           for each of pH, IS and CHI.

 OUTPUT
 dGt       N by N by N matrix of reaction transformed Gibbs energies
           as a function of pH, ionic strength and electrical potential
           respectively.
 dGt0      N by N by N matrix of reaction standard transformed Gibbs energies
           as a function of pH, ionic strength and electrical potential
           respectively.
 dGft      M by N by N by N matrix of reactant transformed Gibbs energies
           as a function of pH, ionic strength and electrical potential
           respectively. M is the number of reactants involved in the
           reaction.
 dGft0     M by N by N by N matrix of reactant standard transformed Gibbs energies
           as a function of pH, ionic strength and electrical potential
           respectively. M is the number of reactants involved in the
           reaction.
 SpH       M by N by N matrix of pH balanced stoichiometric coefficients
           as a function of pH, ionic strength and electrical potential
           respectively. M is the number of reactants involved in the
           reaction. see pHbalanceProtons.m
 aveHbound M by N by N by N matrix of average number of protons bound by each reactant
           as a function of pH, ionic strength and electrical potential
           respectively. M is the number of reactants involved in the
           reaction. see pHbalanceProtons.m
 aveZi     M by N by N by N matrix of the average charge of each reactant
           as a function of pH, ionic strength and electrical potential
           respectively. M is the number of reactants involved in the
           reaction. see pHbalanceProtons.m
 pHVec     N by 1 vector of glass electrode pH used
 isVec     N by 1 vector of ionic strengths used
 chiVec    N by 1 vector of electrical potentials used</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../setupThermoModel/alberty/calcdGHT.html" class="code" title="function [dGf0,dHf0,mf,aveHbound,aveZi,lambda,gpfnsp]=calcdGHT(dGzero,dHzero,zi,nH,pHr,is,temp,chi,Legendre,LegendreCHI)">calcdGHT</a>	calculates the standard transformed Gibbs energy of a reactant</li><li><a href="../../setupThermoModel/massBalance/numAtomsOfElementInFormula.html" class="code" title="function N=numAtomsOfElementInFormula(formula,element)">numAtomsOfElementInFormula</a>	returns the number of atoms of a single element in a formula</li><li><a href="../../setupThermoModel/setupThermoModel.html" class="code" title="function [modelT,directions,solutionThermoRecon]=setupThermoModel(model,metAbbrAlbertyAbbr,metGroupCont,Alberty2006,computedSpeciesData,temp,PHA,IS,CHI,biomassRxnAbbr,rxnAbbrDatabaseID,defaultMetBounds,metBoundsFile,rxnBoundsFile,Legendre,useKeqData,nStdDevGroupCont,cumNormProbCutoff,figures,printToFile,secondPassAssignment)">setupThermoModel</a>	Thermodynamically constrains a COBRA model.</li><li><a href="../../setupThermoModel/transport/getCompartment.html" class="code" title="function [compartments,uniqueCompartments]=getCompartment(mets,numChar)">getCompartment</a>	Get the compartment for each metabolite, and the unique compartments</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [dGt,dGt0,dGft,dGft0,SpH,aveHbound,aveZi,pHVec,isVec,chiVec]=testInterCompartmentRxn(model,rxnAbbr,PHmin,PHmax,ISmin,ISmax,CHImin,CHImax,N)</a>
0002 <span class="comment">%Calculates the transformed Gibbs energy for a reaction and</span>
0003 <span class="comment">%standard transformend Gibbs energy for a reaction as a function of</span>
0004 <span class="comment">%pH, ionic strength and electrical potential. The reaction may involve</span>
0005 <span class="comment">%multiple compartments.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% model     COBRA model structure</span>
0008 <span class="comment">% rxnAbbr   Abbreviation of a reaction in the model.rxns field to be tested</span>
0009 <span class="comment">% PHmin     Minimum glass electrode pH</span>
0010 <span class="comment">% PHmax     Maximum glass electrode pH</span>
0011 <span class="comment">% ISmin     Ionic strength minimum</span>
0012 <span class="comment">% ISmax     Ionic strength maximum</span>
0013 <span class="comment">% CHImin    Electrical potential minimum</span>
0014 <span class="comment">% CHImax    Electrical potential maximum</span>
0015 <span class="comment">% N         Number of data points to interpolate between each min and max</span>
0016 <span class="comment">%           for each of pH, IS and CHI.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% OUTPUT</span>
0019 <span class="comment">% dGt       N by N by N matrix of reaction transformed Gibbs energies</span>
0020 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0021 <span class="comment">%           respectively.</span>
0022 <span class="comment">% dGt0      N by N by N matrix of reaction standard transformed Gibbs energies</span>
0023 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0024 <span class="comment">%           respectively.</span>
0025 <span class="comment">% dGft      M by N by N by N matrix of reactant transformed Gibbs energies</span>
0026 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0027 <span class="comment">%           respectively. M is the number of reactants involved in the</span>
0028 <span class="comment">%           reaction.</span>
0029 <span class="comment">% dGft0     M by N by N by N matrix of reactant standard transformed Gibbs energies</span>
0030 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0031 <span class="comment">%           respectively. M is the number of reactants involved in the</span>
0032 <span class="comment">%           reaction.</span>
0033 <span class="comment">% SpH       M by N by N matrix of pH balanced stoichiometric coefficients</span>
0034 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0035 <span class="comment">%           respectively. M is the number of reactants involved in the</span>
0036 <span class="comment">%           reaction. see pHbalanceProtons.m</span>
0037 <span class="comment">% aveHbound M by N by N by N matrix of average number of protons bound by each reactant</span>
0038 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0039 <span class="comment">%           respectively. M is the number of reactants involved in the</span>
0040 <span class="comment">%           reaction. see pHbalanceProtons.m</span>
0041 <span class="comment">% aveZi     M by N by N by N matrix of the average charge of each reactant</span>
0042 <span class="comment">%           as a function of pH, ionic strength and electrical potential</span>
0043 <span class="comment">%           respectively. M is the number of reactants involved in the</span>
0044 <span class="comment">%           reaction. see pHbalanceProtons.m</span>
0045 <span class="comment">% pHVec     N by 1 vector of glass electrode pH used</span>
0046 <span class="comment">% isVec     N by 1 vector of ionic strengths used</span>
0047 <span class="comment">% chiVec    N by 1 vector of electrical potentials used</span>
0048 
0049 
0050 <span class="keyword">if</span> ~exist(<span class="string">'PHmin'</span>,<span class="string">'var'</span>)
0051     PHmin = 5.5;
0052 <span class="keyword">end</span>
0053 <span class="keyword">if</span> ~exist(<span class="string">'PHmax'</span>,<span class="string">'var'</span>)
0054     PHmax = 8.5;
0055 <span class="keyword">end</span>
0056 <span class="keyword">if</span> ~exist(<span class="string">'ISmin'</span>,<span class="string">'var'</span>)
0057     ISmin = 0;
0058 <span class="keyword">end</span>
0059 <span class="keyword">if</span> ~exist(<span class="string">'ISmax'</span>,<span class="string">'var'</span>)
0060     ISmax = 0.25;
0061 <span class="keyword">end</span>
0062 <span class="keyword">if</span> ~exist(<span class="string">'CHImin'</span>,<span class="string">'var'</span>)
0063     CHImin = 0;
0064 <span class="keyword">end</span>
0065 <span class="keyword">if</span> ~exist(<span class="string">'CHImax'</span>,<span class="string">'var'</span>)
0066     CHImax = 0.25;
0067 <span class="keyword">end</span>
0068 <span class="keyword">if</span> ~exist(<span class="string">'N'</span>,<span class="string">'var'</span>)
0069     N = 50;
0070 <span class="keyword">end</span>
0071 <span class="keyword">if</span> ~exist(<span class="string">'Alberty2006'</span>,<span class="string">'var'</span>)
0072     loadDataToSetupThermoModel
0073 <span class="keyword">end</span>
0074 <span class="keyword">for</span> n=1:length(Alberty2006)
0075     albertyAbbrAll{n,1}=Alberty2006(n).abbreviation; 
0076 <span class="keyword">end</span>
0077 <span class="keyword">if</span> ~exist(<span class="string">'rxnAbbr'</span>,<span class="string">'var'</span>)
0078     <span class="keyword">if</span> 1
0079         <span class="comment">%'succinate transport via proton symport (2 H)'</span>
0080         rxnAbbr=<span class="string">'SUCCt2_2'</span>;
0081     <span class="keyword">else</span>
0082         <span class="comment">%'citrate transport, mitochondrial'</span>
0083         rxnAbbr=<span class="string">'CITtam'</span>;
0084     <span class="keyword">end</span>
0085 <span class="keyword">end</span>
0086 
0087 [nMet,nRxn]=size(model.S);
0088 <span class="comment">%reduce size of model to just selected reaction and protons in each</span>
0089 <span class="comment">%compartment</span>
0090 rxnBool=strcmp(model.rxns,rxnAbbr);
0091 <span class="keyword">if</span> ~any(rxnBool)
0092     error([<span class="string">'could not find '</span> rxnAbbr])
0093 <span class="keyword">end</span>
0094 metBool=false(nMet,1);
0095 metBool(model.S(:,rxnBool)~=0)=1;
0096 
0097 [compartments,uniqueCompartments]=<a href="../../setupThermoModel/transport/getCompartment.html" class="code" title="function [compartments,uniqueCompartments]=getCompartment(mets,numChar)">getCompartment</a>(model.mets(metBool));
0098 <span class="comment">%indices of protons in different uniqueCompartments</span>
0099 hydrogenBool=false(nMet,1);
0100 <span class="keyword">for</span> p=1:length(uniqueCompartments)
0101     ind=find(strcmp([<span class="string">'h['</span> uniqueCompartments{p} <span class="string">']'</span>],model.mets)~=0);
0102     <span class="keyword">if</span> ~isempty(ind)
0103         hydrogenBool(ind)=1;
0104     <span class="keyword">end</span>
0105 <span class="keyword">end</span>
0106 metBool = metBool | hydrogenBool;
0107 
0108 <span class="comment">%extract that part of the model needed for thermodynamic calculations</span>
0109 model2.mets=model.mets(metBool);
0110 model2.metNames=model.metNames(metBool);
0111 model2.metFormulas=model.metFormulas(metBool);
0112 model2.metCharges=model.metCharge(metBool);
0113 model2.rxns=model.rxns(rxnBool);
0114 model2.rxnNames=model.rxnNames(rxnBool);
0115 model2.rev=model.rev(rxnBool);
0116 model2.lb=model.lb(rxnBool);
0117 model2.ub=model.ub(rxnBool);
0118 model2.S=model.S(metBool,rxnBool);
0119 [nMet,nRxn]=size(model2.S);
0120 model2.b=zeros(nMet,1);
0121 model2.c=zeros(nRxn,1);
0122 
0123 <span class="comment">%save reduced model</span>
0124 model=model2;
0125 model.biomassRxnAbbr=<span class="string">'NONE'</span>;
0126 
0127 <span class="comment">%create vectors of changing pH, ionic strength and electrical potential</span>
0128 pHVec  = linspace(PHmin,PHmax,N);
0129 isVec  = linspace(ISmin,ISmax,N);
0130 chiVec = linspace(CHImin,CHImax,N);
0131 
0132 <span class="comment">%parameters for setupThermoModel</span>
0133 rxnBoundsFile=[];
0134 Legendre=1;
0135 LegendreCHI=1;
0136 useKeqData=1;
0137 nStdDevGroupCont=1;
0138 cumNormProbCutoff=0.2;
0139 figures=0;
0140 printToFile=0;
0141 
0142 rxnAbbr=<span class="string">'SUCCt_Jol'</span>;
0143 <span class="comment">%rxnAbbr='SUCCt2_2';</span>
0144 <span class="comment">%rxnAbbr='SUCCt2_3';</span>
0145 <span class="comment">%rxnAbbr='SUCCt2_3';</span>
0146 <span class="comment">%rxnAbbr='CITtam';</span>
0147 <span class="keyword">switch</span> rxnAbbr
0148     <span class="keyword">case</span> <span class="string">'SUCCt_Jol'</span>
0149         Ni=N; Nj=1; Nk=1;
0150         
0151         <span class="comment">%Extracellular compartment pH =  inside compartment in Jol et al.</span>
0152         <span class="comment">%Intracellular compartment pH = outside compartment in Jol et al.</span>
0153         PHR.c=5; <span class="comment">%real pH 5 - make sure to set pH adjustment off in setupThermoModel</span>
0154         
0155         <span class="keyword">if</span> 1
0156             IS.c=0.15;
0157             IS.e=0.15;
0158             isVec(1)=IS.e;
0159         <span class="keyword">else</span>
0160             IS.c=0;
0161             IS.e=0;
0162             isVec(1)=IS.e;
0163         <span class="keyword">end</span>
0164         
0165         <span class="keyword">if</span> 1
0166             CHI.c=40;
0167             CHI.e=0;
0168             chiVec(1)=CHI.e;
0169         <span class="keyword">else</span>
0170             CHI.c=0;
0171             CHI.e=0;
0172             chiVec(1)=CHI.e;
0173         <span class="keyword">end</span>
0174 
0175         temp=298.15;
0176         
0177         model.rxns{1}=<span class="string">'SUCCt'</span>;
0178         
0179         model.metFormulas{strcmp(model.mets,<span class="string">'succ[c]'</span>)}=<span class="string">'C4H6O4'</span>;
0180         model.metFormulas{strcmp(model.mets,<span class="string">'succ[e]'</span>)}=<span class="string">'C4H6O4'</span>;
0181         model.S(strcmp(<span class="string">'succ[e]'</span>,model.mets),1)=1;
0182         model.S(strcmp(<span class="string">'succ[c]'</span>,model.mets),1)=-1;
0183         model.S(strcmp(<span class="string">'h[c]'</span>,model.mets),1)=0;
0184         model.S(strcmp(<span class="string">'h[e]'</span>,model.mets),1)=0;
0185         model.metCharge(strcmp(model.mets,<span class="string">'succ[c]'</span>))=0;
0186         model.metCharge(strcmp(model.mets,<span class="string">'succ[e]'</span>))=0;
0187         model.metCharge(strcmp(model.mets,<span class="string">'h[c]'</span>))=1;
0188         model.metCharge(strcmp(model.mets,<span class="string">'h[e]'</span>))=1;
0189         
0190         <span class="keyword">if</span> 1
0191             metBoundsFile=<span class="string">'SuccinateTransport.txt'</span>;
0192         <span class="keyword">else</span>
0193             metBoundsFile=<span class="string">'SuccinateTransportStandard.txt'</span>;
0194         <span class="keyword">end</span>
0195                 
0196         <span class="comment">%left</span>
0197         bool=strcmp(<span class="string">'succ'</span>,metAbbrAlbertyAbbr(:,2));
0198         albertyAbbr=metAbbrAlbertyAbbr(bool,3);
0199         n=find(strcmp(albertyAbbr,albertyAbbrAll));
0200         <span class="comment">%find the number of species within pseudoisomer group</span>
0201         p=max(find(~isnan(Alberty2006(n).basicData(:,1))));
0202         [dGf0_left,dHf0_left,mf_left,aveHbound_left,aveZi_left,lambda_left]=<a href="../../setupThermoModel/alberty/calcdGHT.html" class="code" title="function [dGf0,dHf0,mf,aveHbound,aveZi,lambda,gpfnsp]=calcdGHT(dGzero,dHzero,zi,nH,pHr,is,temp,chi,Legendre,LegendreCHI)">calcdGHT</a>(Alberty2006(n).basicData(1:p,1),Alberty2006(n).basicData(1:p,2),Alberty2006(n).basicData(1:p,3),Alberty2006(n).basicData(1:p,4),PHR.c,IS.c,temp,CHI.c,Legendre,LegendreCHI);
0203         
0204         dGt2=zeros(Ni,1);
0205         dGft02=zeros(nMet,Ni);
0206         
0207         staticCompartment=<span class="string">'c'</span>;
0208         variableCompartment=<span class="string">'e'</span>;
0209         
0210     <span class="keyword">case</span> <span class="string">'SUCCt2_2'</span>
0211         Ni=N; Nj=N; Nk=N;
0212         
0213         PHR.c=5; <span class="comment">%real pH 5 - make sure to set pH adjustment off in setupThermoModel</span>
0214         
0215         CHI.c  = 0;
0216         CHI.e  = 0;
0217         chiVec(1)=CHI.e;
0218         
0219         isVec = 0.15;
0220         IS.e  = 0.15;
0221         isVec(1)=IS.e;
0222         
0223         temp=298.15;
0224         
0225         model.metFormulas{strcmp(model.mets,<span class="string">'succ[c]'</span>)}=<span class="string">'C4H6O4'</span>;
0226         model.metFormulas{strcmp(model.mets,<span class="string">'succ[e]'</span>)}=<span class="string">'C4H6O4'</span>;
0227         model.S(strcmp(<span class="string">'h[c]'</span>,model.mets),1)=0;
0228         model.S(strcmp(<span class="string">'h[e]'</span>,model.mets),1)=0;
0229         
0230         metBoundsFile=<span class="string">'SuccinateTransportStandard.txt'</span>;
0231         
0232         staticCompartment=<span class="string">'c'</span>;
0233         variableCompartment=<span class="string">'e'</span>;
0234         
0235     <span class="keyword">case</span> <span class="string">'SUCCt2_3'</span>
0236         <span class="comment">%Groeneveld, M.; Weme, R. G. J. D. O.; Duurkens, R. H. &amp; Slotboom, D. J.</span>
0237         <span class="comment">%Biochemical characterization of the C4-dicarboxylate transporter DctA from</span>
0238         <span class="comment">%Bacillus subtilis. J Bacteriol, 2010, 192, 2900-2907</span>
0239         
0240 <span class="comment">%         The Vmax for succinate</span>
0241 <span class="comment">%         transport was approximately 3-fold lower at an external pH of</span>
0242 <span class="comment">%         7 [1.4 nmol (mg protein)21 s21] than at pH 5.5 [3.9 nmol (mg</span>
0243 <span class="comment">%         protein)21 s21]. This result is consistent with the protons being</span>
0244 <span class="comment">%         cosubstrates.</span>
0245 
0246         <span class="keyword">if</span> 1
0247             <span class="keyword">if</span> 0
0248                 Ni=N; Nj=N; Nk=N;
0249             <span class="keyword">else</span>
0250                 Ni=N; Nj=N; Nk=1;
0251             <span class="keyword">end</span>
0252         <span class="keyword">else</span>
0253             Ni=N; Nj=1; Nk=1;
0254         <span class="keyword">end</span>
0255         
0256         <span class="comment">%cytoplasm mimics vesicle compartment</span>
0257         <span class="keyword">if</span> 1
0258             PHR.c=8;
0259         <span class="keyword">else</span>
0260             PHR.c=6;
0261         <span class="keyword">end</span>
0262         
0263         <span class="comment">%&quot;In the first experiment, we varied the external pH (5.5 or 7) while keeping the internal pH (8) constant.</span>
0264         <span class="keyword">if</span> 1
0265             PHmin = 5.5;
0266             PHmax = 7;
0267             pHVec  = linspace(PHmin,PHmax,N);
0268         <span class="keyword">end</span>
0269         
0270         <span class="comment">%&quot;In the presence of valinomycin, an additional K+ diffusion potential,</span>
0271         <span class="comment">%DC (Nernst potential, -118 mV), was created.&quot;</span>
0272         <span class="keyword">if</span> 1
0273             CHI.c=0;
0274             CHI.e=118;
0275             <span class="keyword">if</span> 1
0276                  chiVec  = linspace(0,118,Nj);
0277             <span class="keyword">else</span>
0278                  chiVec(1)=CHI.e;
0279             <span class="keyword">end</span>
0280         <span class="keyword">else</span>
0281             CHI.c=0;
0282             CHI.e=0;
0283         <span class="keyword">end</span>
0284 
0285         <span class="comment">%&quot;Membrane vesicles contain 100 mM K-HEPES (pH 7.5).&quot;</span>
0286         <span class="comment">%http://www.sigmaaldrich.com/life-science/core-bioreagents/biological-buffers/hepes-specification.html</span>
0287 <span class="comment">%         Synonyms        4-(2-Hydroxyethyl)piperazine-1-ethanesulfonic acid</span>
0288 <span class="comment">%         N-(2-Hydroxyethyl)piperazine-N'-(2-ethanesulfonic acid)</span>
0289 <span class="comment">%         Molecular Formula    C8H18N2O4S    Beilstein Registry    883043    pKa (at 20)    7.55</span>
0290 <span class="comment">%         Molecular Weight    238.30    MDL Number    MFCD00006158    pKa (at 25)    7.48</span>
0291 <span class="comment">%         CAS Number    7365-45-9    EG/EC Number    230-907-9    pKa (at 37)    7.31</span>
0292 <span class="comment">%         Useful pH range    6.8 - 8.2</span>
0293         pKa=7.31;
0294         IS.c = 0.5 *(10^-pKa)*0.1;
0295         
0296         <span class="comment">%&quot;vesicles were diluted 100-fold in an isosmotic Na-MES buffer, pH 5.5</span>
0297         <span class="comment">%(consisting of 135 mM MES [morpholineethanesulfonic acid] adjusted to</span>
0298         <span class="comment">%pH 5.5 with NaOH)&quot;</span>
0299 <span class="comment">%         http://www.sigmaaldrich.com/life-science/core-bioreagents/biological-buffers/mes-sodium-salt-specification.html</span>
0300 <span class="comment">%         Molecular Formula    C6H12NNaO4S    Beilstein Registry    3765682    Useful pH range    5.5 - 6.7</span>
0301 <span class="comment">%         Molecular Weight    217.22    MDL Number    MFCD00065473    pKa (at 25)    6.1</span>
0302 <span class="comment">%         CAS Number    71119-23-8    EG/EC Number    275-203-2</span>
0303         pKa=6.1;
0304         IS.e = 0.5 *(10^-pKa)*0.135;
0305         isVec(1)=IS.e;
0306         
0307         temp=310.15;
0308         
0309         <span class="comment">% &quot;Succinate transport was stimulated by a negative membrane potential,</span>
0310         <span class="comment">% indicating that transport was electrogenic. Therefore, at</span>
0311         <span class="comment">% least three protons must be transported with the divalent anion</span>
0312         <span class="comment">% succinate.&quot;</span>
0313         model.metFormulas{strcmp(model.mets,<span class="string">'succ[c]'</span>)}=<span class="string">'C4H4O4'</span>;
0314         model.metFormulas{strcmp(model.mets,<span class="string">'succ[e]'</span>)}=<span class="string">'C4H4O4'</span>;
0315         model.metCharge(strcmp(model.mets,<span class="string">'succ[c]'</span>))=-2;
0316         model.metCharge(strcmp(model.mets,<span class="string">'succ[e]'</span>))=-2;
0317         model.S(strcmp(<span class="string">'h[c]'</span>,model.mets),1)=3;
0318         model.S(strcmp(<span class="string">'h[e]'</span>,model.mets),1)=-3;
0319         model.metCharges(strcmp(model.mets,<span class="string">'h[c]'</span>))=1;
0320         model.metCharges(strcmp(model.mets,<span class="string">'h[e]'</span>))=1;
0321         
0322         <span class="keyword">if</span> 0
0323             <span class="comment">%&quot;3.1 mM [14C]succinate&quot;</span>
0324             metBoundsFile=<span class="string">'SuccinateTransportGROENEVELD.txt'</span>; <span class="comment">% 3.1 mM on both sides at present</span>
0325         <span class="keyword">else</span>
0326             metBoundsFile=<span class="string">'SuccinateTransportStandard.txt'</span>;
0327         <span class="keyword">end</span>
0328         
0329         staticCompartment=<span class="string">'c'</span>;
0330         variableCompartment=<span class="string">'e'</span>;
0331           
0332     <span class="keyword">case</span> <span class="string">'CITtam'</span>
0333          <span class="comment">%citrate transport, mitochondrial</span>
0334          <span class="comment">%cit[c] + mal-L[m] &lt;==&gt; cit[m] + mal-L[c]</span>
0335          
0336 <span class="comment">%         F. Bisaccia, A. De Palma, G. Prezioso, and F. Palmieri. Kinetic characterization</span>
0337 <span class="comment">%         of the reconstituted tricarboxylate carrier from rat liver mitochondria.</span>
0338 <span class="comment">%         Biochim Biophys Acta, 1019(3):250–256, Sep 1990.</span>
0339 
0340           temp = 273.15 + 25;
0341           
0342           <span class="comment">%10 mM PIPES</span>
0343           <span class="comment">%1,4-Piperazinediethanesulfonic acid</span>
0344           <span class="keyword">if</span> 1
0345               <span class="comment">%http://www.sigmaaldrich.com/catalog/ProductDetail.do?lang=en&amp;N4=P6757|SIGMA&amp;N5=SEARCH_CONCAT_PNO|BRAND_KEY&amp;F=SPEC</span>
0346               <span class="comment">%http://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI:44933</span>
0347               <span class="comment">%pKa (25 °C) 6.8</span>
0348               pKa_PIPES = 6.8;
0349           <span class="keyword">else</span>
0350               <span class="comment">%GOLDBERG, KISHORE, AND LENNEN NIST tables</span>
0351               pKa_PIPES=7.141;
0352           <span class="keyword">end</span>
0353           
0354           <span class="comment">%50 mM NaCl</span>
0355           <span class="comment">%pKa = 6.7–7.3</span>
0356           pKa_NaCl=7;
0357           
0358           <span class="keyword">if</span> 0
0359               <span class="comment">%IS.c = 0.5 *(2*(10^-pKa_PIPES)*0.01 + 2*(10^-pKa_NaCl)*0.05);</span>
0360               IS.c = 0.5 *(2*(10^-pKa_PIPES)*0.01 + 2*(1)*0.05);
0361               IS.m = IS.c;
0362               <span class="comment">% TODO how to include effect of</span>
0363               <span class="comment">% 10mM citrate or 20mM malate</span>
0364           <span class="keyword">else</span>
0365               IS.c = 0;
0366               IS.m = IS.c;
0367           <span class="keyword">end</span>
0368           
0369           <span class="keyword">if</span> 1
0370               CHI.c = 0;
0371               CHI.m = 0;
0372           <span class="keyword">else</span>
0373               CHI.c = 0;
0374               CHI.m = 0;
0375           <span class="keyword">end</span>
0376           
0377           <span class="keyword">if</span> 1
0378               PHR.c = 7;
0379               PHR.m = 7;
0380           <span class="keyword">else</span>
0381               <span class="comment">%intracellular</span>
0382               PHR.c = 7.35;
0383               PHR.m = 8;
0384           <span class="keyword">end</span>
0385           
0386           metBoundsFile=<span class="string">'CITtam.txt'</span>;
0387           metBoundsFile=<span class="string">'CITtam_Standard.txt'</span>;
0388           
0389           <span class="keyword">if</span> 1
0390               <span class="comment">%cit[c] + mal-L[m] &lt;==&gt; cit[m] + mal-L[c]</span>
0391               model.metFormulas{strcmp(model.mets,<span class="string">'cit[m]'</span>)}=<span class="string">'C6H5O7'</span>;
0392               model.metFormulas{strcmp(model.mets,<span class="string">'cit[c]'</span>)}=<span class="string">'C6H5O7'</span>;
0393               model.metCharges(strcmp(model.mets,<span class="string">'cit[m]'</span>))=-3;
0394               model.metCharges(strcmp(model.mets,<span class="string">'cit[c]'</span>))=-3;
0395               model.metFormulas{strcmp(model.mets,<span class="string">'mal-L[m]'</span>)}=<span class="string">'C4H4O5'</span>;
0396               model.metFormulas{strcmp(model.mets,<span class="string">'mal-L[c]'</span>)}=<span class="string">'C4H4O5'</span>;
0397               model.metCharges(strcmp(model.mets,<span class="string">'mal-L[m]'</span>))=-2;
0398               model.metCharges(strcmp(model.mets,<span class="string">'mal-L[c]'</span>))=-2;
0399           <span class="keyword">else</span>
0400               <span class="comment">%cit[c] + mal-L[m] &lt;==&gt; cit[m] + mal-L[c] + h[m]</span>
0401               model.S(strcmp(model.mets,<span class="string">'h[m]'</span>),1)=1;
0402               model.metFormulas{strcmp(model.mets,<span class="string">'cit[m]'</span>)}=<span class="string">'C6H5O7'</span>;
0403               model.metFormulas{strcmp(model.mets,<span class="string">'cit[c]'</span>)}=<span class="string">'C6H6O7'</span>;
0404               model.metCharges(strcmp(model.mets,<span class="string">'cit[m]'</span>))=-3;
0405               model.metCharges(strcmp(model.mets,<span class="string">'cit[c]'</span>))=-2;
0406               model.metFormulas{strcmp(model.mets,<span class="string">'mal-L[m]'</span>)}=<span class="string">'C4H4O5'</span>;
0407               model.metFormulas{strcmp(model.mets,<span class="string">'mal-L[c]'</span>)}=<span class="string">'C4H4O5'</span>;
0408               model.metCharges(strcmp(model.mets,<span class="string">'mal-L[m]'</span>))=-2;
0409               model.metCharges(strcmp(model.mets,<span class="string">'mal-L[c]'</span>))=-2;
0410           <span class="keyword">end</span>
0411               
0412           
0413           <span class="keyword">if</span> 1
0414               <span class="keyword">if</span> 0
0415                   Ni=N; Nj=N; Nk=N;
0416               <span class="keyword">else</span>
0417                   Ni=N; Nj=1; Nk=1;
0418               <span class="keyword">end</span>
0419           <span class="keyword">else</span>
0420               Ni=N; Nj=1; Nk=1;
0421           <span class="keyword">end</span>
0422           
0423           staticCompartment=<span class="string">'c'</span>;
0424           variableCompartment=<span class="string">'m'</span>;
0425 <span class="keyword">end</span>
0426 
0427 [nMet,nRxn]=size(model.S);
0428 
0429 dGt=zeros(Ni,Nj,Nk);
0430 dGt0=zeros(Ni,Nj,Nk);
0431 dGft=zeros(nMet,Ni,Nj,Nk);
0432 dGft0=zeros(nMet,Ni,Nj,Nk);
0433 SpH=zeros(nMet,Ni,Nj,Nk);
0434 aveHbound=zeros(nMet,Ni,Nj,Nk);
0435 aveZi=zeros(nMet,Ni,Nj,Nk);
0436 
0437 
0438 <span class="keyword">for</span> i=1:Ni
0439     PHR.(variableCompartment)=pHVec(i);
0440     <span class="keyword">for</span> j=1:Nj
0441         CHI.(variableCompartment)=chiVec(j);
0442         <span class="keyword">for</span> k=1:Nk
0443             IS.(variableCompartment)=isVec(k);
0444                  
0445             <span class="comment">%setup thermo model for a single reaction</span>
0446             [modelT,directions,solutionThermoRecon]=<a href="../../setupThermoModel/setupThermoModel.html" class="code" title="function [modelT,directions,solutionThermoRecon]=setupThermoModel(model,metAbbrAlbertyAbbr,metGroupCont,Alberty2006,computedSpeciesData,temp,PHA,IS,CHI,biomassRxnAbbr,rxnAbbrDatabaseID,defaultMetBounds,metBoundsFile,rxnBoundsFile,Legendre,useKeqData,nStdDevGroupCont,cumNormProbCutoff,figures,printToFile,secondPassAssignment)">setupThermoModel</a>(model,metAbbrAlbertyAbbr,<span class="keyword">...</span>
0447                 metGroupCont,Alberty2006,temp,PHR,IS,CHI,model.biomassRxnAbbr,<span class="keyword">...</span>
0448                 symphID_rxnAbbr,metBoundsFile,rxnBoundsFile,Legendre,useKeqData,<span class="keyword">...</span>
0449                 nStdDevGroupCont,cumNormProbCutoff,figures,printToFile);
0450 
0451             <span class="comment">%assumes there is only one reaction</span>
0452             dGt0(i,j,k)=(modelT.rxn(1).dGt0Min + modelT.rxn(1).dGt0Max)/2;
0453             dGt(i,j,k)=(modelT.rxn(1).dGtMin + modelT.rxn(1).dGtMax)/2;
0454             
0455             <span class="comment">%stoichiometry</span>
0456             SpH(:,i,j,k)=modelT.S;
0457             <span class="comment">%average number of protons bound</span>
0458             <span class="keyword">for</span> m=1:nMet
0459                 aveHbound(m,i,j,k)=modelT.met(m).aveHbound;
0460                 aveZi(m,i,j,k)=modelT.met(m).aveZi;
0461                 dGft0(m,i,j,k)=modelT.met(m).dGft0;
0462                 dGft(m,i,j,k)=(modelT.dGftMin(m) + modelT.dGftMax(m))/2;
0463             <span class="keyword">end</span>
0464                 
0465             <span class="keyword">if</span> strcmp(rxnAbbr,<span class="string">'SUCCt_Jol'</span>)
0466                 <span class="comment">% Compare with Jol et al approach for neutral succinate transport</span>
0467                 zi = 0;
0468                 <span class="keyword">if</span> 1
0469                     Cj_left  = 0.00005;
0470                     Cj_right = 0.0005;
0471                 <span class="keyword">else</span>
0472                     Cj_left  = 1;
0473                     Cj_right = 1;
0474                 <span class="keyword">end</span>
0475                 
0476                 <span class="comment">%other data</span>
0477                 dGf0_H = 0; <span class="comment">%proton standard</span>
0478                 
0479                 
0480                 <span class="comment">%By convention, we assume the chemical potential of a metabolite</span>
0481                 <span class="comment">%includes an electrical potential term</span>
0482                 <span class="comment">% u = u0 + RT*log(activity) + F*zi*chi;</span>
0483         
0484                 R = 8.314472/1000; <span class="comment">% kJ K-1 mol-1</span>
0485                 F = 96.48;     <span class="comment">% Coloumb mol-1</span>
0486                 RT=R*temp;
0487                 nH = <a href="../../setupThermoModel/massBalance/numAtomsOfElementInFormula.html" class="code" title="function N=numAtomsOfElementInFormula(formula,element)">numAtomsOfElementInFormula</a>(model.metFormulas{strcmp(model.mets,<span class="string">'succ[c]'</span>)},<span class="string">'H'</span>);
0488                 
0489                 pH_right   = pHVec(i);
0490                 chi_right  = CHI.e;
0491                 is_right   = IS.e;
0492                 
0493                 <span class="comment">%stoichiometry</span>
0494                 Sj_left  = 0;
0495                 Sj_right = 0;
0496                 si_transport_left  = -1;
0497                 si_transport_right = 1;
0498                 si_charge_inside   = 1;
0499                 
0500                 <span class="comment">%find the right bit of Alberty's data</span>
0501                 bool=strcmp(<span class="string">'succ'</span>,metAbbrAlbertyAbbr(:,2));
0502                 albertyAbbr=metAbbrAlbertyAbbr(bool,3);
0503                 n=find(strcmp(albertyAbbr,albertyAbbrAll));
0504                 
0505                 <span class="comment">%find the number of species within pseudoisomer group</span>
0506                 p=max(find(~isnan(Alberty2006(n).basicData(:,1))));
0507                 [dGf0_right,dHf0_right,mf_right,aveHbound_right,aveZi_right,lambda_right]=<a href="../../setupThermoModel/alberty/calcdGHT.html" class="code" title="function [dGf0,dHf0,mf,aveHbound,aveZi,lambda,gpfnsp]=calcdGHT(dGzero,dHzero,zi,nH,pHr,is,temp,chi,Legendre,LegendreCHI)">calcdGHT</a>(Alberty2006(n).basicData(1:p,1),Alberty2006(n).basicData(1:p,2),Alberty2006(n).basicData(1:p,3),Alberty2006(n).basicData(1:p,4),pH_right,is_right,temp,chi_right,Legendre,LegendreCHI);
0508                 
0509                 <span class="comment">%legendre transform of species</span>
0510                 <span class="comment">%dGft0_species_left  = dGf0i  - nH*(dGf0_H + RT*log(10^-pH_left));</span>
0511                 <span class="comment">%dGft0_species_right = dGf0i  - nH*(dGf0_H + RT*log(10^-pH_right));</span>
0512                 
0513                 <span class="comment">%Standard transformed Gibbs energy of reactant</span>
0514                 dGft0_reactant_left=dGf0_left;
0515                 dGft0_reactant_right=dGf0_right;
0516                 
0517                 dGft02(1,i)=dGf0_H - RT*log(10^-PHR.c);
0518                 dGft02(2,i)=dGf0_H - RT*log(10^-pH_right);
0519                 dGft02(3,i)=dGft0_reactant_left;
0520                 dGft02(4,i)=dGft0_reactant_right;
0521                 
0522                 dGft2(1,i)= dGf0_H + (F*(CHI.e/1000))*zi;
0523                 dGft2(2,i)= dGf0_H + (F*(chi_right/1000))*zi;
0524                 dGft2(3,i)= dGft0_reactant_left   + RT*log(Cj_left);
0525                 dGft2(4,i)= dGft0_reactant_right   + RT*log(Cj_right);
0526                 
0527                 dGt2(i) =    Sj_left*(dGft0_reactant_left + RT*log(Cj_left))   +  si_transport_left*(dGft0_reactant_left   + RT*log(Cj_left)  + nH*(dGf0_H + RT*log(10^-PHR.c )))<span class="keyword">...</span>
0528                     + Sj_right*(dGft0_reactant_right + RT*log(Cj_right)) +  si_transport_right*(dGft0_reactant_right + RT*log(Cj_right) + nH*(dGf0_H + RT*log(10^-pH_right)))<span class="keyword">...</span>
0529                     + F*(-CHI.c + chi_right)*si_charge_inside*zi;
0530                 <span class="keyword">if</span> i==Ni
0531                     pause(eps)
0532                 <span class="keyword">end</span>
0533             <span class="keyword">end</span>
0534             
0535         <span class="keyword">end</span>
0536     <span class="keyword">end</span>
0537 <span class="keyword">end</span>
0538 
0539 <span class="keyword">if</span> Nj==1
0540     <span class="comment">%pH vs delta G</span>
0541     figure;
0542     hold on
0543     plot(pHVec,dGt(:,1,1),<span class="string">'.-b'</span>)
0544     xlabel([<span class="string">'pH['</span> staticCompartment <span class="string">']'</span>])
0545     ylabel(<span class="string">'\Delta G'</span>)
0546     equation=printRxnFormula(model,model.rxns(1),0);
0547     <span class="keyword">if</span> 1
0548         string = {[<span class="string">'pH['</span> variableCompartment <span class="string">'] = '</span> num2str(PHR.c)];[<span class="string">'\Delta \psi = -'</span> num2str(CHI.(variableCompartment)) <span class="string">' mV'</span>]; equation{1}};
0549     <span class="keyword">else</span>
0550         string = equation;
0551     <span class="keyword">end</span>
0552 
0553     <span class="keyword">if</span> strcmp(rxnAbbr,<span class="string">'SUCCt_Jol'</span>)
0554         plot(pHVec,dGt2,<span class="string">'*--r'</span>)
0555         xlabel(<span class="string">'inside pH'</span>)
0556 
0557         <span class="keyword">if</span> 1
0558             string = {[<span class="string">'pH[out] = '</span> num2str(PHR.c)];[<span class="string">'\Delta \psi = '</span> num2str(CHI.c) <span class="string">' mV'</span>]; equation{1}};
0559         <span class="keyword">else</span>
0560             string = equation;
0561         <span class="keyword">end</span>
0562 
0563         disp(model.metFormulas{1})
0564         disp(equation)
0565         model.mets
0566 
0567         <span class="keyword">if</span> 1
0568             dGft0
0569             dGft02
0570             dGft
0571             dGft2
0572         <span class="keyword">end</span>
0573     <span class="keyword">end</span>
0574     pause(eps)
0575 
0576     title(string)
0577 <span class="keyword">else</span>
0578     <span class="comment">%pH, chi, deltaG</span>
0579     figure;
0580     hold on;
0581     surf(pHVec,chiVec,dGt(:,:,1))
0582     xlabel(<span class="string">'pH[e]'</span>)
0583     ylabel(<span class="string">'\Delta \psi'</span>)
0584     zlabel(<span class="string">'\Delta G (kJ/mol)'</span>)
0585     <span class="comment">%box on</span>
0586     grid on
0587 <span class="keyword">end</span>
0588     
0589     
0590 
0591</pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>