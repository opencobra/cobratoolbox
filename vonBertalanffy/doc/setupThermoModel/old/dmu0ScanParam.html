<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of dmu0ScanParam</title>
  <meta name="keywords" content="dmu0ScanParam">
  <meta name="description" content="plot the standard transformed reaction Gibbs energy  as a function">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html old -->
<h1>dmu0ScanParam
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>plot the standard transformed reaction Gibbs energy  as a function</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [dmu0,T,PH,IS]=dmu0ScanParam(scanParam,METDATA,modelT,rxnAbbr) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> plot the standard transformed reaction Gibbs energy  as a function
 of temperture, ionic strength, and pH</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [dmu0,T,PH,IS]=dmu0ScanParam(scanParam,METDATA,modelT,rxnAbbr)</a>
0002 <span class="comment">% plot the standard transformed reaction Gibbs energy  as a function</span>
0003 <span class="comment">% of temperture, ionic strength, and pH</span>
0004 
0005 [mlt,nlt,olt]=size(scanParam);
0006 
0007 Sj=modelT.S(:,strcmp(modelT.rxns,rxnAbbr));
0008 
0009 [nMet,nRxn]=size(modelT.S);
0010 
0011 dmu0=zeros(mlt,nlt,olt);
0012 T=zeros(1,mlt);
0013 IS=zeros(1,nlt);
0014 PH=zeros(1,olt);
0015 <span class="keyword">for</span> m=1:mlt
0016     <span class="keyword">for</span> n=1:nlt
0017         <span class="keyword">for</span> o=1:olt
0018             T(1,m)=scanParam{m,n,o}.temp;
0019             IS(1,n)=scanParam{m,n,o}.is;
0020             PH(1,o)=scanParam{m,n,o}.pHa;
0021             mu0=zeros(1,nMet);
0022             met=METDATA{m,n,o};
0023             <span class="keyword">if</span> ~isempty(met)
0024                 <span class="keyword">for</span> x=1:nMet
0025                     mu0(1,x)=(met(x).mu0Min+met(x).mu0Max)/2;
0026                 <span class="keyword">end</span>
0027                 dmu0(m,n,o)=mu0*Sj;
0028             <span class="keyword">else</span>
0029                 dmu0(m,n,o)=NaN;
0030             <span class="keyword">end</span>
0031         <span class="keyword">end</span>
0032     <span class="keyword">end</span>
0033 <span class="keyword">end</span>
0034 
0035 <span class="comment">% D=reshape(dmu0(20,:,:),20,20);</span>
0036 <span class="comment">% %temp 311.15</span>
0037 <span class="comment">% for n=1:nlt</span>
0038 <span class="comment">%     for o=1:olt</span>
0039 <span class="comment">%         D(n,o)=exp(dmu0(20,n,o)/(modelT.gasConstant*311.15));</span>
0040 <span class="comment">%     end</span>
0041 <span class="comment">% end</span>
0042 <span class="comment">% figure</span>
0043 <span class="comment">% surf(PH,IS,D,'EdgeColor','none');</span>
0044 <span class="comment">% xlabel('pH','FontSize',12)</span>
0045 <span class="comment">% ylabel('ionic strength (mol L^{-1})','FontSize',12)</span>
0046 <span class="comment">% zlabel('\Delta_{r}G^{\primeo} (kJ mol^{-1})','FontSize',12)</span>
0047 <span class="comment">% title('Standard transformed Gibbs energy of formation $\n$ as a function of pH and ionic strength','FontSize',12)</span>
0048 <span class="comment">% shading interp</span>
0049 <span class="comment">%</span>
0050 <span class="comment">% %pH 7.6</span>
0051 <span class="comment">% D=reshape(dmu0(20,:,:),20,20);</span>
0052 <span class="comment">% for m=1:mlt</span>
0053 <span class="comment">%     for o=1:olt</span>
0054 <span class="comment">%         D(m,o)=exp(dmu0(m,14,o)/(modelT.gasConstant*T(m)));</span>
0055 <span class="comment">%     end</span>
0056 <span class="comment">% end</span>
0057 <span class="comment">% figure;</span>
0058 <span class="comment">% surf(T,IS,D,'EdgeColor','none');</span>
0059 <span class="comment">% xlabel('temp (K)','FontSize',12)</span>
0060 <span class="comment">% ylabel('ionic strength (mol L^{-1})','FontSize',12)</span>
0061 <span class="comment">% zlabel('\Delta_{r}G^{\primeo} (kJ mol^{-1})','FontSize',12)</span>
0062 <span class="comment">% title('Standard transformed Gibbs energy of formation $\n$ as a function of temperature and ionic strength','FontSize',12)</span>
0063 <span class="comment">% shading interp</span>
0064 
0065 rxn=modelT.rxnNames{strcmp(rxnAbbr,modelT.rxns)};
0066 <span class="comment">%equilibrium constants</span>
0067 <span class="comment">% D=reshape(dmu0(20,:,:),20,20);</span>
0068 <span class="comment">%temp 311.15</span>
0069 D=zeros(nlt,olt);
0070 <span class="keyword">for</span> n=1:nlt
0071     <span class="keyword">for</span> o=1:olt
0072         D(n,o)=exp(dmu0(20,n,o)/(modelT.gasConstant*T(20)));
0073     <span class="keyword">end</span>
0074 <span class="keyword">end</span>
0075 <span class="comment">% surf(X,Y,Z)  creates a shaded surface using Z for the color data as well</span>
0076 <span class="comment">% as surface height.</span>
0077 <span class="comment">% If X and Y are vectors, length(X) = n and length(Y) = m, where [m,n] = size(Z).</span>
0078 <span class="comment">% In this case, the vertices of the surface faces are (X(j), Y(i), Z(i,j)) triples.</span>
0079 figure
0080 surf(PH,IS,D,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);<span class="comment">%(X(j), Y(i), Z(i,j)) triples</span>
0081 xlabel(<span class="string">'pH'</span>,<span class="string">'FontSize'</span>,12)
0082 xlim([min(PH) max(PH)])
0083 ylabel(<span class="string">'ionic strength (mol L^{-1})'</span>,<span class="string">'FontSize'</span>,12)
0084 ylim([min(IS) max(IS)])
0085 zlabel(<span class="string">'K\prime'</span>,<span class="string">'FontSize'</span>,12)
0086 title({rxn,<span class="string">'Apparent Equilibrium constant as a function of'</span>,<span class="string">'pH and ionic strength. (311.15 K)'</span>},<span class="string">'FontSize'</span>,12)
0087 shading interp
0088 
0089 <span class="comment">%pH 7.6</span>
0090 <span class="comment">% D=reshape(dmu0(20,:,:),20,20);</span>
0091 D2=zeros(mlt,olt);
0092 <span class="keyword">for</span> m=1:mlt
0093     <span class="keyword">for</span> o=1:olt
0094         D2(m,o)=exp(dmu0(m,o,14)/(modelT.gasConstant*T(m)));
0095     <span class="keyword">end</span>
0096 <span class="keyword">end</span>
0097 figure;
0098 surf(IS,T,D2,<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);<span class="comment">%(X(j), Y(i), Z(i,j)) triples</span>
0099 xlabel(<span class="string">'ionic strength (mol L^{-1})'</span>,<span class="string">'FontSize'</span>,12)
0100 xlim([min(IS) max(IS)])
0101 ylabel(<span class="string">'temp (K)'</span>,<span class="string">'FontSize'</span>,12)
0102 ylim([min(T) max(T)])
0103 zlabel(<span class="string">'K\prime'</span>,<span class="string">'FontSize'</span>,12)
0104 title({rxn,<span class="string">'Apparent Equilibrium constant as a function of'</span>,<span class="string">' temperature and ionic strength. (pH 7.6)'</span>},<span class="string">'FontSize'</span>,12)
0105 shading interp
0106 
0107 <span class="comment">%all three</span>
0108 
0109</pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>