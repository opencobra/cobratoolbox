<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of directionalityCheckAll</title>
  <meta name="keywords" content="directionalityCheckAll">
  <meta name="description" content="Analysis of differences between qualitative and quantiative directionality assignments.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html directionalityReport -->
<h1>directionalityCheckAll
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Analysis of differences between qualitative and quantiative directionality assignments.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function directions=directionalityCheckAll(model,cumNormProbCutoff,thorStandard,printToFile,printToTable,figures) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Analysis of differences between qualitative and quantiative directionality assignments.

 assess reaction directionality, perhaps also print changed directions, and
 optionally generate figures

INPUT
 model
 cumNormProbCutoff     {0.1} positive real number between 0 and 0.5 that
                       specifies to tolerance when there is uncertainty in group
                       contribution estimates.
OPTIONAL INPUT
 thorStandard          {0,(1)} use new standard reactant concentration
                       half way between upper and lower concentration bounds
 printToFile           {0,(1)} Boolean. 1=print out to log file
 printToTable          {0,(1)} Boolean. 1=print changes to a table (for publication)
 figures               {(0),1} Boolean. 1=create figures illustrating
                       changed directions

OUTPUT
 directions    a structue of boolean vectors with different directionality 
               assignments where some vectors contain subsets of others

 qualitatively assigned directions 
   directions.fwdReconBool
   directions.revReconBool
   directions.reversibleReconBool

 qualitatively assigned directions using thermo in preference to
 qualitative assignments but using qualitative assignments where
 thermodynamic data is lacking
   directions.fwdReconThermoBool
   directions.revReconThermoBool
   directions.reversibleReconThermoBool

 reactions that are qualitatively assigned by thermodynamics
 directions.fwdThermoOnlyBool
 directions.revThermoOnlyBool
 directions.reversibleThermoOnlyBool

 qualtiative -&gt; quantiative changed reaction directions 
 directions.ChangeReversibleFwd
 directions.ChangeReversibleRev
 directions.ChangeForwardReverse
 directions.ChangeForwardReversible

 subsets of forward qualtiative -&gt; reversible quantiative change
   directions.ChangeForwardReversibleBool_dGfGC
   directions.ChangeForwardReversibleBool_dGfGC_byConcLHS
   directions.ChangeForwardReversibleBool_dGfGC_byConcRHS
   directions.ChangeForwardReversibleBool_dGfGC_bydGt0
   directions.ChangeForwardReversibleBool_dGfGC_bydGt0LHS
   directions.ChangeForwardReversibleBool_dGfGC_bydGt0Mid
   directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS
   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorLHS
   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS

   directions.cumNormProbCutoff
   directions.ChangeForwardForwardBool_dGfGC


 Ronan M.T. Fleming</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="directionalityCheck.html" class="code" title="function directionalityCheck(model,directions,printToFile,printToTable)">directionalityCheck</a>	identification of metabolites involved in reactions with changed</li><li><a href="directionalityStatFigures.html" class="code" title="function directionalityStatFigures(directions,figures)">directionalityStatFigures</a>	creates pie charts of directionality stats</li><li><a href="directionalityStats.html" class="code" title="function directions=directionalityStats(model,cumNormProbCutoff,thorStandard,printToFile)">directionalityStats</a>	Build Boolean vectors with reaction directionality statistics</li><li><a href="forwardProbablyReverseFigures.html" class="code" title="function forwardProbablyReverseFigures(model,directions,miliMolarStandard)">forwardProbablyReverseFigures</a>	figure of qualitatively forward reactions that are probably quantiatively reverse</li><li><a href="forwardReversibleFiguresGC.html" class="code" title="function forwardReversibleFiguresGC(model,directions,thorStandard)">forwardReversibleFiguresGC</a>	Figures of different classes of reactions: qualitatively forward -> quantitatively reversible</li><li><a href="forwardReversibleFiguresKeq.html" class="code" title="function forwardReversibleFiguresKeq(model,directions,thorStandard)">forwardReversibleFiguresKeq</a>	Figure of qualitatively forward -> quantitatively reversible (keq)</li><li><a href="forwardTransportQuantReverseFigures.html" class="code" title="function forwardTransportQuantReverseFigures(model,directions,thorStandard)">forwardTransportQuantReverseFigures</a>	figure of the qualitatively forward transport reactions that are quantitatively reversible</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../setupThermoModel/setupThermoModel.html" class="code" title="function [modelT,directions,solutionThermoRecon]=setupThermoModel(model,metAbbrAlbertyAbbr,metGroupCont,Alberty2006,computedSpeciesData,temp,PHA,IS,CHI,biomassRxnAbbr,rxnAbbrDatabaseID,defaultMetBounds,metBoundsFile,rxnBoundsFile,Legendre,useKeqData,nStdDevGroupCont,cumNormProbCutoff,figures,printToFile,secondPassAssignment)">setupThermoModel</a>	Thermodynamically constrains a COBRA model.</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function directions=directionalityCheckAll(model,cumNormProbCutoff,thorStandard,printToFile,printToTable,figures)</a>
0002 <span class="comment">% Analysis of differences between qualitative and quantiative directionality assignments.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% assess reaction directionality, perhaps also print changed directions, and</span>
0005 <span class="comment">% optionally generate figures</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%INPUT</span>
0008 <span class="comment">% model</span>
0009 <span class="comment">% cumNormProbCutoff     {0.1} positive real number between 0 and 0.5 that</span>
0010 <span class="comment">%                       specifies to tolerance when there is uncertainty in group</span>
0011 <span class="comment">%                       contribution estimates.</span>
0012 <span class="comment">%OPTIONAL INPUT</span>
0013 <span class="comment">% thorStandard          {0,(1)} use new standard reactant concentration</span>
0014 <span class="comment">%                       half way between upper and lower concentration bounds</span>
0015 <span class="comment">% printToFile           {0,(1)} Boolean. 1=print out to log file</span>
0016 <span class="comment">% printToTable          {0,(1)} Boolean. 1=print changes to a table (for publication)</span>
0017 <span class="comment">% figures               {(0),1} Boolean. 1=create figures illustrating</span>
0018 <span class="comment">%                       changed directions</span>
0019 <span class="comment">%</span>
0020 <span class="comment">%OUTPUT</span>
0021 <span class="comment">% directions    a structue of boolean vectors with different directionality</span>
0022 <span class="comment">%               assignments where some vectors contain subsets of others</span>
0023 <span class="comment">%</span>
0024 <span class="comment">% qualitatively assigned directions</span>
0025 <span class="comment">%   directions.fwdReconBool</span>
0026 <span class="comment">%   directions.revReconBool</span>
0027 <span class="comment">%   directions.reversibleReconBool</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% qualitatively assigned directions using thermo in preference to</span>
0030 <span class="comment">% qualitative assignments but using qualitative assignments where</span>
0031 <span class="comment">% thermodynamic data is lacking</span>
0032 <span class="comment">%   directions.fwdReconThermoBool</span>
0033 <span class="comment">%   directions.revReconThermoBool</span>
0034 <span class="comment">%   directions.reversibleReconThermoBool</span>
0035 <span class="comment">%</span>
0036 <span class="comment">% reactions that are qualitatively assigned by thermodynamics</span>
0037 <span class="comment">% directions.fwdThermoOnlyBool</span>
0038 <span class="comment">% directions.revThermoOnlyBool</span>
0039 <span class="comment">% directions.reversibleThermoOnlyBool</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% qualtiative -&gt; quantiative changed reaction directions</span>
0042 <span class="comment">% directions.ChangeReversibleFwd</span>
0043 <span class="comment">% directions.ChangeReversibleRev</span>
0044 <span class="comment">% directions.ChangeForwardReverse</span>
0045 <span class="comment">% directions.ChangeForwardReversible</span>
0046 <span class="comment">%</span>
0047 <span class="comment">% subsets of forward qualtiative -&gt; reversible quantiative change</span>
0048 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC</span>
0049 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConcLHS</span>
0050 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConcRHS</span>
0051 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_bydGt0</span>
0052 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_bydGt0LHS</span>
0053 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_bydGt0Mid</span>
0054 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS</span>
0055 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorLHS</span>
0056 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS</span>
0057 <span class="comment">%</span>
0058 <span class="comment">%   directions.cumNormProbCutoff</span>
0059 <span class="comment">%   directions.ChangeForwardForwardBool_dGfGC</span>
0060 <span class="comment">%</span>
0061 <span class="comment">%</span>
0062 <span class="comment">% Ronan M.T. Fleming</span>
0063 
0064 <span class="keyword">if</span> ~exist(<span class="string">'cumNormProbCutoff'</span>,<span class="string">'var'</span>)
0065     cumNormProbCutoff=0.1;
0066 <span class="keyword">else</span>
0067     <span class="keyword">if</span> cumNormProbCutoff&lt;0
0068         error(<span class="string">'cumNormProbCutoff cannot be less than zero'</span>)
0069     <span class="keyword">end</span>
0070 <span class="keyword">end</span>
0071 <span class="keyword">if</span> ~exist(<span class="string">'thorStandard'</span>,<span class="string">'var'</span>)
0072     thorStandard=1;
0073 <span class="keyword">end</span>
0074     
0075 <span class="comment">%statistics of directions</span>
0076 directions=<a href="directionalityStats.html" class="code" title="function directions=directionalityStats(model,cumNormProbCutoff,thorStandard,printToFile)">directionalityStats</a>(model,cumNormProbCutoff,thorStandard,printToFile);
0077 
0078 <span class="comment">%print out problematic reactions in structured format</span>
0079 <span class="keyword">if</span> ~exist(<span class="string">'printToFile'</span>,<span class="string">'var'</span>)
0080     printToFile=1;
0081 <span class="keyword">end</span>
0082 <span class="comment">%print out problematic reactions in summary table format for paper</span>
0083 <span class="keyword">if</span> ~exist(<span class="string">'printToTable'</span>,<span class="string">'var'</span>)
0084     printToTable=1;
0085 <span class="keyword">end</span>
0086 
0087 <a href="directionalityCheck.html" class="code" title="function directionalityCheck(model,directions,printToFile,printToTable)">directionalityCheck</a>(model,directions,printToFile,printToTable)
0088 
0089 <span class="keyword">if</span> ~exist(<span class="string">'figures'</span>,<span class="string">'var'</span>)
0090     figures=0;
0091 <span class="keyword">end</span>
0092 <span class="keyword">if</span> figures
0093     <span class="comment">%pie charts with proportions of reaction directionalities and changes in</span>
0094     <span class="comment">%directionality</span>
0095     fprintf(<span class="string">'\n%s\n'</span>,<span class="string">'...directionalityStatFigures'</span>);
0096     <a href="directionalityStatFigures.html" class="code" title="function directionalityStatFigures(directions,figures)">directionalityStatFigures</a>(directions,figures)
0097 
0098     <span class="comment">%figures of reaction directionality changes</span>
0099     <span class="comment">%qualitatively forward now quantiatiavely reversible</span>
0100     <span class="keyword">if</span> any(directions.ChangeForwardReversibleBool_dGfGC)
0101         <a href="forwardReversibleFiguresGC.html" class="code" title="function forwardReversibleFiguresGC(model,directions,thorStandard)">forwardReversibleFiguresGC</a>(model,directions,thorStandard)
0102     <span class="keyword">end</span>
0103     
0104     <span class="comment">%make figure of  reactions that have changed from qualitatively forward</span>
0105     <span class="comment">%to quantitatively reversible, where all metabolites dGt0 were back</span>
0106     <span class="comment">%calculated from Keq.</span>
0107     <span class="comment">%omit those reactions that are transport reactions</span>
0108     <span class="keyword">if</span> any(directions.ChangeForwardReversible_dGfKeq)
0109         <a href="forwardReversibleFiguresKeq.html" class="code" title="function forwardReversibleFiguresKeq(model,directions,thorStandard)">forwardReversibleFiguresKeq</a>(model,directions,thorStandard)
0110     <span class="keyword">end</span>
0111     
0112     <span class="comment">%create a vertical errorbar figure of the qualitatively forward transport reactions</span>
0113     <span class="comment">%that are quantitatively reverseible, whether from group contribution or</span>
0114     <span class="comment">%Keq, that then need to be assigned to be forward, to limit the growth rate</span>
0115     <span class="comment">% i.e. abc transporters or reactions involving protons</span>
0116     <span class="keyword">if</span> any(directions.ChangeForwardReversible &amp; model.transportRxnBool)
0117         <a href="forwardTransportQuantReverseFigures.html" class="code" title="function forwardTransportQuantReverseFigures(model,directions,thorStandard)">forwardTransportQuantReverseFigures</a>(model,directions,thorStandard)
0118     <span class="keyword">end</span>
0119     
0120     <span class="comment">%vertical errorbar of qualitatively forward but quantitatively reverse</span>
0121     <span class="comment">%forward, probably reverse</span>
0122     fwdProbReverse=directions.ChangeForwardReversibleBool_dGfGC_byConcRHS | <span class="keyword">...</span>
0123     directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS | <span class="keyword">...</span>
0124     directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS;
0125     <span class="keyword">if</span> any(fwdProbReverse)  
0126         <a href="forwardProbablyReverseFigures.html" class="code" title="function forwardProbablyReverseFigures(model,directions,miliMolarStandard)">forwardProbablyReverseFigures</a>(model,directions,thorStandard)
0127     <span class="keyword">end</span>
0128 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>