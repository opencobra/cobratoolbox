<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of forwardReversibleFiguresGC</title>
  <meta name="keywords" content="forwardReversibleFiguresGC">
  <meta name="description" content="Figures of different classes of reactions: qualitatively forward -> quantitatively reversible">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html directionalityReport -->
<h1>forwardReversibleFiguresGC
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Figures of different classes of reactions: qualitatively forward -> quantitatively reversible</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function forwardReversibleFiguresGC(model,directions,thorStandard) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Figures of different classes of reactions: qualitatively forward -&gt; quantitatively reversible

INPUT
model
 
 directions must have the fields below:
   directions.ChangeForwardReversibleBool_dGfGC;
   directions.ChangeForwardReversibleBool_dGfGC_byConcLHS;
   directions.ChangeForwardReversibleBool_dGfGC_byConcRHS;
   directions.ChangeForwardReversibleBool_dGfGC_bydGt0;
   directions.ChangeForwardReversibleBool_dGfGC_bydGt0Mid;
   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorLHS;
   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS;

 thorStandard          {(0),1} use new standard reactant concentration
                       half way between upper and lower concentration
                       bounds

 Ronan M.T. Fleming</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="directionalityCheckAll.html" class="code" title="function directions=directionalityCheckAll(model,cumNormProbCutoff,thorStandard,printToFile,printToTable,figures)">directionalityCheckAll</a>	Analysis of differences between qualitative and quantiative directionality assignments.</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function forwardReversibleFiguresGC(model,directions,thorStandard)</a>
0002 <span class="comment">% Figures of different classes of reactions: qualitatively forward -&gt; quantitatively reversible</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%INPUT</span>
0005 <span class="comment">%model</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% directions must have the fields below:</span>
0008 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC;</span>
0009 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConcLHS;</span>
0010 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConcRHS;</span>
0011 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_bydGt0;</span>
0012 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_bydGt0Mid;</span>
0013 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorLHS;</span>
0014 <span class="comment">%   directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS;</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% thorStandard          {(0),1} use new standard reactant concentration</span>
0017 <span class="comment">%                       half way between upper and lower concentration</span>
0018 <span class="comment">%                       bounds</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% Ronan M.T. Fleming</span>
0021 
0022 <span class="comment">%all forward reversible classes</span>
0023 <span class="comment">% forwardReversible=directions.ChangeForwardReversible;</span>
0024 dGfGCforwardReversibleBool=directions.ChangeForwardReversibleBool_dGfGC;
0025 dGfGCforwardReversibleBool_byConcLHS=directions.ChangeForwardReversibleBool_dGfGC_byConcLHS;
0026 dGfGCforwardReversibleBool_byConcRHS=directions.ChangeForwardReversibleBool_dGfGC_byConcRHS;
0027 dGfGCforwardReversibleBool_bydGt0=directions.ChangeForwardReversibleBool_dGfGC_bydGt0;
0028 <span class="comment">% dGfGCforwardReversibleBool_bydGt0LHS=directions.ChangeForwardReversibleBool_dGfGC_bydGt0LHS;</span>
0029 dGfGCforwardReversibleBool_bydGt0Mid=directions.ChangeForwardReversibleBool_dGfGC_bydGt0Mid;
0030 <span class="comment">% dGfGCforwardReversibleBool_bydGt0RHS=directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS;</span>
0031 dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS=directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorLHS;
0032 dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS=directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS;
0033 
0034 <span class="comment">% thorStandard</span>
0035 
0036 <span class="comment">% close all</span>
0037 figureMaster=1;
0038 figure1=1;
0039 figure2=1;
0040 figure345=1;
0041 figure6=1;
0042 figure7=1;
0043 
0044 [nMet,nRxn]=size(model.S);
0045 <span class="keyword">if</span> thorStandard
0046     dGt0Min=model.dGt0Min;
0047     dGt0Max=model.dGt0Max;
0048     <span class="keyword">for</span> n=1:nRxn
0049         model.dGt0Min(n)=model.rxn(n).dGtmMMin;
0050         model.dGt0Max(n)=model.rxn(n).dGtmMMax;
0051     <span class="keyword">end</span>
0052 <span class="keyword">end</span>
0053 
0054 
0055 <span class="keyword">if</span> figureMaster
0056     <span class="comment">%make the master plot of all 7 regions, 2, 4,6 are shaded</span>
0057     X1=1:nRxn;<span class="comment">%nnz(dGfGCforwardReversibleBool);</span>
0058     <span class="comment">%dGrt0</span>
0059     Y0=(model.dGt0Min+model.dGt0Max)/2;
0060     L0=Y0-model.dGt0Min;
0061     U0=model.dGt0Max-Y0;
0062     <span class="comment">%dGrt</span>
0063     Y=(model.dGtMin+model.dGtMax)/2;
0064     L=Y-model.dGtMin;
0065     U=model.dGtMax-Y;
0066     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0067     <span class="comment">%range of dGt0</span>
0068     P = normcdf(0,Y0,L0);
0069     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0070     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0071     
0072     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0073     <span class="comment">%     take them in order of descending P</span>
0074     xip2=zeros(nnz(dGfGCforwardReversibleBool),1);
0075     p=1;
0076     <span class="keyword">for</span> n=1:nRxn
0077         <span class="keyword">if</span> dGfGCforwardReversibleBool(xip(n))
0078             xip2(p)=xip(n);
0079             p=p+1;
0080         <span class="keyword">end</span>
0081     <span class="keyword">end</span>
0082     xip=xip2;
0083     X1=1:length(xip);
0084     
0085     <span class="comment">%replace the NaN due to zero st dev</span>
0086     nNaNpLHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS);
0087     nNaNpRHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS);
0088     <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(dGfGCforwardReversibleBool))))
0089         error(<span class="string">'Extra category of NaN P(\Delta_{r}G^{\primem}&lt;0) not taken into account'</span>);
0090     <span class="keyword">end</span>
0091     <span class="comment">%nans are first in the ordering of indexes</span>
0092     NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0093     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0094     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0095     <span class="comment">%new ordering</span>
0096     xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0097        
0098     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0099     <span class="comment">% Create axes</span>
0100     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0101     hold on;
0102     <span class="comment">%upper and lower Y</span>
0103     minY=min(model.dGtMin(dGfGCforwardReversibleBool));
0104     maxY=max(model.dGtMax(dGfGCforwardReversibleBool));
0105     <span class="comment">%baselines</span>
0106     PreversibleBar_byConcLHS=ones(1,nRxn)*minY;
0107     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0108     PreversibleBar_bydGt0=ones(1,nRxn)*minY;
0109     <span class="comment">%bar for 2 &amp; 6</span>
0110     PreversibleBar_byConcLHS(dGfGCforwardReversibleBool_byConcLHS)=maxY;
0111     PreversibleBar_byConcRHS(dGfGCforwardReversibleBool_byConcRHS)=maxY;
0112     <span class="comment">%bar for 4</span>
0113     PreversibleBar_bydGt0(dGfGCforwardReversibleBool_bydGt0Mid)=maxY;
0114     bar_handle2=bar(X1,PreversibleBar_byConcLHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0115     bar_handle4=bar(X1,PreversibleBar_bydGt0(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0116     bar_handle6=bar(X1,PreversibleBar_byConcRHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0117     
0118     <span class="comment">%dGrt errorbar</span>
0119     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0120     <span class="comment">% adjust error bar width</span>
0121     hE_c=get(hE, <span class="string">'Children'</span>);
0122     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0123     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0124     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0125     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0126     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0127     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0128     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0129     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0130     <span class="comment">% adjust error bar width</span>
0131     hE_c=get(hE2, <span class="string">'Children'</span>);
0132     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0133     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0134     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0135     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0136     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0137     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0138     
0139     <span class="comment">%mean dGrt0</span>
0140     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0141     <span class="comment">%zero line</span>
0142     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0143     <span class="comment">%normal distribution about the mean dGt0</span>
0144     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0145     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:100:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0146     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0147     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0148     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0149     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0150     <span class="comment">%axis limits</span>
0151     <span class="comment">%     axis(AX(1),[0 length(X1) minY maxY])</span>
0152     axis(AX(1),[0 length(X1) -500 500]);
0153     set(AX(1),<span class="string">'FontSize'</span>,16)
0154     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0155     axis(AX(2),[0 length(X1) 0 1])
0156     title(<span class="string">'Qualitatively forward, but quantitatively reversible using group contribution estimates of \Delta_{r}G^{\primem}.'</span>,<span class="string">'FontSize'</span>,16)
0157     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0158     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0159     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0160     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0161     xlabel(<span class="string">'Reactions, sorted by \Delta_{r}G^{\primem} or P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0162     saveas(figure1 ,<span class="string">'fwdReversibleGC'</span>,<span class="string">'fig'</span>);
0163 <span class="comment">%     saveas(figure1 ,'GCfwdReversible','eps');</span>
0164 <span class="keyword">end</span>
0165 
0166 <span class="comment">%qualitatively forward reactions that are quantitatively</span>
0167 <span class="comment">%reversible by concentration alone (no dGt0 error)</span>
0168 <span class="comment">% fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS),' qualitatively forward reactions that are GC quantitatively forward by dGr0t, but reversible by concentration alone (No error in GC dGr0t).');</span>
0169 <span class="keyword">if</span> figure1 &amp;&amp; any(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS)
0170     <span class="comment">%make the master plot of all 7 regions, 2, 4,6 are shaded</span>
0171     X1=1:nRxn;<span class="comment">%nnz(dGfGCforwardReversibleBool);</span>
0172     <span class="comment">%dGrt0</span>
0173     Y0=(model.dGt0Min+model.dGt0Max)/2;
0174     L0=Y0-model.dGt0Min;
0175     U0=model.dGt0Max-Y0;
0176     <span class="comment">%dGrt</span>
0177     Y=(model.dGtMin+model.dGtMax)/2;
0178     L=Y-model.dGtMin;
0179     U=model.dGtMax-Y;
0180     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0181     <span class="comment">%range of dGt0</span>
0182     P = normcdf(0,Y0,L0);
0183     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0184     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0185     
0186     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0187     <span class="comment">%     take them in order of descending P</span>
0188     xip2=zeros(nnz(dGfGCforwardReversibleBool),1);
0189     p=1;
0190     <span class="keyword">for</span> n=1:nRxn
0191         <span class="keyword">if</span> dGfGCforwardReversibleBool(xip(n))
0192             xip2(p)=xip(n);
0193             p=p+1;
0194         <span class="keyword">end</span>
0195     <span class="keyword">end</span>
0196     xip=xip2;
0197     X1=1:length(xip);
0198     
0199     <span class="comment">%replace the NaN due to zero st dev</span>
0200     nNaNpLHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS);
0201     nNaNpRHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS);
0202     <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(dGfGCforwardReversibleBool))))
0203         warning(<span class="string">'ExtraCategory'</span>);
0204     <span class="keyword">end</span>
0205     <span class="comment">%nans are first in the ordering of indexes</span>
0206     NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0207     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0208     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0209     <span class="comment">%new ordering</span>
0210     xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0211     <span class="comment">%     xip=xip(nNaNpLHS+nNaNpRHS+1:end);</span>
0212     
0213     <span class="comment">%reactions that cannot be assigned directionality</span>
0214     <span class="comment">%cuttoff for probabilities: must be reflective about 0.5;</span>
0215 <span class="comment">%     dGfGCforwardReversibleBool_bydGt0Mid=P&lt;0.6 &amp; P&gt;0.4 &amp; dGfGCforwardReversibleBool;</span>
0216     
0217     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0218     <span class="comment">%     take them in order of descending P</span>
0219     xip2=zeros(nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS),1);
0220     p=1;
0221     <span class="keyword">for</span> n=1:length(xip)
0222         <span class="keyword">if</span> dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS(xip(n))
0223             xip2(p)=xip(n);
0224             p=p+1;
0225         <span class="keyword">end</span>
0226     <span class="keyword">end</span>
0227     xip=xip2;
0228     X1=1:length(xip);
0229     
0230     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0231     <span class="comment">% Create axes</span>
0232     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0233     hold on;
0234     <span class="comment">%upper and lower Y</span>
0235     minY=min(model.dGtMin(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS));
0236     maxY=max(model.dGtMax(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS));
0237     <span class="comment">%baselines</span>
0238     PreversibleBar_byConcLHS=ones(1,nRxn)*minY;
0239     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0240     PreversibleBar_bydGt0=ones(1,nRxn)*minY;
0241     <span class="comment">%bar for 2 &amp; 6</span>
0242     PreversibleBar_byConcLHS(dGfGCforwardReversibleBool_byConcLHS)=maxY;
0243     bar_handle2=bar(X1,PreversibleBar_byConcLHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0244    
0245     <span class="comment">%dGrt errorbar</span>
0246     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,9,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0247     <span class="comment">% adjust error bar width</span>
0248     hE_c=get(hE, <span class="string">'Children'</span>);
0249     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0250     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0251     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0252     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0253     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0254     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0255     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0256     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,9,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0257     <span class="comment">% adjust error bar width</span>
0258     hE_c=get(hE2, <span class="string">'Children'</span>);
0259     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0260     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0261     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0262     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0263     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0264     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0265     
0266     <span class="comment">%mean dGrt0</span>
0267     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,20,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0268     <span class="comment">%zero line</span>
0269     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0270     <span class="comment">%normal distribution about the mean dGt0</span>
0271     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0272     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:20:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0273     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0274     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0275     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0276     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0277     <span class="comment">%axis limits</span>
0278 <span class="comment">%     axis(AX(1),[0 length(X1) minY maxY])</span>
0279     axis(AX(1),[0 length(X1) -200 200]);
0280     set(AX(1),<span class="string">'FontSize'</span>,16)
0281     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0282     axis(AX(2),[0 length(X1) 0 1])
0283     title({<span class="string">'Qualitatively forward, but quantitatively reversible. Exact negative \Delta_{r}G^{\primem},'</span>;<span class="keyword">...</span>
0284             <span class="string">'but with a quantitatively reversible concentration range.'</span>},<span class="string">'FontSize'</span>,16)
0285     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0286     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0287     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0288     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0289     xlabel(<span class="string">'Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0290 <span class="keyword">end</span>
0291 
0292 <span class="comment">%qualitatively reverse reactions that are quantitatively</span>
0293 <span class="comment">%reversible by concentration alone (no dGt0 error)</span>
0294 <span class="comment">% fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS),' qualitatively forward reactions that are GC quantitatively reverse by dGr0t, but reversible by concentration.(No error in GC dGr0t).');</span>
0295 <span class="keyword">if</span> figure7 &amp;&amp; any(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS)
0296     X1=1:nRxn;
0297     <span class="comment">%dGrt0</span>
0298     Y0=(model.dGt0Min+model.dGt0Max)/2;
0299     L0=Y0-model.dGt0Min;
0300     U0=model.dGt0Max-Y0;
0301     <span class="comment">%dGrt</span>
0302     Y=(model.dGtMin+model.dGtMax)/2;
0303     L=Y-model.dGtMin;
0304     U=model.dGtMax-Y;
0305     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0306     <span class="comment">%range of dGt0</span>
0307     P = normcdf(0,Y0,L0);
0308     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0309     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0310     
0311     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0312     <span class="comment">%     take them in order of descending P</span>
0313     xip2=zeros(nnz(dGfGCforwardReversibleBool),1);
0314     p=1;
0315     <span class="keyword">for</span> n=1:nRxn
0316         <span class="keyword">if</span> dGfGCforwardReversibleBool(xip(n))
0317             xip2(p)=xip(n);
0318             p=p+1;
0319         <span class="keyword">end</span>
0320     <span class="keyword">end</span>
0321     xip=xip2;
0322     X1=1:length(xip);
0323     
0324     <span class="comment">%replace the NaN due to zero st dev</span>
0325     nNaNpLHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS);
0326     nNaNpRHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS);
0327     <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(dGfGCforwardReversibleBool))))
0328         warning(<span class="string">'ExtraCategory'</span>);
0329     <span class="keyword">end</span>
0330     <span class="comment">%nans are first in the ordering of indexes</span>
0331     NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0332     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0333     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0334     <span class="comment">%new ordering</span>
0335     xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0336     <span class="comment">%     xip=xip(nNaNpLHS+nNaNpRHS+1:end);</span>
0337     
0338     <span class="comment">%reactions that cannot be assigned directionality</span>
0339     <span class="comment">%cuttoff for probabilities: must be reflective about 0.5;</span>
0340 <span class="comment">%     dGfGCforwardReversibleBool_bydGt0Mid=P&lt;0.6 &amp; P&gt;0.4 &amp; dGfGCforwardReversibleBool;</span>
0341     
0342     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0343     <span class="comment">%     take them in order of descending P</span>
0344     xip2=zeros(nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS),1);
0345     p=1;
0346     <span class="keyword">for</span> n=1:length(xip)
0347         <span class="keyword">if</span> dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS(xip(n))
0348             xip2(p)=xip(n);
0349             p=p+1;
0350         <span class="keyword">end</span>
0351     <span class="keyword">end</span>
0352     xip=xip2;
0353     X1=1:length(xip);
0354     
0355     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0356     <span class="comment">% Create axes</span>
0357     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0358     hold on;
0359     <span class="comment">%upper and lower Y</span>
0360     minY=min(model.dGtMin(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS));
0361     maxY=max(model.dGtMax(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS));
0362     <span class="comment">%baselines</span>
0363     PreversibleBar_byConcLHS=ones(1,nRxn)*minY;
0364     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0365     PreversibleBar_bydGt0=ones(1,nRxn)*minY;
0366     <span class="comment">%bar for 2 &amp; 6</span>
0367     PreversibleBar_byConcLHS(dGfGCforwardReversibleBool_byConcLHS)=maxY;
0368     bar_handle2=bar(X1,PreversibleBar_byConcLHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0369    
0370     <span class="comment">%dGrt errorbar</span>
0371     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,16,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0372     <span class="comment">% adjust error bar width</span>
0373     hE_c=get(hE, <span class="string">'Children'</span>);
0374     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0375     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0376     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0377     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0378     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0379     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0380     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0381     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,16,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0382     <span class="comment">% adjust error bar width</span>
0383     hE_c=get(hE2, <span class="string">'Children'</span>);
0384     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0385     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0386     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0387     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0388     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0389     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0390     
0391     <span class="comment">%mean dGrt0</span>
0392     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,24,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0393     <span class="comment">%zero line</span>
0394     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0395     <span class="comment">%normal distribution about the mean dGt0</span>
0396     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0397     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:20:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0398     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0399     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0400     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0401     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0402     <span class="comment">%axis limits</span>
0403     axis(AX(1),[0 (length(X1)+1) minY maxY])
0404 <span class="comment">%     axis(AX(1),[0 length(X1) -500 500]);</span>
0405     set(AX(1),<span class="string">'FontSize'</span>,16)
0406     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0407     axis(AX(2),[0 (length(X1)+1) 0 1])
0408     title({<span class="string">'Qualitatively forward, but quantitatively reversible. Exact positive \Delta_{r}G^{\primem},'</span>;<span class="keyword">...</span>
0409             <span class="string">'but with a quantitatively reversible concentration range.'</span>},<span class="string">'FontSize'</span>,16)
0410     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0411     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0412     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0413     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0414     xlabel(<span class="string">'Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0415 <span class="keyword">end</span>
0416 
0417 <span class="comment">%qualitatively reverse reactions that are quantitatively</span>
0418 <span class="comment">%reversible by concentration alone (with dGt0 error)</span>
0419 <span class="comment">% fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_byConcLHS),' qualitatively forward reactions that are GC quantitatively reverse by dGr0t, but reversible by concentration.');</span>
0420 <span class="keyword">if</span> figure2 &amp;&amp; any(dGfGCforwardReversibleBool_byConcLHS)
0421     <span class="comment">%make the master plot of all 7 regions, 2, 4,6 are shaded</span>
0422     X1=1:nRxn;<span class="comment">%nnz(dGfGCforwardReversibleBool);</span>
0423     <span class="comment">%dGrt0</span>
0424     Y0=(model.dGt0Min+model.dGt0Max)/2;
0425     L0=Y0-model.dGt0Min;
0426     U0=model.dGt0Max-Y0;
0427     <span class="comment">%dGrt</span>
0428     Y=(model.dGtMin+model.dGtMax)/2;
0429     L=Y-model.dGtMin;
0430     U=model.dGtMax-Y;
0431     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0432     <span class="comment">%range of dGt0</span>
0433     P = normcdf(0,Y0,L0);
0434     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0435     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0436     
0437     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0438     <span class="comment">%     take them in order of descending P</span>
0439     xip2=zeros(nnz(dGfGCforwardReversibleBool),1);
0440     p=1;
0441     <span class="keyword">for</span> n=1:nRxn
0442         <span class="keyword">if</span> dGfGCforwardReversibleBool(xip(n))
0443             xip2(p)=xip(n);
0444             p=p+1;
0445         <span class="keyword">end</span>
0446     <span class="keyword">end</span>
0447     xip=xip2;
0448     X1=1:length(xip);
0449     
0450     <span class="comment">%replace the NaN due to zero st dev</span>
0451     nNaNpLHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS);
0452     nNaNpRHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS);
0453     <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(dGfGCforwardReversibleBool))))
0454         warning(<span class="string">'ExtraCategory'</span>);
0455     <span class="keyword">end</span>
0456     <span class="comment">%nans are first in the ordering of indexes</span>
0457     NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0458     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0459     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0460     <span class="comment">%new ordering</span>
0461     xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0462     <span class="comment">%     xip=xip(nNaNpLHS+nNaNpRHS+1:end);</span>
0463     
0464     <span class="comment">%reactions that cannot be assigned directionality</span>
0465     <span class="comment">%cuttoff for probabilities: must be reflective about 0.5;</span>
0466 <span class="comment">%     dGfGCforwardReversibleBool_bydGt0Mid=P&lt;0.6 &amp; P&gt;0.4 &amp; dGfGCforwardReversibleBool;</span>
0467     
0468         <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0469     <span class="comment">%     take them in order of descending P</span>
0470     xip2=zeros(nnz(dGfGCforwardReversibleBool_byConcLHS),1);
0471     p=1;
0472     <span class="keyword">for</span> n=1:length(xip)
0473         <span class="keyword">if</span> dGfGCforwardReversibleBool_byConcLHS(xip(n))
0474             xip2(p)=xip(n);
0475             p=p+1;
0476         <span class="keyword">end</span>
0477     <span class="keyword">end</span>
0478     xip=xip2;
0479     X1=1:length(xip);
0480     
0481     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0482     <span class="comment">% Create axes</span>
0483     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0484     hold on;
0485     <span class="comment">%upper and lower Y</span>
0486     minY=min(model.dGtMin(dGfGCforwardReversibleBool_byConcLHS));
0487     maxY=max(model.dGtMax(dGfGCforwardReversibleBool_byConcLHS));
0488     <span class="comment">%baselines</span>
0489     PreversibleBar_byConcLHS=ones(1,nRxn)*minY;
0490     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0491     PreversibleBar_bydGt0=ones(1,nRxn)*minY;
0492     <span class="comment">%bar for 2 &amp; 6</span>
0493     PreversibleBar_byConcLHS(dGfGCforwardReversibleBool_byConcLHS)=maxY;
0494     PreversibleBar_byConcRHS(dGfGCforwardReversibleBool_byConcRHS)=maxY;
0495     <span class="comment">%bar for 4</span>
0496     PreversibleBar_bydGt0(dGfGCforwardReversibleBool_bydGt0Mid)=maxY;
0497     bar_handle2=bar(X1,PreversibleBar_byConcLHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0498 <span class="comment">%     bar_handle4=bar(X1,PreversibleBar_bydGt0(xip),1,'BaseValue',minY,'FaceColor',[0.86 0.86 0.86],'EdgeColor','none');</span>
0499 <span class="comment">%     bar_handle6=bar(X1,PreversibleBar_byConcRHS(xip),1,'BaseValue',minY,'FaceColor',[0.86 0.86 0.86],'EdgeColor','none');</span>
0500 <span class="comment">%</span>
0501     <span class="comment">%dGrt errorbar</span>
0502     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,4.5,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0503     <span class="comment">% adjust error bar width</span>
0504     hE_c=get(hE, <span class="string">'Children'</span>);
0505     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0506     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0507     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0508     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0509     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0510     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0511     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0512     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,4.5,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0513     <span class="comment">% adjust error bar width</span>
0514     hE_c=get(hE2, <span class="string">'Children'</span>);
0515     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0516     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0517     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0518     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0519     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0520     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0521     
0522     <span class="comment">%mean dGrt0</span>
0523     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,9,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0524     <span class="comment">%zero line</span>
0525     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0526     <span class="comment">%normal distribution about the mean dGt0</span>
0527     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0528     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:50:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0529     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0530     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
0531     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>);
0532     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0533     <span class="comment">%axis limits</span>
0534     <span class="keyword">if</span> length(X1)~=1
0535         axis(AX(1),[1 length(X1) minY maxY])
0536     <span class="keyword">else</span>
0537         axis(AX(1),[1-0.5 length(X1)+0.5 minY maxY])
0538     <span class="keyword">end</span>
0539 <span class="comment">%     axis(AX(1),[1 length(X1) -500 500]);</span>
0540     set(AX(1),<span class="string">'FontSize'</span>,16)
0541     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0542     <span class="keyword">if</span> length(X1)~=1
0543         axis(AX(2),[1 length(X1) 0 1])
0544     <span class="keyword">else</span>
0545         axis(AX(2),[1-0.5 length(X1)+0.5 0 1])
0546     <span class="keyword">end</span>
0547     title({<span class="string">'Qualitatively forward, but quantitatively reversible. Negative group contribution \Delta_{r}G^{\primem} estimate,'</span>;<span class="keyword">...</span>
0548             <span class="string">'even with uncertainty, but with a quantitatively reversible concentration range.'</span>},<span class="string">'FontSize'</span>,16)
0549     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0550     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0551     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0552     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0553     xlabel(<span class="string">'Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0554 <span class="keyword">end</span>
0555 
0556 <span class="comment">%qualitatively reverse reactions that are quantitatively</span>
0557 <span class="comment">%reversible by concentration alone (with dGt0 error)</span>
0558 <span class="comment">% fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_byConcRHS),' qualitatively forward reactions that are GC quantitatively reverse by dGr0t, but reversible by concentration.');</span>
0559 <span class="keyword">if</span> figure6 &amp;&amp; any(dGfGCforwardReversibleBool_byConcRHS)
0560     <span class="comment">%make the master plot of all 7 regions, 2, 4,6 are shaded</span>
0561     X1=1:nRxn;<span class="comment">%nnz(dGfGCforwardReversibleBool);</span>
0562     <span class="comment">%dGrt0</span>
0563     Y0=(model.dGt0Min+model.dGt0Max)/2;
0564     L0=Y0-model.dGt0Min;
0565     U0=model.dGt0Max-Y0;
0566     <span class="comment">%dGrt</span>
0567     Y=(model.dGtMin+model.dGtMax)/2;
0568     L=Y-model.dGtMin;
0569     U=model.dGtMax-Y;
0570     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0571     <span class="comment">%range of dGt0</span>
0572     P = normcdf(0,Y0,L0);
0573     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0574     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0575     
0576     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0577     <span class="comment">%     take them in order of descending P</span>
0578     xip2=zeros(nnz(dGfGCforwardReversibleBool),1);
0579     p=1;
0580     <span class="keyword">for</span> n=1:nRxn
0581         <span class="keyword">if</span> dGfGCforwardReversibleBool(xip(n))
0582             xip2(p)=xip(n);
0583             p=p+1;
0584         <span class="keyword">end</span>
0585     <span class="keyword">end</span>
0586     xip=xip2;
0587     X1=1:length(xip);
0588     
0589     <span class="comment">%replace the NaN due to zero st dev</span>
0590     nNaNpLHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS);
0591     nNaNpRHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS);
0592     <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(dGfGCforwardReversibleBool))))
0593         warning(<span class="string">'ExtraCategory'</span>);
0594     <span class="keyword">end</span>
0595     <span class="comment">%nans are first in the ordering of indexes</span>
0596     NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0597     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0598     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0599     <span class="comment">%new ordering</span>
0600     xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0601     <span class="comment">%     xip=xip(nNaNpLHS+nNaNpRHS+1:end);</span>
0602     
0603     <span class="comment">%reactions that cannot be assigned directionality</span>
0604     <span class="comment">%cuttoff for probabilities: must be reflective about 0.5;</span>
0605 <span class="comment">%     dGfGCforwardReversibleBool_bydGt0Mid=P&lt;0.6 &amp; P&gt;0.4 &amp; dGfGCforwardReversibleBool;</span>
0606     
0607         <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0608     <span class="comment">%     take them in order of descending P</span>
0609     xip2=zeros(nnz(dGfGCforwardReversibleBool_byConcRHS),1);
0610     p=1;
0611     <span class="keyword">for</span> n=1:length(xip)
0612         <span class="keyword">if</span> dGfGCforwardReversibleBool_byConcRHS(xip(n))
0613             xip2(p)=xip(n);
0614             p=p+1;
0615         <span class="keyword">end</span>
0616     <span class="keyword">end</span>
0617     xip=xip2;
0618     X1=1:length(xip);
0619     
0620     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0621     <span class="comment">% Create axes</span>
0622     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0623     hold on;
0624     <span class="comment">%upper and lower Y</span>
0625     minY=min(model.dGtMin(dGfGCforwardReversibleBool_byConcRHS));
0626     maxY=max(model.dGtMax(dGfGCforwardReversibleBool_byConcRHS));
0627     <span class="comment">%baselines</span>
0628     PreversibleBar_byConcLHS=ones(1,nRxn)*minY;
0629     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0630     PreversibleBar_bydGt0=ones(1,nRxn)*minY;
0631     <span class="comment">%bar for 2 &amp; 6</span>
0632     PreversibleBar_byConcLHS(dGfGCforwardReversibleBool_byConcLHS)=maxY;
0633     PreversibleBar_byConcRHS(dGfGCforwardReversibleBool_byConcRHS)=maxY;
0634     <span class="comment">%bar for 4</span>
0635     PreversibleBar_bydGt0(dGfGCforwardReversibleBool_bydGt0Mid)=maxY;
0636 <span class="comment">%     bar_handle2=bar(X1,PreversibleBar_byConcLHS(xip),1,'BaseValue',minY,'FaceColor',[0.86 0.86 0.86],'EdgeColor','none');</span>
0637 <span class="comment">%     bar_handle4=bar(X1,PreversibleBar_bydGt0(xip),1,'BaseValue',minY,'FaceColor',[0.86 0.86 0.86],'EdgeColor','none');</span>
0638     bar_handle6=bar(X1,PreversibleBar_byConcRHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0639 <span class="comment">%</span>
0640     <span class="comment">%dGrt errorbar</span>
0641     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,10,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0642     <span class="comment">% adjust error bar width</span>
0643     hE_c=get(hE, <span class="string">'Children'</span>);
0644     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0645     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0646     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0647     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0648     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0649     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0650     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0651     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,10,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0652     <span class="comment">% adjust error bar width</span>
0653     hE_c=get(hE2, <span class="string">'Children'</span>);
0654     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0655     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0656     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0657     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0658     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0659     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0660     
0661     <span class="comment">%mean dGrt0</span>
0662     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,16,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0663     <span class="comment">%zero line</span>
0664     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0665     <span class="comment">%normal distribution about the mean dGt0</span>
0666     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0667     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:20:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0668     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0669     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
0670     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>);
0671     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'MarkerSize'</span>,10,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0672     <span class="comment">%axis limits</span>
0673     axis(AX(1),[0.48 (length(X1)+0.48) minY maxY])
0674 <span class="comment">%     axis(AX(1),[0.48 (length(X1)+0.48) -500 500]);</span>
0675     set(AX(1),<span class="string">'FontSize'</span>,16)
0676     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0677     axis(AX(2),[0.48 (length(X1)+0.48) 0 1])
0678     title({<span class="string">'Qualitatively forward, but quantitatively reversible. Positive group contribution \Delta_{r}G^{\primem} estimate,'</span>;<span class="keyword">...</span>
0679             <span class="string">'even with uncertainty, but with a quantitatively reversible concentration range.'</span>},<span class="string">'FontSize'</span>,16)
0680     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0681     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0682     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0683     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0684     xlabel(<span class="string">'Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0685 <span class="keyword">end</span>
0686 
0687 
0688 <span class="comment">%qualitatively forward reactions that are quantitatively reversible by</span>
0689 <span class="comment">%the range of dGt0</span>
0690 <span class="comment">% fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_bydGt0),' qualitatively forward reactions that are GC quantitatively reversible by range of dGt0.');</span>
0691 <span class="keyword">if</span> figure345 &amp;&amp; any(dGfGCforwardReversibleBool_bydGt0)
0692     <span class="comment">%make the master plot of all 7 regions, 2, 4,6 are shaded</span>
0693     X1=1:nRxn;<span class="comment">%nnz(dGfGCforwardReversibleBool);</span>
0694     <span class="comment">%dGrt0</span>
0695     Y0=(model.dGt0Min+model.dGt0Max)/2;
0696     L0=Y0-model.dGt0Min;
0697     U0=model.dGt0Max-Y0;
0698     <span class="comment">%dGrt</span>
0699     Y=(model.dGtMin+model.dGtMax)/2;
0700     L=Y-model.dGtMin;
0701     U=model.dGtMax-Y;
0702     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0703     <span class="comment">%range of dGt0</span>
0704     P = normcdf(0,Y0,L0);
0705     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0706     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0707     
0708     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0709     <span class="comment">%     take them in order of descending P</span>
0710     xip2=zeros(nnz(dGfGCforwardReversibleBool),1);
0711     p=1;
0712     <span class="keyword">for</span> n=1:nRxn
0713         <span class="keyword">if</span> dGfGCforwardReversibleBool(xip(n))
0714             xip2(p)=xip(n);
0715             p=p+1;
0716         <span class="keyword">end</span>
0717     <span class="keyword">end</span>
0718     xip=xip2;
0719     X1=1:length(xip);
0720     
0721     <span class="comment">%replace the NaN due to zero st dev</span>
0722     nNaNpLHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorLHS);
0723     nNaNpRHS=nnz(dGfGCforwardReversibleBool_byConc_No_dGt0ErrorRHS);
0724     <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(dGfGCforwardReversibleBool))))
0725         warning(<span class="string">'ExtraCategory'</span>);
0726     <span class="keyword">end</span>
0727     <span class="comment">%nans are first in the ordering of indexes</span>
0728     NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0729     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0730     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0731     <span class="comment">%new ordering</span>
0732     xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0733     <span class="comment">%     xip=xip(nNaNpLHS+nNaNpRHS+1:end);</span>
0734     
0735     <span class="comment">%reactions that cannot be assigned directionality</span>
0736     <span class="comment">%cuttoff for probabilities: must be reflective about 0.5;</span>
0737 <span class="comment">%     dGfGCforwardReversibleBool_bydGt0Mid=P&lt;0.6 &amp; P&gt;0.4 &amp; dGfGCforwardReversibleBool;</span>
0738     
0739             <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0740     <span class="comment">%     take them in order of descending P</span>
0741     xip2=zeros(nnz(dGfGCforwardReversibleBool_byConcRHS),1);
0742     p=1;
0743     <span class="keyword">for</span> n=1:length(xip)
0744         <span class="keyword">if</span> dGfGCforwardReversibleBool_bydGt0(xip(n))
0745             xip2(p)=xip(n);
0746             p=p+1;
0747         <span class="keyword">end</span>
0748     <span class="keyword">end</span>
0749     xip=xip2;
0750     X1=1:length(xip);
0751     
0752     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0753     <span class="comment">% Create axes</span>
0754     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0755     hold on;
0756     <span class="comment">%upper and lower Y</span>
0757     minY=min(model.dGtMin(dGfGCforwardReversibleBool_bydGt0));
0758     maxY=max(model.dGtMax(dGfGCforwardReversibleBool_bydGt0));
0759 
0760     <span class="comment">%baselines</span>
0761     PreversibleBar_byConcLHS=ones(1,nRxn)*minY;
0762     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0763     PreversibleBar_bydGt0=ones(1,nRxn)*minY;
0764     <span class="comment">%bar for 2 &amp; 6</span>
0765     PreversibleBar_byConcLHS(dGfGCforwardReversibleBool_byConcLHS)=maxY;
0766     PreversibleBar_byConcRHS(dGfGCforwardReversibleBool_byConcRHS)=maxY;
0767     <span class="comment">%bar for 4</span>
0768     PreversibleBar_bydGt0(dGfGCforwardReversibleBool_bydGt0Mid)=maxY;
0769     bar_handle2=bar(X1,PreversibleBar_byConcLHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0770     bar_handle4=bar(X1,PreversibleBar_bydGt0(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0771     bar_handle6=bar(X1,PreversibleBar_byConcRHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0772     
0773     <span class="comment">%dGrt errorbar</span>
0774     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0775     <span class="comment">% adjust error bar width</span>
0776     hE_c=get(hE, <span class="string">'Children'</span>);
0777     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0778     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0779     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0780     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0781     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0782     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0783     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0784     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0785     <span class="comment">% adjust error bar width</span>
0786     hE_c=get(hE2, <span class="string">'Children'</span>);
0787     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0788     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0789     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0790     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0791     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0792     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0793     
0794     <span class="comment">%mean dGrt0</span>
0795     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'MarkerSize'</span>,6,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0796     <span class="comment">%zero line</span>
0797     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0798     <span class="comment">%normal distribution about the mean dGt0</span>
0799     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0800     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:100:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0801     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0802     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0803     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0804     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0805     <span class="comment">%axis limits</span>
0806     <span class="comment">%     axis(AX(1),[0 length(X1) minY maxY])</span>
0807     axis(AX(1),[0 length(X1) -500 500]);
0808     set(AX(1),<span class="string">'FontSize'</span>,16)
0809     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0810     axis(AX(2),[0 length(X1) 0 1])
0811     title({<span class="string">'Qualitatively forward, but quantitatively reversible. The group contribution '</span>;
0812            <span class="string">'\Delta_{r}G^{\primem} estimates span the zero line.'</span>},<span class="string">'FontSize'</span>,16)
0813     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0814     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0815     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0816     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0817     xlabel(<span class="string">'Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0818 <span class="keyword">end</span>
0819 
0820 <span class="keyword">if</span> thorStandard
0821     model.dGt0Min=dGt0Min;
0822     model.dGt0Max=dGt0Max;
0823 <span class="keyword">end</span>
0824 
0825 
0826 
0827 
0828 
0829 
0830 
0831 
0832 
0833 
0834 
0835 
0836 
0837 
0838 
0839 
0840 
0841 
0842 
0843 
0844 <span class="comment">% old code</span>
0845     <span class="comment">%     %reactions that are qualitatively forward but quantitatively reverse</span>
0846     <span class="comment">%     X=1:nnz(changedDirections.forwardReversible);</span>
0847     <span class="comment">%     Y=(model.dGt0Min(changedDirections.forwardReversible)+model.dGt0Max(changedDirections.forwardReversible))/2;</span>
0848     <span class="comment">%     L=Y-model.dGt0Min(changedDirections.forwardReversible);</span>
0849     <span class="comment">%     U=model.dGt0Max(changedDirections.forwardReversible)-Y;</span>
0850     <span class="comment">%     [tmp,xi]=sort(Y);</span>
0851     <span class="comment">%     [tmp,xi]=sort(model.dGt0Max(changedDirections.forwardReversible)-model.dGt0Min(changedDirections.forwardReversible));</span>
0852     <span class="comment">%     errorbar(X,Y(xi),L(xi),U(xi),'b.')</span>
0853     <span class="comment">%     title('All reactions that are qualitatively forward, yet quantitatively reversible');</span>
0854     <span class="comment">%     ylabel('dGt0 (kJ/mol)')</span>
0855     <span class="comment">%     xlabel('Reactions, sorted by uncertainty in dGt0')</span>
0856     <span class="comment">%</span>
0857     <span class="comment">%     X=1:nnz(forwardReversibleKeq);</span>
0858     <span class="comment">%     Y=(model.dGt0Min(forwardReversibleKeq)+model.dGt0Max(forwardReversibleKeq))/2;</span>
0859     <span class="comment">%     L=Y-model.dGt0Min(forwardReversibleKeq);</span>
0860     <span class="comment">%     U=model.dGt0Max(forwardReversibleKeq)-Y;</span>
0861     <span class="comment">%     [tmp,xi]=sort(Y);</span>
0862     <span class="comment">%     figure;</span>
0863     <span class="comment">%     errorbar(X,Y(xi),L(xi),U(xi),'b.')</span>
0864     <span class="comment">%     title('Reactions qualitiatively forward, but quantitatively reversible by Alberty');</span>
0865     <span class="comment">%     ylabel('dGt0 (kJ/mol)')</span>
0866     <span class="comment">%     xlabel('Reactions, sorted by mean dGt0')</span>
0867 <span class="comment">% %     %GC forward prediction of reactions qualitiatively forward</span>
0868 <span class="comment">% %     X1=1:nnz(dGfGCforwardForwardBool);</span>
0869 <span class="comment">% %     Y=(model.dGt0Min(dGfGCforwardForwardBool)+model.dGt0Max(dGfGCforwardForwardBool))/2;</span>
0870 <span class="comment">% %     L=Y-model.dGt0Min(dGfGCforwardForwardBool);</span>
0871 <span class="comment">% %     U=model.dGt0Max(dGfGCforwardForwardBool)-Y;</span>
0872 <span class="comment">% %     [tmp,xi]=sort(Y);</span>
0873 <span class="comment">% %     figure;</span>
0874 <span class="comment">% %     hold on</span>
0875 <span class="comment">% %     errorbar(X1,Y(xi),L(xi),U(xi),'b.')</span>
0876 <span class="comment">% %     legend('forwardForward')</span>
0877 <span class="comment">% %     title('GC forward prediction of reactions qualitiatively forward')</span>
0878 <span class="comment">% %     ylabel('dGt0 (kJ/mol)')</span>
0879 <span class="comment">% %     xlabel('Reactions, sorted by mean dGt0')</span>
0880 <span class="comment">% %</span>
0881 <span class="comment">% %     [tmp,xi]=sort(abs(model.dGt0Max(dGfGCforwardForwardBool)-model.dGt0Min(dGfGCforwardForwardBool)));</span>
0882 <span class="comment">% %     figure;</span>
0883 <span class="comment">% %     hold on</span>
0884 <span class="comment">% %     errorbar(X1,Y(xi),L(xi),U(xi),'b.')</span>
0885 <span class="comment">% %     legend('forwardForward')</span>
0886 <span class="comment">% %     title('GC forward prediction of reactions qualitiatively forward')</span>
0887 <span class="comment">% %     ylabel('dGt0 (kJ/mol)')</span>
0888 <span class="comment">% %     xlabel('Reactions, sorted by uncertainty in dGt0')</span>
0889 <span class="comment">% %</span>
0890 <span class="comment">% %     figure</span>
0891 <span class="comment">% %     plot(Y(xi),L(xi),'.g')</span>
0892 <span class="comment">% %     title('GC forward prediction of reactions qualitiatively forward')</span>
0893 <span class="comment">% %     ylabel('dGt0 Uncertainty (kJ/mol)')</span>
0894 <span class="comment">% %     xlabel('Reaction dGt0 (kJ/mol), sorted by uncertainty in dGt0')</span>
0895 <span class="comment">%</span>
0896 <span class="comment">%     %GC reversible prediction of reactions qualitiatively forward by dGrt</span>
0897 <span class="comment">%     %dGr0t</span>
0898 <span class="comment">%     X1=1:nnz(dGfGCforwardReversibleBool);</span>
0899 <span class="comment">%     Y=(model.dGt0Min(dGfGCforwardReversibleBool)+model.dGt0Max(dGfGCforwardReversibleBool))/2;</span>
0900 <span class="comment">%     L=Y-model.dGt0Min(dGfGCforwardReversibleBool);</span>
0901 <span class="comment">%     U=model.dGt0Max(dGfGCforwardReversibleBool)-Y;</span>
0902 <span class="comment">% %     [tmp,xi]=sort(Y);</span>
0903 <span class="comment">% %     figure</span>
0904 <span class="comment">% %     errorbar(X1,Y(xi),L(xi),U(xi),'r.')</span>
0905 <span class="comment">% %     title('All GC reversible prediction of reactions qualitiatively forward')</span>
0906 <span class="comment">% %     legend('forwardReversible')</span>
0907 <span class="comment">% %     ylabel('dGt0 (kJ/mol)')</span>
0908 <span class="comment">% %     xlabel('Reactions, sorted by mean dGt0')</span>
0909 <span class="comment">%     %dGrt</span>
0910 <span class="comment">%     Y2=(model.dGtMin(dGfGCforwardReversibleBool)+model.dGtMax(dGfGCforwardReversibleBool))/2;</span>
0911 <span class="comment">%     L2=Y2-model.dGtMin(dGfGCforwardReversibleBool);</span>
0912 <span class="comment">%     U2=model.dGtMax(dGfGCforwardReversibleBool)-Y2;</span>
0913 <span class="comment">%     [tmp,xi]=sort(abs(model.dGt0Max(dGfGCforwardReversibleBool)-model.dGt0Min(dGfGCforwardReversibleBool)));</span>
0914 <span class="comment">%     figure</span>
0915 <span class="comment">%     hold on;</span>
0916 <span class="comment">%     %dGrt errorbar</span>
0917 <span class="comment">%     hE=errorbar(X1,Y2(xi),L2(xi),U2(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
0918 <span class="comment">%     % adjust error bar width</span>
0919 <span class="comment">%     hE_c=get(hE, 'Children');</span>
0920 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
0921 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0922 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0923 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0924 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0925 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
0926 <span class="comment">%     %dGrt0 errorbar on top and inside dGrt</span>
0927 <span class="comment">%     hE2=errorbar(X1,Y(xi),L(xi),U(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
0928 <span class="comment">%     % adjust error bar width</span>
0929 <span class="comment">%     hE_c=get(hE2, 'Children');</span>
0930 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
0931 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0932 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0933 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0934 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0935 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
0936 <span class="comment">%     %mean dGrt0</span>
0937 <span class="comment">%     plot(X1,Y(xi),'.g','LineStyle','none');</span>
0938 <span class="comment">%     %zero line</span>
0939 <span class="comment">%     plot(X1,zeros(1,length(X1)),'k');</span>
0940 <span class="comment">%     title('GC reversible prediction of reactions qualitiatively forward');</span>
0941 <span class="comment">%     ylabel('dGt0 (kJ/mol)');</span>
0942 <span class="comment">%     xlabel('Reactions, sorted by uncertainty in dGt0');</span>
0943 <span class="comment">%</span>
0944 <span class="comment">%     %%%%%%%%</span>
0945 <span class="comment">%     %qualitatively forward reactions that are quantitatively reversible by concentration alone</span>
0946 <span class="comment">%     %dGrt0</span>
0947 <span class="comment">%     Y=(model.dGt0Min(dGfGCforwardReversibleBool_byConc)+model.dGt0Max(dGfGCforwardReversibleBool_byConc))/2;</span>
0948 <span class="comment">%     L=Y-model.dGt0Min(dGfGCforwardReversibleBool_byConc);</span>
0949 <span class="comment">%     U=model.dGt0Max(dGfGCforwardReversibleBool_byConc)-Y;</span>
0950 <span class="comment">%     %dGrt</span>
0951 <span class="comment">%     Y2=(model.dGtMin(dGfGCforwardReversibleBool_byConc)+model.dGtMax(dGfGCforwardReversibleBool_byConc))/2;</span>
0952 <span class="comment">%     L2=Y2-model.dGtMin(dGfGCforwardReversibleBool_byConc);</span>
0953 <span class="comment">%     U2=model.dGtMax(dGfGCforwardReversibleBool_byConc)-Y2;</span>
0954 <span class="comment">%     [tmp,xi]=sort(abs(model.dGt0Max(dGfGCforwardReversibleBool_byConc)-model.dGt0Min(dGfGCforwardReversibleBool_byConc)));</span>
0955 <span class="comment">%</span>
0956 <span class="comment">%     figure</span>
0957 <span class="comment">%     hold on;</span>
0958 <span class="comment">%     %dGrt errorbar underneath</span>
0959 <span class="comment">%     X1=1:nnz(dGfGCforwardReversibleBool_byConc);</span>
0960 <span class="comment">%     hE=errorbar(X1,Y2(xi),L2(xi),U2(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
0961 <span class="comment">%     % adjust error bar width</span>
0962 <span class="comment">%     hE_c=get(hE, 'Children');</span>
0963 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
0964 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0965 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0966 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0967 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0968 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
0969 <span class="comment">%     %dGrt0 errorbar on top and inside dGrt</span>
0970 <span class="comment">%     hE2=errorbar(X1,Y(xi),L(xi),U(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
0971 <span class="comment">%     % adjust error bar width</span>
0972 <span class="comment">%     hE_c=get(hE2, 'Children');</span>
0973 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
0974 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0975 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
0976 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0977 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
0978 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
0979 <span class="comment">%</span>
0980 <span class="comment">%     %mean dGrt0</span>
0981 <span class="comment">% %     plot(X1,Y(xi),'Marker','none','LineStyle','none');</span>
0982 <span class="comment">%     plot(X1,Y(xi),'.g','LineStyle','none');</span>
0983 <span class="comment">%     %zero line</span>
0984 <span class="comment">%     plot(X1,zeros(1,length(X1)),'k');</span>
0985 <span class="comment">%     title('Qualitatively forward reactions that are GC quantitatively reversible by concentration');</span>
0986 <span class="comment">%     ylabel('dGt0 or dGt(kJ/mol)');</span>
0987 <span class="comment">%     xlabel('Reactions, sorted by uncertainty in dGt0');</span>
0988 <span class="comment">%</span>
0989 <span class="comment">%</span>
0990 <span class="comment">%     %qualitatively forward reactions that are quantitatively reversible by</span>
0991 <span class="comment">%     %the range of dGt0</span>
0992 <span class="comment">%     fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_bydGt0),' qualitatively forward reactions that are gc quantitatively reversible by range of dGt0');</span>
0993 <span class="comment">%     X1=1:nnz(dGfGCforwardReversibleBool_bydGt0);</span>
0994 <span class="comment">%     %dGrt0</span>
0995 <span class="comment">%     Y=(model.dGt0Min(dGfGCforwardReversibleBool_bydGt0)+model.dGt0Max(dGfGCforwardReversibleBool_bydGt0))/2;</span>
0996 <span class="comment">%     L=Y-model.dGt0Min(dGfGCforwardReversibleBool_bydGt0);</span>
0997 <span class="comment">%     U=model.dGt0Max(dGfGCforwardReversibleBool_bydGt0)-Y;</span>
0998 <span class="comment">%     %dGrt</span>
0999 <span class="comment">%     Y2=(model.dGtMin(dGfGCforwardReversibleBool_bydGt0)+model.dGtMax(dGfGCforwardReversibleBool_bydGt0))/2;</span>
1000 <span class="comment">%     L2=Y2-model.dGtMin(dGfGCforwardReversibleBool_bydGt0);</span>
1001 <span class="comment">%     U2=model.dGtMax(dGfGCforwardReversibleBool_bydGt0)-Y2;</span>
1002 <span class="comment">%     [tmp,xi]=sort(abs(model.dGt0Max(dGfGCforwardReversibleBool_bydGt0)-model.dGt0Min(dGfGCforwardReversibleBool_bydGt0)));</span>
1003 <span class="comment">%</span>
1004 <span class="comment">%     figure;</span>
1005 <span class="comment">%     hold on;</span>
1006 <span class="comment">%     %dGrt errorbar</span>
1007 <span class="comment">%     hE=errorbar(X1,Y2(xi),L2(xi),U2(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
1008 <span class="comment">%     % adjust error bar width</span>
1009 <span class="comment">%     hE_c=get(hE, 'Children');</span>
1010 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
1011 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1012 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1013 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1014 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1015 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
1016 <span class="comment">%     %dGrt0 errorbar on top and inside dGrt</span>
1017 <span class="comment">%     hE2=errorbar(X1,Y(xi),L(xi),U(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
1018 <span class="comment">%     % adjust error bar width</span>
1019 <span class="comment">%     hE_c=get(hE2, 'Children');</span>
1020 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
1021 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1022 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1023 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1024 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1025 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
1026 <span class="comment">%</span>
1027 <span class="comment">%     %mean dGrt0</span>
1028 <span class="comment">% %     plot(X1,Y(xi),'Marker','none','LineStyle','none');</span>
1029 <span class="comment">%     plot(X1,Y(xi),'.g','LineStyle','none');</span>
1030 <span class="comment">%     %zero line</span>
1031 <span class="comment">%     plot(X1,zeros(1,length(X1)),'k');</span>
1032 <span class="comment">%     title('Qualitatively forward reactions that are GC quantitatively reversible by range of dGt0');</span>
1033 <span class="comment">%     ylabel('dGt0 or dGt(kJ/mol)');</span>
1034 <span class="comment">%     xlabel('Reactions, sorted by uncertainty in dGt0');</span>
1035 <span class="comment">%</span>
1036 <span class="comment">%      %qualitatively forward reactions that are quantitatively reverseible by</span>
1037 <span class="comment">%     %the range of dGt0</span>
1038 <span class="comment">%     fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_bydGt0),' qualitatively forward reactions that are gc quantitatively reversible by range of dGt0');</span>
1039 <span class="comment">%     X1=1:nnz(dGfGCforwardReversibleBool_bydGt0);</span>
1040 <span class="comment">%     %dGrt0</span>
1041 <span class="comment">%     Y=(model.dGt0Min(dGfGCforwardReversibleBool_bydGt0)+model.dGt0Max(dGfGCforwardReversibleBool_bydGt0))/2;</span>
1042 <span class="comment">%     L=Y-model.dGt0Min(dGfGCforwardReversibleBool_bydGt0);</span>
1043 <span class="comment">%     U=model.dGt0Max(dGfGCforwardReversibleBool_bydGt0)-Y;</span>
1044 <span class="comment">%     %dGrt</span>
1045 <span class="comment">%     Y2=(model.dGtMin(dGfGCforwardReversibleBool_bydGt0)+model.dGtMax(dGfGCforwardReversibleBool_bydGt0))/2;</span>
1046 <span class="comment">%     L2=Y2-model.dGtMin(dGfGCforwardReversibleBool_bydGt0);</span>
1047 <span class="comment">%     U2=model.dGtMax(dGfGCforwardReversibleBool_bydGt0)-Y2;</span>
1048 <span class="comment">%     %find the amount of reactions with normal cumulative distribution</span>
1049 <span class="comment">%     P = normcdf(0,Y,L);</span>
1050 <span class="comment">%</span>
1051 <span class="comment">%     %sort by fraction of uncertainty that is negative</span>
1052 <span class="comment">% %     [tmp,xi]=sort(abs(model.dGt0Min(dGfGCforwardReversibleBool_bydGt0))./abs(model.dGt0Max(dGfGCforwardReversibleBool_bydGt0)-model.dGt0Min(dGfGCforwardReversibleBool_bydGt0)),'descend');</span>
1053 <span class="comment">%     %     [tmp,xi]=sort(Y);</span>
1054 <span class="comment">%     [tmp,xi]=sort(P,'descend');</span>
1055 <span class="comment">%     %cuttoff for probabilities: must be reflective about 0.5;</span>
1056 <span class="comment">%     PSortedeversibleBool=tmp&lt;0.6 &amp; tmp&gt;0.4;</span>
1057 <span class="comment">%     %reversible section bar in the background</span>
1058 <span class="comment">%     figure1=figure;</span>
1059 <span class="comment">%     hold on;</span>
1060 <span class="comment">%     xbar=1:length(PSortedeversibleBool);</span>
1061 <span class="comment">%     PSortedeversibleBar=ones(1,length(PSortedeversibleBool))*min(model.dGtMin(dGfGCforwardReversibleBool_bydGt0));</span>
1062 <span class="comment">%     PSortedeversibleBar(PSortedeversibleBool)=max(model.dGtMax(dGfGCforwardReversibleBool_bydGt0));</span>
1063 <span class="comment">%     bar_handle=bar(xbar,PSortedeversibleBar,1,'BaseValue',min(model.dGtMin(dGfGCforwardReversibleBool_bydGt0)),'EdgeColor',[0.86 0.86 0.86]);</span>
1064 <span class="comment">%     %dGrt errorbar</span>
1065 <span class="comment">%     hE=errorbar(X1,Y2(xi),L2(xi),U2(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
1066 <span class="comment">%     % adjust error bar width</span>
1067 <span class="comment">%     hE_c=get(hE, 'Children');</span>
1068 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
1069 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1070 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1071 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1072 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1073 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
1074 <span class="comment">%     %dGrt0 errorbar on top and inside dGrt</span>
1075 <span class="comment">%     hE2=errorbar(X1,Y(xi),L(xi),U(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
1076 <span class="comment">%     % adjust error bar width</span>
1077 <span class="comment">%     hE_c=get(hE2, 'Children');</span>
1078 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
1079 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1080 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1081 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1082 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1083 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
1084 <span class="comment">%</span>
1085 <span class="comment">%     %mean dGrt0</span>
1086 <span class="comment">% %     plot(X1,Y(xi),'Marker','none','LineStyle','none');</span>
1087 <span class="comment">%     plot(X1,Y(xi),'.g','LineStyle','none');</span>
1088 <span class="comment">%     %zero line</span>
1089 <span class="comment">%     %cumulative probability that reaction is really forward, assuming a</span>
1090 <span class="comment">%     %normal distribution about the mean dGt0</span>
1091 <span class="comment">%     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xi));</span>
1092 <span class="comment">%     set(AX(2),'YTick',[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);</span>
1093 <span class="comment">%     set(H1,'LineStyle','none')</span>
1094 <span class="comment">%     set(H2,'LineStyle','--','Color','k')</span>
1095 <span class="comment">%     plot(X1,zeros(1,length(X1)),'k');</span>
1096 <span class="comment">%     axis(AX(1),[0 length(X1) min(model.dGtMin(dGfGCforwardReversibleBool_bydGt0)) max(model.dGtMax(dGfGCforwardReversibleBool_bydGt0))])</span>
1097 <span class="comment">%     axis(AX(2),[0 length(X1) 0 1])</span>
1098 <span class="comment">%     title('Qualitatively forward reactions that are GC quantitatively reversible by range of dGt0');</span>
1099 <span class="comment">%     ylabel('dGt0 or dGt(kJ/mol)');</span>
1100 <span class="comment">%     xlabel('Reactions, sorted by cumulative probability of being forward');</span>
1101 <span class="comment">%</span>
1102 <span class="comment">%     %qualitatively forward reactions that are quantitatively reverse by</span>
1103 <span class="comment">%     %dGt0</span>
1104 <span class="comment">%     fprintf('%i%s\n',nnz(dGfGCforwardReversibleBool_byConcRHS),' qualitatively forward reactions that are GC quantitatively forward by dGf0');</span>
1105 <span class="comment">%     X1=1:nnz(dGfGCforwardReversibleBool_byConcRHS);</span>
1106 <span class="comment">%     %dGrt0</span>
1107 <span class="comment">%     Y=(model.dGt0Min(dGfGCforwardReversibleBool_byConcRHS)+model.dGt0Max(dGfGCforwardReversibleBool_byConcRHS))/2;</span>
1108 <span class="comment">%     L=Y-model.dGt0Min(dGfGCforwardReversibleBool_byConcRHS);</span>
1109 <span class="comment">%     U=model.dGt0Max(dGfGCforwardReversibleBool_byConcRHS)-Y;</span>
1110 <span class="comment">%     %dGrt</span>
1111 <span class="comment">%     Y2=(model.dGtMin(dGfGCforwardReversibleBool_byConcRHS)+model.dGtMax(dGfGCforwardReversibleBool_byConcRHS))/2;</span>
1112 <span class="comment">%     L2=Y2-model.dGtMin(dGfGCforwardReversibleBool_byConcRHS);</span>
1113 <span class="comment">%     U2=model.dGtMax(dGfGCforwardReversibleBool_byConcRHS)-Y2;</span>
1114 <span class="comment">%     [tmp,xi]=sort(abs(model.dGt0Max(dGfGCforwardReversibleBool_byConcRHS)-model.dGt0Min(dGfGCforwardReversibleBool_byConcRHS)));</span>
1115 <span class="comment">%</span>
1116 <span class="comment">%     figure</span>
1117 <span class="comment">%     hold on;</span>
1118 <span class="comment">%     %dGrt errorbar</span>
1119 <span class="comment">%     hE=errorbar(X1,Y2(xi),L2(xi),U2(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
1120 <span class="comment">%     % adjust error bar width</span>
1121 <span class="comment">%     hE_c=get(hE, 'Children');</span>
1122 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
1123 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1124 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1125 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1126 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1127 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
1128 <span class="comment">%     %dGrt0 errorbar on top and inside dGrt</span>
1129 <span class="comment">%     hE2=errorbar(X1,Y(xi),L(xi),U(xi),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
1130 <span class="comment">%     % adjust error bar width</span>
1131 <span class="comment">%     hE_c=get(hE2, 'Children');</span>
1132 <span class="comment">%     errorbarXData= get(hE_c(2), 'XData');</span>
1133 <span class="comment">%     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1134 <span class="comment">%     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0.2;</span>
1135 <span class="comment">%     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1136 <span class="comment">%     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0.2;</span>
1137 <span class="comment">%     set(hE_c(2), 'XData', errorbarXData);</span>
1138 <span class="comment">%     %mean dGrt0</span>
1139 <span class="comment">% %     plot(X1,Y(xi),'Marker','none','LineStyle','none');</span>
1140 <span class="comment">%     plot(X1,Y(xi),'.g','LineStyle','none');</span>
1141 <span class="comment">%     %zero line</span>
1142 <span class="comment">%     plot(X1,zeros(1,length(X1)),'k');</span>
1143 <span class="comment">%     title('Qualitatively forward reactions that are GC quantitatively forward by dGf0');</span>
1144 <span class="comment">%     ylabel('dGt0 or dGt(kJ/mol)');</span>
1145 <span class="comment">%     xlabel('Reactions, sorted by uncertainty in dGt0');</span></pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>