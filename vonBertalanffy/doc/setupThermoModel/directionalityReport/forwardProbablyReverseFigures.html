<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of forwardProbablyReverseFigures</title>
  <meta name="keywords" content="forwardProbablyReverseFigures">
  <meta name="description" content="figure of qualitatively forward reactions that are probably quantiatively reverse">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html directionalityReport -->
<h1>forwardProbablyReverseFigures
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>figure of qualitatively forward reactions that are probably quantiatively reverse</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function forwardProbablyReverseFigures(model,directions,miliMolarStandard) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> figure of qualitatively forward reactions that are probably quantiatively reverse

create a vertical errorbar figure of the qualitatively forward reactions
that end up being probably quantiatively reverse by at least one metabolite
group contribution estimate

INPUT
 model

 subsets of forward qualtiative -&gt; probably quantiative reverse by group
 contribution
       directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS
       directions.ChangeForwardReversibleBool_dGfGC_byConcRHS
       directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS

 thorStandard          {(0),1} use new standard reactant concentration
                       half way between upper and lower concentration
                       bounds
 Ronan M.T. Fleming</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../setupThermoModel/external/ploterr.html" class="code" title="function hh = ploterr(x, y, xerr, yerr, varargin)">ploterr</a>	PLOTERR General error bar plot.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="directionalityCheckAll.html" class="code" title="function directions=directionalityCheckAll(model,cumNormProbCutoff,thorStandard,printToFile,printToTable,figures)">directionalityCheckAll</a>	Analysis of differences between qualitative and quantiative directionality assignments.</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function forwardProbablyReverseFigures(model,directions,miliMolarStandard)</a>
0002 <span class="comment">% figure of qualitatively forward reactions that are probably quantiatively reverse</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%create a vertical errorbar figure of the qualitatively forward reactions</span>
0005 <span class="comment">%that end up being probably quantiatively reverse by at least one metabolite</span>
0006 <span class="comment">%group contribution estimate</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%INPUT</span>
0009 <span class="comment">% model</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% subsets of forward qualtiative -&gt; probably quantiative reverse by group</span>
0012 <span class="comment">% contribution</span>
0013 <span class="comment">%       directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS</span>
0014 <span class="comment">%       directions.ChangeForwardReversibleBool_dGfGC_byConcRHS</span>
0015 <span class="comment">%       directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% thorStandard          {(0),1} use new standard reactant concentration</span>
0018 <span class="comment">%                       half way between upper and lower concentration</span>
0019 <span class="comment">%                       bounds</span>
0020 <span class="comment">% Ronan M.T. Fleming</span>
0021 
0022 <span class="comment">%%%%%%%%%vertical%%%%%%%%%%%%%</span>
0023 [nMet,nRxn]=size(model.S);
0024 <span class="keyword">if</span> miliMolarStandard
0025     dGt0Min=model.dGt0Min;
0026     dGt0Max=model.dGt0Max;
0027     <span class="keyword">for</span> n=1:nRxn
0028         model.dGt0Min(n)=model.rxn(n).dGtmMMin;
0029         model.dGt0Max(n)=model.rxn(n).dGtmMMax;
0030     <span class="keyword">end</span>
0031 <span class="keyword">end</span>
0032 
0033 <span class="comment">%forward, probably reverse</span>
0034 fwdProbReverse=directions.ChangeForwardReversibleBool_dGfGC_byConcRHS | <span class="keyword">...</span>
0035     directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS | <span class="keyword">...</span>
0036     directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS;
0037 
0038 <span class="comment">%plot regions 5,6,7, with region 6 shaded</span>
0039 X1=1:nRxn;
0040 <span class="comment">%dGrt0</span>
0041 Y0=(model.dGt0Min+model.dGt0Max)/2;
0042 L0=Y0-model.dGt0Min;
0043 U0=model.dGt0Max-Y0;
0044 <span class="comment">%dGrt</span>
0045 Y=(model.dGtMin+model.dGtMax)/2;
0046 L=Y-model.dGtMin;
0047 U=model.dGtMax-Y;
0048 <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0049 <span class="comment">%range of dGt0</span>
0050 P = normcdf(0,Y0,L0);
0051 <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0052 [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0053 <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0054 <span class="comment">%     take them in order of descending P</span>
0055 xip2=zeros(nnz(fwdProbReverse),1);
0056 p=1;
0057 <span class="keyword">for</span> n=1:nRxn
0058     <span class="keyword">if</span> fwdProbReverse(xip(n))
0059         xip2(p)=xip(n);
0060         p=p+1;
0061     <span class="keyword">end</span>
0062 <span class="keyword">end</span>
0063 xip=xip2;
0064 X1=1:length(xip);
0065 
0066 <span class="comment">%replace the NaN due to zero st dev</span>
0067 nNaNpRHS=nnz(directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS);
0068 <span class="keyword">if</span> nNaNpRHS~=nnz(isnan((P(fwdProbReverse))))
0069     warning(<span class="string">'ExtraCategory'</span>);
0070 <span class="keyword">end</span>
0071 <span class="comment">%nans are first in the ordering of indexes</span>
0072 NaNPInd=xip(1:nNaNpRHS);
0073 <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0074 [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0075 <span class="comment">%new ordering with NaNs sorted to right</span>
0076 xip=[xip(nNaNpRHS+1:end); NaNPInd(xipNaNPInd(1:nNaNpRHS))];
0077 
0078 <span class="comment">% close all</span>
0079 figure1 = figure;
0080 <span class="comment">% Create axes</span>
0081 axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0082 hold on;
0083 
0084 <span class="comment">%upper and lower X</span>
0085 minX=min(model.dGtMin(fwdProbReverse));
0086 maxX=max(model.dGtMax(fwdProbReverse));
0087 <span class="comment">%baselines</span>
0088 PreversibleBar_byConcRHS=ones(1,nRxn)*minX;
0089 <span class="comment">%bar for 6</span>
0090 PreversibleBar_byConcRHS(directions.ChangeForwardReversibleBool_dGfGC_byConcRHS)=maxX;
0091 bar_handle6=barh(X1,PreversibleBar_byConcRHS(xip),1,<span class="string">'BaseValue'</span>,minX,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0092 
0093 <span class="comment">%dGrt errorbar</span>
0094 <span class="comment">%   PLOTERR(X,Y,{LX,UX},{LY,UY}) plots the graph of vector X vs. vector Y</span>
0095 <span class="comment">%   with error bars specified by LX and UX in horizontal direction and</span>
0096 <span class="comment">%   with error bars specified by LY and UY in vertical direction.</span>
0097 <span class="comment">%   H = PLOTERR(...) returns a vector of line handles in this order:</span>
0098 <span class="comment">%      H(1) = handle to datapoints</span>
0099 <span class="comment">%      H(2) = handle to errorbar y OR errorbar x if error y not specified</span>
0100 <span class="comment">%      H(3) = handle to errorbar x if error y specified</span>
0101 <span class="comment">% LineSpec=[''LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r'']</span>
0102 LineSpec=<span class="string">'r.'</span>;
0103 hE = <a href="../../setupThermoModel/external/ploterr.html" class="code" title="function hh = ploterr(x, y, xerr, yerr, varargin)">ploterr</a>(Y(xip),X1,{model.dGtMin(xip) model.dGtMax(xip)},[],LineSpec,<span class="string">'hhxy'</span>,0);
0104 set(hE(2),<span class="string">'LineWidth'</span>,10);
0105 <span class="comment">% hE=errorbar(X1,Y(xip),L(xip),U(xip),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
0106 <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0107 LineSpec=<span class="string">'b.'</span>;
0108 hE = <a href="../../setupThermoModel/external/ploterr.html" class="code" title="function hh = ploterr(x, y, xerr, yerr, varargin)">ploterr</a>(Y0(xip),X1,{model.dGt0Min(xip) model.dGt0Max(xip)},[],LineSpec,<span class="string">'hhxy'</span>,0);
0109 set(hE(2),<span class="string">'LineWidth'</span>,10);
0110 <span class="comment">% hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
0111 
0112 <span class="comment">%mean dGrt0</span>
0113 plot(Y0(xip),X1,<span class="string">'.'</span>,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0114 <span class="comment">%zero line</span>
0115 <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0116 <span class="comment">%normal distribution about the mean dGt0</span>
0117 [AX,H1,H2]=plotyy(zeros(1,length(X1)),X1,P(xip),X1);
0118 set(gca,<span class="string">'XTick'</span>,[]);
0119 set(AX(1),<span class="string">'XTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minX/100)*200:50:maxX);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0120 set(AX(2),<span class="string">'YTick'</span>,1:length(xip));
0121 set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0122 set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0123 plot(zeros(1,length(X1)),X1,<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0124 <span class="comment">%axis limits</span>
0125 set(AX(1),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0126 set(AX(1),<span class="string">'YTick'</span>,[],<span class="string">'YTickLabelMode'</span>,<span class="string">'manual'</span>);
0127 set(AX(1),<span class="string">'XTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'XTick'</span>,floor(minX/100)*200:50:maxX);
0128 set(get(AX(1),<span class="string">'Xlabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0129 set(get(AX(1),<span class="string">'Xlabel'</span>),<span class="string">'FontSize'</span>,16)
0130 set(AX(1),<span class="string">'Position'</span>,[0.05 0.1 0.4 0.8]);
0131 axis(AX(1),[minX maxX 0.5 length(X1)+0.5 ]);
0132 <span class="comment">% axis(AX(1),[-250 250 0 length(X1)+0.5 ]);</span>
0133 
0134 set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0135 set(AX(2),<span class="string">'YTick'</span>,1:length(X1),<span class="string">'YTickLabelMode'</span>,<span class="string">'manual'</span>);
0136 set(AX(2),<span class="string">'XAxisLocation'</span>,<span class="string">'top'</span>);
0137 set(get(AX(2),<span class="string">'Xlabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0138 set(get(AX(2),<span class="string">'Xlabel'</span>),<span class="string">'FontSize'</span>,16);
0139 axis(AX(2),[0 1 0.5 length(X1)+0.5 ]);
0140 set(AX(2),<span class="string">'Position'</span>,[0.05 0.1 0.4 0.8]);
0141 
0142 <span class="comment">% ylabel('Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0) (blue)');</span>
0143 title(<span class="string">'Qualitatively forward, but probably quantitatively reverse, using group contribution estimates of \Delta_{r}G^{\primem}.'</span>,<span class="string">'FontSize'</span>,16)
0144 
0145 <span class="keyword">for</span> n=1:length(xip)
0146 <span class="comment">%     textLen(n)=length(model.rxn(xip(n)).officialName)+length(model.rxn(xip(n)).equation);</span>
0147 <span class="comment">%     textLen(n)=length(model.rxn(xip(n)).equation);</span>
0148    textLen(n)=length(model.rxn(xip(n)).officialName);
0149 <span class="keyword">end</span>
0150 textLenMax=max(textLen);
0151 <span class="keyword">for</span> n=1:length(xip)
0152 <span class="comment">%     YTickLabel{n}=[model.rxn(xip(n)).officialName blanks(textLenMax-textLen(n)+5) model.rxn(xip(n)).equation];</span>
0153     YTickLabel{n}=[model.rxn(xip(n)).officialName <span class="string">' '</span> model.rxn(xip(n)).equation];
0154     <span class="comment">%get rid of the cytoplasmic compartment abbreviations</span>
0155     YTickLabel{n} = strrep(YTickLabel{n}, <span class="string">'[c]'</span>, <span class="string">''</span>);
0156     
0157    <span class="comment">% no idea why this does not work</span>
0158    <span class="comment">%     fprintf('%s\n',[model.rxn(xip(n)).officialName blanks(textLenMax-textLen(n)+5) model.rxn(xip(n)).equation]);</span>
0159 <span class="keyword">end</span>
0160 set(AX(2),<span class="string">'YTickLabel'</span>,YTickLabel,<span class="string">'FontSize'</span>,16);
0161 saveas(figure1 ,<span class="string">'fwdProbReverseGC'</span>,<span class="string">'fig'</span>);
0162 
0163 <span class="comment">%change back</span>
0164 <span class="keyword">if</span> miliMolarStandard
0165     model.dGt0Min=dGt0Min;
0166     model.dGt0Max=dGt0Max;
0167 <span class="keyword">end</span>
0168 
0169 
0170 <span class="comment">%horizontal bar</span>
0171 horizontal=0;
0172 <span class="keyword">if</span> horizontal
0173     [nMet,nRxn]=size(model.S);
0174     <span class="keyword">if</span> miliMolarStandard
0175         dGt0Min=model.dGt0Min;
0176         dGt0Max=model.dGt0Max;
0177         <span class="keyword">for</span> n=1:nRxn
0178             model.dGt0Min(n)=model.rxn(n).dGtmMMin;
0179             model.dGt0Max(n)=model.rxn(n).dGtmMMax;
0180         <span class="keyword">end</span>
0181     <span class="keyword">end</span>
0182     <span class="comment">%forward possibly reversible</span>
0183     dGfGCforwardReversibleBool=directions.ChangeForwardReversibleBool_dGfGC;
0184     <span class="comment">%forward, probably reverse</span>
0185     fwdProbReverse=directions.ChangeForwardReversibleBool_dGfGC_byConcRHS | <span class="keyword">...</span>
0186         directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS | <span class="keyword">...</span>
0187         directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS;
0188     
0189     <span class="comment">%plot regions 5,6,7, with region 6 shaded</span>
0190     X1=1:nRxn;
0191     <span class="comment">%dGrt0</span>
0192     Y0=(model.dGt0Min+model.dGt0Max)/2;
0193     L0=Y0-model.dGt0Min;
0194     U0=model.dGt0Max-Y0;
0195     <span class="comment">%dGrt</span>
0196     Y=(model.dGtMin+model.dGtMax)/2;
0197     L=Y-model.dGtMin;
0198     U=model.dGtMax-Y;
0199     <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0200     <span class="comment">%range of dGt0</span>
0201     P = normcdf(0,Y0,L0);
0202     <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0203     [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0204     <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0205     <span class="comment">%     take them in order of descending P</span>
0206     xip2=zeros(nnz(fwdProbReverse),1);
0207     p=1;
0208     <span class="keyword">for</span> n=1:nRxn
0209         <span class="keyword">if</span> fwdProbReverse(xip(n))
0210             xip2(p)=xip(n);
0211             p=p+1;
0212         <span class="keyword">end</span>
0213     <span class="keyword">end</span>
0214     xip=xip2;
0215     X1=1:length(xip);
0216     
0217     <span class="comment">%replace the NaN due to zero st dev</span>
0218     nNaNpRHS=nnz(directions.ChangeForwardReversibleBool_dGfGC_byConc_No_dGt0ErrorRHS);
0219     <span class="keyword">if</span> nNaNpRHS~=nnz(isnan((P(fwdProbReverse))))
0220         warning(<span class="string">'ExtraCategory'</span>);
0221     <span class="keyword">end</span>
0222     <span class="comment">%nans are first in the ordering of indexes</span>
0223     NaNPInd=xip(1:nNaNpRHS);
0224     <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0225     [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0226     <span class="comment">%new ordering with NaNs sorted to right</span>
0227     xip=[xip(nNaNpRHS+1:end); NaNPInd(xipNaNPInd(1:nNaNpRHS))];
0228     
0229     figure1 = figure(<span class="string">'PaperSize'</span>,[11 8.5],<span class="string">'PaperOrientation'</span>,<span class="string">'landscape'</span>);
0230     <span class="comment">% Create axes</span>
0231     axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0232     hold on;
0233     <span class="comment">%upper and lower Y</span>
0234     minY=min(model.dGtMin(fwdProbReverse));
0235     maxY=max(model.dGtMax(fwdProbReverse));
0236     <span class="comment">%baselines</span>
0237     PreversibleBar_byConcRHS=ones(1,nRxn)*minY;
0238     <span class="comment">%bar for 6</span>
0239     PreversibleBar_byConcRHS(directions.ChangeForwardReversibleBool_dGfGC_byConcRHS &amp; directions.ChangeForwardReversibleBool_dGfGC_bydGt0RHS)=maxY;
0240     bar_handle6=bar(X1,PreversibleBar_byConcRHS(xip),1,<span class="string">'BaseValue'</span>,minY,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0241     
0242     <span class="comment">%dGrt errorbar</span>
0243     hE=errorbar(X1,Y(xip),L(xip),U(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'r'</span>);
0244     <span class="comment">% adjust error bar width</span>
0245     hE_c=get(hE, <span class="string">'Children'</span>);
0246     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0247     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0248     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0249     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0250     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0251     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0252     <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0253     hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'DisplayName'</span>,<span class="string">'forwardReversible'</span>,<span class="string">'Color'</span>,<span class="string">'b'</span>);
0254     <span class="comment">% adjust error bar width</span>
0255     hE_c=get(hE2, <span class="string">'Children'</span>);
0256     errorbarXData= get(hE_c(2), <span class="string">'XData'</span>);
0257     errorbarXData(4:9:end) = errorbarXData(1:9:end) - 0;
0258     errorbarXData(7:9:end) = errorbarXData(1:9:end) - 0;
0259     errorbarXData(5:9:end) = errorbarXData(1:9:end) + 0;
0260     errorbarXData(8:9:end) = errorbarXData(1:9:end) + 0;
0261     set(hE_c(2), <span class="string">'XData'</span>, errorbarXData);
0262     
0263     <span class="comment">%mean dGrt0</span>
0264     plot(X1,Y0(xip),<span class="string">'.'</span>,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0265     <span class="comment">%zero line</span>
0266     <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0267     <span class="comment">%normal distribution about the mean dGt0</span>
0268     [AX,H1,H2]=plotyy(X1,zeros(1,length(X1)),X1,P(xip));
0269     set(AX(1),<span class="string">'YTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minY/100)*200:50:maxY);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0270     set(AX(2),<span class="string">'YTick'</span>,[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]);
0271     set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0272     set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0273     plot(X1,zeros(1,length(X1)),<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0274     <span class="comment">%axis limits</span>
0275     axis(AX(1),[0 length(X1) minY maxY])
0276     set(AX(1),<span class="string">'FontSize'</span>,16)
0277     set(AX(2),<span class="string">'FontSize'</span>,16,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0278     axis(AX(2),[0 length(X1) 0 1])
0279     title({<span class="string">'Qualitatively forward, but quantitatively reversible'</span> ; <span class="string">'using group contribution estimates of \Delta_{r}G^{\primem}.'</span>},<span class="string">'FontSize'</span>,16)
0280     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0281     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>)
0282     set(get(AX(1),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0283     set(get(AX(2),<span class="string">'Ylabel'</span>),<span class="string">'FontSize'</span>,16)
0284     xlabel(<span class="string">'Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0) (blue)'</span>);
0285     saveas(figure1 ,<span class="string">'GCfwdProbFwd'</span>,<span class="string">'fig'</span>);
0286     
0287     <span class="comment">%change back</span>
0288     <span class="keyword">if</span> miliMolarStandard
0289         model.dGt0Min=dGt0Min;
0290         model.dGt0Max=dGt0Max;
0291     <span class="keyword">end</span>
0292 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>