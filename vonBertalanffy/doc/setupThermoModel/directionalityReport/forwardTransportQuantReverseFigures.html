<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of forwardTransportQuantReverseFigures</title>
  <meta name="keywords" content="forwardTransportQuantReverseFigures">
  <meta name="description" content="figure of the qualitatively forward transport reactions that are quantitatively reversible">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html directionalityReport -->
<h1>forwardTransportQuantReverseFigures
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>figure of the qualitatively forward transport reactions that are quantitatively reversible</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function forwardTransportQuantReverseFigures(model,directions,thorStandard) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> figure of the qualitatively forward transport reactions that are quantitatively reversible

create a vertical errorbar figure of the qualitatively forward transport reactions
that are quantitatively reversible, whether from group contribution or
Keq, that then need to be assigned to be forward, to limit the growth rate
 i.e. abc transporters or reactions involving protons

 INPUT
 model.transportRxnBool
 model.dGt0Min
 model.dGt0Max
 directions.ChangeForwardReversible
 thorStandard

 Ronan M.T. Fleming</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../setupThermoModel/external/ploterr.html" class="code" title="function hh = ploterr(x, y, xerr, yerr, varargin)">ploterr</a>	PLOTERR General error bar plot.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="directionalityCheckAll.html" class="code" title="function directions=directionalityCheckAll(model,cumNormProbCutoff,thorStandard,printToFile,printToTable,figures)">directionalityCheckAll</a>	Analysis of differences between qualitative and quantiative directionality assignments.</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function forwardTransportQuantReverseFigures(model,directions,thorStandard)</a>
0002 <span class="comment">% figure of the qualitatively forward transport reactions that are quantitatively reversible</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%create a vertical errorbar figure of the qualitatively forward transport reactions</span>
0005 <span class="comment">%that are quantitatively reversible, whether from group contribution or</span>
0006 <span class="comment">%Keq, that then need to be assigned to be forward, to limit the growth rate</span>
0007 <span class="comment">% i.e. abc transporters or reactions involving protons</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% INPUT</span>
0010 <span class="comment">% model.transportRxnBool</span>
0011 <span class="comment">% model.dGt0Min</span>
0012 <span class="comment">% model.dGt0Max</span>
0013 <span class="comment">% directions.ChangeForwardReversible</span>
0014 <span class="comment">% thorStandard</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Ronan M.T. Fleming</span>
0017 
0018 [nMet,nRxn]=size(model.S);
0019 <span class="comment">%transport reactions</span>
0020 forwardTransportQuantReverseBool=false(nRxn,1);
0021 <span class="keyword">for</span> n=1:nRxn
0022     <span class="comment">%if reaction directionality changed from forward to Reversible and als</span>
0023     <span class="comment">%a transport reaction</span>
0024     <span class="keyword">if</span> directions.ChangeForwardReversible(n) &amp;&amp; model.transportRxnBool(n)
0025         <span class="comment">%abc transporters or reactions involving protons</span>
0026         <span class="keyword">if</span> ~isempty(strfind(model.rxns{n},<span class="string">'abc'</span>)) ||  nnz(strcmp(<span class="string">'h[c]'</span>,model.mets(model.S(:,n)~=0)))~=0 || nnz(strcmp(<span class="string">'h[e]'</span>,model.mets(model.S(:,n)~=0)))~=0
0027             forwardTransportQuantReverseBool(n,1)=1;
0028         <span class="keyword">end</span>
0029     <span class="keyword">end</span>
0030 <span class="keyword">end</span>
0031 
0032 <span class="comment">%%%%%%%%%vertical%%%%%%%%%%%%%</span>
0033 <span class="keyword">if</span> thorStandard
0034     dGt0Min=model.dGt0Min;
0035     dGt0Max=model.dGt0Max;
0036     <span class="keyword">for</span> n=1:nRxn
0037         model.dGt0Min(n)=model.rxn(n).dGtmMMin;
0038         model.dGt0Max(n)=model.rxn(n).dGtmMMax;
0039     <span class="keyword">end</span>
0040 <span class="keyword">end</span>
0041 
0042 X1=1:nRxn;
0043 <span class="comment">%dGrt0</span>
0044 Y0=(model.dGt0Min+model.dGt0Max)/2;
0045 L0=Y0-model.dGt0Min;
0046 U0=model.dGt0Max-Y0;
0047 <span class="comment">%dGrt</span>
0048 Y=(model.dGtMin+model.dGtMax)/2;
0049 L=Y-model.dGtMin;
0050 U=model.dGtMax-Y;
0051 <span class="comment">%find the amount of reactions with normal cumulative distribution over</span>
0052 <span class="comment">%range of dGt0</span>
0053 P = normcdf(0,Y0,L0);
0054 <span class="comment">%sort by probability that a reaction is forward (puts any NaN first)</span>
0055 [tmp,xip]=sort(P,<span class="string">'descend'</span>);
0056 <span class="comment">%     only take the indices of the problematic reactions, but be sure to</span>
0057 <span class="comment">%     take them in order of descending P</span>
0058 xip2=zeros(nnz(forwardTransportQuantReverseBool),1);
0059 p=1;
0060 <span class="keyword">for</span> n=1:nRxn
0061     <span class="keyword">if</span> forwardTransportQuantReverseBool(xip(n))
0062         xip2(p)=xip(n);
0063         p=p+1;
0064     <span class="keyword">end</span>
0065 <span class="keyword">end</span>
0066 xip=xip2;
0067 X1=1:length(xip);
0068 
0069 <span class="comment">%replace the NaN due to zero st dev</span>
0070 forwardReversible_dGf_dG0Fwd=false(nRxn,1);
0071 forwardReversible_dGf_dG0Rev=false(nRxn,1);
0072 <span class="keyword">for</span> n=1:nRxn
0073     <span class="comment">%only the transport reactions</span>
0074     <span class="keyword">if</span> forwardTransportQuantReverseBool(n)
0075         <span class="keyword">if</span> model.dGt0Min(n)==model.dGt0Max(n)
0076             <span class="keyword">if</span> model.dGt0Min(n)&lt;0
0077                 forwardReversible_dGf_dG0Fwd(n)=1;
0078             <span class="keyword">else</span>
0079                 forwardReversible_dGf_dG0Rev(n)=1;
0080             <span class="keyword">end</span>
0081         <span class="keyword">end</span>
0082     <span class="keyword">end</span>
0083 <span class="keyword">end</span>
0084 nNaNpLHS=nnz(forwardReversible_dGf_dG0Fwd);
0085 nNaNpRHS=nnz( forwardReversible_dGf_dG0Rev);
0086 <span class="keyword">if</span> (nNaNpLHS+nNaNpRHS)~=nnz(isnan((P(forwardTransportQuantReverseBool))))
0087     warning(<span class="string">'ExtraCategory'</span>);
0088 <span class="keyword">end</span>
0089 <span class="comment">%nans are first in the ordering of indexes</span>
0090 NaNPInd=xip(1:nNaNpLHS+nNaNpRHS);
0091 <span class="comment">%sorts indices of the zero std dev met by their mean dG0t</span>
0092 [tmp,xipNaNPInd]=sort(Y0(NaNPInd));
0093 <span class="comment">%new ordering</span>
0094 xip=[NaNPInd(xipNaNPInd(1:nNaNpLHS)); xip(nNaNpLHS+nNaNpRHS+1:end); NaNPInd(xipNaNPInd(nNaNpLHS+1:nNaNpLHS+nNaNpRHS))];
0095 
0096 <span class="comment">% close all</span>
0097 figure1 = figure;
0098 <span class="comment">% Create axes</span>
0099 axes1 = axes(<span class="string">'Parent'</span>,figure1,<span class="string">'Color'</span>,[0.702 0.7804 1]);
0100 hold on;
0101 
0102 <span class="comment">%upper and lower X</span>
0103 minX=min(model.dGtMin(forwardTransportQuantReverseBool));
0104 maxX=max(model.dGtMax(forwardTransportQuantReverseBool));
0105 <span class="comment">%baselines</span>
0106 Y1(1:length(xip))=minX;
0107 P(P==1)=NaN;
0108 P(P==0.5)=NaN;
0109 Y1(~isnan(P(xip)) &amp; P(xip)~=1 &amp; P(xip)~=0.5)=maxX;
0110 bar_handle6=barh(X1,Y1,1,<span class="string">'BaseValue'</span>,minX,<span class="string">'FaceColor'</span>,[0.86 0.86 0.86],<span class="string">'EdgeColor'</span>,<span class="string">'none'</span>);
0111 
0112 <span class="comment">%dGrt errorbar</span>
0113 <span class="comment">%   PLOTERR(X,Y,{LX,UX},{LY,UY}) plots the graph of vector X vs. vector Y</span>
0114 <span class="comment">%   with error bars specified by LX and UX in horizontal direction and</span>
0115 <span class="comment">%   with error bars specified by LY and UY in vertical direction.</span>
0116 <span class="comment">%   H = PLOTERR(...) returns a vector of line handles in this order:</span>
0117 <span class="comment">%      H(1) = handle to datapoints</span>
0118 <span class="comment">%      H(2) = handle to errorbar y OR errorbar x if error y not specified</span>
0119 <span class="comment">%      H(3) = handle to errorbar x if error y specified</span>
0120 <span class="comment">% LineSpec=[''LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r'']</span>
0121 LineSpec=<span class="string">'r.'</span>;
0122 hE = <a href="../../setupThermoModel/external/ploterr.html" class="code" title="function hh = ploterr(x, y, xerr, yerr, varargin)">ploterr</a>(Y(xip),X1,{model.dGtMin(xip) model.dGtMax(xip)},[],LineSpec,<span class="string">'hhxy'</span>,0);
0123 set(hE(2),<span class="string">'LineWidth'</span>,5);
0124 <span class="comment">% hE=errorbar(X1,Y(xip),L(xip),U(xip),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','r');</span>
0125 <span class="comment">%dGrt0 errorbar on top and inside dGrt</span>
0126 LineSpec=<span class="string">'b.'</span>;
0127 hE = <a href="../../setupThermoModel/external/ploterr.html" class="code" title="function hh = ploterr(x, y, xerr, yerr, varargin)">ploterr</a>(Y0(xip),X1,{model.dGt0Min(xip) model.dGt0Max(xip)},[],LineSpec,<span class="string">'hhxy'</span>,0);
0128 set(hE(2),<span class="string">'LineWidth'</span>,5);
0129 <span class="comment">% hE2=errorbar(X1,Y0(xip),L0(xip),U0(xip),'LineStyle','none','LineWidth',2,'DisplayName','forwardReversible','Color','b');</span>
0130 
0131 <span class="comment">%mean dGrt0</span>
0132 plot(Y0(xip),X1,<span class="string">'.'</span>,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>,<span class="string">'Color'</span>,[0.3412 0.7961 0.1922]);
0133 <span class="comment">%zero line</span>
0134 <span class="comment">%cumulative probability that reaction is really forward, assuming a</span>
0135 <span class="comment">%normal distribution about the mean dGt0</span>
0136 [AX,H1,H2]=plotyy(zeros(1,length(X1)),X1,P(xip),X1);
0137 set(gca,<span class="string">'XTick'</span>,[]);
0138 set(AX(1),<span class="string">'XTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'YTick'</span>,floor(minX/100)*200:50:maxX);<span class="comment">%,'TickDirMode','manual','TickDir','out');</span>
0139 set(AX(2),<span class="string">'YTick'</span>,1:length(xip));
0140 set(H1,<span class="string">'LineStyle'</span>,<span class="string">'none'</span>)
0141 set(H2,<span class="string">'LineStyle'</span>,<span class="string">'-'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'Color'</span>,<span class="string">'k'</span>)
0142 plot(zeros(1,length(X1)),X1,<span class="string">'w'</span>,<span class="string">'LineWidth'</span>,2,<span class="string">'LineStyle'</span>,<span class="string">'--'</span>);
0143 <span class="comment">%axis limits</span>
0144 set(AX(1),<span class="string">'FontSize'</span>,10,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0145 set(AX(1),<span class="string">'YTick'</span>,[],<span class="string">'YTickLabelMode'</span>,<span class="string">'manual'</span>);
0146 set(AX(1),<span class="string">'XTickMode'</span>,<span class="string">'manual'</span>,<span class="string">'XTick'</span>,floor(minX/100)*200:50:maxX);
0147 set(get(AX(1),<span class="string">'Xlabel'</span>),<span class="string">'String'</span>,<span class="string">'\Delta_{r}G^{\primem}  (blue)    or     \Delta_{r}G^{\prime} (red) (kJ/mol)'</span>)
0148 set(get(AX(1),<span class="string">'Xlabel'</span>),<span class="string">'FontSize'</span>,10)
0149 set(AX(1),<span class="string">'Position'</span>,[0.05 0.1 0.4 0.8]);
0150 <span class="comment">% axis(AX(1),[minX maxX 0 length(X1)+0.5 ]);</span>
0151 axis(AX(1),[-350 350 0 length(X1)+0.5 ]);
0152 
0153 set(AX(2),<span class="string">'FontSize'</span>,10,<span class="string">'YColor'</span>,<span class="string">'k'</span>)
0154 set(AX(2),<span class="string">'YTick'</span>,1:length(X1),<span class="string">'YTickLabelMode'</span>,<span class="string">'manual'</span>);
0155 set(AX(2),<span class="string">'XAxisLocation'</span>,<span class="string">'top'</span>);
0156 set(get(AX(2),<span class="string">'Xlabel'</span>),<span class="string">'String'</span>,<span class="string">'P(\Delta_{r}G^{\primem}&lt;0)'</span>);
0157 set(get(AX(2),<span class="string">'Xlabel'</span>),<span class="string">'FontSize'</span>,10);
0158 axis(AX(2),[0 1 0.5 length(X1)+0.5 ]);
0159 set(AX(2),<span class="string">'Position'</span>,[0.05 0.1 0.4 0.8]);
0160 
0161 <span class="comment">% ylabel('Reactions, sorted by P(\Delta_{r}G^{\primem}&lt;0) (blue)');</span>
0162 title({<span class="string">'Qualitatively forward transport reactions, but quantitatively reversible'</span>},<span class="string">'FontSize'</span>,16)
0163 
0164 <span class="keyword">for</span> n=1:length(xip)
0165 <span class="comment">%     textLen(n)=length(model.rxn(xip(n)).officialName)+length(model.rxn(xip(n)).equation);</span>
0166 <span class="comment">%     textLen(n)=length(model.rxn(xip(n)).equation);</span>
0167    textLen(n)=length(model.rxn(xip(n)).officialName);
0168 <span class="keyword">end</span>
0169 textLenMax=max(textLen);
0170 <span class="keyword">for</span> n=1:length(xip)
0171     YTickLabel{n}=[model.rxn(xip(n)).officialName blanks(textLenMax-textLen(n)+5) model.rxn(xip(n)).equation];
0172     <span class="comment">%get rid of the cytoplasmic compartment abbreviations</span>
0173     YTickLabel{n} = strrep(YTickLabel{n}, <span class="string">'[c]'</span>, <span class="string">''</span>);
0174     
0175    <span class="comment">% no idea why this does not work</span>
0176    <span class="comment">%     fprintf('%s\n',[model.rxn(xip(n)).officialName blanks(textLenMax-textLen(n)+5) model.rxn(xip(n)).equation]);</span>
0177 <span class="keyword">end</span>
0178 set(AX(2),<span class="string">'YTickLabel'</span>,YTickLabel,<span class="string">'FontSize'</span>,10);
0179 saveas(figure1 ,<span class="string">'forwardTransportQuantReverseBoolSetToForward'</span>,<span class="string">'fig'</span>);
0180 
0181 <span class="comment">%change back</span>
0182 <span class="keyword">if</span> thorStandard
0183     model.dGt0Min=dGt0Min;
0184     model.dGt0Max=dGt0Max;
0185 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>