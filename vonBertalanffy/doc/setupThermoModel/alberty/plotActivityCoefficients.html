<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of plotActivityCoefficients</title>
  <meta name="keywords" content="plotActivityCoefficients">
  <meta name="description" content="Plots statistics on activity coefficients.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html alberty -->
<h1>plotActivityCoefficients
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Plots statistics on activity coefficients.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [n,edges,lambda]=plotActivityCoefficients(modelT) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">Plots statistics on activity coefficients.

plot a histogram of the distribution of activity coefficients
also a curve of  activity coefficients for different charges at a range of
ionic strengths 

INPUT
 model.met(i).lambda   activity coefficient
 model.temp            temperature
 
 Ronan M. T. Fleming</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [n,edges,lambda]=plotActivityCoefficients(modelT)</a>
0002 <span class="comment">%Plots statistics on activity coefficients.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%plot a histogram of the distribution of activity coefficients</span>
0005 <span class="comment">%also a curve of  activity coefficients for different charges at a range of</span>
0006 <span class="comment">%ionic strengths</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%INPUT</span>
0009 <span class="comment">% model.met(i).lambda   activity coefficient</span>
0010 <span class="comment">% model.temp            temperature</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Ronan M. T. Fleming</span>
0013 
0014 [nMet,nRxn]=size(modelT.S);
0015 p=1;
0016 <span class="keyword">for</span> x=1:nMet
0017     <span class="keyword">if</span> ~isempty(modelT.met(x).lambda)
0018         <span class="keyword">for</span> q=1:length(modelT.met(x).lambda)
0019             lambda(p)=modelT.met(x).lambda(q);
0020             <span class="keyword">if</span> lambda(p)&lt;0.01
0021                 fprintf(<span class="string">'%d\t%s\t%s\t%d\t%d\n'</span>,x,modelT.mets{x},modelT.metNames{x},modelT.met(x).aveZi,lambda(p));
0022             <span class="keyword">end</span>
0023             p=p+1;
0024         <span class="keyword">end</span>
0025     <span class="keyword">end</span>
0026 <span class="comment">%     chargeMag(x)=abs(modelT.met(x).aveZi);</span>
0027 <span class="keyword">end</span>
0028 
0029 edges=[0:0.01:1];
0030 n = histc(lambda,edges);
0031 bar(edges-0.005,n)
0032 <span class="comment">% xlim([0 1])</span>
0033 set(gca,<span class="string">'FontSize'</span>,14)
0034 xlabel(<span class="string">'Activity Coefficient'</span>,<span class="string">'FontSize'</span>,16)
0035 ylabel(<span class="string">'# Metabolite Species'</span>,<span class="string">'FontSize'</span>,16)
0036 
0037 <span class="comment">% figure</span>
0038 <span class="comment">% hist(chargeMag)</span>
0039 
0040 temp=modelT.temp; 
0041 gibbscoeff = (9.20483*temp)/10^3 - (1.284668*temp^2)/10^5 + (4.95199*temp^3)/10^8;
0042 gasConstant=modelT.gasConstant;
0043 isAll=zeros(1000,1);
0044 <span class="keyword">for</span> x=1:1000
0045     is=isAll(x);
0046     <span class="keyword">for</span> zi=1:4 
0047         lambda(zi,x)=exp(-(gibbscoeff/(gasConstant*temp))*(((zi.^2)*is^0.5)/(1 + 1.6*is^0.5)));
0048     <span class="keyword">end</span>
0049     isAll(x+1)=isAll(x)+(0.25/1000);
0050 <span class="keyword">end</span>
0051 figure;
0052 plot(isAll(1:1000),lambda',<span class="string">'LineWidth'</span>,2)
0053 ylabel(<span class="string">'Activity Coefficient, \gamma'</span>,<span class="string">'FontSize'</span>,16)
0054 xlabel(<span class="string">'Ionic strength (mol/L)'</span>,<span class="string">'FontSize'</span>,16)
0055 set(gca,<span class="string">'FontSize'</span>,14)</pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>