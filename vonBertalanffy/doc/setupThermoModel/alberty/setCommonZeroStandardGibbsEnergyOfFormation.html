<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of setCommonZeroStandardGibbsEnergyOfFormation</title>
  <meta name="keywords" content="setCommonZeroStandardGibbsEnergyOfFormation">
  <meta name="description" content="Set all Alberty's cofactor metabolites to have a common thermodynamic baseline.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html setupThermoModel --><!-- menu.html alberty -->
<h1>setCommonZeroStandardGibbsEnergyOfFormation
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Set all Alberty's cofactor metabolites to have a common thermodynamic baseline.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function model=setCommonZeroStandardGibbsEnergyOfFormation(model) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Set all Alberty's cofactor metabolites to have a common thermodynamic baseline.

 Set all the exceptional metabolites to have a common baseline.
 i.e. Standard transformed Gibbs energies of reactants with the baseline adjusted
 for certain paired cofactors e.g. fad &amp; fadh2, such that the
 difference between the two is the same as in Albertys data but
 the absolute values are consistent with the group contribution data

INPUT
 model                           Thermodynamic model
 modelT.met(m).dGft0             standard transformed Gibbs energy of formation(kJ/mol)
 modelT.met(m).dGft0Keq          standard transformed Gibbs energy of formation(kJ/mol)
 modelT.met(m).dGft0Source       origin of data, Keq or groupContFileName.txt
 modelT.met(m).dGft0GroupCont    group. cont. estimate of standard transformed Gibbs energy of formation(kJ/mol)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../setupThermoModel/transport/getCompartment.html" class="code" title="function [compartments,uniqueCompartments]=getCompartment(mets,numChar)">getCompartment</a>	Get the compartment for each metabolite, and the unique compartments</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../setupThermoModel/setupThermoModel.html" class="code" title="function [modelT,directions,solutionThermoRecon]=setupThermoModel(model,metAbbrAlbertyAbbr,metGroupCont,Alberty2006,computedSpeciesData,temp,PHA,IS,CHI,biomassRxnAbbr,rxnAbbrDatabaseID,defaultMetBounds,metBoundsFile,rxnBoundsFile,Legendre,useKeqData,nStdDevGroupCont,cumNormProbCutoff,figures,printToFile,secondPassAssignment)">setupThermoModel</a>	Thermodynamically constrains a COBRA model.</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function model=setCommonZeroStandardGibbsEnergyOfFormation(model)</a>
0002 <span class="comment">% Set all Alberty's cofactor metabolites to have a common thermodynamic baseline.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Set all the exceptional metabolites to have a common baseline.</span>
0005 <span class="comment">% i.e. Standard transformed Gibbs energies of reactants with the baseline adjusted</span>
0006 <span class="comment">% for certain paired cofactors e.g. fad &amp; fadh2, such that the</span>
0007 <span class="comment">% difference between the two is the same as in Albertys data but</span>
0008 <span class="comment">% the absolute values are consistent with the group contribution data</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%INPUT</span>
0011 <span class="comment">% model                           Thermodynamic model</span>
0012 <span class="comment">% modelT.met(m).dGft0             standard transformed Gibbs energy of formation(kJ/mol)</span>
0013 <span class="comment">% modelT.met(m).dGft0Keq          standard transformed Gibbs energy of formation(kJ/mol)</span>
0014 <span class="comment">% modelT.met(m).dGft0Source       origin of data, Keq or groupContFileName.txt</span>
0015 <span class="comment">% modelT.met(m).dGft0GroupCont    group. cont. estimate of standard transformed Gibbs energy of formation(kJ/mol)</span>
0016 
0017 <span class="comment">%OUTPUT</span>
0018 <span class="comment">% model.met(m).dGft0    Standard transformed Gibbs energies of reactants</span>
0019 <span class="comment">%                       with the baseline adjusted for certain paired</span>
0020 <span class="comment">%                       cofactors e.g. fad &amp; fadh2, such that the</span>
0021 <span class="comment">%                       difference between the two is the same as in</span>
0022 <span class="comment">%                       Albertys data but the absolute values are</span>
0023 <span class="comment">%                       consistent with the group contribution data</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% Ronan M.T. Fleming</span>
0026 
0027 <span class="comment">% Here is the list of cofactors in iAF1260 that have thermodynamic</span>
0028 <span class="comment">% properties backcalculated from Equilibrium values by Alberty</span>
0029 <span class="comment">% The compartments here are important since the same reactant in different</span>
0030 <span class="comment">% compartments may have different properties.</span>
0031 
0032 numChar=1;
0033 [allMetCompartments,uniqueCompartments]=<a href="../../setupThermoModel/transport/getCompartment.html" class="code" title="function [compartments,uniqueCompartments]=getCompartment(mets,numChar)">getCompartment</a>(model.mets,numChar);
0034 
0035 <span class="keyword">for</span> p=1:length(uniqueCompartments)
0036     
0037     n=1;
0038     leftAll{n}=[<span class="string">'fad'</span> uniqueCompartments{p}];
0039     rightAll{n}=[<span class="string">'fadh2'</span> uniqueCompartments{p}];
0040     n=n+1;
0041     leftAll{n}=[<span class="string">'q8'</span> uniqueCompartments{p}];
0042     rightAll{n}=[<span class="string">'q8h2'</span> uniqueCompartments{p}];
0043     n=n+1;
0044     leftAll{n}=[<span class="string">'nad'</span> uniqueCompartments{p}];
0045     rightAll{n}=[<span class="string">'nadh'</span> uniqueCompartments{p}];
0046     n=n+1;
0047     leftAll{n}=[<span class="string">'nad'</span> uniqueCompartments{p}]; <span class="comment">% it is essential that the nad nmn pair are in this position</span>
0048     rightAll{n}=[<span class="string">'nmn'</span> uniqueCompartments{p}];
0049     n=n+1;
0050     leftAll{n}=[<span class="string">'nadp'</span> uniqueCompartments{p}];
0051     rightAll{n}=[<span class="string">'nadph'</span> uniqueCompartments{p}];
0052     n=n+1;
0053     leftAll{n}=[<span class="string">'gthox'</span> uniqueCompartments{p}];
0054     rightAll{n}=[<span class="string">'gthrd'</span> uniqueCompartments{p}];
0055     n=n+1;
0056     leftAll{n}=[<span class="string">'fmn'</span> uniqueCompartments{p}];
0057     rightAll{n}=[<span class="string">'fmnh2'</span> uniqueCompartments{p}];
0058     n=n+1;
0059     <span class="comment">%here is the list of cofactors in E. coli which are covered by Albertys data</span>
0060     <span class="comment">%see:</span>
0061     <span class="comment">%Standard transformed Gibbs energies of coenzyme A derivatives as</span>
0062     <span class="comment">%functions of pH and ionic strength</span>
0063     <span class="comment">%R.A. Alberty / Biophysical Chemistry 104 (2003) 327ï¿½334</span>
0064     coAset={<span class="string">'coa'</span>,<span class="string">'aacoa'</span>,<span class="string">'accoa'</span>,<span class="string">'mmcoa-R'</span>,<span class="string">'mmcoa-S'</span>,<span class="string">'ppcoa'</span>,<span class="string">'succoa'</span>,<span class="string">'malcoa'</span>};
0065     leftAll{n}=[];n=n+1;
0066     leftAll{n}=[<span class="string">'ppcoa'</span> uniqueCompartments{p}];
0067     rightAll{n}=[<span class="string">'succoa'</span> uniqueCompartments{p}];
0068     n=n+1;
0069     leftAll{n}=[<span class="string">'ppcoa'</span> uniqueCompartments{p}];
0070     rightAll{n}=[<span class="string">'mmcoa-S'</span> uniqueCompartments{p}];
0071     n=n+1;
0072     leftAll{n}=[<span class="string">'ppcoa'</span> uniqueCompartments{p}];
0073     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0074     n=n+1;
0075     leftAll{n}=[];n=n+1;
0076     leftAll{n}=[<span class="string">'succoa'</span> uniqueCompartments{p}];
0077     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0078     n=n+1;
0079     leftAll{n}=[<span class="string">'succoa'</span> uniqueCompartments{p}];
0080     rightAll{n}=[<span class="string">'mmcoa-R'</span> uniqueCompartments{p}];
0081     n=n+1;
0082     leftAll{n}=[<span class="string">'malcoa'</span> uniqueCompartments{p}];
0083     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0084     n=n+1;
0085     leftAll{n}=[<span class="string">'malcoa'</span> uniqueCompartments{p}];
0086     rightAll{n}=[<span class="string">'accoa'</span> uniqueCompartments{p}];
0087     n=n+1;
0088     leftAll{n}=[];n=n+1;
0089     leftAll{n}=[<span class="string">'dpcoa'</span> uniqueCompartments{p}];
0090     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0091     n=n+1;
0092     leftAll{n}=[<span class="string">'dpcoa'</span> uniqueCompartments{p}];
0093     rightAll{n}=[<span class="string">'2tpr3dpcoa'</span> uniqueCompartments{p}];
0094     n=n+1;
0095     leftAll{n}=[<span class="string">'dpcoa'</span> uniqueCompartments{p}];
0096     rightAll{n}=[<span class="string">'pan4p'</span> uniqueCompartments{p}];
0097     n=n+1;
0098     leftAll{n}=[];n=n+1;
0099     leftAll{n}=[<span class="string">'sbzcoa'</span> uniqueCompartments{p}];
0100     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0101     n=n+1;
0102     leftAll{n}=[<span class="string">'aacoa'</span> uniqueCompartments{p}];
0103     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0104     n=n+1;
0105     <span class="comment">% Note this reaction that contains three cofactors:</span>
0106     <span class="comment">% KAT1, 3-ketoacyl-CoA thiolase [c] : aacoa + coa --&gt; (2) accoa</span>
0107     leftAll{n}=[<span class="string">'accoa'</span> uniqueCompartments{p}];
0108     rightAll{n}=[<span class="string">'coa'</span> uniqueCompartments{p}];
0109     n=n+1;
0110     leftAll{n}=[<span class="string">'accoa'</span> uniqueCompartments{p}];
0111     rightAll{n}=[<span class="string">'aacoa'</span> uniqueCompartments{p}];
0112     n=n+1;
0113     <span class="comment">%check 'mmcoa-R'</span>
0114     <span class="comment">% methylmalonyl-CoA epimerase</span>
0115     <span class="comment">% equation:    [c] : mmcoa-R &lt;==&gt; mmcoa-S</span>
0116     
0117     <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0118     [nMet,nRxn]=size(model.S);
0119     exceptions={<span class="string">'coa'</span>,<span class="string">'aacoa'</span>,<span class="string">'accoa'</span>,<span class="string">'ppcoa'</span>,<span class="string">'mmcoa_R'</span>,<span class="string">'mmcoa-R'</span>,<span class="keyword">...</span>
0120         <span class="string">'succoa'</span>,<span class="string">'gthrd'</span>,<span class="string">'gthox'</span>,<span class="string">'q8h2'</span>,<span class="string">'q8'</span>,<span class="string">'fmn'</span>,<span class="string">'fmnh2'</span>,<span class="string">'nad'</span>,<span class="keyword">...</span>
0121         <span class="string">'nadh'</span>,<span class="string">'nmn'</span>,<span class="string">'fad'</span>,<span class="string">'fadh2'</span>,<span class="string">'nadp'</span>,<span class="string">'nadph'</span>,<span class="string">'malcoa'</span>};
0122     <span class="comment">%NOTE: some cofactors in the pairs listed above are not listed in Albertys</span>
0123     <span class="comment">%tables e.g. mmcoa-S</span>
0124     
0125     exceptionMetBool=false(nMet,1);
0126     <span class="keyword">for</span> m=1:nMet
0127         abbr=model.mets{m};
0128         abbr=abbr(1:end-3);
0129         <span class="keyword">if</span> any(strcmp(abbr,exceptions))
0130             exceptionMetBool(m)=1;
0131         <span class="keyword">end</span>
0132     <span class="keyword">end</span>
0133     fprintf(<span class="string">'\n%s\n%s\n'</span>,<span class="string">'Setting all exceptional Alberty reactants to have a common thermodynamic'</span>,<span class="keyword">...</span>
0134         <span class="string">'baseline so that this data can be incorporated with group contribution data.'</span>)
0135     fprintf(<span class="string">'%s\n'</span>,<span class="string">'Before baseline edit of Cofactors:'</span>)
0136     fprintf(<span class="string">'%s\n'</span>,<span class="string">'Metabolite properties:'</span>)
0137     <span class="comment">%print out existing data</span>
0138     fprintf(<span class="string">'%10s\t%20s\t%s\t\t%s\t\t%s\n'</span>,<span class="string">'abbr'</span>,<span class="string">'albertyAbbr'</span>,<span class="string">'dGft0Keq'</span>,<span class="string">'dGft0gc'</span>,<span class="string">'dGft0'</span>);
0139     <span class="keyword">for</span> m=1:nMet
0140         <span class="keyword">if</span> exceptionMetBool(m)
0141             fprintf(<span class="string">'%10s\t%20s\t%8.4g\t\t%8.4g\t\t%8.4g\n'</span>,model.mets{m},model.met(m).albertyAbbreviation,model.met(m).dGft0Keq,model.met(m).dGft0GroupCont,model.met(m).dGft0);
0142         <span class="keyword">end</span>
0143     <span class="keyword">end</span>
0144     fprintf(<span class="string">'\n\n'</span>)
0145     
0146     fprintf(<span class="string">'%s\n'</span>,<span class="string">'Differences between pairs of cofactors:'</span>)
0147     fprintf(<span class="string">'%20s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n'</span>,<span class="string">'left-right'</span>,<span class="string">'#RxnLeft'</span>,<span class="string">'#RxnRight'</span>,<span class="string">'#Both'</span>,<span class="string">'#LNotR'</span>,<span class="string">'#RNotL'</span>,<span class="string">'dGt0Keq'</span>,<span class="string">'dGt0gc'</span>);
0148     xx=0;
0149     <span class="keyword">for</span> x=1:length(leftAll)
0150         <span class="keyword">if</span> isempty(leftAll{x})
0151             <span class="comment">%         fprintf('\n');</span>
0152         <span class="keyword">else</span>
0153             nCoFcLRxn=length(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0));
0154             nCoFcRRxn=length(find(model.S(strcmp(model.mets,rightAll{x}),:)~=0));
0155             nCoFc2Rxn=length(intersect(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0),find(model.S(strcmp(model.mets,rightAll{x}),:)~=0)));
0156             nCoLeftOnly=length(setdiff(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0),find(model.S(strcmp(model.mets,rightAll{x}),:)~=0)));
0157             nCoRightOnly=length(setdiff(find(model.S(strcmp(model.mets,rightAll{x}),:)~=0),find(model.S(strcmp(model.mets,leftAll{x}),:)~=0)));
0158             
0159             <span class="comment">%nothing to print out if no match</span>
0160             <span class="keyword">if</span> any(strcmp(model.mets,leftAll{x}))  &amp;&amp; any(strcmp(model.mets,rightAll{x}))
0161                 fprintf(<span class="string">'%20s\t\t%i\t\t\t%i\t\t%i\t\t%i\t\t%i\t\t%8.4g\t\t%8.4g\n'</span>,[leftAll{x} <span class="string">'-'</span> rightAll{x}],nCoFcLRxn,nCoFcRRxn,nCoFc2Rxn,nCoLeftOnly,nCoRightOnly,<span class="keyword">...</span>
0162                     model.met(strcmp(model.mets,leftAll{x})).dGft0Keq-model.met(strcmp(model.mets,rightAll{x})).dGft0Keq,<span class="keyword">...</span>
0163                     model.met(strcmp(model.mets,leftAll{x})).dGft0GroupCont-model.met(strcmp(model.mets,rightAll{x})).dGft0GroupCont);
0164             <span class="keyword">end</span>
0165             a=1;
0166         <span class="keyword">end</span>
0167     <span class="keyword">end</span>
0168     
0169     <span class="comment">%edit the baseline of a cofactor that is not always used in a pair</span>
0170     <span class="comment">%with another cofactor</span>
0171     coaSorted=0;
0172     x=1;
0173     <span class="keyword">while</span> x&lt;=length(leftAll)
0174         <span class="keyword">if</span> strcmp(<span class="string">'nad[c]'</span>,leftAll{x})
0175             pause(eps)
0176         <span class="keyword">end</span>
0177         <span class="comment">%check that both left and right cofactors are always used in the network</span>
0178         <span class="comment">%together because there is no need to change if they are always used</span>
0179         <span class="comment">%together on different sides of the reaction</span>
0180         <span class="keyword">if</span> any(strcmp(leftAll{x},model.mets)) &amp;&amp; any(strcmp(rightAll{x},model.mets))
0181             abbrL=leftAll{x};
0182             abbrR=rightAll{x};
0183             <span class="comment">%abbrL=abbrL(1:end-3);</span>
0184             <span class="comment">%abbrR=abbrR(1:end-3);</span>
0185             <span class="comment">%check if coa is involved since coa is a special case that is not a</span>
0186             <span class="comment">%simple cofactor pair</span>
0187             <span class="keyword">if</span> ~(any(strcmp(abbrL,coAset) | any(strcmp(abbrR,coAset))))
0188                 nCoLeftOnly=length(setdiff(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0),find(model.S(strcmp(model.mets,rightAll{x}),:)~=0)));
0189                 nCoRightOnly=length(setdiff(find(model.S(strcmp(model.mets,rightAll{x}),:)~=0),find(model.S(strcmp(model.mets,leftAll{x}),:)~=0)));
0190                 <span class="comment">%identify which one in each cofactor pair is synthesised/used in</span>
0191                 <span class="comment">%another reaction, besides just being used in reactions with its</span>
0192                 <span class="comment">%paired cofactor</span>
0193                 <span class="keyword">if</span> nCoLeftOnly==0 &amp;&amp; nCoRightOnly~=0
0194                     abbrL=leftAll{x};
0195                     abbrR=rightAll{x};
0196                     <span class="comment">%calculate the difference between the group contribution</span>
0197                     <span class="comment">%estimate and Albertys value</span>
0198                     baseLineChange=model.met(strcmp(model.mets,abbrR)).dGft0GroupCont-model.met(strcmp(model.mets,abbrR)).dGft0Keq;
0199                     <span class="comment">%abbrL=abbrL(1:end-3);</span>
0200                     <span class="comment">%abbrR=abbrR(1:end-3);</span>
0201                     <span class="keyword">for</span> m=1:nMet
0202                         abbr=model.mets{m};
0203                         abbr=abbr(1:end-3);
0204                         <span class="keyword">if</span> any(strcmp(abbr,{abbrL,abbrR}))
0205                             <span class="comment">%only change if we are using Albertys data</span>
0206                             <span class="keyword">if</span> strcmp(model.met(m).dGft0Source,<span class="string">'Keq'</span>)
0207                                 model.met(m).dGft0=model.met(m).dGft0+baseLineChange;
0208                             <span class="keyword">end</span>
0209                         <span class="keyword">end</span>
0210                     <span class="keyword">end</span>
0211                 <span class="keyword">end</span>
0212                 
0213                 <span class="keyword">if</span> nCoLeftOnly~=0 &amp;&amp; nCoRightOnly==0
0214                     abbrL=leftAll{x};
0215                     abbrR=rightAll{x};
0216                     <span class="comment">%calculate the difference between the group contribution</span>
0217                     <span class="comment">%estimate and Albertys value</span>
0218                     baseLineChange=model.met(strcmp(model.mets,abbrL)).dGft0GroupCont-model.met(strcmp(model.mets,abbrL)).dGft0Keq;
0219                     <span class="comment">%abbrL=abbrL(1:end-3);</span>
0220                     <span class="comment">%abbrR=abbrR(1:end-3);</span>
0221                     <span class="keyword">for</span> m=1:nMet
0222                         abbr=model.mets{m};
0223                         abbr=abbr(1:end-3);
0224                         <span class="keyword">if</span> any(strcmp(abbr,{abbrL,abbrR}))
0225                             <span class="comment">%only change if we are using Albertys data</span>
0226                             <span class="keyword">if</span> strcmp(model.met(m).dGft0Source,<span class="string">'Keq'</span>)
0227                                 model.met(m).dGft0=model.met(m).dGft0+baseLineChange;
0228                             <span class="keyword">end</span>
0229                         <span class="keyword">end</span>
0230                     <span class="keyword">end</span>
0231                     <span class="keyword">if</span> strcmp(leftAll{x},[<span class="string">'nad'</span> uniqueCompartments{p}]) &amp;&amp; strcmp(rightAll{x},[<span class="string">'nadh'</span> uniqueCompartments{p}]) &amp;&amp; any(strcmp(model.mets,[<span class="string">'nmn'</span> uniqueCompartments{p}] ))
0232                         fprintf(<span class="string">'%s\n'</span>,[<span class="string">'Assuming Albertys value for nmn is set to nad baseline'</span>]);
0233                         <span class="keyword">for</span> m=1:nMet
0234                             <span class="comment">%abbr=model.mets{m};</span>
0235                             <span class="comment">%abbr=abbr(1:end-3);</span>
0236                             <span class="keyword">if</span> any(strcmp(abbr,<span class="string">'nmn'</span>))
0237                                 <span class="comment">%only change if we are using Albertys data</span>
0238                                 <span class="keyword">if</span> strcmp(model.met(m).dGft0Source,<span class="string">'Keq'</span>)
0239                                     model.met(m).dGft0=model.met(m).dGft0+baseLineChange;
0240                                     
0241                                 <span class="keyword">end</span>
0242                             <span class="keyword">end</span>
0243                         <span class="keyword">end</span>
0244                         <span class="comment">%ensure that nad baseline is not changed twice due to nad also</span>
0245                         <span class="comment">%appearing as a cofactor with nmn</span>
0246                         <span class="comment">%skip the next pair as it is nad[c] &amp; nmn[c]</span>
0247                         x=x+1;
0248                     <span class="keyword">end</span>
0249                 <span class="keyword">end</span>
0250                 
0251             <span class="keyword">else</span>
0252                 <span class="comment">%for the cofactors associated with coa by Alberty, then set coA to</span>
0253                 <span class="comment">%have the same baseline as the group contribution data</span>
0254                 <span class="keyword">if</span> coaSorted==0
0255                     <span class="keyword">for</span> s=1:length(coAset)
0256                         baseLineChange=model.met(strcmp(model.mets,<span class="string">'coa[c]'</span>)).dGft0GroupCont-model.met(strcmp(model.mets,<span class="string">'coa[c]'</span>)).dGft0Keq;
0257                         <span class="keyword">for</span> m=1:nMet
0258                             <span class="comment">%abbr=model.mets{m};</span>
0259                             <span class="comment">%abbr=abbr(1:end-3);</span>
0260                             <span class="keyword">if</span> strcmp(coAset{s},abbr)
0261                                 <span class="comment">%only change if we are using Albertys data</span>
0262                                 <span class="keyword">if</span> strcmp(model.met(m).dGft0Source,<span class="string">'Keq'</span>)
0263                                     model.met(m).dGft0=model.met(m).dGft0+baseLineChange;
0264                                 <span class="keyword">end</span>
0265                             <span class="keyword">end</span>
0266                         <span class="keyword">end</span>
0267                     <span class="keyword">end</span>
0268                     coaSorted=1;
0269                 <span class="keyword">end</span>
0270             <span class="keyword">end</span>
0271         <span class="keyword">end</span>
0272         x=x+1;
0273     <span class="keyword">end</span>
0274     <span class="comment">%compartment by compartment</span>
0275     coASorted=0;
0276 <span class="keyword">end</span>
0277 
0278 fprintf(<span class="string">'\n\n'</span>)
0279 fprintf(<span class="string">'%s\n'</span>,<span class="string">'After baseline edit of Cofactors:'</span>)
0280 fprintf(<span class="string">'%s\n'</span>,<span class="string">'Metabolite properties:'</span>)
0281 fprintf(<span class="string">'%10s\t%20s\t%s\t\t%s\t\t%s\n'</span>,<span class="string">'abbr'</span>,<span class="string">'albertyAbbr'</span>,<span class="string">'dGft0Keq'</span>,<span class="string">'dGft0gc'</span>,<span class="string">'dGft0'</span>);
0282 <span class="comment">%print out the new changes</span>
0283 <span class="keyword">for</span> m=1:nMet
0284     <span class="keyword">if</span> exceptionMetBool(m)
0285         fprintf(<span class="string">'%10s\t%20s\t%8.4g\t\t%8.4g\t\t%8.4g\n'</span>,model.mets{m},model.met(m).albertyAbbreviation,model.met(m).dGft0Keq,model.met(m).dGft0GroupCont,model.met(m).dGft0);
0286     <span class="keyword">end</span>
0287 <span class="keyword">end</span>
0288 
0289 fprintf(<span class="string">'\n\n'</span>);
0290 fprintf(<span class="string">'%s\n'</span>,<span class="string">'Differences between pairs of cofactors:'</span>)
0291 fprintf(<span class="string">'%20s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n'</span>,<span class="string">'left-right'</span>,<span class="string">'#RxnLeft'</span>,<span class="string">'#RxnRight'</span>,<span class="string">'#Both'</span>,<span class="string">'#LNotR'</span>,<span class="string">'#RNotL'</span>,<span class="string">'dGtr0Keq'</span>,<span class="string">'dGrt0'</span>);
0292 <span class="keyword">for</span> x=1:length(leftAll)
0293     <span class="keyword">if</span> isempty(leftAll{x})
0294         <span class="comment">%         fprintf('\n');</span>
0295     <span class="keyword">else</span>
0296         nCoFcLRxn=length(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0));
0297         nCoFcRRxn=length(find(model.S(strcmp(model.mets,rightAll{x}),:)~=0));
0298         nCoFc2Rxn=length(intersect(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0),find(model.S(strcmp(model.mets,rightAll{x}),:)~=0)));
0299         nCoLeftOnly=length(setdiff(find(model.S(strcmp(model.mets,leftAll{x}),:)~=0),find(model.S(strcmp(model.mets,rightAll{x}),:)~=0)));
0300         nCoRightOnly=length(setdiff(find(model.S(strcmp(model.mets,rightAll{x}),:)~=0),find(model.S(strcmp(model.mets,leftAll{x}),:)~=0)));
0301 
0302         <span class="comment">%nothing to print out if no match</span>
0303         <span class="keyword">if</span> any(strcmp(model.mets,leftAll{x}))  &amp;&amp; any(strcmp(model.mets,rightAll{x}))
0304             fprintf(<span class="string">'%20s\t\t%i\t\t\t%i\t\t%i\t\t%i\t\t%i\t\t%8.4g\t\t%8.4g\n'</span>,[leftAll{x} <span class="string">'-'</span> rightAll{x}],nCoFcLRxn,nCoFcRRxn,nCoFc2Rxn,nCoLeftOnly,nCoRightOnly,<span class="keyword">...</span>
0305                 model.met(strcmp(model.mets,leftAll{x})).dGft0Keq-model.met(strcmp(model.mets,rightAll{x})).dGft0Keq,<span class="keyword">...</span>
0306                 model.met(strcmp(model.mets,leftAll{x})).dGft0-model.met(strcmp(model.mets,rightAll{x})).dGft0);
0307         <span class="keyword">end</span>
0308     <span class="keyword">end</span>
0309 <span class="keyword">end</span>
0310 
0311 
0312 <span class="comment">%OLD CODE -may still be usefull for looking at nullspace of internal</span>
0313 <span class="comment">%reactions that are also involve cofactors</span>
0314 <span class="comment">% if ~exist('exceptions','var')</span>
0315 <span class="comment">%     exceptions={'coa','aacoa','accoa','ppcoa','mmcoa_R','mmcoa-R',...</span>
0316 <span class="comment">%         'succoa','gthrd','gthox','q8h2','q8','fmn','fmnh2','nad',...</span>
0317 <span class="comment">%         'nadh','fad','fadh2','nadp','nadph','malcoa'};</span>
0318 <span class="comment">% end</span>
0319 <span class="comment">%</span>
0320 <span class="comment">%</span>
0321 <span class="comment">% [nMet,nRxn]=size(model.S);</span>
0322 <span class="comment">%</span>
0323 <span class="comment">% if ~isfield(model,'biomassRxnAbbr')</span>
0324 <span class="comment">%     if ~exist('biomassRxnAbbr')</span>
0325 <span class="comment">%         fprintf('\n%s\n','...checkObjective');</span>
0326 <span class="comment">%         objectiveAbbr=checkObjective(model);</span>
0327 <span class="comment">%         fprintf('%s\n',['Asumming objective is ' objectiveAbbr]);</span>
0328 <span class="comment">%         model.biomassRxnAbbr=objectiveAbbr;</span>
0329 <span class="comment">%     else</span>
0330 <span class="comment">%         model.biomassRxnAbbr=biomassRxnAbbr;</span>
0331 <span class="comment">%     end</span>
0332 <span class="comment">% end</span>
0333 <span class="comment">%</span>
0334 <span class="comment">% %finds the reactions in the model which export/import from the model</span>
0335 <span class="comment">% %boundary</span>
0336 <span class="comment">% %e.g. Exchange reactions</span>
0337 <span class="comment">% %     Demand reactions</span>
0338 <span class="comment">% %     Sink reactions</span>
0339 <span class="comment">% model=findSExRxnInd(model);</span>
0340 <span class="comment">% %OUTPUT</span>
0341 <span class="comment">% % model.SIntRxnInd          indices of internal reactions</span>
0342 <span class="comment">% % model.SExRxnInd           indices of boundary reactions</span>
0343 <span class="comment">% intRxnBool=false(1,nRxn);</span>
0344 <span class="comment">% intRxnBool(model.SIntRxnInd)=1;</span>
0345 <span class="comment">%</span>
0346 
0347 <span class="comment">%</span>
0348 <span class="comment">% %extract subnetwork</span>
0349 <span class="comment">% modelE=model;</span>
0350 <span class="comment">% %reactions</span>
0351 <span class="comment">% exceptionRxnBool=logical(sign(sum(abs(model.S(exceptionMetBool,:)),1)));</span>
0352 <span class="comment">% %only keep internal reactions involving exceptional metabolites</span>
0353 <span class="comment">% modelE.S=modelE.S(:,exceptionRxnBool &amp; intRxnBool);</span>
0354 <span class="comment">% modelE.rxns=modelE.rxns(exceptionRxnBool &amp; intRxnBool);</span>
0355 <span class="comment">% modelE.lb=modelE.lb(exceptionRxnBool &amp; intRxnBool);</span>
0356 <span class="comment">% modelE.ub=modelE.ub(exceptionRxnBool &amp; intRxnBool);</span>
0357 <span class="comment">% %metabolites</span>
0358 <span class="comment">% keepMetBool=false(nMet,1);</span>
0359 <span class="comment">% for m=1:nMet</span>
0360 <span class="comment">%     if nnz(modelE.S(m,:))~=0</span>
0361 <span class="comment">%         keepMetBool(m,1)=1;</span>
0362 <span class="comment">%     end</span>
0363 <span class="comment">% end</span>
0364 <span class="comment">% modelE.S=modelE.S(keepMetBool,:);</span>
0365 <span class="comment">% modelE.mets=modelE.mets(keepMetBool);</span>
0366 <span class="comment">%</span>
0367 <span class="comment">% exceptionMetBool=false(nMet,1);</span>
0368 <span class="comment">% for m=1:nMet</span>
0369 <span class="comment">%     abbr=model.mets{m};</span>
0370 <span class="comment">%     if any(strcmp(abbr(end-2:end),'[c]'))</span>
0371 <span class="comment">%         abbr=abbr(1:end-3);</span>
0372 <span class="comment">%         if any(strcmp(abbr,exceptions))</span>
0373 <span class="comment">%             exceptionMetBool(m)=1;</span>
0374 <span class="comment">%         end</span>
0375 <span class="comment">%     end</span>
0376 <span class="comment">% end</span>
0377 
0378 
0379 
0380 
0381 
0382</pre></div>
<hr><address>Generated on Fri 20-May-2011 17:06:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>