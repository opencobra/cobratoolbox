<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/opencobra/cobratoolbox@ffa0229fc0c01c9236bb7e961f65712443277719/latest/_static/js/iframeResizer.contentWindow.min.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: normal; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: normal; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: center;  }
.S4 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: normal; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis</span></h1><h2  class = 'S1'><span>Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.</span></h2><h2  class = 'S1'><span>Reviewer: Francisco J. Planes, TECNUN, University of Navarra, Laurent Heirendt, University of Luxembourg.</span></h2><h2  class = 'S1'><span>INTRODUCTION</span></h2><div  class = 'S2'><span>We consider a biochemical network of </span><span> </span><span style=' font-family: monospace;'>m </span><span>molecular species and </span><span> </span><span style=' font-family: monospace;'>n</span><span> </span><span> biochemical reactions. The biochemical network is mathematically represented by a stoichiometric matrix </span><span texencoding="S\in\mathcal{Z}^{m\times n}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="63.5" height="19" /></span><span>. In standard notation, flux balance analysis (FBA) is the linear optimisation problem</span></div><div  class = 'S3'><span texencoding="\begin{array}{ll}
\min\limits _{v} &amp; \rho(v)\equiv c^{T}v\\
\text{s.t.} &amp; Sv=b,\\
 &amp; l\leq v\leq u,
\end{array}" style="vertical-align:-30px"><img src="data:image/png;base64,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" width="103.5" height="72" /></span></div><div  class = 'S2'><span>where </span><span texencoding="$c\in\Re^{n}$" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="46.5" height="19" /></span><span> is a parameter vector that linearly combines one or more reaction fluxes to form what is termed the objective function,  and where a </span><span texencoding="$b_{i}&lt;0$" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAoCAYAAAC/xadkAAAFKklEQVRoQ+2ZZcgtVRSGn2t3NwZXxe7CLrBFxB+K3Y0NdnfXFQNbfyioiIoFdiC2YCsqdjcWJs91zcfccyfPzLl8HGbB9+M7s/fae7+z9rvetWYMnfWNwJi+Z3YT6cBrEAQdeB14DRBoMLWLvAGBNzOwWPwtDiwI7NZgraGbWhR5OwFrAbsC0wJPAOsNHQL/H2hj4EBgfhifRKcEbgcuBn7MO3OVa/sWYOSdApw8ZOBNBlwawJ0HHAP8DSwP3Av8BmwOvJt17jLwZgjkXWQd4KkhA89gOAl4AVg9gEuO6Hm9be8Aq2VFYBl4WwL3AD8BswN/DRF48vkbwOTARsBDGWd7NoA7Fziq93kZeJcABwN3AtuMUuBmBA6Il3tkjT1eDewF/AHMAvyeMfcs4Oi4vvNEEI0MKwPvTWAJYD/gqhobmxRDPfBBwKHAbMD1wB4VFzbavgDmAB4DNsiZtwnwQDzbBbg5Pa4IvAWAj2LwwsAHEeIbhnxx8YeBHypuuK1hHljABG6mWN+sWJgZexZfGngtfjNhHJKzubkDZB/fAOxeFTzf4rWRaeSHNYHrIvMmPgRwK+D5tpAp8OO1OQLYH5ge+D4Ak1py5USFiCpSEVOnrvMrwIpVwbsV2A64DLgNkDRPAJ4BVgHuiOvyKrDcAMFTe8llewPTBGgXAYJmIuvH9gSuiYmHxUvI8/Nr6NxvgDmrgKc0+SpIeN9IFtv2bPacOJT+vErf9nOKgjljg6ytaqYCvgMuBMY1AC1ZziA4Nf7xKnol8+wzYN5QGornEcvjvJVD+/wJPBhX5ZMe7yaRK+K3RYD3WwJPijgW2BGYIl5KAtrPLa2hGD4zfFlB3VTg98MoTc3GVlql4KWdyzFXZjg/HTgO+Ceuk0A3sWXCnxFu5BvJFwRttAVasj+jTf7WlGJGc55JDcqh94BFq4D3KLA+8HUK9V7npnBTuWPNwE3MaNPPfOHEDSvQn2zitGDuZsB98fxE4LScsUZ+EhTuZd0y8Mxk8os8o1Od95oc8HFIlyzO8EofHuq8qpQxGZjhVfJ2cLS7gpteahnEtFQx+bjXLJPLDSDtFmCHMvAshC2KRXwh4PMMr2fHIV8HVsgo2wTAq+8mP615cEl555ifXJO7A8QXa/rKGy7XfxnZ0xtkJGZZUt/6bKJCISthKDYVjTYBnNxrJgdBk5dU5k/nLKyKt0PRrzlfqWTy8CVo1tlmSQv5piaPqyR+AWZNXc+036RxYE1vIJl5RywLPIvlJYHLo1WTHq9otJyxA7EPYH04aHOPWwPHAyvFYt4MxW0Tcb4UoEY1CNbOCQJ5zmdmY7PyBNYLnoJULtN6s6wcaP1oNvSNJdkq7dDwl1RNADYT5Yk2Tf+CaLWjSfqC+FyfiyRa1SLAc6VtVcCuipxnf89qqhA8JyQbkbwFS1sWuDF0l8BZZWSZL0N5oWq3lLGkGYRJF4KYZPn7Q+a8XHMx+dVKw6Jfnj4/pJcvXy6cLsrPzJeTdW03DYGqwrdmtHthaWLomv3Kenq2r9YIVf5vzcPUHe46as0tsgr3Gs6kBdvwCfcJmlFtCThRxCV+y1pSNdYfPzSpCARwUn4sMsoV2RO0jOpuvu74tsGT7x4HtgdsLAy1tQ3eGVHMzzWARsGoexFtg/cI4EcjP5j4xe3tUXfiFjfUJnj6shSzvWOWVTz75WlorU3wBElRqVa0cZn1NWqogGwbvKECp+wwHXhlCBU878DrwGuAQIOpXeR14DVAoMHULvIagPcftJ73KXkJ7JYAAAAASUVORK5CYII=" width="39.5" height="20" /></span><span>, or  </span><span texencoding="$b_{i}&gt;0$" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAAAoCAYAAAC/xadkAAAFMElEQVRoQ+2ZdcgmVRTGf2sndoGB7mIndgeo6yIiJgZ2IigKFmJ3J+quraCCiqgoCnZi/CF2oGK3qNjNT898zM5Ofe/Mu6zDHPj4eGfm3jv3uec85zlnxtDbwAiMGXhkP5AevAZO0IPXg9cAgQZDe88bEnhzAUvH3zLA4sBeDdbq3NAyz9sdWB/YE5gVeBzYuHMI/LehLYBDgEXh3yQ6I3A7cBHwXdGe64TtG4CedzJwUsfAmw64JIA7FzgW+BNYBbgX+BmYALydt+8q8OYI5F1kQ+DJjoGnM5wIvACsE8AlW3S/RttbwFp5HlgF3tbAPcD3wHzAHx0CTz5/DZge2Bx4MGdvzwZw5wBHZ+9XgXcxcChwJ7DdEIHbBvDvTOCdIa6TnvoqYD/gV2Bu4JecdX2fYyJ8Fw4nGnmsCrzXgWWBg4CJQ9yUB3NHhM3NAaJrD8v0ts+A+YFHgU0LFtoSuD/u7QHclH6uDLzFgA/i4aWA98LFNwv54uIPAd+2sEM5dWfghDisvyLbnQ681ML82SlWAF6JiyaMwwrWWChA9vb1wN51wdsHuCYyjfywHnBtZN5kDgE03J5vaYOCuFOAuBzwN3A3IIhtreGrpj2qTEXMnArnF4HV6oJ3a3jDZcBtgKR5PPAMsEaE2bzAy8DKLYGXTCOIOwaIy8dFw+c04KkW1toXuDrmOTz0XNG0P4XO/QpYoA54vvwXkWEPjGShR5h1EzsbOCp+yB1ft7Cp7BQJiB6aoaY9Apwa/wdd0vlOicGGoiFZZJ8Ai4TSUDyPWBHnrR7a53fgAeBg4KPM7CaRK+LaWODdQXdSY5wg7hCev2I8/3SAmBB6jWlGHlEMnxG/rKBuLBn8fpSmZmMrrUrw0pML3JU5kxtCxwGS+yyAQA/bPGxBNLEkICpwfRe5UY6sY3qb/K0pxS4tGWS0zRkSalwd8AyNTYAvU6hn5/fEJV6fNQNPTVNz3ZcicLXaARUelH6/rWK81zwIaSDPZkg5xRPARlXgzQ58A8wUkzp51uSAD0O65HGGIX1EqPM2pEyyvtLhyKCR2QDJfBJgXSo31bW0VLkw3jVvrFyuA2m3ALtWgWchbFFsGC4BfJoz61lRrrwKrJpTtlnKGPq+5Md1d1TynKCZnDwUQTOULgcuSG1uNMsY/p9H9jSC9MQ8S+pb701RKOQlDNswikabAA7OmslB0CRxlXmRdFDF26FoYoZnAppkbURYMipsm3q0PK6S+BGYp4Czk8aBNb2ONJl354FnsaxA9WTtcaVN0Wg5YwdCjrE+HIZlQVM2nR/v9ENLC6of1ag6wQYFTiDPec9sbFaezLLg2QyUy7RslpUDr4sKwBNLslV6Qt1fUrUisZkoT4zG5NLE08zgyiP5zEOyt9a2JVrVIkAdm7Y1Absqcp79PaupUvAc8Fw8YXkmWNpKwA2A2UfgrDLyzMPQQ1TtljKWNHXMdpfC1bkFTc3oxhSvv9WZYMBnFL1WGhb98vR5Ib08fLlQfrX8TDApBc+b44HdgCWjAWi7xtJE172rRk/P9tW6ocrr6q7tw1PtWite9dip2TvcNigq4T5BUwrJr1N4XIJgVUtqtAeqZ1qmCeBoPhatHXrStpSi+39hbYMn3z0G7ALYWOi0tQ2erSM7rwsOqVEwTR1G2+A9DPjRyA8mfnF7c5rabcsv0yZ4zqVwNUOaZRXPfnnqrLUJniApKtWK+xd8jeoUkG2D1ylwqjbTg1eFUMn9HrwevAYINBjae14PXgMEGgztPa8BeP8AkyUAOPI3aRkAAAAASUVORK5CYII=" width="39.5" height="20" /></span><span>, represents some fixed output, or input, of the ith molecular species. A typical application of flux balance analysis is to predict an optimal non-equilibrium steady-state flux vector that optimises a linear objective function, such biomass production rate, subject to bounds on certain reaction rates. </span></div><div  class = 'S2'><span>In this tutorial, we demonstrate how to predict the minimal number of active reactions that are still consistent with an optimal objective derived from the result of a standard flux balance analysis problem. In each case, the corresponding problem is a cardinality minimisation problem that we term </span><span style=' font-style: italic;'>sparse flux balance analysis</span></div><div  class = 'S3'><span texencoding="\begin{array}{ll}
\min\limits _{v} &amp; \Vert v\Vert_{0}\\
\text{s.t.} &amp; Sv=b\\
 &amp; l\leq v\leq u\\
 &amp; c^{T}v=\rho^{\star}
\end{array}" style="vertical-align:-41px"><img src="data:image/png;base64,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" width="94" height="93" /></span></div><div  class = 'S2'><span>where the last constraint is optional and represents the requirement to satisfy an optimal objective value </span><span texencoding="\rho^{\star}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAmCAYAAABDClKtAAACmUlEQVRYR+3XWchMYRjA8d9nJ1GWpMgSSZRsF5bcKBeiRC6UKJKSFKWUkCXKBUkioWwXCiHKUhKKCKGkXCCyZLlAcYUevVPTdL6Z+eabb2YuvHWaznnP+zz/efbTpAFXUwMy+Q9Vrlf+W6oRLRVe+VMOWC3dNwNXGw1qPzbiUymwWlrqPjbgcqNAdcJ3bMW2ekD1xhx8xpt0DUJY6hwWYAAGpustrueDtpX7hmAPZidlv9EOud94/AXrcLgwK9sKKvfHAyrgAjK3oiwcSkBfs1zZ1lChcyLu5Sm/hFnF4qqlUB2SwCnoiY+4gttFlIR7luAi4lwPDMOr5s60BGoMTuIWdqELLmAwjmFxhpJ+eI0DWI1R6U+cwprWQoULriWYLXnCFuJ4up9emEXYjF/YkXcmMvE04v1vlcZUNzzFe0xLGZSTFVZ6mW62Y32eknD1zGTNQt19MRI3K4UKV4XpJ+BBgZBwz4f07CCWlyqM5eyXiqmIo4d4grEZAqemGIutcOumcpSWeqcU1F6sTEG5O0PY0lRzYmsezpZSWM5+MaiOeIc+KWueZQg8ikWpr4Urf5ajtNQ7xaCiGkfKR8z0zxAUwRq9rXNqsjEBVGUVg8pZIWpTpH7hikyLjh91aDR+VIWIop9YYYXo5hFT+zKyLspE91SlH1ULKOQ0Z6kReJ4UTcadPKVdU8sYn0aUG9UEKga1Is8645CzxPA0arRHZF4OvKpczVnqDObicarkETdR2eM6gfPlfplUQpsFFcNYDPe9kjWOVCK4NWeyoMJduXYyNK+3tUZPi85mQa3FzpTq0XBrvrKgYmiLD8dwWwRzzVchVMzSLxDZNQl3a06UUadWYVlK9fn1ACpWp+rF809vqdGlLnANCfUXoS5wJ1YsJXcAAAAASUVORK5CYII=" width="18.5" height="19" /></span><span> </span><span> </span><span>derived from any solution to a flux balance analysis (FBA) problem. This approach is used to check for minimal sets of reactions that either should be active, or should not be active in a flux balance model that is representative of a biochemical network.</span></div><div  class = 'S2'><span>In particular, we use sparse flux balance analysis test for a minimal stoichiometrically balanced cycle involving ATP hydrolysis, which should never appear in any flux balance analysis model where constraints arising from ATP demands are being implemented, since a stoichiometrically balanced cycle involving ATP hydrolysis might create artefactual energy metabolism predictions. In order to mimic the requirement for energy, for maintenance of cellular integrity, many flux balance models contain a cytoplasmic adenosine triphosphate (atp[c]) hydrolysis reaction where the products are adenosine diphosphate (adp[c]) and orthophosphate (pi[c]). In Recon 3D, the full corresponding reaction formula is </span></div><div  class = 'S2'><span>                                                            h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]  </span><a href = "#eq_ATPhydrolysis"><span style=' text-decoration: underline;'>(1)</span></a><span> </span></div><div  class = 'S2'><span>In a flux balance model, a maintenance requirement for synthesis of adenosine triphosphate can be represented with a lower bound on reaction </span><a href = "#eq_ATPhydrolysis"><span style=' text-decoration: underline;'>(1)</span></a><span> or inclusion of reaction </span><a href = "#eq_ATPhydrolysis"><span style=' text-decoration: underline;'>(1)</span></a><span> within a composite biomass reaction, when cellular growth is being modelled [1]. In order for either of these approaches to result in a constraint on energy metabolism within the model, no stoichiometrically balanced set of internal reactions that include reaction </span><a href = "#eq_ATPhydrolysis"><span style=' text-decoration: underline;'>(1)</span></a><span> should admit isolated hydrolysis of ATP, given the reaction bounds supplied with the model. If such a set exists, sparse flux balance analysis can be used to find one such minimal cardinality set [4, 5]. </span></div><h2  class = 'S1'><span>TIMING</span></h2><div  class = 'S2'><span>A minimal solution to sparse flux balance analysis problem can be obtained in &lt; 10 seconds. The time consuming part is comparing the predictions with the biochemical literature to assess whether the predictions are consistent with biochemical network function or not, as such, the process of refining a model to increase its biochemical fidelity can take days or weeks.</span></div><h2  class = 'S4'><span>EQUIPMENT SETUP</span></h2><div  class = 'S2'><span>Make sure to initialise the COBRA Toolbox.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >initCobraToolbox(false) </span><span style="color: rgb(2, 128, 9);">% false, as we don't want to update</span></span></div></div></div><h2  class = 'S4'><span>PROCEDURE</span></h2><h2  class = 'S1'><span>Setting the numerical tolerance</span></h2><div  class = 'S2'><span>Implementation of sparse flux balance analysis with any numerical optimisation solver requires a tolerance to be set that distinguished between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver. Typically 1e-6 will suffice, except for multiscale models.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >feasTol = getCobraSolverParams(</span><span style="color: rgb(170, 4, 249);">'LP'</span><span >, </span><span style="color: rgb(170, 4, 249);">'feasTol'</span><span >);</span></span></div></div></div><h2  class = 'S1'><span>Loading and examining the properties of a model</span></h2><div  class = 'S2'><span>We are going to focus here on testing the biochemical fidelity of Recon3.0model [3]. As an example, Recon 1.0 may also be used [6].</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">global </span><span >CBTDIR</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >filename = </span><span style="color: rgb(170, 4, 249);">'Recon1.0model.mat'</span><span >; </span><span style="color: rgb(2, 128, 9);">% amend fileName for Recon 3</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >model = readCbModel([CBTDIR filesep </span><span style="color: rgb(170, 4, 249);">'test' </span><span >filesep </span><span style="color: rgb(170, 4, 249);">'models' </span><span >filesep filename]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >model.csense(1:size(model.S,1),1) = </span><span style="color: rgb(170, 4, 249);">'E'</span><span >;</span></span></div></div></div><h2  class = 'S4'><span>Testing for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><div  class = 'S2'><span>There are two options: A: sparse flux balance analysis using zero norm minimisation, and B: one norm minimisation.</span></div><h2  class = 'S1'><span>A: Sparse flux balance analysis test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><div  class = 'S2'><span>Detect the ATP maintenance reaction and if there is none already, add one.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >atpMaintenanceBool=strcmp(model.rxns,</span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >) | strcmp(model.rxns,</span><span style="color: rgb(170, 4, 249);">'DM_atp(c)'</span><span >) | strcmp(model.rxns,</span><span style="color: rgb(170, 4, 249);">'ATPM'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">if </span><span >~any(atpMaintenanceBool)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    fprintf(</span><span style="color: rgb(170, 4, 249);">'Could not find ATP maintenance reaction, adding one.'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >~strcmp(filename,</span><span style="color: rgb(170, 4, 249);">'HMR2.0'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        model = addReaction(model, </span><span style="color: rgb(170, 4, 249);">'ATPMnew'</span><span >, </span><span style="color: rgb(170, 4, 249);">'h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        model = addReaction(model, </span><span style="color: rgb(170, 4, 249);">'ATPMnew'</span><span >, </span><span style="color: rgb(170, 4, 249);">'m02040c + m01371c -&gt; m02039c + m01285c + m02751c'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    atpMaintenanceBool=strcmp(model.rxns,</span><span style="color: rgb(170, 4, 249);">'ATPMnew'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    fprintf(</span><span style="color: rgb(170, 4, 249);">'%s %s\n'</span><span >,model.rxns{atpMaintenanceBool},</span><span style="color: rgb(170, 4, 249);">' is the ATP maintenance reaction'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    fprintf(</span><span style="color: rgb(170, 4, 249);">'%s %s\n'</span><span >,model.rxns{atpMaintenanceBool},</span><span style="color: rgb(170, 4, 249);">' is the ATP maintenance reaction:'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span>Display the size of the  model</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >[nMet,nRxn] = size(model.S);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'%6s\t%6s\n'</span><span >,</span><span style="color: rgb(170, 4, 249);">'#mets'</span><span >,</span><span style="color: rgb(170, 4, 249);">'#rxns'</span><span >); fprintf(</span><span style="color: rgb(170, 4, 249);">'%6u\t%6u\t%s%s\n'</span><span >,nMet,nRxn,</span><span style="color: rgb(170, 4, 249);">' totals in '</span><span >, filename)</span></span></div></div></div><div  class = 'S9'><span>Display the constraints</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >minInf = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >maxInf =  1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >printConstraints(model, minInf, maxInf);</span></span></div></div></div><div  class = 'S2'><span>Identify the exchange reactions(s) heuristically</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">if </span><span >~isfield(model,</span><span style="color: rgb(170, 4, 249);">'SIntRxnBool'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    model = findSExRxnInd(model,size(model.S,1),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span>Maximise the atp maintenance reaction</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >model.c(:) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >model.c(atpMaintenanceBool) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >osenseStr = </span><span style="color: rgb(170, 4, 249);">'max'</span><span >;</span></span></div></div></div><div  class = 'S9'><span>Choose to minimize the zero norm of the optimal flux vector</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >minNorm = </span><span style="color: rgb(170, 4, 249);">'zero'</span><span >;</span></span></div></div></div><div  class = 'S9'><span>Allow thermodynamically infeasible fluxes</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >allowLoops = 1;</span></span></div></div></div><div  class = 'S9'><span>Select the approximate step functions when minimising the zero norm of the flux vector</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% zeroNormApprox='cappedL1';% : Capped-L1 norm</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% zeroNormApprox='exp';%Exponential function</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% zeroNormApprox='log';%Logarithmic function</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% zeroNormApprox='lp-';%L_p norm with p&lt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% zeroNormApprox='lp+';%L_p norm with 0&lt;p&lt;1</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >zeroNormApprox=</span><span style="color: rgb(170, 4, 249);">'all'</span><span >;</span><span style="color: rgb(2, 128, 9);">% test all approximations avialable and return the best one</span></span></div></div></div><div  class = 'S9'><span>Close all external reactions</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >model.lb(~model.SIntRxnBool) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >model.ub(~model.SIntRxnBool) = 0;</span></span></div></div></div><div  class = 'S2'><span>Run sparse flux balance analysis on the model with all exchanges closed</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >tic</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >toc</span></span></div></div></div><div  class = 'S9'><span>Check to see if there is a non-zero flux through the ATP maintenance reaction</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'%g%s\n'</span><span >,sparseFBAsolutionBounded.v(atpMaintenanceBool),</span><span style="color: rgb(170, 4, 249);">' flux through the ATP maintenance reaction'</span><span >)</span></span></div></div></div><div  class = 'S9'><span>Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >cutoff=0.1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">for </span><span >n=1:nRxn</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        formula=printRxnFormula(model, model.rxns{n}, 0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        fprintf(</span><span style="color: rgb(170, 4, 249);">'%10g%15s\t%-60s\n'</span><span >,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S4'><span>ANTICIPATED RESULTS</span></h2><div  class = 'S2'><span>When all external reactions are blocked (bounds are set to zero), then the only net flux admissible is within a stoichiometrically balanced cycle, if and only if, the bounds on each reaction in the stoichiometrically balanced cycle simultaneously admit net flux in one direction around the cycle. Net flux around a stoichiometrically balanced cycle is thermodynamically infeasible [2], but steady state mass balance constraints do not enforce thermodynamic constraints. In lieu of such constraints, the bounds on reactions can be set based on the biochemical literature to eliminate net flux around a stoichiometrically balanced cycle. In Recon3.0, with all external reactions blocked, maximising reaction </span><a href = "#eq_ATPhydrolysis"><span style=' text-decoration: underline;'>(1)</span></a><span> while minimising the cardinality of all internal reactions, using sparse flux balance analysis was used to find one such minimal cycle. The optimal solution involves reaction </span><a href = "#eq_ATPhydrolysis"><span style=' text-decoration: underline;'>(1)</span></a><span> in a set of nine stoichiometrically balanced reactions, with bounds that admit an arbitrary amount of isolated ATP hydrolysis. Recon3.0model contains no set of reactions that admit an arbitrary amount of isolated ATP hydrolysis.</span></div><h2  class = 'S4'><span>TROUBLESHOOTING</span></h2><div  class = 'S2'><span>By further constraining the bounds to convert one reversible reaction in each such stoichiometrically balanced cycle to an irreversible reaction, isolated ATP hydrolysis can be eliminated, e.g., though there are important exceptions, a reactions hydrolyses ATP does not generally operate in a reverse direction at biochemically realistic metabolite concentrations. </span></div><h2  class = 'S1'><span>B: One norm minimisation test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><div  class = 'S2'><span>Run flux balance analysis on the same model and minimise the total sum of all reaction rates (minimum one norm)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >minNorm = </span><span style="color: rgb(170, 4, 249);">'one'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >oneNormFBASolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></span></div></div></div><div  class = 'S9'><span>Display the one norm flux balance analysis solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">for </span><span >n=1:nRxn</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >abs(oneNormFBASolutionBounded.v(n))&gt;cutoff</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        formula = printRxnFormula(model, model.rxns{n}, 0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        fprintf(</span><span style="color: rgb(170, 4, 249);">'%10g%15s\t%-60s\n'</span><span >,oneNormFBASolutionBounded.v(n),model.rxns{n}, formula{1});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S4'><span>ANTICIPATED RESULTS</span></h2><div  class = 'S2'><span>Depending on the model, minimising the one norm may give as good an approximation of a minimal stoichiometrically balanced cycle as minimising the zero norm, but experience suggests this is less likely for large cycles or large models.</span></div><h2  class = 'S1'><span>Testing for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><div  class = 'S2'><span>There are two options: A: sparse flux balance analysis using zero norm minimisation, and B: one norm minimisation.</span></div><h2  class = 'S1'><span>A: Sparse flux balance analysis test for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><div  class = 'S2'><span>Fully open all internal reactions</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >model.lb(model.SIntRxnBool) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >model.ub(model.SIntRxnBool) = 1000;</span></span></div></div></div><div  class = 'S9'><span>Run sparse flux balance analysis on the model with all exchanges closed and all internal reactions reversible</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></span></div></div></div><div  class = 'S9'><span>Check to see if there is a non-zero flux through the ATP maintenance reaction</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'%g%s\n'</span><span >,sparseFBAsolutionUnBounded.v(atpMaintenanceBool),</span><span style="color: rgb(170, 4, 249);">' flux through the ATP maintenance reaction'</span><span >);</span></span></div></div></div><div  class = 'S9'><span>Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >cutoff=0.1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">for </span><span >n=1:nRxn</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >abs(sparseFBAsolutionUnBounded.v(n))&gt;cutoff</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        formula=printRxnFormula(model, model.rxns{n}, 0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        fprintf(</span><span style="color: rgb(170, 4, 249);">'%10g%15s\t%-60s\n'</span><span >,sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S4'><span>ANTICIPATED RESULTS</span></h2><div  class = 'S2'><span>When all reactions are reversible, in a genome-scale model, it should be anticipated to find a stoichiometrically balanced cycle of reactions that admit an arbitrary amount of isolated ATP hydrolysis. It is important nevertheless to realise that these cycles are latent in the network and could become active with inadvertent relaxation of model bounds.</span></div><h2  class = 'S1'><span>B: One norm minimisation test for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><div  class = 'S2'><span>Run flux balance analysis on the samemodel and minimise the sum total of all reaction rates (minimium one norm)</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >minNorm = </span><span style="color: rgb(170, 4, 249);">'one'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span >oneNormFBASolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></span></div></div></div><div  class = 'S9'><span>Display the one norm flux balance analysis solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">for </span><span >n=1:nRxn</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >abs(oneNormFBASolutionUnBounded.v(n))&gt;cutoff</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        formula = printRxnFormula(model, model.rxns{n}, 0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >        fprintf(</span><span style="color: rgb(170, 4, 249);">'%10g%15s\t%-60s\n'</span><span >,oneNormFBASolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S4'><span>ANTICIPATED RESULTS</span></h2><div  class = 'S2'><span>When all reactions are reversible, in a genome-scale model, it should be anticipated to find a stoichiometrically balanced cycle of reactions that admit an arbitrary amount of isolated ATP hydrolysis. It is important nevertheless to realise that these cycles are latent in the network and could become active with inadvertent relaxation of model bounds.</span></div><h2  class = 'S1'><span>REFERENCES</span></h2><div  class = 'S2'><span>[1] Feist, Adam M, and Bernhard O Palsson. The Biomass Objective Function. </span><span style=' font-style: italic;'>Current Opinion in Microbiology</span><span>, Ecology and industrial microbiology  Special section: Systems biology, 13, no. 3 (June 2010): 34449. doi:10.1016/j.mib.2010.03.003.</span></div><div  class = 'S2'><span>[2] Fleming, R. M. T., C. M. Maes, M. A. Saunders, Y. Ye, and B. . Palsson. A Variational Principle for Computing Nonequilibrium Fluxes and Potentials in Genome-Scale Biochemical Networks. </span><span style=' font-style: italic;'>Journal of Theoretical Biology</span><span> 292 (January 7, 2012): 7177. doi:10.1016/j.jtbi.2011.09.029.</span></div><div  class = 'S2'><span>[3] Brunk, Elizabeth, Swagatika Sahoo, Daniel C Zielinski, Ali Altunkaya, Maike Aurich, Nathan Mih, German Andres Preciat Gonzalez, et al. Recon 3D: A Resource Enabling a Three-Dimensional View of Gene Variation in Human Metabolism. </span><span style=' font-style: italic;'>(Submitted)</span><span> 1 (2017).</span></div><div  class = 'S2'><span>[4] Fleming, R.M.T., et al., Cardinality optimisation in constraint-based modelling: illustration with Recon 3D (submitted), 2017.</span></div><div  class = 'S2'><span>[5] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span> </span><span>optimization</span><span>. European Journal of Operational Research 244, 2646.</span></div><div  class = 'S2'><span>[6] Duarte, N. C., S. A. Becker, N. Jamshidi, I. Thiele, M. L. Mo, T. D. Vo, R. Srivas, and B. . Palsson. Global Reconstruction of the Human Metabolic Network Based on Genomic and Bibliomic Data. </span><span style=' font-style: italic;'>Proceedings of the National Academy of Sciences of the United States of America</span><span> 104, no. 6 (2007): 177782. doi:10.1073/pnas.0610772104.</span></div><div  class = 'S2'><span>  </span></div><div  class = 'S2'><span></span></div><div  class = 'S2'></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis
%% Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.
%% Reviewer: Francisco J. Planes, TECNUN, University of Navarra, Laurent Heirendt, University of Luxembourg.
%% INTRODUCTION
% We consider a biochemical network of  |m| molecular species and  |n|  biochemical 
% reactions. The biochemical network is mathematically represented by a stoichiometric 
% matrix $S\in\mathcal{Z}^{m\times n}$. In standard notation, flux balance analysis 
% (FBA) is the linear optimisation problem
% 
% $$\begin{array}{ll}\min\limits _{v} & \rho(v)\equiv c^{T}v\\\text{s.t.} & 
% Sv=b,\\ & l\leq v\leq u,\end{array}$$
% 
% where $$c\in\Re^{n}$$ is a parameter vector that linearly combines one or 
% more reaction fluxes to form what is termed the objective function,  and where 
% a $$b_{i}<0$$, or  $$b_{i}>0$$, represents some fixed output, or input, of the 
% ith molecular species. A typical application of flux balance analysis is to 
% predict an optimal non-equilibrium steady-state flux vector that optimises a 
% linear objective function, such biomass production rate, subject to bounds on 
% certain reaction rates. 
% 
% In this tutorial, we demonstrate how to predict the minimal number of active 
% reactions that are still consistent with an optimal objective derived from the 
% result of a standard flux balance analysis problem. In each case, the corresponding 
% problem is a cardinality minimisation problem that we term _sparse flux balance 
% analysis_
% 
% $$\begin{array}{ll}\min\limits _{v} & \Vert v\Vert_{0}\\\text{s.t.} & Sv=b\\ 
% & l\leq v\leq u\\ & c^{T}v=\rho^{\star}\end{array}$$
% 
% where the last constraint is optional and represents the requirement to satisfy 
% an optimal objective value $\rho^{\star}$  derived from any solution to a flux 
% balance analysis (FBA) problem. This approach is used to check for minimal sets 
% of reactions that either should be active, or should not be active in a flux 
% balance model that is representative of a biochemical network.
% 
% In particular, we use sparse flux balance analysis test for a minimal stoichiometrically 
% balanced cycle involving ATP hydrolysis, which should never appear in any flux 
% balance analysis model where constraints arising from ATP demands are being 
% implemented, since a stoichiometrically balanced cycle involving ATP hydrolysis 
% might create artefactual energy metabolism predictions. In order to mimic the 
% requirement for energy, for maintenance of cellular integrity, many flux balance 
% models contain a cytoplasmic adenosine triphosphate (atp[c]) hydrolysis reaction 
% where the products are adenosine diphosphate (adp[c]) and orthophosphate (pi[c]). 
% In Recon 3D, the full corresponding reaction formula is 
% 
% h2o[c] + atp[c] -> h[c] + adp[c] + pi[c]  <#eq_ATPhydrolysis (1)> 
% 
% In a flux balance model, a maintenance requirement for synthesis of adenosine 
% triphosphate can be represented with a lower bound on reaction <#eq_ATPhydrolysis 
% (1)> or inclusion of reaction <#eq_ATPhydrolysis (1)> within a composite biomass 
% reaction, when cellular growth is being modelled [1]. In order for either of 
% these approaches to result in a constraint on energy metabolism within the model, 
% no stoichiometrically balanced set of internal reactions that include reaction 
% <#eq_ATPhydrolysis (1)> should admit isolated hydrolysis of ATP, given the reaction 
% bounds supplied with the model. If such a set exists, sparse flux balance analysis 
% can be used to find one such minimal cardinality set [4, 5]. 
%% TIMING
% A minimal solution to sparse flux balance analysis problem can be obtained 
% in < 10 seconds. The time consuming part is comparing the predictions with the 
% biochemical literature to assess whether the predictions are consistent with 
% biochemical network function or not, as such, the process of refining a model 
% to increase its biochemical fidelity can take days or weeks.
%% EQUIPMENT SETUP
% Make sure to initialise the COBRA Toolbox.

initCobraToolbox(false) % false, as we don't want to update
%% PROCEDURE
%% Setting the numerical tolerance
% Implementation of sparse flux balance analysis with any numerical optimisation 
% solver requires a tolerance to be set that distinguished between zero and non-zero 
% flux, based on the numerical tolerance of the currently installed optimisation 
% solver. Typically 1e-6 will suffice, except for multiscale models.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% Loading and examining the properties of a model
% We are going to focus here on testing the biochemical fidelity of Recon3.0model 
% [3]. As an example, Recon 1.0 may also be used [6].

global CBTDIR
filename = 'Recon1.0model.mat'; % amend fileName for Recon 3
model = readCbModel([CBTDIR filesep 'test' filesep 'models' filesep filename]);
model.csense(1:size(model.S,1),1) = 'E';
%% Testing for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% There are two options: A: sparse flux balance analysis using zero norm minimisation, 
% and B: one norm minimisation.
%% A: Sparse flux balance analysis test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% Detect the ATP maintenance reaction and if there is none already, add one.

atpMaintenanceBool=strcmp(model.rxns,'DM_atp_c_') | strcmp(model.rxns,'DM_atp(c)') | strcmp(model.rxns,'ATPM');
if ~any(atpMaintenanceBool)
    fprintf('Could not find ATP maintenance reaction, adding one.')
    if ~strcmp(filename,'HMR2.0')
        model = addReaction(model, 'ATPMnew', 'h2o[c] + atp[c] -> h[c] + adp[c] + pi[c]');
    else
        model = addReaction(model, 'ATPMnew', 'm02040c + m01371c -> m02039c + m01285c + m02751c');
    end
    atpMaintenanceBool=strcmp(model.rxns,'ATPMnew');
    fprintf('%s %s\n',model.rxns{atpMaintenanceBool},' is the ATP maintenance reaction')
else
    fprintf('%s %s\n',model.rxns{atpMaintenanceBool},' is the ATP maintenance reaction:')
end
%% 
% Display the size of the  model

[nMet,nRxn] = size(model.S);
fprintf('%6s\t%6s\n','#mets','#rxns'); fprintf('%6u\t%6u\t%s%s\n',nMet,nRxn,' totals in ', filename)
%% 
% Display the constraints

minInf = -1000;
maxInf =  1000;
printConstraints(model, minInf, maxInf);
%% 
% Identify the exchange reactions(s) heuristically

if ~isfield(model,'SIntRxnBool')
    model = findSExRxnInd(model,size(model.S,1),1);
end
%% 
% Maximise the atp maintenance reaction

model.c(:) = 0;
model.c(atpMaintenanceBool) = 1;
osenseStr = 'max';
%% 
% Choose to minimize the zero norm of the optimal flux vector

minNorm = 'zero';
%% 
% Allow thermodynamically infeasible fluxes

allowLoops = 1;
%% 
% Select the approximate step functions when minimising the zero norm of the 
% flux vector

% zeroNormApprox='cappedL1';% : Capped-L1 norm
% zeroNormApprox='exp';%Exponential function
% zeroNormApprox='log';%Logarithmic function
% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function
% zeroNormApprox='lp-';%L_p norm with p<0
% zeroNormApprox='lp+';%L_p norm with 0<p<1
zeroNormApprox='all';% test all approximations avialable and return the best one
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool) = 0;
model.ub(~model.SIntRxnBool) = 0;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed

tic
sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
toc
%% 
% Check to see if there is a non-zero flux through the ATP maintenance reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpMaintenanceBool),' flux through the ATP maintenance reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above a specified 
% cutoff.

cutoff=0.1;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all external reactions are blocked (bounds are set to zero), then the 
% only net flux admissible is within a stoichiometrically balanced cycle, if and 
% only if, the bounds on each reaction in the stoichiometrically balanced cycle 
% simultaneously admit net flux in one direction around the cycle. Net flux around 
% a stoichiometrically balanced cycle is thermodynamically infeasible [2], but 
% steady state mass balance constraints do not enforce thermodynamic constraints. 
% In lieu of such constraints, the bounds on reactions can be set based on the 
% biochemical literature to eliminate net flux around a stoichiometrically balanced 
% cycle. In Recon3.0, with all external reactions blocked, maximising reaction 
% <#eq_ATPhydrolysis (1)> while minimising the cardinality of all internal reactions, 
% using sparse flux balance analysis was used to find one such minimal cycle. 
% The optimal solution involves reaction <#eq_ATPhydrolysis (1)> in a set of nine 
% stoichiometrically balanced reactions, with bounds that admit an arbitrary amount 
% of isolated ATP hydrolysis. Recon3.0model contains no set of reactions that 
% admit an arbitrary amount of isolated ATP hydrolysis.
%% TROUBLESHOOTING
% By further constraining the bounds to convert one reversible reaction in each 
% such stoichiometrically balanced cycle to an irreversible reaction, isolated 
% ATP hydrolysis can be eliminated, e.g., though there are important exceptions, 
% a reactions hydrolyses ATP does not generally operate in a reverse direction 
% at biochemically realistic metabolite concentrations. 
%% B: One norm minimisation test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% Run flux balance analysis on the same model and minimise the total sum of 
% all reaction rates (minimum one norm)

minNorm = 'one';
oneNormFBASolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Display the one norm flux balance analysis solution, but only the non-zero 
% fluxes, above a specified cutoff.

for n=1:nRxn
    if abs(oneNormFBASolutionBounded.v(n))>cutoff
        formula = printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',oneNormFBASolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% Depending on the model, minimising the one norm may give as good an approximation 
% of a minimal stoichiometrically balanced cycle as minimising the zero norm, 
% but experience suggests this is less likely for large cycles or large models.
%% Testing for production of ATP with all external reactions blocked and all internal reactions reversible
% There are two options: A: sparse flux balance analysis using zero norm minimisation, 
% and B: one norm minimisation.
%% A: Sparse flux balance analysis test for production of ATP with all external reactions blocked and all internal reactions reversible
% Fully open all internal reactions

model.lb(model.SIntRxnBool) = -1000;
model.ub(model.SIntRxnBool) = 1000;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed and 
% all internal reactions reversible

sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP maintenance reaction

fprintf('%g%s\n',sparseFBAsolutionUnBounded.v(atpMaintenanceBool),' flux through the ATP maintenance reaction');
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above a specified 
% cutoff.

cutoff=0.1;
for n=1:nRxn
    if abs(sparseFBAsolutionUnBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all reactions are reversible, in a genome-scale model, it should be anticipated 
% to find a stoichiometrically balanced cycle of reactions that admit an arbitrary 
% amount of isolated ATP hydrolysis. It is important nevertheless to realise that 
% these cycles are latent in the network and could become active with inadvertent 
% relaxation of model bounds.
%% B: One norm minimisation test for production of ATP with all external reactions blocked and all internal reactions reversible
% Run flux balance analysis on the samemodel and minimise the sum total of all 
% reaction rates (minimium one norm)

minNorm = 'one';
oneNormFBASolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Display the one norm flux balance analysis solution, but only the non-zero 
% fluxes, above a specified cutoff.

for n=1:nRxn
    if abs(oneNormFBASolutionUnBounded.v(n))>cutoff
        formula = printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',oneNormFBASolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all reactions are reversible, in a genome-scale model, it should be anticipated 
% to find a stoichiometrically balanced cycle of reactions that admit an arbitrary 
% amount of isolated ATP hydrolysis. It is important nevertheless to realise that 
% these cycles are latent in the network and could become active with inadvertent 
% relaxation of model bounds.
%% REFERENCES
% [1] Feist, Adam M, and Bernhard O Palsson. The Biomass Objective Function. 
% _Current Opinion in Microbiology_, Ecology and industrial microbiology  Special 
% section: Systems biology, 13, no. 3 (June 2010): 34449. doi:10.1016/j.mib.2010.03.003.
% 
% [2] Fleming, R. M. T., C. M. Maes, M. A. Saunders, Y. Ye, and B. . Palsson. 
% A Variational Principle for Computing Nonequilibrium Fluxes and Potentials 
% in Genome-Scale Biochemical Networks. _Journal of Theoretical Biology_ 292 
% (January 7, 2012): 7177. doi:10.1016/j.jtbi.2011.09.029.
% 
% [3] Brunk, Elizabeth, Swagatika Sahoo, Daniel C Zielinski, Ali Altunkaya, 
% Maike Aurich, Nathan Mih, German Andres Preciat Gonzalez, et al. Recon 3D: 
% A Resource Enabling a Three-Dimensional View of Gene Variation in Human Metabolism. 
% _(Submitted)_ 1 (2017).
% 
% [4] Fleming, R.M.T., et al., Cardinality optimisation in constraint-based 
% modelling: illustration with Recon 3D (submitted), 2017.
% 
% [5] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation 
% approaches for sparse optimization. European Journal of Operational Research 
% 244, 2646.
% 
% [6] Duarte, N. C., S. A. Becker, N. Jamshidi, I. Thiele, M. L. Mo, T. D. Vo, 
% R. Srivas, and B. . Palsson. Global Reconstruction of the Human Metabolic 
% Network Based on Genomic and Bibliomic Data. _Proceedings of the National Academy 
% of Sciences of the United States of America_ 104, no. 6 (2007): 177782. doi:10.1073/pnas.0610772104.
% 
% 
% 
% 
% 
%
##### SOURCE END #####
-->
</div></body></html>