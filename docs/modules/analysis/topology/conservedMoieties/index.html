

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Conservedmoieties &mdash; The COBRA Toolbox</title>
  

  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_static/img/apple-touch-icon.png">
  
  
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_static/img/favicon-32x32.png">
  
  
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_static/img/favicon-16x16.png">
  
  
    <link rel="mask-icon" href="../../../../_static/img/safari-pinned-tab.svg" color="#5bbad5">
  
  
    <link rel="manifest" href="../../../../_static/json/manifest.json">
  
  
    <meta name="msapplication-config" content="../../../../_static/browserconfig.xml">
  
  <meta name="theme-color" content="#ffffff">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="../../../../_static/js/jquery.easy-autocomplete.min.js" type="text/javascript" ></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href="../../../../_static/css/easy-autocomplete.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/cobra.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../../_static/css/cobra.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="The COBRA Toolbox" href="../../../../index.html"/>
        <link rel="up" title="Topology" href="../index.html"/>
        <link rel="next" title="Old" href="old/index.html"/>
        <link rel="prev" title="Topology" href="../index.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> The COBRA Toolbox
          

          
            <img src="https://king.nuigalway.ie/cobratoolbox/img/cobratoolbox_logo_transparent.png" class="logo" alt="cobratoolbox logo" />
          
          </a>

              
          <h1>The COBRA Toolbox</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" id="simple"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <script>
    	var options = {

		url: "../../../../_static/json/functions.json",

		getValue: "name",

		list: {
            onKeyEnterEvent: function(item) {
                    return "_static/../" + item.website_url
            },
            maxNumberOfElements: 25,
			match: {
					enabled: true,
			},
            sort: {
			    enabled: true
		    }
		},

    	template: {
	    	type: "custom",
		    method: function(value, item) {
                return "<span><a href='../../../../search.html?q=" + item.name + "&check_keywords=yes&area=default'>" + value + "</a>" + "<a href='../../../../_static/../" + item.website_url + "' ><img src='../../../../_static/link.svg'/></a></span>";
		    }
	    },

		theme: "square"

	};

	$("#simple").easyAutocomplete(options);


    </script>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a></li>
              </ul>
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../dynamicFBA/index.html">Dynamicfba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fluxEnrichmentAnalysis/index.html">Fluxenrichmentanalysis</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Topology</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Conservedmoieties</a><ul>
<li class="toctree-l5"><a class="reference internal" href="old/index.html">Old</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../extremeRays/index.html">Extremerays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../FR/index.html">Fr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../graphHypergraphConversion/index.html">Graphhypergraphconversion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../deletion/index.html">Deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../persephone/index.html">Persephone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../transport/index.html">Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../parsimoniousFBA/index.html">Parsimoniousfba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sparseFBA/index.html">Sparsefba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../relaxedFBA/index.html">Relaxedfba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sampling/index.html">Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../percentileCalc/index.html">Percentilecalc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rumba/index.html">Rumba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiSpecies/index.html">Multispecies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rFBA/index.html">Rfba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ROOM/index.html">Room</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../QFCA/index.html">Qfca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nutritionAlgorithm/index.html">Nutritionalgorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometricFBA/index.html">Geometricfba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../wholeBody/index.html">Wholebody</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../thermo/index.html">Thermo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../exploration/index.html">Exploration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../igemRNA/index.html">Igemrna</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../findMIIS/index.html">Findmiis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../KLdistance/index.html">Kldistance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../subspaces/index.html">Subspaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../uFBA/index.html">Ufba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../MOMA/index.html">Moma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../coupling/index.html">Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gMCS/index.html">Gmcs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ICONGEMs/index.html">Icongems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../FBA/index.html">Fba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mdFBA/index.html">Mdfba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../robustnessAnalysis/index.html">Robustnessanalysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../FVA/index.html">Fva</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rMTA/index.html">Rmta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fastForest/index.html">Fastforest</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../base/index.html">Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dataIntegration/index.html">Dataintegration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../design/index.html">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reconstruction/index.html">Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualization/index.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../plan.html">Development Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citations.html">Citations</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">The COBRA Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Functions</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Analysis</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Topology</a></li>
      <li class="breadcrumb-item active">Conservedmoieties</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="https://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="conservedmoieties">
<span id="id1"></span><h1>Conservedmoieties<a class="headerlink" href="#conservedmoieties" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="old/index.html">Old</a></li>
</ul>
</div>
<span class="target" id="module-src.analysis.topology.conservedMoieties"></span><dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.classifyMoieties">
<span class="sig-name descname"><span class="pre">classifyMoieties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">L</span></em>, <em class="sig-param"><span class="pre">S</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/classifyMoieties.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.classifyMoieties" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies conserved moieties for a metabolic network</p>
<dl class="field-list">
<dt class="field-odd">USAGE</dt>
<dd class="field-odd"><p><strong>types = classifyMoieties</strong> (<em>L, S</em>)</p>
</dd>
<dt class="field-even">INPUTS</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>L</strong> – The <cite>r</cite> x <cite>m</cite> moiety matrix with moiety vectors as columns.</p></li>
<li><p><strong>S</strong> – The <cite>m</cite> x <cite>n</cite> total stoichiometric matrix.</p></li>
</ul>
</dd>
<dt class="field-odd">OUTPUT</dt>
<dd class="field-odd"><p><strong>types</strong> – an <cite>r</cite> x <cite>1</cite> cell array of with one of the following moiety classifications
‘Internal’ moiety that is also conserved in the open network
‘Transitive’ moiety that is only found in primary metabolites
‘Integrative’ moiety that is not conserved in the open</p>
<blockquote>
<div><p>network and found in both primary and secondary metabolites.</p>
</div></blockquote>
</dd>
</dl>
<dl class="simple">
<dt>isSecondary  <cite>m x 1</cite> Boolean vector indicating secondary metabolites</dt><dd><p>(containing at least one internal conserved moiety’)</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.constructElementalMatrix">
<span class="sig-name descname"><span class="pre">constructElementalMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">metFormulas</span></em>, <em class="sig-param"><span class="pre">metCharges</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/constructElementalMatrix.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.constructElementalMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the elemental matrix for a set of metabolites</p>
<dl class="field-list simple">
<dt class="field-odd">USAGE</dt>
<dd class="field-odd"><p><strong>[E, elements] = constructElementalMatrix</strong> (<em>metFormulas, metCharges</em>)</p>
</dd>
<dt class="field-even">INPUT</dt>
<dd class="field-even"><p><strong>metFormulas</strong> – <cite>m x 1</cite> cell array of metabolite formulas, e.g., CHO2</p>
</dd>
<dt class="field-odd">OPTIONAL INPUT</dt>
<dd class="field-odd"><p><strong>metCharges</strong> – <cite>m x 1</cite> vector of metabolite charges. Used to compute the
electron vector.</p>
</dd>
<dt class="field-even">OUTPUTS</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>E</strong> – The <cite>m x p</cite> elemental matrix where <cite>p</cite> is the number of unique
elements in <cite>metFormulas</cite> (plus the electron if <cite>metCharges</cite> is
included as input)</p></li>
<li><p><strong>elements</strong> – <cite>1 x p</cite> cell array of element symbols (e for electron)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.decomposeMoietyVectors">
<span class="sig-name descname"><span class="pre">decomposeMoietyVectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">L</span></em>, <em class="sig-param"><span class="pre">N</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/decomposeMoietyVectors.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.decomposeMoietyVectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Decomposes moiety vectors for a metabolic network.</p>
<dl class="field-list simple">
<dt class="field-odd">USAGE</dt>
<dd class="field-odd"><p><strong>D = decomposeMoieties</strong> (<em>L, N</em>)</p>
</dd>
<dt class="field-even">INPUTS</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>L</strong> – The <cite>m x r</cite> moiety matrix with moiety vectors as columns.</p></li>
<li><p><strong>N</strong> – The <cite>m x u</cite> internal stoichiometric matrix such that <span class="math notranslate nohighlight">\(N^T L = 0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-odd">OUTPUTS</dt>
<dd class="field-odd"><p><strong>D</strong> – An <cite>m x t</cite> moiety matrix with decomposed moiety vectors as columns <span class="math notranslate nohighlight">\((t \geq r)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.estimateMoietyFormulas">
<span class="sig-name descname"><span class="pre">estimateMoietyFormulas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">L</span></em>, <em class="sig-param"><span class="pre">E</span></em>, <em class="sig-param"><span class="pre">elements</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/estimateMoietyFormulas.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.estimateMoietyFormulas" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the chemical formulas of conserved moieties in a metabolic network</p>
<dl class="field-list simple">
<dt class="field-odd">USAGE</dt>
<dd class="field-odd"><p><strong>moietyFormulas = estimateMoietyFormulas</strong> (<em>L, E, elements</em>)</p>
</dd>
<dt class="field-even">INPUTS</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>L</strong> – The <cite>m x r</cite> moiety matrix for a metabolic network. Each column is a
moiety vector.</p></li>
<li><p><strong>E</strong> – The <cite>m x p</cite> elemental matrix for metabolites in the metabolic network.</p></li>
<li><p><strong>elements</strong> – A <cite>1 x p</cite> cell array of element symbols.</p></li>
</ul>
</dd>
<dt class="field-odd">OUTPUT</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> – An <cite>r x p</cite> estimated elemental matrix for moieties.</p></li>
<li><p><strong>moietyFormulas</strong> – An <cite>r x 1</cite> cell array of estimated moiety formulas.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.findElementaryMoietyVectors">
<span class="sig-name descname"><span class="pre">findElementaryMoietyVectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/findElementaryMoietyVectors.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.findElementaryMoietyVectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerate all possible elementary conserved moiety vectors based on the
left null space of the stoichiometric matrix S.</p>
<dl class="field-list simple">
<dt class="field-odd">USAGE</dt>
<dd class="field-odd"><p><strong>EMV = findElementaryMoietyVectors</strong> (<em>model, method</em>)</p>
</dd>
<dt class="field-even">INPUT</dt>
<dd class="field-even"><p><strong>model</strong> – COBRA model</p>
</dd>
</dl>
<dl>
<dt>OPTIONAL INPUTS (in name-value pair):</dt><dd><dl class="simple">
<dt>‘method’:           method for finding all conserved moiety vectors</dt><dd><ul class="simple">
<li><p>‘efmtool’:  use EFMtool, ‘CalculateFluxModes.m’ must be in matlab path (default)</p></li>
<li><p>‘null’:     use matlab rational null basis.</p></li>
</ul>
</dd>
<dt>‘deadCMs’:           include dead end metabolites or not (default true)</dt><dd><p>(will have more conserved moieties found for dead end metabolites if true)</p>
</dd>
</dl>
<p>‘printLevel’:       print messages or not (default 0).</p>
<p>Other COBRA LP solver parameters, see solveCobraLP.m</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">OUTPUT</dt>
<dd class="field-odd"><p><strong>EMV</strong> – all minimal conserved moiety vectors</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.identifyConservedMoieties">
<span class="sig-name descname"><span class="pre">identifyConservedMoieties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">dATM</span></em>, <em class="sig-param"><span class="pre">options</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/identifyConservedMoieties.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.identifyConservedMoieties" title="Permalink to this definition">¶</a></dt>
<dd><p>[arm, moietyFormulae] = identifyConservedMoieties(model, dATM, options)</p>
<p>Identifies conserved moieties in a metabolic network (model) by graph
theoretical analysis of the corresponding directed atom transition network (dATM).
Decomposes a stoichiometric matrix into a set of moiety transitions, that
is</p>
<blockquote>
<div><p>N = inv(M2M*M2M’)*M2M*M*M2R;</p>
</div></blockquote>
<dl class="simple">
<dt>where</dt><dd><p>N   = model.S(arm.MRH.metAtomMappedBool,arm.MRH.rxnAtomMappedBool) = arm.MRH.S(arm.MRH.metAtomMappedBool,arm.MRH.rxnAtomMappedBool);
M2M = arm.M2M;
M   = incidence(arm.MTG);
M2R = arm.M2R;</p>
</dd>
</dl>
<p>where M2M*M2M’ is a diagonal matrix and each diagonal entry is the number
of moieties in a metabolite.</p>
<dl class="field-list simple">
<dt class="field-odd">USAGE</dt>
<dd class="field-odd"><p><strong>[arm, moietyFormulae] = identifyConservedMoieties</strong> (<em>model, dATM, options</em>)</p>
</dd>
<dt class="field-even">INPUTS</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> – Structure with following fields:</p>
<ul>
<li><p>.S - The <cite>m x n</cite> stoichiometric matrix for the metabolic network</p></li>
<li><p>.mets - An <cite>m x 1</cite> array of metabolite identifiers. Should match metabolite identifiers in rxnfiles.</p></li>
<li><p>.rxns - An <cite>n x 1</cite> array of reaction identifiers. Should match <cite>rxnfile</cite> names in <cite>rxnFileDir</cite>.</p></li>
</ul>
</li>
<li><p><strong>dATM</strong> – Directed atom transition multigraph, obtained from buildAtomTransitionMultigraph.m
A MATLAB digraph structure with the following tables and variables:</p>
<ul>
<li><p>.Nodes — Table of node information, with <cite>p</cite> rows, one for each atom.</p></li>
<li><p>.Nodes.Atom - unique alphanumeric id for each atom by concatenation of the metabolite, atom and element</p></li>
<li><p>.Nodes.AtomIndex - unique numeric id for each atom in atom transition multigraph</p></li>
<li><p>.Nodes.mets - metabolite containing each atom</p></li>
<li><p>.Nodes.AtomNumber - unique numeric id for each atom in a metabolite</p></li>
<li><p>.Nodes.Element - atomic element of each atom</p></li>
<li><p>.Edges — Table of edge information, with <cite>q</cite> rows, one for each atom transition instance.</p></li>
<li><p>.Edges.EndNodes - two-column cell array of character vectors that defines the graph edges</p></li>
<li><p>.Edges.Trans - unique alphanumeric id for each atom transition instance by concatenation of the reaction, head and tail atoms</p></li>
<li><p>.Edges.TransIndex - unique numeric id for each atom transition instance</p></li>
<li><p>.Edges.rxns - reaction abbreviation corresponding to each atom transition instance</p></li>
<li><p>.Edges.HeadAtomIndex - head Nodes.AtomIndex</p></li>
<li><p>.Edges.TailAtomIndex - tail Nodes.AtomIndex</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
<p>OPTIONAL INPUTS:
options:       Structure with following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>.sanityChecks {(0),1} true if additional sanity checks</p></li>
</ul>
<p>on computations, but substantially more computation time</p>
</div></blockquote>
<p>OUTPUTS:
arm            atomically resolved model as a matlab structure with the following fields:</p>
<p>arm.MRH:                    Directed metabolic reaction hypergraph, i.e. standard COBRA model, with additional fields:
arm.MRH.metAtomMappedBool:  <cite>m x 1</cite> boolean vector indicating atom mapped metabolites
arm.MRH.rxnAtomMappedBool:  <cite>n x 1</cite> boolean vector indicating atom mapped reactions</p>
<p>arm.dATM:                   Directed atom transition multigraph (dATM) obtained from buildAtomTransitionMultigraph.m</p>
<p>arm.M2Ai:              <cite>m</cite> x <cite>a</cite> matrix mapping each mapped metabolite to one or more atoms in the directed atom transition multigraph
arm.Ti2R:              <cite>t</cite> x <cite>n</cite> matrix mapping one or more directed atom transition instances to each mapped reaction
arm.Ti2I               <cite>t</cite> x <cite>i</cite> matrix to map one or more directed atom transition instances to each isomorphism class</p>
<p>arm.ATG:  Atom transition graph, as a MATLAB graph structure with the following tables and variables:</p>
<blockquote>
<div><ul class="simple">
<li><p>.Nodes — Table of node information, with <cite>a</cite> rows, one for each atom.</p></li>
<li><p>.Nodes.Atom - unique alphanumeric id for each atom by concatenation of the metabolite, atom and element</p></li>
<li><p>.Nodes.AtomIndex - unique numeric id for each atom in atom transition multigraph</p></li>
<li><p>.Nodes.mets - metabolite containing each atom</p></li>
<li><p>.Nodes.AtomNumber - unique numeric id for each atom in an atom mapping</p></li>
<li><p>.Nodes.Element - atomic element of each atom</p></li>
<li><p>.Nodes.MoietyIndex - numeric id of the corresponding moiety (arm.MTG.Nodes.MoietyIndex)</p></li>
<li><p>.Nodes.Component - numeric id of the corresponding connected component (rows of C2A)</p></li>
<li><p>.Nodes.IsomorphismClass - numeric id of the corresponding isomprphism class (rows of I2C)</p></li>
<li><p>.Nodes.IsCanonical - boolean, true if atom is within first component of an isomorphism class</p></li>
<li><p>.Edges — Table of edge information, with <cite>u</cite> rows, one for each atom transition instance.</p></li>
<li><p>.Edges.EndNodes - numeric id of head and tail atoms that defines the graph edges</p></li>
<li><p>.Edges.Trans - unique alphanumeric id for each atom transition by concatenation of head and tail atoms</p></li>
<li><p>.Edges.HeadAtomIndex - head Nodes.AtomIndex</p></li>
<li><p>.Edges.TailAtomIndex - tail Nodes.AtomIndex</p></li>
<li><p>.Edges.HeadAtom - head Nodes.Atom</p></li>
<li><p>.Edges.TailAtom - tail Nodes.Atom</p></li>
<li><p>.Edges.TransIndex - unique numeric id for each atom transition</p></li>
<li><p>.Edges.Component - numeric id of the corresponding connected component (columns of T2C)</p></li>
<li><p>.Edges.IsomorphismClass - numeric id of the corresponding isomprphism class (columns of T2I)</p></li>
<li><p>.Edges.IsCanonical - boolean, true if atom transition is within first component of an isomorphism class</p></li>
</ul>
</div></blockquote>
<p>arm.M2A:  <cite>m x a</cite> matrix mapping each metabolite to one or more atoms in the (undirected) atom transition graph
arm.A2R:  <cite>u x n</cite> matrix that maps atom transitions to reactions. An atom transition can map to multiple reactions and a reaction can map to multiple atom transitions
arm.A2Ti: <cite>u x t</cite> matrix to map each atom transition (in ATG) to one or more directed atom transition instance (in dATM) with reorientation if necessary.</p>
<p>arm.I2C  <cite>i x c</cite> matrix to map each isomorphism class (I) to one or more components (C) of the atom transition graph (ATG)
arm.C2A  <cite>c x a</cite> matrix to map each connected component (C) of the atom transition graph to one or more atoms (A)
arm.A2C  <cite>u x c</cite> matrix to map one or more atom transitions (T) to connected components (C) of the atom transition graph (ATG)</p>
<p>arm.I2A  <cite>i x a</cite> matrix to map each isomorphism class to one or more atoms of the atom transition graph (ATG)
arm.A2I  <cite>u x i</cite> matrix to map one or more atom transitions to each isomorphism class</p>
<p>arm.MTG = MTG; % (undirected) moiety transition graph</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.relateConservedMoietiesToConservationRelations">
<span class="sig-name descname"><span class="pre">relateConservedMoietiesToConservationRelations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">C</span></em>, <em class="sig-param"><span class="pre">R</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/relateConservedMoietiesToConservationRelations.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.relateConservedMoietiesToConservationRelations" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a stoichiometric matrix N, a set of conserved moieties C, and a set of
conservation relations R, such that C*N = 0 and R*N = 0, then compute a matrix X,
such that C = X*R, and R’<a href="#id2"><span class="problematic" id="id3">*</span></a>x = C(j,:)’ with x’ =: X(j,:) of minimal cardinality.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.representativeMoiety">
<span class="sig-name descname"><span class="pre">representativeMoiety</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">MMN</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/representativeMoiety.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.representativeMoiety" title="Permalink to this definition">¶</a></dt>
<dd><p>For each moiety, identify a set of representative molecules, based on
various criteria</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.topology.conservedMoieties.representativeMolecule">
<span class="sig-name descname"><span class="pre">representativeMolecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">L</span></em>, <em class="sig-param"><span class="pre">moietyFormulae</span></em>, <em class="sig-param"><span class="pre">mets</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/master/src/analysis/topology/conservedMoieties/representativeMolecule.m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.analysis.topology.conservedMoieties.representativeMolecule" title="Permalink to this definition">¶</a></dt>
<dd><p>For each moiety, identify a set of representative molecules, based on
various criteria</p>
<p>INPUT
L                     Matrix to map isomorphism classes to metabolites.
moietyFormulae        Chemical formula of the moiety (Hill notation)
mets                  Metabolite abbreviation</p>
<p>OUTPUT
minimalMassMetabolite       Abbreviation of metabolite with minimal mass relative to the moiety
minimalMassFraction         Fraction of moiety/metabolite mass
numMinimalMassMetabolites   Number of metabolites with minimal mass</p>
</dd></dl>

</section>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="old/index.html" class="btn btn-default float-right" title="Old" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-default" title="Topology" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2021, The COBRA Toolbox developers.

    </p>
  </div>
  Built with Sphinx using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mathjax/MathJax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  


  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TRCMZL1FKK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TRCMZL1FKK');
  </script>
    
</body>
</html>