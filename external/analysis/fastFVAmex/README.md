# Generating a system-specific MEX file - fastFVA

<img src="https://prince.lcsb.uni.lu/jenkins/userContent/warning.png"
height="20px" alt="warning"> Please make sure that you have CPLEX installed.
You must have IBM/ILOG CPLEX, and not the TOMLAB version.

<img src="https://prince.lcsb.uni.lu/jenkins/userContent/warning.png"
height="20px" alt="warning"> IBM ILOG CPLEX must be properly installed as
explained [here](https://opencobra.github.io/cobratoolbox/docs/solvers.html).

### Compiler and MEX setup

Please make sure that you have installed a compiler as explained
[here](https://opencobra.github.io/cobratoolbox/docs/compilers.html). In order
to generate the MEX file, you must have a compiler installed that is compatible
with your MATLAB release. You need to install a `C++` compiler if you haven't
done so already, e. g. The Microsoft Visual Studio Express 2008 compiler which
is available free of charge. Depending on your Matlab version, you must check
[this list](http://www.mathworks.com/support/compilers) to determine the
supported compiler.

For R2015b, you should have the Microsoft Windows SDK for Windows 7 and .NET
Framework 4 installed. Note: Please make sure that you have the correct C++
Redistributable package. The compiler and SDK can be downloaded from
[here](https://www.microsoft.com/en-us/download/details.aspx?id=8279). Other
compilers that are compatible with R2015b can be found
[here](http://www.mathworks.com/support/sysreq/files/SystemRequirements-Release2015b_SupportedCompilers.pdf).
In order to have the compiler set up properly, you must start MATLAB and run
```Matlab
mex -setup
```

***Note for Matlab R2016b***

Currently, the default Compiler MinGW64 is not compatible and *cannot* be used
to generate a new MEX file. The error is traced back to an issue with the
cplex1263.lib file not being compiled properly using the MINGW64 compiler. Even
specifying the option -D_LP64 and changing CFLAGS into COMPFLAGS does not work.

This issue is already tracked
[here](https://nl.mathworks.com/help/matlab/matlab_external/install-mingw-support-package.html)
and mentioned as a limitation of using existing `.lib` files: `Library (.lib)
files generated by Microsoft® Visual Studio® are not compatible with MinGW.`

If you have installed MinGW64, uninstall MinGW64 and install the SDK and the
latest `cygwin`. Then, re-run `mex -setup`

### Generation of the MEX file

Once the system is properly configured, you can generate your MEX file based on
the fastFVA code by running:
```Matlab
>> generateMexFastFVA
```
