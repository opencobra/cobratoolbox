<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Sparse Linear Optimisation</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: center;  }
.S4 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S5 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S6 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Sparse Linear Optimisation</span></h1><h2  class = 'S1'><span>Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.</span></h2><h2  class = 'S1'><span>Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.</span></h2><h2  class = 'S1'><span>INTRODUCTION</span></h2><div  class = 'S2'><span>In this tutorial, we will show how to use the sparse LP solver. This solver aims to solve the following optimisation problem</span></div><div  class = 'S3'><span texencoding="\begin{array}{ll}
\min &amp; \Vert x\Vert_{0}\\
s.t &amp; A_{eq}x=b_{eq}\\
 &amp; A_{ieq}x\leq b_{ieq}\\
 &amp; l\leq x\leq u
\end{array}" style="vertical-align:-39px"><img src="data:image/png;base64,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" width="105.5" height="90" /></span></div><div  class = 'S2'><span>It has been proved that zero-norm is a non-convex function and the minimisation of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively developed. For a complete study of non-convex approximations of zero-norm, the reader is referred to Le Thie et al. (2015)</span><span texencoding="^1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAAAhUlEQVRIS+3VMQrCQBRF0ZNK3IrWgthkCW4gpJKsws3YW9q7gTRZTUgTQkAbyRB0Omd+/+7A5f0/hcgpIvMSAJxxxSHkKuTghBoNBmy/BcyBHi32vwDeDz5xzIDsILYHHXbYYFyqc2gXSlxQvUI3PHD/hCRwUFZvbnYghY8l92DVwF/0YALu1BMnstNhqgAAAABJRU5ErkJggg==" width="8" height="19" /></span><span>.</span></div><div  class = 'S2'><span>The method is described in Le Thie et al. (2015)</span><span texencoding="^1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAAAhUlEQVRIS+3VMQrCQBRF0ZNK3IrWgthkCW4gpJKsws3YW9q7gTRZTUgTQkAbyRB0Omd+/+7A5f0/hcgpIvMSAJxxxSHkKuTghBoNBmy/BcyBHi32vwDeDz5xzIDsILYHHXbYYFyqc2gXSlxQvUI3PHD/hCRwUFZvbnYghY8l92DVwF/0YALu1BMnstNhqgAAAABJRU5ErkJggg==" width="8" height="19" /></span><span>. The sparse LP solver contains one convex (one-norm) and 6 non-convex approximation of zero-norms</span></div><ul  class = 'S4'><li  class = 'S5'><span>Capped-L1 norm</span></li><li  class = 'S5'><span>Exponential function</span></li><li  class = 'S5'><span>Logarithmic function</span></li><li  class = 'S5'><span>SCAD (Smoothly Clipped Absolute Deviation) function</span></li><li  class = 'S5'><span>p norm with </span><span> </span><span>  </span><span>p</span><span>&lt;</span><span>0</span><span>  </span><span> </span><span> </span></li><li  class = 'S5'><span>p norm with </span><span> </span><span>  </span><span>0</span><span>&lt;</span><span>p</span><span>&lt;</span><span>1</span><span>  </span><span> </span></li></ul><div  class = 'S2'><span>The tutorial consist of two parts. Part 1 shows a basic usage of the solver. In part 2 provides an application of the code for finding the minimal set of reactions subject to a LP objective. Ready-made scripts are provided for both parts.</span></div><h2  class = 'S6'><span>EQUIPMENT SETUP</span></h2><h2  class = 'S1'><span style=' font-weight: bold;'>Initialize the COBRA Toolbox.</span></h2><div  class = 'S2'><span>If necessary, initialize The Cobra Toolbox using the </span><span style=' font-family: monospace;'>initCobraToolbox</span><span> function.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >initCobraToolbox(false) </span><span style="color: rgb(2, 128, 9);">% false, as we don't want to update</span></span></div></div></div><h2  class = 'S6'><span>COBRA model. </span></h2><div  class = 'S2'><span>In thi</span><span>s tutorial, the model used</span><span> is the generic reconstruction of human metabolism, the Recon 2.04</span><span texencoding="^2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAABF0lEQVRIS+3UsSuFURjH8c/NoJRkUsTIRMmoDAYZZDDJatLNJpudxSSUQWySDMqkJDb/gNVsMSilRKcO3d7e8557u9vtnu2cnud7nuf3/M6paXPV2szXwYAF7GAKb7iJ+4+iZmUarGAfV+jFMkZxj/kcoCcGhqT3GNyPZ0xgDo+NkGIFsxjGZeGmOg6wgeMqwABCn98FwFLUYRUXVYCUr9ZxhJEo6n9cs0YKLb1iKydiWQXjOI8CfrUKCFO5xjZeyui5FvbwgNuUOFWAzTiR06oXmwKsYQy7heRJDOHu77wMsIgTnOGnATAYrTyDzxRgGk/oS5R9iODKln2QlCE3heyP1wXo5G89O/+qt9B0cgjsGqmrQfDBL0GOJif7qwNnAAAAAElFTkSuQmCC" width="8" height="19" /></span><span>, which is provided in the COBRA Toolbox. The Recon 2.04 model can also be downloaded from the </span><a href = "https://www.vmh.life/#downloadview"><span>Virtual Metabolic Human</span></a><span> webpage. You can also select your own model to work with. Before proceeding with the simulations, the path for the model needs to be set up:      </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">global </span><span >CBTDIR</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelFileName = </span><span style="color: rgb(170, 4, 249);">'Recon2.v04.mat'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelDirectory = getDistributedModelFolder(modelFileName); </span><span style="color: rgb(2, 128, 9);">%Look up the folder for the distributed Models.</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelFileName= [modelDirectory filesep modelFileName]; </span><span style="color: rgb(2, 128, 9);">% Get the full path. Necessary to be sure, that the right model is loaded</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >model = readCbModel(modelFileName);</span></span></div></div></div><div  class = 'S11'><span style=' font-weight: bold;'>NOTE: The following text, code, and results are shown for the Recon 2.04 model</span></div><h2  class = 'S6'><span>PROCEDUR</span><span>E</span></h2><h2  class = 'S1'><span>Example of using</span><span> sparseLP solver on randomly generated data</span></h2><div  class = 'S2'><span>One randomly generates a m</span><span>atrix </span><span texencoding="A\in\mathcal{R}^{^{m\times n}}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="66" height="22" /></span><span> </span><span>  and a vector </span><span texencoding="x_{0}\in\mathcal{R}^{^{n}}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAAwCAYAAAASA1QFAAAHS0lEQVR4Xu2adazlVBCHv8Xd3d0dElyDuyc4wSWQ4O4OQYO7u1twd7fgkuAe3C3fZkoOb3tve/t63+4lnX/ebm97znR+Z2Z+M9NBNDLMW2DQMK9hoyANSD1wCBqQGpB6wAI9oGLjSQ1IPWCBHlCx8aQGpB6wQA+o2HhSA1IPWGDgVZwK2B6YFxgLWARYADgNmALYCHggVavxpIEHyR2nB94GjgduAJYGbgFeAI4E9mtAGjrApLsuATwYXjM3sBfgX0HaGLisAWnog3QosCNwIbA/8DOwJXAuMCnwaQNSNZAmBlYDFgbmByYAhgf+BD4C3gVeCsN/kmwxD/A+8HVy7XHA60sBT8b1y4HZ4vp/NGxyUjFgswMHAssA1wH3Ak8AHwdA2nBCYEpgRWAz4PnINSsECOfEve42NvAVcCuwZmzvGnqPnmXoa0AqxmXwHcMBhwUTM5mfDvxU4tkRgHvC4+4H1ge+S54TGMnCGsDNcX0u4EVgufDIz4EfsmcaT8q3+ojAFcDMwCoRrvreqUeYS35LfhgVuBSYFVgHuA94LYxvWFSk2nqb3ufzyg5x3f2WB05tclKxO0iNBWch4JsWt58F7Al8G7+bn24Dlgym9iawFWCo2zBA99Y3gJeBdZN1DZNXAdfHMxmgg2/pBU9Sx7XipeYL9jNSgZ0PAY4uxiL3DhP6s0EOpMSt5O7wkOz3E4BdgAOAw+PinEEmrgQ2qKjPMA/SHMAleYyn4IWltUdUNIoeMjmwapvnZ4mCc5O4Zz3g6kj+0yVhTBb4THhYu/XaqtrOkzxRKwMzAp6EO5OVxolTMzpwcJrkKhom77HFgNuBMYEfozqXWZlgsxBT43b/LqVRpcN6RisRyPOAp6K183p4uJ50UvLQzsDJ4Vl6WCXJA8lQort+D6wULOVVQCqqWB+o3LTx/5SlVFIi5yELOkPNRFGZW4V/WNfiBet4CGRyApEnerfhVGKgnALslONFHi7zj3/tJlhHVZKinORpfjhWlnm8FeHnREAGZGPQE5WxlEpK5DykgbYBPBw2ILvpOX23N9FbuK6eo5eMzuQuGxMAm6RPR1ErTddb/gKmDpoty9siIQ2V7FMEkrWC1bMnetv46wm3EOuWGEK/BEYBFgyv7dZeeetOFiHVkKfH2CkYOXLUbsHoHok66rHQMVvng/B417CrYBHswe6XFIHk4p4c2dVzwCvB8fu1acHDhlhzkS0Ww8TQEEcG9tek04Z/Q78H0zyV9dW2A84I5S4Ib7dQ1cMkCX/UpXgZkPYAjo1qWzf2lHdT9Ngzo43ye8WN+kPBy2xpISoY4wLvRc/tF2CmuH4MsHeZhcrcUwakLC9ZYJkEW+UfQ8JBQTDsTZn8BVjv60QciJm4+yP9oeBl9rXHZtdA0Xtuin9Lv98BDHsO92qRMiDZWJT6KgL2aM7O5i5DlPnEWcnf0TG29e5ASwJQVtZOGpnLln1oAO/TBg9FI8Aenf22TDykliQWw5KqWqQIJMe7KjRGTBPt0Br6+ootjmui9e4wKxMB/TU6yGUVNh94EvXcSQYgvNrOkUZLrZ2ISgpaic1Tc7OdBEOxOdPenCIoEglZb9p1KPveLe8rAumiqJZlWbvGiDePmtqz0uMscgUlE6v+faPhaMFXVjSE9NZTaX7ppmQHzD2MBvbsWslxwO7x49YxpPO/MlFZr2XKZ8AMdRb47UCyxW64sV6xYL0x6KjFrOHMkyfz8STJflSyr4tnocskajItK/a5pMAypMVjflP22U7vMwdavHvApNhpxyBdS1DOjgv2BfdJfpTN+Y2CYq66OPnNgyYdTzs2HemYgjResBMnhXYXzCd6hzOU8YEvIg4bkwVGRX3BaeKjChuOttlTMR/ZrpcIOC4uK+Y4X8pD4nBtiC9oyi5U4j4LTuc7RotWRfPm0c1WL0Ni3+atgFnMqqvh2kOsbW0JGU47efchVE5BcgDleNhRrzMSp4ppK0MQNJq/W+DqJSrlSTdvXQvYaEzFkGXossZw7U7Eqt+hmUa0ircm8bR6iFqNDzpZP73XHpvNUj0+y6MWpNlUdtEgP0aVPOKUkQnpuM+ou10Zaz3DtaBVlhQkFdDt/dTIf/elznqF42MB8qMJR8iKbRsVlzgYIlPJJo53RB+wU0X14PNbtGjarVWFgnugzDeSAQHSAzyEkgEPoO/Qzth6m4RhtOhYONXNA7RTG9QyqjBJ2vq4K7wvVSL7dMmK3B5WVfGAbAp4ojWgNVk7kQobfv4XUsTuyrykI2PDj8TBuJ5KRjgGgqWV0bUn76kDJF/cXOFplyGlPausuDOUtJty9qTxBkrpukByhu9Xl+Yn6WYmftNsnyubRQ3Ue/2v9qkLJKmpLRJZWNbKkY7rYX5kIUtrpKIF6gLJ7WU1skM/RpcVObk9KiarFdVrHtMCdYLUWLRLFmhA6pJh61y2AalOa3ZprQakLhm2zmUbkOq0ZpfWakDqkmHrXLYBqU5rdmmtfwArCGRAUoLt+AAAAABJRU5ErkJggg==" width="52.5" height="24" /></span><span> </span><span>. The right hand side vector</span><span> </span><span texencoding="b=A\cdot x_{0}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="62.5" height="20" /></span><span>. There are three optional inputs for the method.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >n = 100; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >m = 50; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >x0 = rand(n,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.A = rand(m,n); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.b = constraint.A*x0; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.lb = -1000*ones(n,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.ub = 1000*ones(n,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >constraint.csense = repmat(</span><span style="color: rgb(170, 4, 249);">'E'</span><span >, m, 1); </span></span></div></div></div><div  class = 'S11'><span>The two first: maximum number of iterations (</span><span style=' font-style: italic;'>nbMaxIteration</span><span>) and threshold (</span><span style=' font-style: italic;'>epsilon</span><span>) are stopping criterion conditions. </span><span style=' font-style: italic;'>theta</span><span> is the parameter of zero-norm approximation. The greater the value of </span><span style=' font-style: italic;'>theta</span><span>, the better the approximation of the zero-norm. However, the greater the value of </span><span style=' font-style: italic;'>theta</span><span>, the more local solutions the problem has. If the value of </span><span style=' font-style: italic;'>theta </span><span>is not given then the algorithm will use a default value and update it gradually.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >params.nbMaxIteration = 100;    </span><span style="color: rgb(2, 128, 9);">% stopping criteria</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >params.epsilon = 1e-6; 		</span><span style="color: rgb(2, 128, 9);">% stopping criteria</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >params.theta   = 2;    		 </span><span style="color: rgb(2, 128, 9);">% parameter of l0 approximation </span></span></div></div></div><div  class = 'S11'><span>Call the solver with a chosen approximation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >solution = sparseLP(</span><span style="color: rgb(170, 4, 249);">'cappedL1'</span><span >,constraint,params); </span></span></div></div></div><div  class = 'S11'><span>or with default parameter</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%solution = sparseLP('cappedL1',constraint);</span></span></div></div></div><h2  class = 'S1'><span>Finding the minimal set of reactions subject to a LP objective</span></h2><div  class = 'S2'><span>Set the tolerance to distinguish between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >feasTol = getCobraSolverParams(</span><span style="color: rgb(170, 4, 249);">'LP'</span><span >, </span><span style="color: rgb(170, 4, 249);">'feasTol'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Select the biomass reaction to optimise</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >model.biomassBool=strcmp(model.rxns,</span><span style="color: rgb(170, 4, 249);">'biomass_reaction'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >model.c(model.biomassBool)=1;</span></span></div></div></div><div  class = 'S11'><span>We will firstly find the optimal value subject to a LP objective</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%% Solve FBA  </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% max c'v </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% s.t   Sv = b </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%       l &lt;= v &lt;= u</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% Define the LP structure </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >[m,n] = size(S); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >LPproblem = struct(</span><span style="color: rgb(170, 4, 249);">'c'</span><span >,-c,</span><span style="color: rgb(170, 4, 249);">'osense'</span><span >,1,</span><span style="color: rgb(170, 4, 249);">'A'</span><span >,S,</span><span style="color: rgb(170, 4, 249);">'csense'</span><span >,csense,</span><span style="color: rgb(170, 4, 249);">'b'</span><span >,b,</span><span style="color: rgb(170, 4, 249);">'lb'</span><span >,lb,</span><span style="color: rgb(170, 4, 249);">'ub'</span><span >,ub);  </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% Call solveCobraLP to solve the LP </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >LPsolution = solveCobraLP(LPproblem);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >vFBA = LPsolution.full;</span></span></div></div></div><div  class = 'S11'><span>We will now find the minimum number of reactions needed to achieve the same max objective found previously. Then one will add one more constraint: </span><span texencoding="$c^{T}v=c^{T}v_{FBA}=:f_{FBA}$" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAAqCAYAAACa0kYSAAALaklEQVR4Xu2dB7AtRRGGPwQlqaACYgYTURQj5oCxDIiIpSCIijkjmBNmRQRzVlQQzGJCBQNGDAiWOUcMYARzrk96Xo379oR9Z++e2Xenq27d986Z3ZnpmZ7u/rt77gZUqhyoHFjvObDBej/DOsHKgcoBqqDXTVA5sAo4UAV9FSxynWLlQBX0ugcqB1YBB6qgr4JFrlOsHOhT0H8IbAd8C/gVcBngysD3gO8C1wK2AT4D3Kiy/n8cqDyrG2EQDvQl6Ar0u4G9gB/EyN8O3BW4G+C/7eu5wF+Apw0yu7I7qTwre33Wq9H1JegPAD4FfCO4syFwDnBRYGvgd/H5rYE/A59er7i4bpOpPFs3vpX4lHJ0e+CWwGbAx4C3Av8pZbB9CfpFgPOySV0POA34HHCD7PNLAH8A/lkKA5Y4jsqzJTK/x64V7LeFUnswcGfgGcChwJE99rPQq/oS9OYgngw8HXhq/F5okKvk4cqzcS708aHJdw1s6oXAo4BXAg8qZUorJeia8QJuavYvlDLZwsdReVb4ArUMT2tVcPkI4DHxvSD03YE3A2eXMqWVEHRN0t+GiS7K/u9SJlvwOCrPCl6cKUP7CHArQG3+9ZKnsBKCfifgROAE4B4lT76gsVWeFbQYcw5lpwCffwZcbs5nltZsJQT9pcBDgIOANy5tZuPquPJsXOvlaJ8UoJuhY0PIRdO8gn4hYA9gN2BH4JfAcZHw0Zzgd4CrAJcGfjFj9ra5OrB7hCO+32h/KUAkUxNJH3ZMVHlW3mq5JuZ73DBQ8dcuMMQzgGsAjwYE4IqmeQTdJBjBhveHOW7m2wuAA4E9A4xIkzQzzmyvr8ahMG3yCvB14j0XAJ4SJ2T+zGMjyeaPgELv7zFQ5VmZq2Qex4djaGcBl+04zG9mz1w4nv1rFi5+PKB1VhxNE/QLhta+I3AH4KPZ6N8Xn70F2D/7/PAQ2DcA95lztiYWaPro1xuDzOnygdpfErga8LU53umh9NA52s1q4qFlKm8XGivPusxxqLafn0NZzBqL1qUWYyItSJXQxYEPRpLLrHe0fX8v4BjgbxE///u6vGTIZyYJuhr2PYBCfj+gaeKcBNwWeDjwEmAX4GDggcAmodXV+u8KM3/anA4A3gRMAjXuDzw7MuzmyTQ6CnhkD0zctqOgj5lnPbCr91ck03iRF2t9CprlpCZW+D+7QOZawlRGU7cxSdAPA54fzNCfaZK+zhWiWGWRhfBZtfaP4yVbAOc2XmgiiX15kJRMlWclr06/YzM3RLczj5/320PPb2sTdEMFVpttDNwO+FDPfTZfZ168fs5GwLWB07MGfubJ7jjU+KVS5VmpK9P/uFRypnv7+y4B7vXfS89vbBN0U1fVohaiWJDyr577bHvdj0Jr7weYUphIt0EhEqgrmSrPSl6dfsemJk/ZngLERqCKpzZB16/ZIU4qT6wh6FTgJsAhgD62JBONwwsElg52jIFnpmaa2+ChqTYyPdMNK+6xaay5h+rzgMdFiFTQ6QlRYizi/EVgq7D2XgQIyk4jQ1nPAr40xCYaqA+jRS+LcuwrTehTuTGX5BbxvcVdArtayfJPYNk1sLrzT4B89r3XjfWwSMbCL0PZHw832mrQSWR4WiDcxKtWagq6ZrT14qLHCpyCNwQZk1ebW/XjRnRcZtY9MS6u6DKGoVH3sfHs28BVI3XzlAZjXxU5C+/MPjed+WIRM/5KfC44a1TFjWXYtY0s2TwZuHcg1F3W0LYrgbp3HUNbe9F2BfNYQCB5EpkValSqDbATcxKo9jKWRALbHp6C4HvHh95ZYKRJvpvHMgmMNsfEQ9pI0VyCbtjhN9FyyMozT0hPNNHMh0WcXi2gsHeloVH3MfFMxPn3kY+gZmmWC983hPMnwfSUF/HTAE3TWhgGVVs3w6vpe7GVL4fmslTTks2utFKoe9dxNNub075zaOyXT3mZlpGFLv6ofJqku5e7pOkAcQ1enzU+M6IEHs5iZ01SQVpAY9RHCyEvF1/Tts10t17cByaV2flCTZN3LMqx7PnnhLmoZtecFH1Xu4+FxsKzlFOvxvb2n0TuA7WF5mTuJomRvDp+vCgjUTJf1ey2aZLhTfeQ5qRgrmBqKWQs3XDwJ4B/dByUxUcelMqA5rJCOIk86GyT538kPvtMk9eCzbpX/vw8e6kulliZGrsJSG8etzdphSuTan0tobWoTdBNJEgotz5IvvAW2Rvz9ue9HZk0rbkZRcbKtSY8QIzHj4nGwjM1kDXShipfFwx28/qZ4dQmuRb7hCmpSSnZXp/ziuGDesFITm5KDwCfM5NR37KUog+FXKzBQ8g9rAnehW4et8eoNXVnJgHVJniZ/m32XT53XWGTydKNS6lvq99M5NFEN602ke6R66T11IaXiX+YyGYIXAshX9f/m1eboHvaaTab+KL/5an86wh9JT8i9+G6MGpSW831F0cmnqm1YyttHQvPrCVQQAU4kwCqfQXf9CVzEntw3bcEbhNAkvPUVNSE9GDOQ6HpWf18rUFN72R2KhRqwmVTngKrsOl2dSHNcE1yD8B9pzyYksAEK70f0cNRYbR+Xd43yXx5E8zMEpV3pubaThdB98hc+iYgrRJ+ZlSIJlfq6Lj0Yq0OJiXM6A9oTgsWeDppSij0vshc9r7pntGXSSdjvWaqdJ5ZaGRKqP63/qDWmRliahM3VvNwTZcqKKwCR2YK3izMVsOvba6b+8VMxmTm6zu6tm5yM9GWTaLerwHUzB5Ur+g4oGThzKrMTOCyVoP4hlaOwijupSA3KdW1K+yug1aA7RV8DwEB0SaJzGsJe3gr9N62LPjpYTa3oHecf20+Ag6Y/2+6ch5N0cfTZDcU1KRUt+Dh6waUbK+p7uEgMpzMeb9TaZgarTmcagSSBlTw9fXHTgqt5r+H3qRwl3xw/loL+cWo3oCsomzG3Q1tKsjmzXunYnIHUj69vr6x+/wg1sLysNISS7zXnTCr1PFVQR/7Tltg/KkQyU2iBpHcWIZw2gAcBdqrwPQZU1jNZ/QLja37vjxuq+b2rrRc+7jZrxkHjG7fmEmLzdDkrGIYrRpd3+bFqN4S+4EWBlgz4gGZh9XSoap7Yajbdyrwkv8378T4e05mlepmuaZrWQDzlKmOeXHq2M/ngAiviy9arPCZcjyNbKPGStmRefzW3AZ9w9xP1Qd1E3utkpopkYlXJhN5/bElzWMieZVr0UeERla7TksASvyZNzydwsHiVHmJqxiJYKZYWX5Vlaa8eEcCUxNPzSj1rjoTz9a6u6EK+pi23rqP1Qwt0dl5Q12WDesfNsNwjkCh1WzU3E9xZAE467z15XMynq7mMfzo/YFjIQ8o//aAeRwKoHJi/FzE3mjCNPokcONpoa7Gw/4tBCvsmmXYCqya2/CaroKHrdaX2aK+v4mppFuE83VZ01UV9LFsvcXGqSAKknn9kab3LNKM9PIMEWN9dUmrwAQPNZahVcM9+pOCP2oXs73aoiVWJlqhOCvuPGtMQ35vjoFXRHl4pXJsow26PR5ak0gQzb9UJKCslTMLWNYtMjohom77hKwr9K6B/rZ9enhoYSj4AnwCik0yA9FEm7Z7HerfRx9y9yyhL1FmhdP4rSagfp5plm6WNjJRSc1ge5WAJqJWgGZkuuFHoXYTuolN89Tc9N8CQ8aIE20fh0sCjDQnzZAbw/XfWiKGe03jNeqgcMuT1qyzmPBNI1J1/fi/4Jv8MNLRRuaqiPynuLk4iW1dA6MgWmBaTBZ8yXuBVK0JIxke1uIFibz8xfGJh+g6+b0/aw7eqtGXIH21y8qBoTlQBX1ojtf+KgeWwIEq6Etgeu2ycmBoDlRBH5rjtb/KgSVwoAr6Epheu6wcGJoDVdCH5njtr3JgCRyogr4EptcuKweG5sB/AXK7okn0+x8yAAAAAElFTkSuQmCC" width="125" height="21" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >constraint.A = [S ; c']; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.b = [b ; c'*vFBA]; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.csense = [csense;</span><span style="color: rgb(170, 4, 249);">'E'</span><span >];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.lb = lb; </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >constraint.ub = ub;</span></span></div></div></div><div  class = 'S11'><span>Call the sparseLP solver to solve the problem</span></div><div  class = 'S3'><span texencoding="
\begin{array}{ll}
\min &amp; \Vert v\Vert_{0}\\
s.t &amp; Sv=b\\
 &amp; c^{T}v=f_{FBA}\\
 &amp; l\leq v\leq u
\end{array}" style="vertical-align:-38px"><img src="data:image/png;base64,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" width="99.5" height="88" /></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% Try all non-convex approximations of zero norm and take the best result </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >approximations = {</span><span style="color: rgb(170, 4, 249);">'cappedL1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'exp'</span><span >,</span><span style="color: rgb(170, 4, 249);">'log'</span><span >,</span><span style="color: rgb(170, 4, 249);">'SCAD'</span><span >,</span><span style="color: rgb(170, 4, 249);">'lp-'</span><span >,</span><span style="color: rgb(170, 4, 249);">'lp+'</span><span >}; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >bestResult = n; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >bestAprox = </span><span style="color: rgb(170, 4, 249);">''</span><span >; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:length(approximations)     </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >	solution = sparseLP(char(approximations(i)),constraint);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >	</span><span style="color: rgb(14, 0, 255);">if </span><span >solution.stat == 1         </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >		</span><span style="color: rgb(14, 0, 255);">if </span><span >bestResult &gt; length(find(abs(solution.x)&gt;eps))             </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >			bestResult=length(find(abs(solution.x)&gt;eps));             </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >			bestAprox = char(approximations(i));             </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >			solutionL0 = solution;         </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >		</span><span style="color: rgb(14, 0, 255);">end</span><span >     </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >	</span><span style="color: rgb(14, 0, 255);">end </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end </span></span></div></div></div><div  class = 'S11'><span>Now we call the sparse linear step function approximations  </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >bestResult = n;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >bestAprox = </span><span style="color: rgb(170, 4, 249);">''</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:length(approximations)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    solution = sparseLP(char(approximations(i)),constraint);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >solution.stat == 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        nnzSol=nnz(abs(solution.x)&gt;feasTol);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        fprintf(</span><span style="color: rgb(170, 4, 249);">'%u%s%s'</span><span >,nnzSol,</span><span style="color: rgb(170, 4, 249);">' active reactions in the sparseFBA solution with '</span><span >, char(approximations(i)))</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >bestResult &gt; nnzSol</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >            bestResult=nnzSol;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >            bestAprox = char(approximations(i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >            solutionL0 = solution;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S11'><span>Select the most sparse flux vector, unless there is a numerical problem.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >~isequal(bestAprox,</span><span style="color: rgb(170, 4, 249);">''</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    vBest = solutionL0.x;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    vBest = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    error(</span><span style="color: rgb(170, 4, 249);">'Min L0 problem error !!!!'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S11'><span>Report the best approximation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >display(strcat(</span><span style="color: rgb(170, 4, 249);">'Best step function approximation: '</span><span >,bestAprox))</span></span></div></div></div><div  class = 'S11'><span>Report the number of active reactions in the most sparse flux vector</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'%u%s'</span><span >,nnz(abs(vBest)&gt;feasTol),</span><span style="color: rgb(170, 4, 249);">' active reactions in the best sparse flux balance analysis solution.'</span><span >)</span></span></div></div></div><div  class = 'S11'><span>Warn if there might be a numerical issue with the solution</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >feasError=norm(constraint.A * solutionL0.x - constraint.b,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >feasError&gt;feasTol</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    fprintf(</span><span style="color: rgb(170, 4, 249);">'%g\t%s\n'</span><span >,feasError, </span><span style="color: rgb(170, 4, 249);">' feasibily error.'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    warning(</span><span style="color: rgb(170, 4, 249);">'Numerical issue with the sparseLP solution'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S6'><span>REFERENCES</span></h2><div  class = 'S2'><span style=' font-style: italic;'> </span><span>[1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span> </span><span>optimization</span><span>. European Journal of Operational Research 244, 26–46.</span></div><div  class = 'S2'><span>[2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). A community-driven global reconstruction of human metabolism. Nat Biotechnol 31, 419-425.</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Sparse Linear Optimisation
%% Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.
%% Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.
%% INTRODUCTION
% In this tutorial, we will show how to use the sparse LP solver. This solver 
% aims to solve the following optimisation problem
% 
% $$\begin{array}{ll}\min & \Vert x\Vert_{0}\\s.t & A_{eq}x=b_{eq}\\ & A_{ieq}x\leq 
% b_{ieq}\\ & l\leq x\leq u\end{array}$$
% 
% It has been proved that zero-norm is a non-convex function and the minimisation 
% of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively 
% developed. For a complete study of non-convex approximations of zero-norm, the 
% reader is referred to Le Thie et al. (2015)$^1$.
% 
% The method is described in Le Thie et al. (2015)$^1$. The sparse LP solver 
% contains one convex (one-norm) and 6 non-convex approximation of zero-norms
%% 
% * Capped-L1 norm
% * Exponential function
% * Logarithmic function
% * SCAD (Smoothly Clipped Absolute Deviation) function
% * p norm with    p<0    
% * p norm with    0<p<1   
%% 
% The tutorial consist of two parts. Part 1 shows a basic usage of the solver. 
% In part 2 provides an application of the code for finding the minimal set of 
% reactions subject to a LP objective. Ready-made scripts are provided for both 
% parts.
%% EQUIPMENT SETUP
%% *Initialize the COBRA Toolbox.*
% If necessary, initialize The Cobra Toolbox using the |initCobraToolbox| function.

initCobraToolbox(false) % false, as we don't want to update
%% COBRA model. 
% In this tutorial, the model used is the generic reconstruction of human metabolism, 
% the Recon 2.04$^2$, which is provided in the COBRA Toolbox. The Recon 2.04 model 
% can also be downloaded from the <https://www.vmh.life/#downloadview Virtual 
% Metabolic Human> webpage. You can also select your own model to work with. Before 
% proceeding with the simulations, the path for the model needs to be set up:      

global CBTDIR
modelFileName = 'Recon2.v04.mat';
modelDirectory = getDistributedModelFolder(modelFileName); %Look up the folder for the distributed Models.
modelFileName= [modelDirectory filesep modelFileName]; % Get the full path. Necessary to be sure, that the right model is loaded
model = readCbModel(modelFileName);
%% 
% *NOTE: The following text, code, and results are shown for the Recon 2.04 
% model*
%% PROCEDURE
%% Example of using sparseLP solver on randomly generated data
% One randomly generates a matrix $A\in\mathcal{R}^{^{m\times n}}$   and a vector 
% $x_{0}\in\mathcal{R}^{^{n}}$ . The right hand side vector $b=A\cdot x_{0}$. 
% There are three optional inputs for the method.

n = 100; 
m = 50; 
x0 = rand(n,1); 
constraint.A = rand(m,n); 
constraint.b = constraint.A*x0; 
constraint.lb = -1000*ones(n,1); 
constraint.ub = 1000*ones(n,1); 
constraint.csense = repmat('E', m, 1); 
%% 
% The two first: maximum number of iterations (_nbMaxIteration_) and threshold 
% (_epsilon_) are stopping criterion conditions. _theta_ is the parameter of zero-norm 
% approximation. The greater the value of _theta_, the better the approximation 
% of the zero-norm. However, the greater the value of _theta_, the more local 
% solutions the problem has. If the value of _theta_ is not given then the algorithm 
% will use a default value and update it gradually.

params.nbMaxIteration = 100;    % stopping criteria
params.epsilon = 1e-6; 		% stopping criteria
params.theta   = 2;    		 % parameter of l0 approximation 
%% 
% Call the solver with a chosen approximation

solution = sparseLP('cappedL1',constraint,params); 
%% 
% or with default parameter

%solution = sparseLP('cappedL1',constraint);
%% Finding the minimal set of reactions subject to a LP objective
% Set the tolerance to distinguish between zero and non-zero flux, based on 
% the numerical tolerance of the currently installed optimisation solver.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% 
% Select the biomass reaction to optimise

model.biomassBool=strcmp(model.rxns,'biomass_reaction');
model.c(model.biomassBool)=1;
%% 
% We will firstly find the optimal value subject to a LP objective

%% Solve FBA  
% max c'v 
% s.t   Sv = b 
%       l <= v <= u
% Define the LP structure 
[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); 
[m,n] = size(S); 
LPproblem = struct('c',-c,'osense',1,'A',S,'csense',csense,'b',b,'lb',lb,'ub',ub);  
% Call solveCobraLP to solve the LP 
LPsolution = solveCobraLP(LPproblem);
vFBA = LPsolution.full;
%% 
% We will now find the minimum number of reactions needed to achieve the same 
% max objective found previously. Then one will add one more constraint: $$c^{T}v=c^{T}v_{FBA}=:f_{FBA}$$.

constraint.A = [S ; c']; 
constraint.b = [b ; c'*vFBA]; 
constraint.csense = [csense;'E'];
constraint.lb = lb; 
constraint.ub = ub;
%% 
% Call the sparseLP solver to solve the problem
% 
% $$\begin{array}{ll}\min & \Vert v\Vert_{0}\\s.t & Sv=b\\ & c^{T}v=f_{FBA}\\ 
% & l\leq v\leq u\end{array}$$

% Try all non-convex approximations of zero norm and take the best result 
approximations = {'cappedL1','exp','log','SCAD','lp-','lp+'}; 
bestResult = n; 
bestAprox = ''; 
for i=1:length(approximations)     
	solution = sparseLP(char(approximations(i)),constraint);
	if solution.stat == 1         
		if bestResult > length(find(abs(solution.x)>eps))             
			bestResult=length(find(abs(solution.x)>eps));             
			bestAprox = char(approximations(i));             
			solutionL0 = solution;         
		end     
	end 
end 
%% 
% Now we call the sparse linear step function approximations  

bestResult = n;
bestAprox = '';
for i=1:length(approximations)
    solution = sparseLP(char(approximations(i)),constraint);
    if solution.stat == 1
        nnzSol=nnz(abs(solution.x)>feasTol);
        fprintf('%u%s%s',nnzSol,' active reactions in the sparseFBA solution with ', char(approximations(i)))
        if bestResult > nnzSol
            bestResult=nnzSol;
            bestAprox = char(approximations(i));
            solutionL0 = solution;
        end
    end
end
%% 
% Select the most sparse flux vector, unless there is a numerical problem.

if ~isequal(bestAprox,'')
    vBest = solutionL0.x;
else
    vBest = [];
    error('Min L0 problem error !!!!')
end
%% 
% Report the best approximation

display(strcat('Best step function approximation: ',bestAprox))
%% 
% Report the number of active reactions in the most sparse flux vector

fprintf('%u%s',nnz(abs(vBest)>feasTol),' active reactions in the best sparse flux balance analysis solution.')
%% 
% Warn if there might be a numerical issue with the solution

feasError=norm(constraint.A * solutionL0.x - constraint.b,2);
if feasError>feasTol
    fprintf('%g\t%s\n',feasError, ' feasibily error.')
    warning('Numerical issue with the sparseLP solution')
end
%% REFERENCES
% [1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation 
% approaches for sparse optimization. European Journal of Operational Research 
% 244, 26–46.
% 
% [2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, 
% M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). 
% A community-driven global reconstruction of human metabolism. Nat Biotechnol 
% 31, 419-425.
##### SOURCE END #####
-->
</div></body></html>