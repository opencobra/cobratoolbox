<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/opencobra/cobratoolbox@ffa0229fc0c01c9236bb7e961f65712443277719/latest/_static/js/iframeResizer.contentWindow.min.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Computation and analysis of rescued lethal gene deletions in a host-microbe model</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: normal; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: normal; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Computation and analysis of rescued lethal gene deletions in a host-microbe model</span></h1><h2  class = 'S1'><span>Author: Almut Heinken, Molecular Systems Physiology Group, University of Luxembourg.</span></h2><div  class = 'S2'><span>Constraint-based modeling has useful applications for predicting the metabolic interactions between a mammalian host and its commensal gut microbes. For example, the potential of a human gut microbe to rescue lethal gene defects in the mouse has been predicted. Some of these rescued gene defects correspond to human inborn errors of metabolism (IEMs) (Heinken et al., Gut Microbes (2013) 4(1):28-40). A variety of IEMs are documented in human and can be browsed at</span><span> </span><a href = "https://www.vmh.life/#diseases"><span>https://www.vmh.life/#diseases</span></a><span>.</span></div><div  class = 'S2'><span>This tutorial demonstrates how to predict the potential of a commensal gut microbe to rescue lethal gene deletions in a mammalian host. For this purpose, a microbe is joined with a mouse host.</span></div><div  class = 'S2'><span>We will use the AGORA resource (Magnusdottir et al., Nat Biotechnol. 2017 Jan;35(1):81-89) in this tutorial. AGORA can be downloaded from</span><span> </span><a href = "https://www.vmh.life/#downloadview"><span>https://www.vmh.life/#downloadview</span></a><span>.</span></div><div  class = 'S2'><span>As the host model, the global mouse reconstruction (Sigurdsson et al., BMC Systems Biology (2010) 4:140) will be used. The mouse reconstruction can be downloaded from</span><span> </span><a href = "https://wwwen.uni.lu/content/download/72950/917509/file/Mus_musculus_iSS1393.zip"><span>https://wwwen.uni.lu/content/download/72950/917509/file/Mus_musculus_iSS1393.zip</span></a><span>.</span></div><h2  class = 'S1'><span>Initialize the COBRA Toolbox</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >initCobraToolbox(false) </span><span style="color: rgb(2, 128, 9);">%don't update the toolbox</span></span></div></div></div><div  class = 'S2'><span>change directory to where the tutorial is located</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >tutorialPath = fileparts(which(</span><span style="color: rgb(170, 4, 249);">'tutorial_hostMicrobeInteractions'</span><span >));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >cd(tutorialPath);</span></span></div></div></div><h2  class = 'S1'><span>Prepare the models</span></h2><div  class = 'S2'><span>Download the mouse reconstruction.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >system(</span><span style="color: rgb(170, 4, 249);">'curl -O https://wwwen.uni.lu/content/download/72950/917509/file/Mus_musculus_iSS1393.zip'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >currentDir=pwd;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >unzip(</span><span style="color: rgb(170, 4, 249);">'Mus_musculus_iSS1393.zip'</span><span >,currentDir)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >iSS1393=readCbModel(</span><span style="color: rgb(170, 4, 249);">'iSS1393.mat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >iSS1393=changeObjective(iSS1393,</span><span style="color: rgb(170, 4, 249);">'biomass_mm_1_no_glygln'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% Define an AGORA model that can grow on the reduced diet and will be joined </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% with the mouse. </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >system(</span><span style="color: rgb(170, 4, 249);">'curl -O https://www.vmh.life/files/reconstructions/AGORA/1.02/reconstructions/sbml/Escherichia_coli_str_K_12_substr_MG1655.xml'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >model=readCbModel(</span><span style="color: rgb(170, 4, 249);">'Escherichia_coli_str_K_12_substr_MG1655.xml'</span><span >);</span></span></div></div></div><div  class = 'S2'><span>NOTE: Since dietary nutrients can also rescue many lethal gene defects, a diet reduced in nutrients will be used in this simulation to identify the effect of the microbes. Not all AGORA models are be able to grow on the given diet. Due to this, only microbes that can grow on the reduced diet can be used. </span></div><div  class = 'S2'><span>Define the reduced diet.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >reducedDietConstraints={</span><span style="color: rgb(170, 4, 249);">'EX_12dgr180[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_26dap_M[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_2dmmq8[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_2obut[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_3mop[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_4abz[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_4hbz[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_5aop[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_acmana[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_adpcbl[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ala_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.3'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_amet[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_amylose300[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.001667'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_anth[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_arab_D[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_arabinogal[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.00078'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_arach[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.1743'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_arachd[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.1743'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_arg_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.15'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_asn_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.225'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_asp_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.225'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ca2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_cbl1[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_chor[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_chsterol[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.12908'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_cl[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_cobalt2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_cu2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_cys_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.3'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ddca[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_dextran40[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.0063'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_fald[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_fe2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_fe3[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_fru[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_fum[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_glc_D[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_glcn[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_gln_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.18'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_glu_D[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_glu_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.18'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_gly[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.45'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_glyc[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1.162'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_glyc3p[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_h2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_h2s[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_hdca[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.21788'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_hdcea[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.21788'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_his_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.15'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ile_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.15'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_indole[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_k[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_lanost[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_lcts[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.5'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_leu_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.15'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_levan1000[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.0005'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_lnlc[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.19367'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_lnlnca[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.19367'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_lys_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.15'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_mal_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_malt[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.5'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_met_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.18'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_metsox_S_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_mg2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_mn2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_mnl[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_mqn7[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_mqn8[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_na1[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_nh4[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-100'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_nmn[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_no2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_no3[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ocdca[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.19367'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ocdcea[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.19367'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_octa[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.43575'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_phe_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.099'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_pheme[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_pi[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-100'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_pime[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_pro_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.18'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ptrc[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_pullulan1200[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.00042'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_pydx5p[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_q8[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_raffin[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.1667'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_rmn[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ser_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.3'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_sheme[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_so4[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_spmd[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_sucr[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.5'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_thr_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.225'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_trp_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.081'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_ttdca[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.24899'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_tyr_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.099'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_val_L[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-0.18'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_xan[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >;</span><span style="color: rgb(170, 4, 249);">'EX_zn2[u]'</span><span >,</span><span style="color: rgb(170, 4, 249);">'-1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'1000'</span><span >};</span></span></div></div></div><div  class = 'S2'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >models={};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >nameTagsModels={};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >bioID={};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >models{1,1}=model;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >bioID{1,1}=model.rxns(find(strncmp(model.rxns,</span><span style="color: rgb(170, 4, 249);">'biomass'</span><span >,7)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >nameTagsModels{1,1}=strcat(</span><span style="color: rgb(170, 4, 249);">'Escherichia_coli_str_K_12_substr_MG1655_'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >modelHost=iSS1393;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >nameTagHost=</span><span style="color: rgb(170, 4, 249);">'Mouse_'</span><span >;</span></span></div></div></div><div  class = 'S2'><span>Join the microbe with the mouse.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >[modelJoint] = createMultipleSpeciesModel(models,</span><span style="color: rgb(170, 4, 249);">'nameTagsModels'</span><span >,nameTagsModels,</span><span style="color: rgb(170, 4, 249);">'modelHost'</span><span >,modelHost,</span><span style="color: rgb(170, 4, 249);">'nameTagHost'</span><span >,nameTagHost,</span><span style="color: rgb(170, 4, 249);">'mergeGenesFlag'</span><span >,false);</span></span></div></div></div><div  class = 'S2'><span>Define the coupling parameters.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >c=400;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >u=0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >[modelJoint]=coupleRxnList2Rxn(modelJoint,modelJoint.rxns(strmatch(nameTagsModels{1,1},modelJoint.rxns)),strcat(nameTagsModels{1,1},bioID{1,1}),c,u);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >[modelJoint]=coupleRxnList2Rxn(modelJoint,modelJoint.rxns(strmatch(</span><span style="color: rgb(170, 4, 249);">'Mouse_'</span><span >,modelJoint.rxns)),</span><span style="color: rgb(170, 4, 249);">'Mouse_biomass_mm_1_no_glygln'</span><span >,c,u);</span></span></div></div></div><div  class = 'S2'><span>Some changes need to be made to the host model to constrain the body fluids compartment and the simulated intestinal barrier. This code needs to be adapted to each host since the IDs of created body fluid reactions may differ.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >modelJoint = changeRxnBounds(modelJoint,modelJoint.rxns(strmatch(</span><span style="color: rgb(170, 4, 249);">'Mouse_EX_'</span><span >,modelJoint.rxns)),0,</span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >modelJoint=changeRxnBounds(modelJoint,</span><span style="color: rgb(170, 4, 249);">'Mouse_EX_o2(e)b'</span><span >,-100,</span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div></div><div  class = 'S2'><span>Make unidirectional transport lumen -&gt; host extracellular space</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >modelJoint = changeRxnBounds(modelJoint,modelJoint.rxns(strmatch(</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX'</span><span >,modelJoint.rxns)),0,</span><span style="color: rgb(170, 4, 249);">'u'</span><span >);</span></span></div></div></div><div  class = 'S2'><span>Exception for metabolites host secretes into mucus/ lumen</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >modelJoint=changeRxnBounds(modelJoint,{</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_chol[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_galam[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_fuc_L[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_etha[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_drib[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_na1[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_h[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_tag_hs[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_mag_hs[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_lpchol_hs[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_Rtotal3[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_Rtotal2[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_Rtotal[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_dag_hs[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_chsterol[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_ha_pre1[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_ha[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_cspg_a[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_cspg_b[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_cspg_c[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_cspg_d[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_cspg_e[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_hspg[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_gchola[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_tdchola[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_tchola[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_tdechola[u]tr'</span><span >},1000,</span><span style="color: rgb(170, 4, 249);">'u'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >modelJoint=changeRxnBounds(modelJoint,{</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_no[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_n2m2nmasn[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_n2m2nmasn[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_s2l2n2m2m[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_s2l2fn2m2masn[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_s2l2n2m2masn[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_f1a[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_gncore1[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_gncore2[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_dsT_antigen[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_sTn_antigen[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_core8[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_core7[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_core5[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_core4[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_s2l2n2m2m[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_oh1[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_co2[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_hco3[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_ca2[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_cl[u]tr'</span><span >;</span><span style="color: rgb(170, 4, 249);">'Mouse_IEX_k[u]tr'</span><span >},1000,</span><span style="color: rgb(170, 4, 249);">'u'</span><span >);</span></span></div></div></div><div  class = 'S2'><span>Implement the reduced diet.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >modelJoint=useDiet(modelJoint,reducedDietConstraints);</span></span></div></div></div><div  class = 'S2'><span>Run the prediction of rescued genes. This will take some time.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >[OptSolKO,OptSolWT,OptSolRatio,RescuedGenes,fluxesKO]=computeRescuedGenes(</span><span style="color: rgb(170, 4, 249);">'modelJoint'</span><span >,modelJoint,</span><span style="color: rgb(170, 4, 249);">'Rxn1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'Mouse_biomass_mm_1_no_glygln'</span><span >,</span><span style="color: rgb(170, 4, 249);">'Rxn2'</span><span >,char(strcat(nameTagsModels{1,1},string(bioID{1,1}))),</span><span style="color: rgb(170, 4, 249);">'nameTag1'</span><span >,</span><span style="color: rgb(170, 4, 249);">'Mouse_'</span><span >,</span><span style="color: rgb(170, 4, 249);">'nameTag2'</span><span >,nameTagsModels{1,1},</span><span style="color: rgb(170, 4, 249);">'OriModel1'</span><span >,iSS1393,</span><span style="color: rgb(170, 4, 249);">'OriModel2'</span><span >,model);</span></span></div></div></div><div  class = 'S2'><span>Show the mouse genes that caused a lethal phenotype when deleted in germfree mouse but not in presence of the microbe:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >RescuedGenes.Mouse_biomass_mm_1_no_glygln.RescuedLethalGenes</span></span></div></div></div><div  class = 'S2'><span>The gene identifiers are NCBI Gene IDs and can be looked up to find the corresponding human genes and associated inborn errors of metabolism (IEMs). The reactions associated with the IEMs can subsequently be browsed at https://www.vmh.life/#diseases. For example, the gene 22247.1 encodes UMP synthase and its deletion can be resuced by the presence of E. coli. The corresponding IEM in human is orotic aciduria (https://www.vmh.life/#disease/OROA).</span></div><div  class = 'S2'><span>We will now identify the mechanisms of rescued KO phenotypes. Metabolites secreted by each species into the lumen may be taken up by the joined species and provide the metabolites that are essential due to the gene defect. To find the lumen exchange reactions of E. coli:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: normal"><span >microbeExchanges=find(strncmp(modelJoint.rxns,strcat(nameTagsModels{1,1},</span><span style="color: rgb(170, 4, 249);">'IEX'</span><span >),length(strcat(nameTagsModels{1,1},</span><span style="color: rgb(170, 4, 249);">'IEX'</span><span >))));</span></span></div></div></div><div  class = 'S2'><span>Now, let us find out which of the metabolites secreted by E.coli was essential for rescuing the defect in mouse UMP synthase. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span >[model,hasEffect,constrRxnNames,deletedGenes] = deleteModelGenes(modelHost,</span><span style="color: rgb(170, 4, 249);">'22247.1'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >constrRxnNames = strcat(nameTagHost,constrRxnNames);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >modelJoint=changeRxnBounds(modelJoint,constrRxnNames,0,</span><span style="color: rgb(170, 4, 249);">'b'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >modelJoint=changeObjective(modelJoint,</span><span style="color: rgb(170, 4, 249);">'Mouse_biomass_mm_1_no_glygln'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >modelJoint=changeRxnBounds(modelJoint,strcat(nameTagHost,</span><span style="color: rgb(170, 4, 249);">'ATPM'</span><span >),0,</span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span >modelJoint=changeRxnBounds(modelJoint,strcat(nameTagsModels{1},</span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >),0,</span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div></div><div  class = 'S2'><span>To print out the E. coli exchange that had to carry flux to rescue the orotic aciduria-like mouse phenotype, use the following code:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:length(microbeExchanges)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >isempty(strfind(modelJoint.rxns{microbeExchanges(i)},</span><span style="color: rgb(170, 4, 249);">'biomass'</span><span >))</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >        </span><span style="color: rgb(2, 128, 9);">% prevent secretion flux through the exchanges one by one while predicting mouse biomass</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >        modelJointDel=changeRxnBounds(modelJoint,modelJoint.rxns{microbeExchanges(i)},0,</span><span style="color: rgb(170, 4, 249);">'u'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >        solution=solveCobraLP(modelJointDel);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >solution.obj&lt;0.0000000001</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >            fprintf(</span><span style="color: rgb(170, 4, 249);">'%s \n'</span><span >,modelJoint.rxns{microbeExchanges(i)},</span><span style="color: rgb(170, 4, 249);">' is essential for rescuing orotic aciduria.'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: normal"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S2'><span>Can you explain what you observe? You can look up the metabolite ID of the respective exchange at</span><span> </span><a href = "https://www.vmh.life."><span>https://www.vmh.life.</span></a><span> Hint: Check the description of orotic aciduria at</span><span> </span><a href = "https://www.vmh.life/#disease/OROA."><span>https://www.vmh.life/#disease/OROA.</span></a><span> Follow the external link to OMIM (Online Mendelian Inheritance in Man) to find more information.</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Computation and analysis of rescued lethal gene deletions in a host-microbe model
%% Author: Almut Heinken, Molecular Systems Physiology Group, University of Luxembourg.
% Constraint-based modeling has useful applications for predicting the metabolic 
% interactions between a mammalian host and its commensal gut microbes. For example, 
% the potential of a human gut microbe to rescue lethal gene defects in the mouse 
% has been predicted. Some of these rescued gene defects correspond to human inborn 
% errors of metabolism (IEMs) (Heinken et al., Gut Microbes (2013) 4(1):28-40). 
% A variety of IEMs are documented in human and can be browsed at <https://www.vmh.life/#diseases 
% https://www.vmh.life/#diseases>.
% 
% This tutorial demonstrates how to predict the potential of a commensal gut 
% microbe to rescue lethal gene deletions in a mammalian host. For this purpose, 
% a microbe is joined with a mouse host.
% 
% We will use the AGORA resource (Magnusdottir et al., Nat Biotechnol. 2017 
% Jan;35(1):81-89) in this tutorial. AGORA can be downloaded from <https://www.vmh.life/#downloadview 
% https://www.vmh.life/#downloadview>.
% 
% As the host model, the global mouse reconstruction (Sigurdsson et al., BMC 
% Systems Biology (2010) 4:140) will be used. The mouse reconstruction can be 
% downloaded from <https://wwwen.uni.lu/content/download/72950/917509/file/Mus_musculus_iSS1393.zip 
% https://wwwen.uni.lu/content/download/72950/917509/file/Mus_musculus_iSS1393.zip>.
%% Initialize the COBRA Toolbox

initCobraToolbox(false) %don't update the toolbox
%% 
% change directory to where the tutorial is located

tutorialPath = fileparts(which('tutorial_hostMicrobeInteractions'));
cd(tutorialPath);
%% Prepare the models
% Download the mouse reconstruction.

system('curl -O https://wwwen.uni.lu/content/download/72950/917509/file/Mus_musculus_iSS1393.zip')
currentDir=pwd;
unzip('Mus_musculus_iSS1393.zip',currentDir)
iSS1393=readCbModel('iSS1393.mat');
iSS1393=changeObjective(iSS1393,'biomass_mm_1_no_glygln');
% Define an AGORA model that can grow on the reduced diet and will be joined 
% with the mouse. 
system('curl -O https://www.vmh.life/files/reconstructions/AGORA/1.02/reconstructions/sbml/Escherichia_coli_str_K_12_substr_MG1655.xml')
model=readCbModel('Escherichia_coli_str_K_12_substr_MG1655.xml');
%% 
% NOTE: Since dietary nutrients can also rescue many lethal gene defects, a 
% diet reduced in nutrients will be used in this simulation to identify the effect 
% of the microbes. Not all AGORA models are be able to grow on the given diet. 
% Due to this, only microbes that can grow on the reduced diet can be used. 
% 
% Define the reduced diet.

reducedDietConstraints={'EX_12dgr180[u]','-1','1000';'EX_26dap_M[u]','-1','1000';'EX_2dmmq8[u]','-1','1000';'EX_2obut[u]','-1','1000';'EX_3mop[u]','-1','1000';'EX_4abz[u]','-1','1000';'EX_4hbz[u]','-1','1000';'EX_5aop[u]','-1','1000';'EX_acmana[u]','-1','1000';'EX_adpcbl[u]','-1','1000';'EX_ala_L[u]','-0.3','1000';'EX_amet[u]','-1','1000';'EX_amylose300[u]','-0.001667','1000';'EX_anth[u]','-1','1000';'EX_arab_D[u]','-1','1000';'EX_arabinogal[u]','-0.00078','1000';'EX_arach[u]','-0.1743','1000';'EX_arachd[u]','-0.1743','1000';'EX_arg_L[u]','-0.15','1000';'EX_asn_L[u]','-0.225','1000';'EX_asp_L[u]','-0.225','1000';'EX_ca2[u]','-1','1000';'EX_cbl1[u]','-1','1000';'EX_chor[u]','-1','1000';'EX_chsterol[u]','-0.12908','1000';'EX_cl[u]','-1','1000';'EX_cobalt2[u]','-1','1000';'EX_cu2[u]','-1','1000';'EX_cys_L[u]','-0.3','1000';'EX_ddca[u]','-1','1000';'EX_dextran40[u]','-0.0063','1000';'EX_fald[u]','-1','1000';'EX_fe2[u]','-1','1000';'EX_fe3[u]','-1','1000';'EX_fru[u]','-1','1000';'EX_fum[u]','-1','1000';'EX_glc_D[u]','-1','1000';'EX_glcn[u]','-1','1000';'EX_gln_L[u]','-0.18','1000';'EX_glu_D[u]','-1','1000';'EX_glu_L[u]','-0.18','1000';'EX_gly[u]','-0.45','1000';'EX_glyc[u]','-1.162','1000';'EX_glyc3p[u]','-1','1000';'EX_h2[u]','-1','1000';'EX_h2s[u]','-1','1000';'EX_hdca[u]','-0.21788','1000';'EX_hdcea[u]','-0.21788','1000';'EX_his_L[u]','-0.15','1000';'EX_ile_L[u]','-0.15','1000';'EX_indole[u]','-1','1000';'EX_k[u]','-1','1000';'EX_lanost[u]','-1','1000';'EX_lcts[u]','-0.5','1000';'EX_leu_L[u]','-0.15','1000';'EX_levan1000[u]','-0.0005','1000';'EX_lnlc[u]','-0.19367','1000';'EX_lnlnca[u]','-0.19367','1000';'EX_lys_L[u]','-0.15','1000';'EX_mal_L[u]','-1','1000';'EX_malt[u]','-0.5','1000';'EX_met_L[u]','-0.18','1000';'EX_metsox_S_L[u]','-1','1000';'EX_mg2[u]','-1','1000';'EX_mn2[u]','-1','1000';'EX_mnl[u]','-1','1000';'EX_mqn7[u]','-1','1000';'EX_mqn8[u]','-1','1000';'EX_na1[u]','-1','1000';'EX_nh4[u]','-100','1000';'EX_nmn[u]','-1','1000';'EX_no2[u]','-1','1000';'EX_no3[u]','-1','1000';'EX_ocdca[u]','-0.19367','1000';'EX_ocdcea[u]','-0.19367','1000';'EX_octa[u]','-0.43575','1000';'EX_phe_L[u]','-0.099','1000';'EX_pheme[u]','-1','1000';'EX_pi[u]','-100','1000';'EX_pime[u]','-1','1000';'EX_pro_L[u]','-0.18','1000';'EX_ptrc[u]','-1','1000';'EX_pullulan1200[u]','-0.00042','1000';'EX_pydx5p[u]','-1','1000';'EX_q8[u]','-1','1000';'EX_raffin[u]','-0.1667','1000';'EX_rmn[u]','-1','1000';'EX_ser_L[u]','-0.3','1000';'EX_sheme[u]','-1','1000';'EX_so4[u]','-1','1000';'EX_spmd[u]','-1','1000';'EX_sucr[u]','-0.5','1000';'EX_thr_L[u]','-0.225','1000';'EX_trp_L[u]','-0.081','1000';'EX_ttdca[u]','-0.24899','1000';'EX_tyr_L[u]','-0.099','1000';'EX_val_L[u]','-0.18','1000';'EX_xan[u]','-1','1000';'EX_zn2[u]','-1','1000'};
%% 
% 

models={};
nameTagsModels={};
bioID={};
models{1,1}=model;
bioID{1,1}=model.rxns(find(strncmp(model.rxns,'biomass',7)));
nameTagsModels{1,1}=strcat('Escherichia_coli_str_K_12_substr_MG1655_');
modelHost=iSS1393;
nameTagHost='Mouse_';
%% 
% Join the microbe with the mouse.

[modelJoint] = createMultipleSpeciesModel(models,'nameTagsModels',nameTagsModels,'modelHost',modelHost,'nameTagHost',nameTagHost,'mergeGenesFlag',false);
%% 
% Define the coupling parameters.

c=400;
u=0;
[modelJoint]=coupleRxnList2Rxn(modelJoint,modelJoint.rxns(strmatch(nameTagsModels{1,1},modelJoint.rxns)),strcat(nameTagsModels{1,1},bioID{1,1}),c,u);
[modelJoint]=coupleRxnList2Rxn(modelJoint,modelJoint.rxns(strmatch('Mouse_',modelJoint.rxns)),'Mouse_biomass_mm_1_no_glygln',c,u);
%% 
% Some changes need to be made to the host model to constrain the body fluids 
% compartment and the simulated intestinal barrier. This code needs to be adapted 
% to each host since the IDs of created body fluid reactions may differ.

modelJoint = changeRxnBounds(modelJoint,modelJoint.rxns(strmatch('Mouse_EX_',modelJoint.rxns)),0,'l');
modelJoint=changeRxnBounds(modelJoint,'Mouse_EX_o2(e)b',-100,'l');
%% 
% Make unidirectional transport lumen -> host extracellular space

modelJoint = changeRxnBounds(modelJoint,modelJoint.rxns(strmatch('Mouse_IEX',modelJoint.rxns)),0,'u');
%% 
% Exception for metabolites host secretes into mucus/ lumen

modelJoint=changeRxnBounds(modelJoint,{'Mouse_IEX_chol[u]tr';'Mouse_IEX_galam[u]tr';'Mouse_IEX_fuc_L[u]tr';'Mouse_IEX_etha[u]tr';'Mouse_IEX_drib[u]tr';'Mouse_IEX_na1[u]tr';'Mouse_IEX_h[u]tr';'Mouse_IEX_tag_hs[u]tr';'Mouse_IEX_mag_hs[u]tr';'Mouse_IEX_lpchol_hs[u]tr';'Mouse_IEX_Rtotal3[u]tr';'Mouse_IEX_Rtotal2[u]tr';'Mouse_IEX_Rtotal[u]tr';'Mouse_IEX_dag_hs[u]tr';'Mouse_IEX_chsterol[u]tr';'Mouse_IEX_ha_pre1[u]tr';'Mouse_IEX_ha[u]tr';'Mouse_IEX_cspg_a[u]tr';'Mouse_IEX_cspg_b[u]tr';'Mouse_IEX_cspg_c[u]tr';'Mouse_IEX_cspg_d[u]tr';'Mouse_IEX_cspg_e[u]tr';'Mouse_IEX_hspg[u]tr';'Mouse_IEX_gchola[u]tr';'Mouse_IEX_tdchola[u]tr';'Mouse_IEX_tchola[u]tr';'Mouse_IEX_tdechola[u]tr'},1000,'u');
modelJoint=changeRxnBounds(modelJoint,{'Mouse_IEX_no[u]tr';'Mouse_IEX_n2m2nmasn[u]tr';'Mouse_IEX_n2m2nmasn[u]tr';'Mouse_IEX_s2l2n2m2m[u]tr';'Mouse_IEX_s2l2fn2m2masn[u]tr';'Mouse_IEX_s2l2n2m2masn[u]tr';'Mouse_IEX_f1a[u]tr';'Mouse_IEX_gncore1[u]tr';'Mouse_IEX_gncore2[u]tr';'Mouse_IEX_dsT_antigen[u]tr';'Mouse_IEX_sTn_antigen[u]tr';'Mouse_IEX_core8[u]tr';'Mouse_IEX_core7[u]tr';'Mouse_IEX_core5[u]tr';'Mouse_IEX_core4[u]tr';'Mouse_IEX_s2l2n2m2m[u]tr';'Mouse_IEX_oh1[u]tr';'Mouse_IEX_co2[u]tr';'Mouse_IEX_hco3[u]tr';'Mouse_IEX_ca2[u]tr';'Mouse_IEX_cl[u]tr';'Mouse_IEX_k[u]tr'},1000,'u');
%% 
% Implement the reduced diet.

modelJoint=useDiet(modelJoint,reducedDietConstraints);
%% 
% Run the prediction of rescued genes. This will take some time.

[OptSolKO,OptSolWT,OptSolRatio,RescuedGenes,fluxesKO]=computeRescuedGenes('modelJoint',modelJoint,'Rxn1','Mouse_biomass_mm_1_no_glygln','Rxn2',char(strcat(nameTagsModels{1,1},string(bioID{1,1}))),'nameTag1','Mouse_','nameTag2',nameTagsModels{1,1},'OriModel1',iSS1393,'OriModel2',model);
%% 
% Show the mouse genes that caused a lethal phenotype when deleted in germfree 
% mouse but not in presence of the microbe:

RescuedGenes.Mouse_biomass_mm_1_no_glygln.RescuedLethalGenes
%% 
% The gene identifiers are NCBI Gene IDs and can be looked up to find the corresponding 
% human genes and associated inborn errors of metabolism (IEMs). The reactions 
% associated with the IEMs can subsequently be browsed at https://www.vmh.life/#diseases. 
% For example, the gene 22247.1 encodes UMP synthase and its deletion can be resuced 
% by the presence of E. coli. The corresponding IEM in human is orotic aciduria 
% (https://www.vmh.life/#disease/OROA).
% 
% We will now identify the mechanisms of rescued KO phenotypes. Metabolites 
% secreted by each species into the lumen may be taken up by the joined species 
% and provide the metabolites that are essential due to the gene defect. To find 
% the lumen exchange reactions of E. coli:

microbeExchanges=find(strncmp(modelJoint.rxns,strcat(nameTagsModels{1,1},'IEX'),length(strcat(nameTagsModels{1,1},'IEX'))));
%% 
% Now, let us find out which of the metabolites secreted by E.coli was essential 
% for rescuing the defect in mouse UMP synthase. 

[model,hasEffect,constrRxnNames,deletedGenes] = deleteModelGenes(modelHost,'22247.1');
constrRxnNames = strcat(nameTagHost,constrRxnNames);
modelJoint=changeRxnBounds(modelJoint,constrRxnNames,0,'b');
modelJoint=changeObjective(modelJoint,'Mouse_biomass_mm_1_no_glygln');
modelJoint=changeRxnBounds(modelJoint,strcat(nameTagHost,'ATPM'),0,'l');
modelJoint=changeRxnBounds(modelJoint,strcat(nameTagsModels{1},'DM_atp_c_'),0,'l');
%% 
% To print out the E. coli exchange that had to carry flux to rescue the orotic 
% aciduria-like mouse phenotype, use the following code:

for i=1:length(microbeExchanges)
    if isempty(strfind(modelJoint.rxns{microbeExchanges(i)},'biomass'))
        % prevent secretion flux through the exchanges one by one while predicting mouse biomass
        modelJointDel=changeRxnBounds(modelJoint,modelJoint.rxns{microbeExchanges(i)},0,'u');
        solution=solveCobraLP(modelJointDel);
        if solution.obj<0.0000000001
            fprintf('%s \n',modelJoint.rxns{microbeExchanges(i)},' is essential for rescuing orotic aciduria.')
        end
    end
end
%% 
% Can you explain what you observe? You can look up the metabolite ID of the 
% respective exchange at <https://www.vmh.life. https://www.vmh.life.> Hint: Check 
% the description of orotic aciduria at <https://www.vmh.life/#disease/OROA. https://www.vmh.life/#disease/OROA.> 
% Follow the external link to OMIM (Online Mendelian Inheritance in Man) to find 
% more information.
##### SOURCE END #####
-->
</div></body></html>