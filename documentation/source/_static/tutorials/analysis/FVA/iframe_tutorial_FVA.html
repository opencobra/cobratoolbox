<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/opencobra/cobratoolbox@ffa0229fc0c01c9236bb7e961f65712443277719/latest/_static/js/iframeResizer.contentWindow.min.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Flux Variability analysis (FVA)</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: normal; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: center;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: normal;  }
.S5 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: normal; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 250px;    overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement{    min-height: 18px;    max-height: 250px;    overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2019 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: rgb(255,100,0);    text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: rgb(230,0,0);    text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: normal;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: normal;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: normal;    word-wrap:  initial;    min-height: 18px;    max-height: 250px;    overflow: auto;}
.textElement,.rtcDataTipElement .textElement {    padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S14 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S15 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-weight: bold;'>Flux Variability analysis (FVA)</span></h1><div  class = 'S1'><span style=' font-weight: bold;'>Authors :  Vanja Vlasov, Systems Biochemistry Group, LCSB, University of Luxembourg.</span></div><div  class = 'S1'><span style=' font-weight: bold;'>Reviewers : Anne Richelle, Lewis Lab at University of California, San Diego.</span></div><div  class = 'S1'><span>Flux variability analysis (FVA) is a widely used computational tool for evaluating the minimum and maximum range of each reaction flux that can still satisfy the constraints using a double LP problem (i.e. a maximization and a subsequent minimization) for each reaction of interest [1]. </span></div><div  class = 'S1'><span></span></div><div  class = 'S2'><span texencoding="\begin{array}{lll}
\\{v}_{j,upper}/\ {v}_{j,lower}=max\limits _{v}/\min\limits _{v} &amp; v_{j} \\
\text{s.t.} &amp; Sv=0,\\
 &amp; l\leq v\leq u\\
\end{array}" style="vertical-align:-40px"><img src="data:image/png;base64,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" width="238.5" height="92" /></span></div><div  class = 'S1'><span>where </span><span texencoding="v \in R^{n}" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAAAmCAYAAABedGw2AAAE7klEQVRoQ+2YdagtVRTGf88O7BYFMZ7YiYKBioooqChiPRsxsANRscXCDgwetqgP22diJ3ZhJ3YndvO7rC3zhnPnnD3nzfHCnfXXuXNnr7X3N2t/61trDK01gsCYRry2TmmBbSgJWmBbYBtCoCG3bca2wDaEQENu24xtgW0IgYbcjqaMnRq4CFgPWLCE56/x9xfA+8DDwHnAZ3VxH03AJozmAT4CpooHhwGnwZCmXwU4B1gR+A3YHrgu3hsHrA+sAJwA3AwcB+wCPAhsWfwIoxHYWYDvAoSfgdkDxITL3MDrwGyAmbw88AYwJXAxIMDzAYcCE4B9gO2A6Yt+RiOwa0WGCeRdwIYdrvu1wFbxfH/g7Ph9P/BPrL8eeA24CVgaWGykZKwfdTNgi7h6ZsE0XTjtWODkurwX644GjonfBwJndvAnkPvG8/OBvSIjvwUmAoJqtmofALcDe44EYP3CV8Y1y8HpiOC3nDXldx8FVo+HywAvd3D2ALB2KWM3iAyXW00IbWzQhH/7/D/rRAXTAksGSadKWo4tUS8aX/uXzFOuAdwBzAT8BJwO3Ae8CHyf6Sv3dWN+E4XrU2D+Dg4810uRoe5vEeDzKHAHxe16PtaZyWcBcwA/VAG7FLBtfJElgozdzB+lj/EjMENcKa9nr+Z1fwGwQDwUpG+FHpRtAtwSwa4AdiwFdl/3AMsGl1rxL4t33PffAWxadmOcxWRZLpJj6H/DFS9BfTVWKy90WrQTAWXKDcGRvQKjjtwtfK82gAwt7+tcYO94eBQwHpgZWBhYJ7h0RuBd4ADg1nhXwNW08vPxBafq3qsAM/hJ4M30vypV8E4E3DVkRnGTakCDnwq42V7MDX8FTAesCjzVy6LJ/I4yavHIRnWqe0kmDcn7dwL3Ar8X/rcNcDVQ5mS5eCFgB+CR4l6rgL0E2Bk4A5Bbimb1/jKKz3s9Hl5ZI7fKX16bQZvdlhVcs4CtGdn6NjBXcOS8QG7N6HiOKmC9KvLnbcDGpdUCrnDeLwOd3YELgb9KnJ3hYmg/deWWfKnA15RbqTYUpZWZqYbt26qA3Qm4NHjD65PMbH0cUH58nbEDdZ6asB/rR25dA2wdwS02j8Vv29dn4/dwDUP2nquAlcztNJQRtoHJTgKeicKVE3DzWKO0chAySPOcSiavvIrGNraodKQn+dPbJGUoxfqyKmBt0VKVs1gZVGHtV7c/zrUFgA/Dj1xmIRuUqWyei2CdqM0a4iBGOySKcl97qwLWr6uc0OaMrL0A2DSGE3UCezgPWeS4On5y1wjWKbGo2PsnP35o9bSDllei98+NMcn7VcDagaU5pZnqiExB/XEfEZNs+TOq8hN9+MpZquhP9LNSIXuLPuz3N4oHw73Tc8xu0y21nsXKsZnDkk59dc/BgCmAu+OQn8QIzllmk2Z98OZ5Ds9T7iRTbNv0NFix0NmB1rZuwFr1nResCzxdO8qkCx00K6zt7mwRpRcnRnYuaU46mUINuSlOs/RvF1UsXCmWN9TuatZoIFYeJrN72ls3YM2uIxvokhxa2IDYu+dYjtzyOktf6XqnOG/F2O/wDoH9yHvEc4vr5cDBORtM73YDto7PnDVKOttBOdxJk1lTZWafc4oRb/83sCMeoLobbIGti1yXdS2wLbANIdCQ2zZjW2AbQqAht23GtsA2hEBDbv8F09/pJ9cl7QEAAAAASUVORK5CYII=" width="43" height="19" /></span><span> is the vector of specific reaction rates (metabolic fluxes) and  </span><span texencoding="{v}_{j,upper}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAoCAYAAABtla08AAAE80lEQVRoQ+2ZBchlRRTHf4uFYmAHIljYvQpiIyoqKnYXmLg2iIFdiB1gJ4qKCmK3iKLYyyp2YBcmYmLwgzPL5frefXNl3gcX7sCyH++dOXPOf/6n5k2iX0UQmFRES6+EHshCJOiB7IEshEAhNT0jeyALIVBITc/IHshCCBRS0zOyB7IQAoXU9IzsgSyEQCE1gxg5C7A8sBowE3DlgLN2ApYCLgR+LWRLp9XUgVwB2A3YFlgO+B2YA/iz4qV7fgZmA04BTu00AoWMH5YjBfGNOENmTq2ddxZwHHAXsEMhWzqtpqnYvA8sAewHXFvzckbgA+Bc4NJOI1DI+CYgrwP2BS4Ajq6dNzPwDbAq8GEhWzqtpgnIkyL/3QdsVfNSgAXx8E57X9D4JiD3Aa4H3gGWqZwpG58FNgO+LWhLp1U1AbkR8ATwEzBXxcuzgZei0Ixy/khgCrAu8MUo4S5/3wTk0sFG/bO4/AWsA+wCHJrp9JkR/qtXdGVu7ZZYE5DzA1+HO/MFKy8HtgF+a+GmTX21D22xtTuiTUA64STAZOJpwN7AZ91xb+IsHfVo4WRjcXk7Gu/XM03bEpgcY+TzwGUN+7wke9W14rJuD1kj4mHgfOCW+P7gSC+OrZ9G/l0ZeArYE/ixhVzVJDuQA4IkFtFzgPuBRaMF9DPbve2Ak4EDYwJ8MikZBaRV2dDcGHgxE0TF3GOh0SDn8jtG7D0WsIhpeGL8UQHiGsArsX8v4EbgogD5obiEqwHbtdNbyil+EOBZFlfPdlrz/WCP0GV9+AU4IwrvQtFX7wjcnQukjDgReKEFiElUx5zFF4zbbFIh42Rwtc2S/QsDMvPv2Cw7ddo+9ob4LI2ztwG7tpRLLZ55/x5gSeDV0C+grsVjijsB+DzOnT3eG6b7NIqR/wO/6VseBBYBVslQ8gnwQISM4ltEaN0JePNpyUwZYjinldq0i4Ej4sMcOdnvZT0dA8fawFXx2lVNRbvHiOyYfMgwX8YFpM5+BzhmJueG2ZDaLNkkq2aIQcCcZ068IjbaOdhFyHILX1pOV4a6ednLyJUz16lLZn8Z4exZqVNJ+k0lvohtDjw20UBaOCwyKWSaSGmhMcfJXpt2c5N/m18F+b3YvHMAvVIwyY8F/c1wfj3gHyBXzvy6ITAn8EeDgYazQNsLD13jYuQxUTzmBX6onS5jLGI67bomKrG5boPoOWWify8GWGxeDrB9J3V/WvsDl8Tcb2fh8lJy5HwmnAeweFTXssBb8YGXNg2wGHqxEw6kIWaRWLN28mGAuexRYNP47jXg46jQtiG+NvlEJ3j3Rg7zhcl/zv22Ii7/d0Cwkj9TOSdXzhbKlscUcnPYa1vzOPBc6PPV67xaZAwEcxyMNNy+j97x+NqpMkggZw0mfBXhanslKL62O4qai2SGA4CO+bPGu4B9m06vGEXHEVQdaeXKKT93nGnus0f04rTXd9i07Fpk7MiCOQ4gzTs6bDujcYOWze7WAVpTxKTv7PUE2vBPYTdoX65czpmtZEoCKRNlk62DYMqaQcsC5GvSTS0stQ1aH1hgxJ5cuRZH54mWAtKE7w9n5q2PoqF9ZIAJhokV3eY3d9n8Og4a4ts3bMqVyz23lVwpIJ1BfXf0ndLJ4NZWVgwXFnh/aNskCpCJ3wJUX7lyhcz6r5pSQI7NwK4o7oEsdFM9kIWA/BfOMBA4HUNA4AAAAABJRU5ErkJggg==" width="41" height="20" /></span><span>  and  </span><span texencoding="{v}_{j,lower}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFEAAAAoCAYAAACGohY/AAAFOElEQVRoQ+2Zd6hdRRDGf7FFJSoSNZqIXcSaKBoiihUM9ooNY8HYWyyIir3HWGPviYIVFSyxgQUbNuyiYsVeE3sv/GBOWI73nvNesveZa8788+Ce3dmdb7/5ZnZfPxqbbgT6TbeHxgENiBlI0IDYgJgBgQwuGiY2IGZAIIOLhokNiBkQyOCiYWIDYgYEMrhomNiAmAGBDC5aMbE/sAKwKjA7cHmLdbYHlgHOA37OsI+udlEGcUVgZ2BrYHngV2Ae4PckSuf8AMwNnAic1NUIZNh8O00UwNfDv4x8sbTW6cDRwG3Adhn20dUuqgrLO8BSwGjg6lKUswHvAuOAC7sagQybrwLxGmAP4Fzg8NJacwBfAsOA9zLso6tdVIF4fOjd3cDmpSgFVwAP6eroM22+CsTdgWuBt4DlkvVk4ZPASODrTPtQNnYCVgamAPtm8tsnbqpAXB94CPgOmC/ZzRnAc1FU6jZ5KHAgsDbwac1gmf0CYAacUud4RvpeBeKywUL3ayH5E1gL2BE4qIdBnBYpv1riq93UTYB7Yg2Z3jVWBeKCwBcRyQLBxkuBLYFfehGhDXvaZ7abeg6wNzA/8Ecv/P/nQ6tA9OZSgCUDTwZ2Az7u0K5fAj4ENuuQ/465rXuA8MZiIXkzmupXe7iTTYHV42r4NHBRzTxZ/3m0Ul4lU7Oo7R8Fx4NdKXT2fcDr5z7BXiWjsFmAs4Aj4gez4W1AebkiGadM2b65/gBgELAN8DewBrALsA5wE2AWXgUMjyvx5MJPHYhWXzewIfBsDwF0mHMsKmMj0Ftr5u4QGx0KvJyM3RWwkKmXMlV7PjLE7NBOBY4CBFjd1tTsY4BFEl/Xxz1fydAWjTXvj0JmZ+Da1gIB19YFHgE2ALYF5oouwm7is56C6ALHAc/0AsBiqFXWu7Wna2NeZbJjqxgrCzTZfGdkwB3J5InAqNDo7yOoG4DFQg4WB66LAmUW/RVzLYi2T/cBc0Yn8GMwyzGXRBexSrKW/bAMNA734lVYxvp2MNXqmDgN2E2dci8wGJBddeYV0oMyUM0gTVdP27t7AazfrNwjYsxvEfhj8fcJ4ExACbk9DsXiaJymsuzUzgYOCwCVKL/ZhnmQaSt2ZRyGh6LfltYpENWabwCvjmNqEFwy7uGmmZvW9gz9kQkTkvmzRoP/WgTnJ5kn4Dbrrus1VHA9lEIeDoj2yXGy0973q2DZQsFOD71sHwTzTHHj6VMQFV/ZYDtkGlSZDxyCt3SA6VjTey/A1HolmazQq21eQ72OauqvXcT5gAVFLVbvrPTeqtRJtawYL4ufAk6IjqPd3ixob8Sbqaxta51i4pFREAaGDqUbsOe0YBUpeiOwJrBEpNTjwC2hhQZvh6AJkKn3KLBfKSJTVgnwMfmjANZ5x0bPaaUuzIp+c/i4LPl93mDdJ/GbxWl8SIeE6HMQJ0XbYJuQ2sHABcCDwEbxwZSx8luFBU0QTT/boiFAEZQBLxyPxj+V/Kqp6pYFoDDT1UJgZ5E2+6a/7wG+kW4MfAusF/LgHoqxd8UjiwUr1eR/gdkJJqpb9lCCUAh5sbApKoiCJSD2hrJOJppeaqimDx9+1SI7BFsV9SzVxzQYU9m1UnCLquoaZbNdETD3INBKxMXJICWi0PTal6pOgOipPhzNtj1dK/OOvEXS11Vlywz/LSeIskcRl4EC6c2ilVlsfBUy/f4XlgtEBdh/clkN1ThbkwdaIGT6WLnrKnZXgZsLRO+bvhv6zuiboBV3prFcIM40gLUKtAExw/E3IGYA8R9sEf0pnKMRzgAAAABJRU5ErkJggg==" width="40.5" height="20" /></span><span> are respectively the upper and lower values of each flux </span><span texencoding="{v}_{j}" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAoCAYAAAACJPERAAAB90lEQVRYR+3WTahNYRTG8d/NVyndAVKGIrmUjzBhQAYGkkiSCcqQkFIUoZAUhZIBhgYykYgBM+UrBlIUMpAiH0khKa169223O3efs9n73IFzZruz1vPfa71rPe/uMwy/vmFg6kEb7Xqvvb321tKB3iDV0sahRFq1dwwGMBejcK5F8jpMxUl8r/qGRehMbMBqzMBPjMOvnHDkfMNYHMDBf4Vm+QF8lh6i4icF4SPYgytYWxc0dF5iCrbgfEF4JF7hOE7XCb2AzTiBXQXh0fiAOXhdJ3R/Oq9rWFkQjpcJ4PaqwIgvM4dNuIgXmJ4TjyrvYjk+1g1ditv4iv6c+FE8TEPUjrkTW7EY77LgskqnpSojNgbnNxZhPba1o6X/D6cjmJfTKm3vRLxPyRNStWexCj86hEZYGEx+z0uh4UyZeFR4CBvxtgKwZWi7WyYcKQbneTKBpx0CV2B+ssp7OJPPaweN6Yz2LMODDoFZS2OIjiF8+nIV6E3sw/0KwCw09jy8eVIykkGJdpX+BWsw5QYmY3ZRpClorNgnhJXu6BZ0IWKAYr2udgu6G+Fc4/GlW9DrCHNZ0GoomjjTEficdnNvt6BLcCeZw6OmoVFhXArhPgGeNdS+1dXeU4iPurhj36QvjltNQ9ekezPu2ce4VOYqdVVaybn+H+gflIJOKVXaZ3wAAAAASUVORK5CYII=" width="14.5" height="20" /></span><span> satisfying the system of linear equations.</span></div><div  class = 'S1'><span>Depending on the size of the model you are using for the analysis, use:</span></div><ul  class = 'S3'><li  class = 'S4'><span style=' font-family: monospace;'>fluxVariability()</span><span> function - for the low dimensional FVA;</span></li><li  class = 'S4'><span style=' font-family: monospace;'>fastFVA()</span><span> function - for the models with more than 1,000 reactions;</span></li><li  class = 'S4'><a href = "https://github.com/opencobra/COBRA.jl"><span>distributedFBA.jl</span></a><span> - for high dimensional FVA,</span><span style=' font-weight: bold;'> </span><span>models larger than 10,000 reactions </span><span texencoding="$^2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAABF0lEQVRIS+3UsSuFURjH8c/NoJRkUsTIRMmoDAYZZDDJatLNJpudxSSUQWySDMqkJDb/gNVsMSilRKcO3d7e8557u9vtnu2cnud7nuf3/M6paXPV2szXwYAF7GAKb7iJ+4+iZmUarGAfV+jFMkZxj/kcoCcGhqT3GNyPZ0xgDo+NkGIFsxjGZeGmOg6wgeMqwABCn98FwFLUYRUXVYCUr9ZxhJEo6n9cs0YKLb1iKydiWQXjOI8CfrUKCFO5xjZeyui5FvbwgNuUOFWAzTiR06oXmwKsYQy7heRJDOHu77wMsIgTnOGnATAYrTyDzxRgGk/oS5R9iODKln2QlCE3heyP1wXo5G89O/+qt9B0cgjsGqmrQfDBL0GOJif7qwNnAAAAAElFTkSuQmCC" width="8" height="19" /></span><span>.</span></li></ul><h2  class = 'S5'><span>EQUIPMENT SETUP</span></h2><div  class = 'S1'><span>If necessary, initialize the cobra toolbox</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: normal"><span >initCobraToolbox(false) </span><span style="color: rgb(2, 128, 9);">% false, as we don't want to update</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="0F5A0DB2" data-testid="output_0" data-width="428" data-height="927" data-hashorizontaloverflow="true" style="width: 458px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">      _____   _____   _____   _____     _____     |
     /  ___| /  _  \ |  _  \ |  _  \   / ___ \    |   COnstraint-Based Reconstruction and Analysis
     | |     | | | | | |_| | | |_| |  | |___| |   |   The COBRA Toolbox - 2021
     | |     | | | | |  _  { |  _  /  |  ___  |   |
     | |___  | |_| | | |_| | | | \ \  | |   | |   |   Documentation:
     \_____| \_____/ |_____/ |_|  \_\ |_|   |_|   |   <a href="http://opencobra.github.io/cobratoolbox" style="white-space: normal; font-style: normal; color: rgb(0, 95, 206); font-size: 12px;">http://opencobra.github.io/cobratoolbox</a>
                                                  | 

 &gt; Checking if git is installed ...  Done (version: 2.20.1).
 &gt; Checking if the repository is tracked using git ...  Done.
 &gt; Checking if curl is installed ...  Done.
 &gt; Checking if remote can be reached ...  Done.
 &gt; Initializing and updating submodules (this may take a while)... Done.
 &gt; Adding all the files of The COBRA Toolbox ...  Done.
 &gt; Define CB map output... set to svg.
 &gt; TranslateSBML is installed and working properly.
 &gt; Configuring solver environment variables ...
   - [-*--] ILOG_CPLEX_PATH: /usr/local/bin/cplex/ibm/ILOG/CPLEX_Studio1210/cplex/matlab/x86-64_linux
   - [-*--] GUROBI_PATH: /usr/local/bin/gurobi811/linux64/matlab
   - [-*--] TOMLAB_PATH: /usr/local/bin/tomlab/tomsym
   - [----] MOSEK_PATH: --&gt; set this path manually after installing the solver ( see <a href="https://opencobra.github.io/cobratoolbox/docs/solvers.html" style="white-space: normal; font-style: normal; color: rgb(0, 95, 206); font-size: 12px;">instructions</a> )
   Done.
 &gt; Checking available solvers and solver interfaces ...No valid license for the SNOPT solver


tomRun: ERROR! snopt solver returned empty Result

Run startup to set paths


 Done.
 &gt; Setting default solvers ... Done.
 &gt; Saving the MATLAB path ... Done.
   - The MATLAB path was saved as ~/pathdef.m.

 &gt; Summary of available solvers and solver interfaces

			Support 	   LP 	 MILP 	   QP 	 MIQP 	  NLP
	----------------------------------------------------------------------
	gurobi       	active        	    1 	    1 	    1 	    1 	    -
	ibm_cplex    	active        	    1 	    1 	    1 	    1 	    -
	tomlab_cplex 	active        	    1 	    1 	    1 	    1 	    -
	glpk         	active        	    1 	    1 	    - 	    - 	    -
	mosek        	active        	    0 	    - 	    0 	    - 	    -
	matlab       	active        	    1 	    - 	    - 	    - 	    1
	pdco         	active        	    1 	    - 	    1 	    - 	    -
	quadMinos    	active        	    1 	    - 	    - 	    - 	    -
	dqqMinos     	active        	    1 	    - 	    1 	    - 	    -
	cplex_direct 	active        	    1 	    1 	    1 	    - 	    -
	cplexlp      	active        	    1 	    - 	    - 	    - 	    -
	qpng         	passive       	    - 	    - 	    1 	    - 	    -
	tomlab_snopt 	passive       	    - 	    - 	    - 	    - 	    1
	lp_solve     	legacy        	    1 	    - 	    - 	    - 	    -
	----------------------------------------------------------------------
	Total        	-             	   11 	    5 	    7 	    3 	    2

 + Legend: - = not applicable, 0 = solver not compatible or not installed, 1 = solver installed.


 &gt; You can solve LP problems using: 'gurobi' - 'ibm_cplex' - 'glpk' - 'matlab' - 'pdco' - 'quadMinos' - 'cplexlp' 
 &gt; You can solve MILP problems using: 'gurobi' - 'ibm_cplex' - 'glpk' 
 &gt; You can solve QP problems using: 'gurobi' - 'ibm_cplex' - 'pdco' 
 &gt; You can solve MIQP problems using: 'gurobi' - 'ibm_cplex' 
 &gt; You can solve NLP problems using: 'matlab' 

&gt; Checking for available updates ... skipped</div></div></div></div></div><div  class = 'S8'><span>For solving line</span><span>ar programming problems in FBA and FVA analysis, certain solvers are required. The present tutoria</span><span>l can ru</span><span>n with glpk package, which does not require additional installation and configuration. Although, for the analysis of large models is recommended to use the GUROBI package.</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: normal"><span >changeCobraSolver (</span><span style="color: rgb(170, 4, 249);">'ibm_cplex'</span><span >, </span><span style="color: rgb(170, 4, 249);">'LP'</span><span >);</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="9A9D0A9E" data-testid="output_1" data-width="428" data-height="31" data-hashorizontaloverflow="true" style="width: 458px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"> &gt; changeCobraSolver: IBM ILOG CPLEX interface added to MATLAB path.
 &gt; ibm_cplex (version 1210) is compatible and fully tested with MATLAB R2019a on your operating system.</div></div></div></div><div class="inlineWrapper outputs"><div  class = 'S9'><span style="white-space: normal"><span >changeCobraSolver (</span><span style="color: rgb(170, 4, 249);">'ibm_cplex'</span><span >, </span><span style="color: rgb(170, 4, 249);">'QP'</span><span >);</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="F5A3B3F4" data-testid="output_2" data-width="428" data-height="31" data-hashorizontaloverflow="true" style="width: 458px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"> &gt; changeCobraSolver: IBM ILOG CPLEX interface added to MATLAB path.
 &gt; ibm_cplex (version 1210) is compatible and fully tested with MATLAB R2019a on your operating system.</div></div></div></div></div><h2  class = 'S5'><span>PROCEDURE</span></h2><div  class = 'S1'><span>In thi</span><span>s tutorial, we will use the generic model of the human cellular metabolism, Recon2.0 </span><span texencoding="$^3" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAABBUlEQVRIS+3UPyuFYRzG8c/JgFLMIsVLUGSzGLwCL8FGsolNFhMGi5QBkVJKYbMrXoBFNoM/UcpCd93DcXo8z32eYzo993bX9fvW77qufjUtvlqL89oYMI41jOIdJ1jCZ6NnWR6MYR0beMEMZrGFuRTAXhS+1Ylv0YvhIkAHBvDQILzAN6aLAFm16IzAsMp1s4AuHOMMO1n0vCItYh6D+MJyNPcXJw8QTOvHZIw0/ENCN/WE1CpP4QorWC0DCDNP2MdCWcBjXGW7DGAIdxjBcx6gD+e4xCZe0YND7OK0qAfdcc8JfOAoRniA+2Z7kHSsUmP8E1YBtPNZTypREFU9qDz4lx78AKqqKSfCSoPFAAAAAElFTkSuQmCC" width="8" height="19" /></span><span>. Load the model</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span style="color: rgb(14, 0, 255);">global </span><span >CBTDIR</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelFileName = </span><span style="color: rgb(170, 4, 249);">'Recon2.0model.mat'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelDirectory = getDistributedModelFolder(modelFileName); </span><span style="color: rgb(2, 128, 9);">%Look up the folder for the distributed Models.</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelFileName= [modelDirectory filesep modelFileName]; </span><span style="color: rgb(2, 128, 9);">% Get the full path. Necessary to be sure, that the right model is loaded</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S12'><span style="white-space: normal"><span >model = readCbModel(modelFileName);</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="027BE71C" data-testid="output_3" data-width="428" data-height="18" data-hashorizontaloverflow="true" style="width: 458px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Each model.subSystems{x} is a character array, and this format is retained.</div></div></div></div><div class="inlineWrapper"><div  class = 'S13'></div></div></div><div  class = 'S8'><span>The metabolites structures an</span><span>d reactions in Recon2.0 can be found in the Virtual Metabolic Human database (VMH, </span><a href = "http://vmh.life"><span>http://vmh.life</span></a><span>).</span></div><div  class = 'S1'><span>Constrain the model to limit the availability of carbon and oxygen energy sources. Find the uptake exchange reactions using </span><span style=' font-style: italic;'>findExcRxns</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span >[selExc, selUpt] = findExcRxns(model);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >uptakes = model.rxns(selUpt);</span></span></div></div></div><div  class = 'S8'><span>Select from the set of reactions defined in </span><span style=' font-style: italic;'>uptakes</span><span> those which contain a least one carbon in the metabolites involved in the reaction and set the flux values of these reactions to zero:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span >subuptakeModel = extractSubNetwork(model, uptakes);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >hiCarbonRxns = findCarbonRxns(subuptakeModel,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >modelalter = changeRxnBounds(model, hiCarbonRxns, 0, </span><span style="color: rgb(170, 4, 249);">'b'</span><span >);</span></span></div></div></div><div  class = 'S8'><span>Also close the other reaction related to the exchange of oxygen and energy sources:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span >energySources = {</span><span style="color: rgb(170, 4, 249);">'EX_adp'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_amp(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_atp(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_co2(e)'</span><span >;</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >    </span><span style="color: rgb(170, 4, 249);">'EX_coa(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_fad(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_fe2(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_fe3(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_gdp(e)'</span><span >;</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >    </span><span style="color: rgb(170, 4, 249);">'EX_gmp(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_gtp(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_h(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_h2o(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_h2o2(e)'</span><span >;</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >    </span><span style="color: rgb(170, 4, 249);">'EX_nad(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_nadp(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_no(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_no2(e)'</span><span >; </span><span style="color: rgb(170, 4, 249);">'EX_o2s(e)'</span><span >};</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >modelalter = changeRxnBounds (modelalter, energySources, 0, </span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div></div><div  class = 'S8'><span>For this tutorial, we will analyse the variability of several reactions of the human cellular metabolism in aerobic and anaerobic condition. For each simulation, the original model will be copied to a new model structure (e.g., </span><span style=' font-style: italic;'>modelfva1</span><span> for aerobic condition and </span><span style=' font-style: italic;'>modelfva2</span><span> for anaerobic condition). This preserves the constraints of the original model and allows to perform simulations with new constraints. Additionally, this method of renaming the model avoids confusion while performing multiple simulations at the same time.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% modelfva1 represents aerobic condition</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelfva1 = modelalter;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelfva1 = changeRxnBounds(modelfva1, </span><span style="color: rgb(170, 4, 249);">'EX_glc(e)'</span><span >, -20, </span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelfva1 = changeRxnBounds(modelfva1, </span><span style="color: rgb(170, 4, 249);">'EX_o2(e)'</span><span >, -1000, </span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% modelfva2 represents anaerobic condition</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelfva2 = modelalter;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >modelfva2 = changeRxnBounds(modelfva2, </span><span style="color: rgb(170, 4, 249);">'EX_glc(e)'</span><span >, -20, </span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >modelfva2 = changeRxnBounds(modelfva2, </span><span style="color: rgb(170, 4, 249);">'EX_o2(e)'</span><span >,  0, </span><span style="color: rgb(170, 4, 249);">'l'</span><span >);</span></span></div></div></div><h2  class = 'S5'><span>1) Standard FVA</span></h2><div  class = 'S1'><span>The full spectrum of flux variability analysis options can be accessed using the command:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% [minFlux, maxFlux, Vmin, Vmax] = fluxVariability(model,...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% optPercentage,osenseStr, rxnNameList, verbFlag, allowLoops, method);</span></span></div></div></div><div  class = 'S8'><span>The </span><span style=' font-family: monospace;'>optPercentage</span><span> parameter allows one to choose whether to consider solutions that give at least a certain percentage of the optimal solution (default - 100). Setting the parameters  </span><span style=' font-family: monospace;'>osenseStr = 'min'</span><span> or </span><span style=' font-family: monospace;'>osenseStr = 'max'</span><span> determines whether the flux balance analysis problem is first solved with minimization or maximisation (default - 'max'). The </span><span style=' font-family: monospace;'>rxnNameList</span><span> accepts a cell array list of reactions to selectively perform flux variability upon (default - all reactions of the model). This is useful for high-dimensional models as computation of flux variability for all reactions can be time consuming:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% Selecting several reactions of the model that we want to analyse with FVA</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >rxnsList = {</span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >; </span><span style="color: rgb(170, 4, 249);">'ACOAHi'</span><span >; </span><span style="color: rgb(170, 4, 249);">'ALCD21_D'</span><span >; </span><span style="color: rgb(170, 4, 249);">'LALDO'</span><span >; </span><span style="color: rgb(170, 4, 249);">'ME2m'</span><span >;</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >    </span><span style="color: rgb(170, 4, 249);">'AKGDm'</span><span >; </span><span style="color: rgb(170, 4, 249);">'PGI'</span><span >; </span><span style="color: rgb(170, 4, 249);">'PGM'</span><span >; </span><span style="color: rgb(170, 4, 249);">'r0062'</span><span >};</span></span></div></div></div><div  class = 'S8'><span>The </span><span style=' font-family: monospace;'>verbFlag</span><span> input determines the verbose output (default - false). </span><span style=' font-family: monospace;'>allowLoops </span><span>input determines whether loops are allowed in the solution (default - true). Note that </span><span style=' font-family: monospace;'>allowLoops==false</span><span> invokes a mixed integer linear programming implementation of thermodynamically constrained flux variability analysis for each minimization or maximisation of a reaction rate. The </span><span style=' font-family: monospace;'>method</span><span> parameter input determines whether are the output flux vectors also minimise the </span><span style=' font-family: monospace;'>0-norm</span><span>, </span><span style=' font-family: monospace;'>1-norm</span><span> or </span><span style=' font-family: monospace;'>2-norm</span><span> whilst maximising or minimising the flux through one reaction (default - 2-norm). </span></div><div  class = 'S1'><span>Run </span><span style=' font-family: monospace;'>fluxVariability()</span><span> on both models (</span><span style=' font-family: monospace;'>modelfva1</span><span>, </span><span style=' font-family: monospace;'>modelfva2</span><span>) to generate the minimum and maximum flux values of selected reactions (</span><span style=' font-style: italic;'>rxnsList</span><span>) in the model.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% Run FVA analysis for the model with the constraints that simulates aerobic conditions:</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S12'><span style="white-space: normal"><span >[minFlux1, maxFlux1, Vmin1, Vmax1] = fluxVariability(modelfva1, 100, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >, rxnsList)</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="76F592F3" data-testid="output_4" data-width="428" data-height="18" data-hashorizontaloverflow="false" style="width: 458px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">OPTIMAL</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsErrorElement scrollableOutput" uid="329B1E78" data-testid="output_5" data-width="428" data-height="170" data-hashorizontaloverflow="true" style="width: 458px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="diagnosticMessage-wrapper diagnosticMessage-errorType" style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;"><div class="diagnosticMessage-messagePart" style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">Error using solveCobraQP (line 1049)<br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">[gurobi] Primal optimality condition in solveCobraQP not satisfied, residual = 0.00038861, while feasTol = 1e-06</div><div class="diagnosticMessage-stackPart" style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;"><br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">Error in fluxVariability&gt;getMinNorm (line 707)<br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">        solution = solveCobraQP(LPproblem, solverVarargin.QP{:});<br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;"><br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">Error in fluxVariability&gt;calcSolForEntry (line 685)<br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">        V = getMinNorm(LPproblem, LPsolution, numel(model.rxns), Flux, model, method, solverVarargin);<br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;"><br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">Error in fluxVariability (line 557)<br style="white-space: normal; font-style: normal; color: rgb(230, 0, 0); font-size: 12px;">        [maxFlux(i), V] = calcSolForEntry(model, rxnID ,LPproblem, method, allowLoopsI, minNorm, solverVarargin, heuristicSolutions{preCompMaxSols(i)}, -1);</div></div></div></div></div></div><div  class = 'S8'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% Run FVA analysis for the model with the constraints that </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span style="color: rgb(2, 128, 9);">% simulates anaerobic conditions:</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >[minFlux2, maxFlux2, Vmin2, Vmax2] = fluxVariability(modelfva2, [], [], rxnsList) </span></span></div></div></div><div  class = 'S8'><span>The additional </span><span style=' font-family: monospace;'>n  k</span><span> output matrices </span><span style=' font-family: monospace;'>Vmin</span><span> and </span><span style=' font-family: monospace;'>Vmax</span><span> return the flux vector for each of the </span><span style=' font-family: monospace;'>k  n</span><span> fluxes selected for flux variability.</span></div><div  class = 'S1'><span>You can further plot and compare the FVA results for the selected reaction from both models:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span >ymax1 = maxFlux1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >ymin1 = minFlux1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >ymax2 = maxFlux2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >ymin2 = minFlux2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >maxf = table(ymax1, ymax2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >minf = table(ymin1, ymin2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >maxfxs = table2cell(maxf);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >minfxs = table2cell(minf);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >plot1 = bar(cell2mat(maxfxs(1:end, :)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >hold </span><span style="color: rgb(170, 4, 249);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >plot2 = bar(cell2mat(minfxs(1:end, :)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >hold </span><span style="color: rgb(170, 4, 249);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >xticklabels({</span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >, </span><span style="color: rgb(170, 4, 249);">'ACOAHi'</span><span >, </span><span style="color: rgb(170, 4, 249);">'ALCD21__D'</span><span >, </span><span style="color: rgb(170, 4, 249);">'LALDO'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >             </span><span style="color: rgb(170, 4, 249);">'ME2m'</span><span >, </span><span style="color: rgb(170, 4, 249);">'AKGDm'</span><span >, </span><span style="color: rgb(170, 4, 249);">'PGI'</span><span >, </span><span style="color: rgb(170, 4, 249);">'PGM'</span><span >, </span><span style="color: rgb(170, 4, 249);">'r0062'</span><span >})</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >set(gca, </span><span style="color: rgb(170, 4, 249);">'XTickLabelRotation'</span><span >, -80);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >yticks([-1000 -800 -600 -400 -200 0 200 400 600 800 1000])</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >xlabel(</span><span style="color: rgb(170, 4, 249);">'Reactions from the models'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >ylabel(</span><span style="color: rgb(170, 4, 249);">'Fluxes'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >legend({</span><span style="color: rgb(170, 4, 249);">'Aerobic'</span><span >, </span><span style="color: rgb(170, 4, 249);">'Anaerobic'</span><span >}, </span><span style="color: rgb(170, 4, 249);">'Location'</span><span >, </span><span style="color: rgb(170, 4, 249);">'southwest'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >title(</span><span style="color: rgb(170, 4, 249);">'Variations in fluxes in the aerobic and anaerobic conditions'</span><span >)</span></span></div></div></div><h2  class = 'S5'><span>2) Fast FVA</span></h2><div  class = 'S1'><span>When the number of reaction on which you want to perform a flux variability is higher to 1000, we recommend using </span><span style=' font-family: monospace;'>fastFVA()</span><span> function instead of </span><span style=' font-family: monospace;'>fluxVariability(). </span><span>Note that for large models the memory requirements may become prohibitive.</span></div><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>fastFVA()</span><span> function only supports the </span><a href = "https://opencobra.github.io/cobratoolbox/docs/solvers.html "><span>CPLEX</span></a><span> solver.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S15'><span style="white-space: normal"><span >changeCobraSolver (</span><span style="color: rgb(170, 4, 249);">'ibm_cplex'</span><span >, </span><span style="color: rgb(170, 4, 249);">'all'</span><span >, 1);</span></span></div></div></div><div  class = 'S1'><span>Run fastFVA analysis for the whole model (i.e. flux varaibility analysis performed on all reactions included in the model) with the constraints that simulates aerobic conditions:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S15'><span style="white-space: normal"><span >[minFluxF1, maxFluxF1, optsol, ret, fbasol, fvamin, fvamax, statussolmin, statussolmax] = fastFVA(modelfva1);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S15'></div></div></div><div  class = 'S1'><span>Run fast FVA analysis for the whole model with the constraints that simulates anaerobic conditions:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span >[minFluxF2, maxFluxF2, optsol2, ret2, fbasol2, fvamin2, fvamax2,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >    statussolmin2, statussolmax2] = fastFVA(modelfva2);</span></span></div></div></div><div  class = 'S1'><span>Plot the results of the fast FVA and compare them between the aerobic and anaerobic models:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: normal"><span >ymaxf1 = maxFluxF1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >yminf1 = minFluxF1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >ymaxf2 = maxFluxF2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >yminf2 = minFluxF2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >maxf =table(ymaxf1, ymaxf2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >minf =table(yminf1, yminf2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >maxf = table2cell(maxf);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >minf = table2cell(minf);</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >plot3 = bar(cell2mat(maxf(1:end, :)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >hold </span><span style="color: rgb(170, 4, 249);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >plot4 = bar(cell2mat(minf(1:end, :)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >hold </span><span style="color: rgb(170, 4, 249);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >xticks([0 2000 4000 6000 8000 10600])</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >yticks([-1000 -800 -600 -400 -200 0 200 400 600 800 1000])</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >xlabel(</span><span style="color: rgb(170, 4, 249);">'All reactions in the model'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >ylabel(</span><span style="color: rgb(170, 4, 249);">'Fluxes'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: normal"><span >legend({</span><span style="color: rgb(170, 4, 249);">'Aerobic'</span><span >, </span><span style="color: rgb(170, 4, 249);">'Anaerobic'</span><span >})</span></span></div></div><div class="inlineWrapper"><div  class = 'S14'><span style="white-space: normal"><span >title(</span><span style="color: rgb(170, 4, 249);">'Variations in fluxes in the aerobic and anaerobic conditions'</span><span >)</span></span></div></div></div><h2  class = 'S5'><span>REFERENCES </span></h2><div  class = 'S1'><span>[1] Gudmundsson, S., Thiele, I. Computationally efficient flux variability analysis. </span><span style=' font-style: italic;'>BMC Bioinformatics. </span><span>11, 489 (2010).</span></div><div  class = 'S1'><span>[2] Heirendt, L., Thiele, I., Fleming, R.M. DistributedFBA.jl: high-level, high-performance flux balance analysis in Julia. </span><span style=' font-style: italic;'>Bioinformatics.</span><span> 33 (9), 1421-1423 (2017).</span></div><div  class = 'S1'><span>[3] Thiele, I., et al. </span><span>A community-driven global reconstruction of human metabolism. </span><span style=' font-style: italic;'>Nat. Biotechnol., </span><span>31(5), 419425 (2013).</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% *Flux Variability analysis (FVA)*
% *Authors :  Vanja Vlasov, Systems Biochemistry Group, LCSB, University of 
% Luxembourg.*
% 
% *Reviewers : Anne Richelle, Lewis Lab at University of California, San Diego.*
% 
% Flux variability analysis (FVA) is a widely used computational tool for evaluating 
% the minimum and maximum range of each reaction flux that can still satisfy the 
% constraints using a double LP problem (i.e. a maximization and a subsequent 
% minimization) for each reaction of interest [1]. 
% 
% 
% 
% $$\begin{array}{lll}\\{v}_{j,upper}/\ {v}_{j,lower}=max\limits _{v}/\min\limits 
% _{v} & v_{j} \\\text{s.t.} & Sv=0,\\ & l\leq v\leq u\\\end{array}$$
% 
% where $v \in R^{n}$ is the vector of specific reaction rates (metabolic fluxes) 
% and  ${v}_{j,upper}$  and  ${v}_{j,lower}$ are respectively the upper and lower 
% values of each flux ${v}_{j}$ satisfying the system of linear equations.
% 
% Depending on the size of the model you are using for the analysis, use:
%% 
% * |fluxVariability()| function - for the low dimensional FVA;
% * |fastFVA()| function - for the models with more than 1,000 reactions;
% * <https://github.com/opencobra/COBRA.jl distributedFBA.jl> - for high dimensional 
% FVA, models larger than 10,000 reactions $$^2$.
%% EQUIPMENT SETUP
% If necessary, initialize the cobra toolbox

initCobraToolbox(false) % false, as we don't want to update
%% 
% For solving linear programming problems in FBA and FVA analysis, certain solvers 
% are required. The present tutorial can run with glpk package, which does not 
% require additional installation and configuration. Although, for the analysis 
% of large models is recommended to use the GUROBI package.

changeCobraSolver ('ibm_cplex', 'LP');
changeCobraSolver ('ibm_cplex', 'QP');
%% PROCEDURE
% In this tutorial, we will use the generic model of the human cellular metabolism, 
% Recon2.0 $$^3$. Load the model

global CBTDIR
modelFileName = 'Recon2.0model.mat';
modelDirectory = getDistributedModelFolder(modelFileName); %Look up the folder for the distributed Models.
modelFileName= [modelDirectory filesep modelFileName]; % Get the full path. Necessary to be sure, that the right model is loaded
model = readCbModel(modelFileName);

%% 
% The metabolites structures and reactions in Recon2.0 can be found in the Virtual 
% Metabolic Human database (VMH, <http://vmh.life http://vmh.life>).
%% 
% Constrain the model to limit the availability of carbon and oxygen energy 
% sources. Find the uptake exchange reactions using _findExcRxns_

[selExc, selUpt] = findExcRxns(model);
uptakes = model.rxns(selUpt);
%% 
% Select from the set of reactions defined in _uptakes_ those which contain 
% a least one carbon in the metabolites involved in the reaction and set the flux 
% values of these reactions to zero:

subuptakeModel = extractSubNetwork(model, uptakes);
hiCarbonRxns = findCarbonRxns(subuptakeModel,1);
modelalter = changeRxnBounds(model, hiCarbonRxns, 0, 'b');
%% 
% Also close the other reaction related to the exchange of oxygen and energy 
% sources:

energySources = {'EX_adp'; 'EX_amp(e)'; 'EX_atp(e)'; 'EX_co2(e)';...
    'EX_coa(e)'; 'EX_fad(e)'; 'EX_fe2(e)'; 'EX_fe3(e)'; 'EX_gdp(e)';...
    'EX_gmp(e)'; 'EX_gtp(e)'; 'EX_h(e)'; 'EX_h2o(e)'; 'EX_h2o2(e)';...
    'EX_nad(e)'; 'EX_nadp(e)'; 'EX_no(e)'; 'EX_no2(e)'; 'EX_o2s(e)'};
modelalter = changeRxnBounds (modelalter, energySources, 0, 'l');
%% 
% For this tutorial, we will analyse the variability of several reactions of 
% the human cellular metabolism in aerobic and anaerobic condition. For each simulation, 
% the original model will be copied to a new model structure (e.g., _modelfva1_ 
% for aerobic condition and _modelfva2_ for anaerobic condition). This preserves 
% the constraints of the original model and allows to perform simulations with 
% new constraints. Additionally, this method of renaming the model avoids confusion 
% while performing multiple simulations at the same time.

% modelfva1 represents aerobic condition
modelfva1 = modelalter;
modelfva1 = changeRxnBounds(modelfva1, 'EX_glc(e)', -20, 'l');
modelfva1 = changeRxnBounds(modelfva1, 'EX_o2(e)', -1000, 'l');
% modelfva2 represents anaerobic condition
modelfva2 = modelalter;
modelfva2 = changeRxnBounds(modelfva2, 'EX_glc(e)', -20, 'l');
modelfva2 = changeRxnBounds(modelfva2, 'EX_o2(e)',  0, 'l');
%% 1) Standard FVA
% The full spectrum of flux variability analysis options can be accessed using 
% the command:

% [minFlux, maxFlux, Vmin, Vmax] = fluxVariability(model,...
% optPercentage,osenseStr, rxnNameList, verbFlag, allowLoops, method);
%% 
% The |optPercentage| parameter allows one to choose whether to consider solutions 
% that give at least a certain percentage of the optimal solution (default - 100). 
% Setting the parameters  |osenseStr = 'min'| or |osenseStr = 'max'| determines 
% whether the flux balance analysis problem is first solved with minimization 
% or maximisation (default - 'max'). The |rxnNameList| accepts a cell array list 
% of reactions to selectively perform flux variability upon (default - all reactions 
% of the model). This is useful for high-dimensional models as computation of 
% flux variability for all reactions can be time consuming:

% Selecting several reactions of the model that we want to analyse with FVA
rxnsList = {'DM_atp_c_'; 'ACOAHi'; 'ALCD21_D'; 'LALDO'; 'ME2m';...
    'AKGDm'; 'PGI'; 'PGM'; 'r0062'};
%% 
% The |verbFlag| input determines the verbose output (default - false). |allowLoops| 
% input determines whether loops are allowed in the solution (default - true). 
% Note that |allowLoops==false| invokes a mixed integer linear programming implementation 
% of thermodynamically constrained flux variability analysis for each minimization 
% or maximisation of a reaction rate. The |method| parameter input determines 
% whether are the output flux vectors also minimise the |0-norm|, |1-norm| or 
% |2-norm| whilst maximising or minimising the flux through one reaction (default 
% - 2-norm). 
%% 
% Run |fluxVariability()| on both models (|modelfva1|, |modelfva2|) to generate 
% the minimum and maximum flux values of selected reactions (_rxnsList_) in the 
% model.

% Run FVA analysis for the model with the constraints that simulates aerobic conditions:
[minFlux1, maxFlux1, Vmin1, Vmax1] = fluxVariability(modelfva1, 100, 'max', rxnsList)
%% 
% 

% Run FVA analysis for the model with the constraints that 
% simulates anaerobic conditions:
[minFlux2, maxFlux2, Vmin2, Vmax2] = fluxVariability(modelfva2, [], [], rxnsList) 
%% 
% The additional |n  k| output matrices |Vmin| and |Vmax| return the flux vector 
% for each of the |k  n| fluxes selected for flux variability.
%% 
% You can further plot and compare the FVA results for the selected reaction 
% from both models:

ymax1 = maxFlux1;
ymin1 = minFlux1;
ymax2 = maxFlux2;
ymin2 = minFlux2;

maxf = table(ymax1, ymax2)
minf = table(ymin1, ymin2)
maxfxs = table2cell(maxf);
minfxs = table2cell(minf);

figure
plot1 = bar(cell2mat(maxfxs(1:end, :)));
hold on
plot2 = bar(cell2mat(minfxs(1:end, :)));
hold off
xticklabels({'DM_atp_c_', 'ACOAHi', 'ALCD21__D', 'LALDO',...
             'ME2m', 'AKGDm', 'PGI', 'PGM', 'r0062'})
set(gca, 'XTickLabelRotation', -80);
yticks([-1000 -800 -600 -400 -200 0 200 400 600 800 1000])
xlabel('Reactions from the models')
ylabel('Fluxes')
legend({'Aerobic', 'Anaerobic'}, 'Location', 'southwest')
title('Variations in fluxes in the aerobic and anaerobic conditions')
%% 2) Fast FVA
% When the number of reaction on which you want to perform a flux variability 
% is higher to 1000, we recommend using |fastFVA()| function instead of |fluxVariability().| 
% Note that for large models the memory requirements may become prohibitive.
% 
% The |fastFVA()| function only supports the <https://opencobra.github.io/cobratoolbox/docs/solvers.html  
% CPLEX> solver.

changeCobraSolver ('ibm_cplex', 'all', 1);
%% 
% Run fastFVA analysis for the whole model (i.e. flux varaibility analysis performed 
% on all reactions included in the model) with the constraints that simulates 
% aerobic conditions:

[minFluxF1, maxFluxF1, optsol, ret, fbasol, fvamin, fvamax, statussolmin, statussolmax] = fastFVA(modelfva1);
%%

%% 
% Run fast FVA analysis for the whole model with the constraints that simulates 
% anaerobic conditions:

[minFluxF2, maxFluxF2, optsol2, ret2, fbasol2, fvamin2, fvamax2,...
    statussolmin2, statussolmax2] = fastFVA(modelfva2);
%% 
% Plot the results of the fast FVA and compare them between the aerobic and 
% anaerobic models:

ymaxf1 = maxFluxF1;
yminf1 = minFluxF1;
ymaxf2 = maxFluxF2;
yminf2 = minFluxF2;

maxf =table(ymaxf1, ymaxf2);
minf =table(yminf1, yminf2);

maxf = table2cell(maxf);
minf = table2cell(minf);

figure
plot3 = bar(cell2mat(maxf(1:end, :)));
hold on
plot4 = bar(cell2mat(minf(1:end, :)));
hold off
xticks([0 2000 4000 6000 8000 10600])
yticks([-1000 -800 -600 -400 -200 0 200 400 600 800 1000])
xlabel('All reactions in the model')
ylabel('Fluxes')
legend({'Aerobic', 'Anaerobic'})
title('Variations in fluxes in the aerobic and anaerobic conditions')
%% REFERENCES 
% [1] Gudmundsson, S., Thiele, I. Computationally efficient flux variability 
% analysis. _BMC Bioinformatics._ 11, 489 (2010).
% 
% [2] Heirendt, L., Thiele, I., Fleming, R.M. DistributedFBA.jl: high-level, 
% high-performance flux balance analysis in Julia. _Bioinformatics._ 33 (9), 1421-1423 
% (2017).
% 
% [3] Thiele, I., et al. A community-driven global reconstruction of human metabolism. 
% _Nat. Biotechnol.,_ 31(5), 419425 (2013).
##### SOURCE END #####
-->
</div></body></html>