<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Test physiologically relevant ATP yields from different carbon sources for a metabolic model </title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S2 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 250px;    overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement{    min-height: 18px;    max-height: 250px;    overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2019 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: rgb(255,100,0);    text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: rgb(230,0,0);    text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 250px;    overflow: auto;}
.textElement,.rtcDataTipElement .textElement {    padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S7 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Test physiologically relevant ATP yields from different carbon sources for a metabolic model </span></h1><div  class = 'S1'><span style=' font-weight: bold;'>Author(s): Ines Thiele, Ronan M. T. Fleming, LCSB, University of Luxembourg.</span></div><div  class = 'S1'><span style=' font-weight: bold;'>Reviewer(s): </span></div><h2  class = 'S2'><span>INTRODUCTION</span></h2><div  class = 'S1'><span>In this tutorial, we show how to compute the ATP yield from different carbon sources under aerobic or anaerobic conditions. The theoretical values for the corresponding ATP yields are also provided. The tutorial can be adapted for Recon 3 derived condition- and cell-type specific models to test whether these models are still able to produce physiologically relevant ATP yields.</span></div><h2  class = 'S2'><span>EQUIPMENT SETUP</span></h2><div  class = 'S1'><span>If necessary, initialize the cobra toolbox with</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >initCobraToolbox(false) </span><span style="color: rgb(2, 128, 9);">% false, as we don't want to update</span></span></div></div></div><div  class = 'S4'><span>For solving line</span><span>ar programming problems in FBA analysis, certain solvers are required:</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S5'><span style="white-space: pre"><span >changeCobraSolver (</span><span style="color: rgb(170, 4, 249);">'glpk'</span><span >, </span><span style="color: rgb(170, 4, 249);">'all'</span><span >, 1);</span></span></div><div  class = 'S6'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="2B0802C1" data-testid="output_0" data-width="420" data-height="73" data-hashorizontaloverflow="true" style="width: 450px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"> &gt; Solver for LP problems has been set to glpk.
 &gt; Solver for MILP problems has been set to glpk.
 &gt; Solver glpk not supported for problems of type MIQP. Currently used: gurobi 
 &gt; Solver glpk not supported for problems of type NLP. Currently used: matlab 
 &gt; Solver glpk not supported for problems of type QP. Currently used: gurobi </div></div></div></div></div><div  class = 'S4'><span>This tutoria</span><span>l can be ru</span><span>n </span><span>with GLPK package as linear programming solver, which does not require additional installation and configuration. However, for the analysis of large models, such as Recon 3, it is not recommended to use GLPK, but rather industrial-strength solvers, such as the GUROBI package. </span></div><h2  class = 'S7'><span>PROCEDURE</span></h2><div  class = 'S1'><span>Before proceeding with the simulations, the path for the model needs to be set up:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelFileName = </span><span style="color: rgb(170, 4, 249);">'Recon2.0model.mat'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelDirectory = getDistributedModelFolder(modelFileName); </span><span style="color: rgb(2, 128, 9);">%Look up the folder for the distributed Models.</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelFileName= [modelDirectory filesep modelFileName]; </span><span style="color: rgb(2, 128, 9);">% Get the full path. Necessary to be sure, that the right model is loaded</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >model = readCbModel(modelFileName);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >tol = 1e-6;</span></span></div></div></div><div  class = 'S4'><span>In this tutorial, the used model i</span><span>s th</span><span>e</span><span> gen</span><span>er</span><span>ic model of human metabolism, Recon 3</span><span texencoding="$^1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAAAhUlEQVRIS+3VMQrCQBRF0ZNK3IrWgthkCW4gpJKsws3YW9q7gTRZTUgTQkAbyRB0Omd+/+7A5f0/hcgpIvMSAJxxxSHkKuTghBoNBmy/BcyBHi32vwDeDz5xzIDsILYHHXbYYFyqc2gXSlxQvUI3PHD/hCRwUFZvbnYghY8l92DVwF/0YALu1BMnstNhqgAAAABJRU5ErkJggg==" width="8" height="19" /></span><span> or  Recon2.0 model.</span></div><div  class = 'S1'><span>The metabolites structures and reactions are from the Virtual Metabolic Human database (VMH, </span><a href = "http://vmh.life/"><span>http://vmh.life</span></a><span>).</span></div><h2  class = 'S2'><span>Harmonization of abbreviation usag</span><span>e</span></h2><div  class = 'S1'><span>First, we will harmonize different</span><span> bra</span><span>c</span><span>ket </span><span>ty</span><span>pes used in different model versions, e.g., different version of the human metabolic reconstruction. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >model.rxns = regexprep(model.rxns, </span><span style="color: rgb(170, 4, 249);">'\('</span><span >, </span><span style="color: rgb(170, 4, 249);">'\['</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >model.rxns = regexprep(model.rxns, </span><span style="color: rgb(170, 4, 249);">'\)'</span><span >, </span><span style="color: rgb(170, 4, 249);">'\]'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >model.mets = regexprep(model.mets, </span><span style="color: rgb(170, 4, 249);">'\('</span><span >, </span><span style="color: rgb(170, 4, 249);">'\['</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >model.mets = regexprep(model.mets, </span><span style="color: rgb(170, 4, 249);">'\)'</span><span >, </span><span style="color: rgb(170, 4, 249);">'\]'</span><span >);</span></span></div></div></div><div  class = 'S4'><span>Recon 3 uses ATPSm4mi instead of </span><a href = "https://vmh.life/#human/all/ATPS4m"><span>ATPS4m</span></a><span> as an abbreviation for the ATP synthetase:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >model.rxns = regexprep(model.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4mi'</span><span >, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >);</span></span></div></div></div><div  class = 'S4'><span>Similarly, the glucose exchange reaction has been updated:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(strmatch(</span><span style="color: rgb(170, 4, 249);">'EX_glc[e]'</span><span >, model.rxns))&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    model.rxns{find(ismember(model.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_glc[e]'</span><span >))} = </span><span style="color: rgb(170, 4, 249);">'EX_glc_D[e]'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S4'><span>Add ATP hydrolysis reaction to the model. If the reaction exist already, nothing will be added by the </span><span style=' font-family: monospace;'>rxnIDexists</span><span> variable will contain the index of the reaction that is present in the model. In this case, we will rename the reaction abbreviation to ensure that the tutorial works correctly.</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S5'><span style="white-space: pre"><span >[model, rxnIDexists] = addReaction(model, </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >, </span><span style="color: rgb(170, 4, 249);">'h2o[c] + atp[c]  -&gt; adp[c] + h[c] + pi[c] '</span><span >);</span></span></div><div  class = 'S6'><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="1A70B869" data-testid="output_1" data-width="420" data-height="30" data-hashorizontaloverflow="false" style="width: 450px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType" style="white-space: normal; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;"><div class="diagnosticMessage-messagePart" style="white-space: pre-wrap; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;">Warning: Reaction with the same name already exists in the model, updating the reaction</div><div class="diagnosticMessage-stackPart" style="white-space: pre; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;"></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="612C706D" data-testid="output_2" data-width="420" data-height="18" data-hashorizontaloverflow="true" style="width: 450px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">DM_atp_c_	h2o[c] + atp[c] 	-&gt;	adp[c] + h[c] + pi[c] </div></div></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(rxnIDexists) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    model.rxns{rxnIDexists} = </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >;  </span><span style="color: rgb(2, 128, 9);">% rename reaction in case that it exists already</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S7'><span>Close model</span></h2><div  class = 'S1'><span>Now, we will set the lower bound ('</span><span style=' font-family: monospace;'>model.lb</span><span>') of all exchange and sink (</span><span style=' font-family: monospace;'>siphon</span><span>) reactions to ensure that only those metabolites that are supposed to be taken up are indded supplied to the model.</span></div><div  class = 'S1'><span>First, we will find all reactions based on their abbreviation ('</span><span style=' font-family: monospace;'>model.rxns</span><span>')</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = model;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelexchanges1 = strmatch(</span><span style="color: rgb(170, 4, 249);">'Ex_'</span><span >, modelClosed.rxns);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelexchanges4 = strmatch(</span><span style="color: rgb(170, 4, 249);">'EX_'</span><span >, modelClosed.rxns);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelexchanges2 = strmatch(</span><span style="color: rgb(170, 4, 249);">'DM_'</span><span >, modelClosed.rxns);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >modelexchanges3 = strmatch(</span><span style="color: rgb(170, 4, 249);">'sink_'</span><span >, modelClosed.rxns);</span></span></div></div></div><div  class = 'S4'><span>Grab also the biomass reaction(s) based on the reaction abbreviation.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >BM= (find(~cellfun(@isempty,strfind(lower(modelClosed.mets), </span><span style="color: rgb(170, 4, 249);">'bioma'</span><span >))));</span></span></div></div></div><div  class = 'S4'><span>As these measures may not identify all exchange and sink reactions in a model, depending on the used nomencalture, we will also grab all reactions based on stoichiomettry. Here, we will identify all reactions that contain only one non-zero entry in the </span><span style=' font-family: monospace;'>S</span><span> matrix (column).</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >selExc = (find(full((sum(abs(modelClosed.S)==1, 1)==1) &amp; (sum(modelClosed.S~=0) == 1))))';</span></span></div></div></div><div  class = 'S4'><span>We will now put all these identified reactions together into one variable '</span><span style=' font-family: monospace;'>modelexchanges</span><span>' and set the lower bound for these reactions to 0.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelexchanges = unique([modelexchanges1; modelexchanges2; modelexchanges3; modelexchanges4; selExc; BM]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, modelClosed.rxns(modelexchanges))))=0;</span></span></div></div></div><div  class = 'S4'><span>Also, set all upper bounds t 1000 (representing infinity). This may be important if other constraints had been applied to the model, which may interfere with the newly set lower bound of lb=0 for all exchange reactions. Note that this may affect any constraints that had been applied, e.g.</span><span>,</span><span> condition-specific </span><span>constraints</span><span> based on measured uptake or secretion rates.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >modelClosed.ub(selExc) = 1000; </span></span></div></div></div><div  class = 'S4'><span>Define the ATP hydrolysis reactioDefinen </span><a href = "https://vmh.life/#human/all/DM_atp_c"><span>DM_atp_c</span></a><span> to  be the objective reaction, for which we will maximize for in the following sections.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >modelClosed = changeObjective(modelClosed, </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >);</span></span></div></div></div><div  class = 'S4'><span>Store the original closed model setup for consequent use in the variable </span><span style=' font-family: monospace;'>modelClosedOri</span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >modelClosedOri = modelClosed;</span></span></div></div></div><h2  class = 'S2'><span>Test for ATP yield from different carbon sources</span></h2><div  class = 'S1'><span>Now, we re ready to thest for the different individual carbon sources under aerobic and anaerobic conditions for their ATP yield. Therefore, we will provide 1 mol/gdw/hr of a carbon source and maximize the flux through the </span><a href = "https://vmh.life/#human/all/DM_atp_c"><span>DM_atp_c_</span></a><span>.</span></div><div  class = 'S1'><span>The results will be stored in the table  'Table_csources'. The table will also contain the theoretical ATP yield, as given by</span><span texencoding="$^2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAmCAYAAADN0BvRAAABF0lEQVRIS+3UsSuFURjH8c/NoJRkUsTIRMmoDAYZZDDJatLNJpudxSSUQWySDMqkJDb/gNVsMSilRKcO3d7e8557u9vtnu2cnud7nuf3/M6paXPV2szXwYAF7GAKb7iJ+4+iZmUarGAfV+jFMkZxj/kcoCcGhqT3GNyPZ0xgDo+NkGIFsxjGZeGmOg6wgeMqwABCn98FwFLUYRUXVYCUr9ZxhJEo6n9cs0YKLb1iKydiWQXjOI8CfrUKCFO5xjZeyui5FvbwgNuUOFWAzTiR06oXmwKsYQy7heRJDOHu77wMsIgTnOGnATAYrTyDzxRgGk/oS5R9iODKln2QlCE3heyP1wXo5G89O/+qt9B0cgjsGqmrQfDBL0GOJif7qwNnAAAAAElFTkSuQmCC" width="8" height="19" /></span><span>. The table also provides the information of how much flux is going throught he ATP syntheatse. Note that the computed flux distribution is not garantied to be unique, although we use the option 'zero', which approximates the sparsest possible flux distribution with an maximal ATP yield.</span></div><h2  class = 'S2'><span>Carbon source: Glucose (VMH ID: </span><a href = "http://vmh.life/#metabolite/glc_D"><span>glc_D</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_glc_D[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_glc_D[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% build table</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{2, 1} = strcat(modelName, </span><span style="color: rgb(170, 4, 249);">': ATP yield'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{3, 1} = strcat(modelName, </span><span style="color: rgb(170, 4, 249);">': ATPS4m yield'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, 1} = </span><span style="color: rgb(170, 4, 249);">'Theoretical'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >k = 2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'glc - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'31'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'></div></div></div><div  class = 'S4'><span>For this carbon source (glucose), we will also print all reactions that are non-zero in the sparse flux distribution and thus contribute to the maximale ATP yield.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ReactionsInSparseSolution = modelClosed.rxns(find(FBA.x));</span></span></div></div></div><div  class = 'S4'><span>We now initiate the next test and delete the variable 'FBA'.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S2'><span>Carbon source: Glucose (VMH ID: </span><a href = "http://vmh.life/#metabolite/glc_D"><span>glc_D</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_glc_D[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'EX_glc_D[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed,</span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'glc - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x)&gt;=0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'2'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Glu</span><span>tamine (VMH ID: </span><a href = "http://vmh.life/#metabolite/gln_L"><span>gln_L</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_gln_L[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_gln_L[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'gln_L - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'NA'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Glu</span><span>tamine (VMH ID: </span><a href = "http://vmh.life/#metabolite/gln_L"><span>gln_L</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_gln_L[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_gln_L[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'gln_L - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'NA'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'></div></div></div><h2  class = 'S7'><span>Carbon source: Fructose (VMH ID: </span><a href = "http://vmh.life/#metabolite/fru"><span>fru</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_fru[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_fru[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'fru - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x)&gt;=0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3 ,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'31'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Fru</span><span>ctose (VMH ID: </span><a href = "http://vmh.life/#metabolite/fru"><span>fru</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = changeObjective(modelClosed, </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_fru[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_fru[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'fru - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x)&gt;=0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'2'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: But</span><span>yrate (VMH ID: </span><a href = "http://vmh.life/#metabolite/but"><span>but</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_but[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_but[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in results</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'but - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt;= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'21.5'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: But</span><span>yrate (VMH ID: </span><a href = "http://vmh.life/#metabolite/but"><span>but</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_but[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_but[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'but - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Cap</span><span>roic acid (VMH ID: </span><a href = "http://vmh.life/#metabolite/caproic"><span>caproic</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_caproic[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_caproic[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'caproic - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'35.25'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Cap</span><span>roic acid (VMH ID: </span><a href = "http://vmh.life/#metabolite/caproic"><span>caproic</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_caproic[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_caproic[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'caproic - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Oct</span><span>anoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/octa"><span>octa</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_octa[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_octa[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'octa - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'49'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'></div></div></div><h2  class = 'S7'><span>Carbon source: Octanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/octa"><span>octa</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, modelClosed.rxns(modelexchanges)))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.c = zeros(length(modelClosed.rxns), 1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed = changeObjective(modelClosed, </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_octa[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_octa[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'octa - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Dec</span><span>anoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/dca"><span>dca</span></a><span>), Oxy</span><span>gen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, modelClosed.rxns(modelexchanges))))=0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.c = zeros(length(modelClosed.rxns),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed = changeObjective(modelClosed, </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_dca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_dca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'dca - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'62.75'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Dec</span><span>anoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/dca"><span>dca</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_dca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_dca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'dca - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'></div></div></div><h2  class = 'S7'><span>Carbon source: Laureate (VMH ID: </span><a href = "http://vmh.life/#metabolite/ddca"><span>ddca</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.c = zeros(length(modelClosed.rxns), 1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed = changeObjective(modelClosed, </span><span style="color: rgb(170, 4, 249);">'DM_atp_c_'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ddca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ddca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'ddca - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'76.5'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Lau</span><span>reate (VMH ID: </span><a href = "http://vmh.life/#metabolite/ddca"><span>ddca</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ddca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ddca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'ddca - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4,k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Tet</span><span>radecanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/ttdca"><span>ttdca</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ttdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ttdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'ttdca - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'90.25'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Tet</span><span>radecanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/ttdca"><span>ttdca</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ttdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ttdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'ttdca - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x)&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns,</span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Hex</span><span>adecanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/hdca"><span>hdca</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'hdca - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'104'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Hex</span><span>adecanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/hdca"><span>hdca</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'hdca - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Oct</span><span>adecanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/ocdca"><span>ocdca</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ocdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ocdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'ocdca - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'117.75'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Oct</span><span>adecanoate (VMH ID: </span><a href = "http://vmh.life/#metabolite/ocdca"><span>ocdca</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ocdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_ocdca[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'ocdca - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Ara</span><span>chidate (VMH ID: </span><a href = "http://vmh.life/#metabolite/arach"><span>arach</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_arach[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_arach[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'arach - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'131.5'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Ara</span><span>chidate (VMH ID: </span><a href = "http://vmh.life/#metabolite/arach"><span>arach</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_arach[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_arach[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'arach - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Beh</span><span>enic acid (VMH ID: </span><a href = "http://vmh.life/#metabolite/docosac"><span>docosac</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_docosac[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_docosac[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'docosac - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'145.25'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Beh</span><span>enic acid (VMH ID: </span><a href = "http://vmh.life/#metabolite/docosac"><span>docosac</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_docosac[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_docosac[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'docosac - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Lig</span><span>nocerate (VMH ID: </span><a href = "http://vmh.life/#metabolite/lgnc"><span>lgnc</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_lgnc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_lgnc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'lgnc - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3 ,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'159'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Lig</span><span>nocerate (VMH ID: </span><a href = "http://vmh.life/#metabolite/lgnc"><span>lgnc</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_lgnc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_lgnc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'lgnc - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Cer</span><span>otate (VMH ID: </span><a href = "http://vmh.life/#metabolite/hexc"><span>hexc</span></a><span>), Oxygen: Yes</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hexc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hexc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'hexc - aerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'172.75'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div></div><h2  class = 'S7'><span>Carbon source: Cer</span><span>otate (VMH ID: </span><a href = "http://vmh.life/#metabolite/hexc"><span>hexc</span></a><span>), Oxygen: No</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >modelClosed = modelClosedOri;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_o2[e]'</span><span >))) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = -1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_h2o[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_co2[e]'</span><span >))) = 1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.lb(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hexc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelClosed.ub(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'EX_hexc[e]'</span><span >))) = -1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >FBA = optimizeCbModel(modelClosed, </span><span style="color: rgb(170, 4, 249);">'max'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{1, k} = </span><span style="color: rgb(170, 4, 249);">'hexc - anaerobic'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources(2, k) = num2cell(FBA.f);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% fill in only when the LP problem was feasible</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >length(FBA.x) &gt; 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% set all flux values less than tol to 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    FBA.x(find(abs(FBA.x)&lt;=tol)) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    Table_csources(3 ,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, </span><span style="color: rgb(170, 4, 249);">'ATPS4m'</span><span >))));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >Table_csources{4, k} = </span><span style="color: rgb(170, 4, 249);">'0'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >k = k+1; clear </span><span style="color: rgb(170, 4, 249);">FBA</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'></div></div></div><h2  class = 'S7'><span>The table contains all computed ATP yields.</span></h2><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S5'><span style="white-space: pre"><span >Table_csources = Table_csources'</span></span></div><div  class = 'S6'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableStringElement scrollableOutput" uid="9FE82058" data-testid="output_3" data-width="420" data-height="246" data-hashorizontaloverflow="true" style="width: 450px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Table_csources = </span></div><div style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">                       []    '2017_04_28_Recon3d.mat: ATP yield'    '2017_04_28_Recon3d.mat: ATPS4m yield'    'Theoretical'    'gln_L - anaerobic'    'fru - aerobic'    'fru - anaerobic'    'but - aerobic'    'but - anaerobic'    'caproic - aerobic'    'caproic - anaerobic'    'octa - aerobic'    'octa - anaerobic'    'dca - aerobic'    'dca - anaerobic'    'ddca - aerobic'    'ddca - anaerobic'    'ttdca - aerobic'    'ttdca - anaerobic'    'hdca - aerobic'    'hdca - anaerobic'    'ocdca - aerobic'    'ocdca - anaerobic'    'arach - aerobic'    'arach - anaerobic'    'docosac - aerobic'    'docosac - anaerobic'    'lgnc - aerobic'    'lgnc - anaerobic'    'hexc - aerobic'    'hexc - anaerobic'
    'glc - aerobic'          [                          78.2245]    [                                   0]    '31'             [           2.5714]    [      78.2245]    [         5.0000]    [      54.4388]    [              0]    [       1.1983e-09]    [         6.1339e-11]    [      125.0816]    [               0]    [     150.9898]    [              0]    [    1.1983e-09]    [      6.1339e-11]    [       230.2959]    [           1.0000]    [      265.3673]    [          1.5000]    [       300.9388]    [           2.5000]    [       336.0102]    [           3.0000]    [       1.1983e-09]    [         6.1339e-11]    [      405.6531]    [          3.5000]    [      440.7245]    [          4.0000]
    'glc - anaerobic'        [                           5.0000]    [                                   0]    '2'              [                0]    [            0]    [              0]    [            0]                   []    [                0]    [                  0]    [             0]                    []    [            0]                   []    [             0]    [               0]    [              0]    [                0]    [             0]    [               0]    [              0]    [                0]    [              0]    [                0]    [                0]    [                  0]    [             0]    [               0]    [             0]    [               0]
    'gln_L - aerobic'        [                          53.8980]    [                                   0]    'NA'             'NA'                   '31'               '2'                  '21.5'             '0'                  '35.25'                '0'                      '49'                '0'                   '62.75'            '0'                  '76.5'              '0'                   '90.25'              '0'                    '104'               '0'                   '117.75'             '0'                    '131.5'              '0'                    '145.25'               '0'                      '159'               '0'                   '172.75'            '0'               
    'gln_L - anaerobic'      [                           2.5714]    [                                   0]    'NA'                              []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'fru - aerobic'          [                          78.2245]    [                                   0]    '31'                              []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'fru - anaerobic'        [                           5.0000]    [                                   0]    '2'                               []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'but - aerobic'          [                          54.4388]    [                                   0]    '21.5'                            []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'but - anaerobic'        [                                0]                                        []    '0'                               []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'caproic - aerobic'      [                       1.1983e-09]    [                                   0]    '35.25'                           []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'caproic - anaerobic'    [                       6.1339e-11]    [                                   0]    '0'                               []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'octa - aerobic'         [                         125.0816]    [                                   0]    '49'                              []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'octa - anaerobic'       [                                0]                                        []    '0'                               []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []
    'dca - aerobic'          [                         150.9898]    [                                   0]    '62.75'                           []                 []                   []                 []                   []                     []                       []                  []                    []                 []                   []                  []                    []                   []                     []                  []                    []                   []                     []                   []                     []                     []                       []                  []                    []                  []                    []<div class="verticalEllipsis" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"></div></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="0B6A091B" data-testid="output_4" data-width="420" data-height="72" data-hashorizontaloverflow="false" style="width: 450px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType" style="white-space: normal; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;"><div class="diagnosticMessage-messagePart" style="white-space: pre-wrap; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;">Warning: A value of class "com.mathworks.mde.cmdwin.XCmdWndView" was indexed with no subscripts specified. Currently the result of this operation is the indexed value itself, but in a future release, it will be an error.</div><div class="diagnosticMessage-stackPart" style="white-space: pre; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;"></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="4D953D27" data-testid="output_5" data-width="420" data-height="72" data-hashorizontaloverflow="false" style="width: 450px; max-height: 261px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType" style="white-space: normal; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;"><div class="diagnosticMessage-messagePart" style="white-space: pre-wrap; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;">Warning: A value of class "com.mathworks.mde.cmdwin.XCmdWndView" was indexed with no subscripts specified. Currently the result of this operation is the indexed value itself, but in a future release, it will be an error.</div><div class="diagnosticMessage-stackPart" style="white-space: pre; font-style: normal; color: rgb(255, 100, 0); font-size: 12px;"></div></div></div></div></div></div><h2  class = 'S7'><span>TIMING</span></h2><div  class = 'S1'><span>This tutorial takes only a few minutes.</span></div><h2  class = 'S2'><span>REFERENCES</span></h2><div  class = 'S1'><span> [1] Brunk, E. et al.</span><span> Recon 3D: A Three-Dimensional View of Human Metabolism and Disease. Submited</span></div><div  class = 'S1'></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Test physiologically relevant ATP yields from different carbon sources for a metabolic model 
% *Author(s): Ines Thiele, Ronan M. T. Fleming, LCSB, University of Luxembourg.*
% 
% *Reviewer(s):* 
%% INTRODUCTION
% In this tutorial, we show how to compute the ATP yield from different carbon 
% sources under aerobic or anaerobic conditions. The theoretical values for the 
% corresponding ATP yields are also provided. The tutorial can be adapted for 
% Recon 3 derived condition- and cell-type specific models to test whether these 
% models are still able to produce physiologically relevant ATP yields.
%% EQUIPMENT SETUP
% If necessary, initialize the cobra toolbox with

initCobraToolbox(false) % false, as we don't want to update
%% 
% For solving linear programming problems in FBA analysis, certain solvers are 
% required:

changeCobraSolver ('glpk', 'all', 1);
%% 
% This tutorial can be run with GLPK package as linear programming solver, which 
% does not require additional installation and configuration. However, for the 
% analysis of large models, such as Recon 3, it is not recommended to use GLPK, 
% but rather industrial-strength solvers, such as the GUROBI package. 
%% PROCEDURE
% Before proceeding with the simulations, the path for the model needs to be 
% set up:

modelFileName = 'Recon2.0model.mat';
modelDirectory = getDistributedModelFolder(modelFileName); %Look up the folder for the distributed Models.
modelFileName= [modelDirectory filesep modelFileName]; % Get the full path. Necessary to be sure, that the right model is loaded
model = readCbModel(modelFileName);
tol = 1e-6;
%% 
% In this tutorial, the used model is the generic model of human metabolism, 
% Recon 3$$^1$ or  Recon2.0 model.
% 
% The metabolites structures and reactions are from the Virtual Metabolic Human 
% database (VMH, <http://vmh.life/ http://vmh.life>).
%% Harmonization of abbreviation usage
% First, we will harmonize different bracket types used in different model versions, 
% e.g., different version of the human metabolic reconstruction. 

model.rxns = regexprep(model.rxns, '\(', '\[');
model.rxns = regexprep(model.rxns, '\)', '\]');
model.mets = regexprep(model.mets, '\(', '\[');
model.mets = regexprep(model.mets, '\)', '\]');
%% 
% Recon 3 uses ATPSm4mi instead of <https://vmh.life/#human/all/ATPS4m ATPS4m> 
% as an abbreviation for the ATP synthetase:

model.rxns = regexprep(model.rxns, 'ATPS4mi', 'ATPS4m');
%% 
% Similarly, the glucose exchange reaction has been updated:

if length(strmatch('EX_glc[e]', model.rxns))>0
    model.rxns{find(ismember(model.rxns, 'EX_glc[e]'))} = 'EX_glc_D[e]';
end
%% 
% Add ATP hydrolysis reaction to the model. If the reaction exist already, nothing 
% will be added by the |rxnIDexists| variable will contain the index of the reaction 
% that is present in the model. In this case, we will rename the reaction abbreviation 
% to ensure that the tutorial works correctly.

[model, rxnIDexists] = addReaction(model, 'DM_atp_c_', 'h2o[c] + atp[c]  -> adp[c] + h[c] + pi[c] ');
if length(rxnIDexists) > 0
    model.rxns{rxnIDexists} = 'DM_atp_c_';  % rename reaction in case that it exists already
end
%% Close model
% Now, we will set the lower bound ('|model.lb|') of all exchange and sink (|siphon|) 
% reactions to ensure that only those metabolites that are supposed to be taken 
% up are indded supplied to the model.
% 
% First, we will find all reactions based on their abbreviation ('|model.rxns|')

modelClosed = model;
modelexchanges1 = strmatch('Ex_', modelClosed.rxns);
modelexchanges4 = strmatch('EX_', modelClosed.rxns);
modelexchanges2 = strmatch('DM_', modelClosed.rxns);
modelexchanges3 = strmatch('sink_', modelClosed.rxns);
%% 
% Grab also the biomass reaction(s) based on the reaction abbreviation.

BM= (find(~cellfun(@isempty,strfind(lower(modelClosed.mets), 'bioma'))));
%% 
% As these measures may not identify all exchange and sink reactions in a model, 
% depending on the used nomencalture, we will also grab all reactions based on 
% stoichiomettry. Here, we will identify all reactions that contain only one non-zero 
% entry in the |S| matrix (column).

selExc = (find(full((sum(abs(modelClosed.S)==1, 1)==1) & (sum(modelClosed.S~=0) == 1))))';
%% 
% We will now put all these identified reactions together into one variable 
% '|modelexchanges|' and set the lower bound for these reactions to 0.

modelexchanges = unique([modelexchanges1; modelexchanges2; modelexchanges3; modelexchanges4; selExc; BM]);
modelClosed.lb(find(ismember(modelClosed.rxns, modelClosed.rxns(modelexchanges))))=0;
%% 
% Also, set all upper bounds t 1000 (representing infinity). This may be important 
% if other constraints had been applied to the model, which may interfere with 
% the newly set lower bound of lb=0 for all exchange reactions. Note that this 
% may affect any constraints that had been applied, e.g., condition-specific constraints 
% based on measured uptake or secretion rates.

modelClosed.ub(selExc) = 1000; 
%% 
% Define the ATP hydrolysis reactioDefinen <https://vmh.life/#human/all/DM_atp_c 
% DM_atp_c> to  be the objective reaction, for which we will maximize for in the 
% following sections.

modelClosed = changeObjective(modelClosed, 'DM_atp_c_');
%% 
% Store the original closed model setup for consequent use in the variable |modelClosedOri|.

modelClosedOri = modelClosed;
%% Test for ATP yield from different carbon sources
% Now, we re ready to thest for the different individual carbon sources under 
% aerobic and anaerobic conditions for their ATP yield. Therefore, we will provide 
% 1 mol/gdw/hr of a carbon source and maximize the flux through the <https://vmh.life/#human/all/DM_atp_c 
% DM_atp_c_>.
% 
% The results will be stored in the table  'Table_csources'. The table will 
% also contain the theoretical ATP yield, as given by$$^2$. The table also provides 
% the information of how much flux is going throught he ATP syntheatse. Note that 
% the computed flux distribution is not garantied to be unique, although we use 
% the option 'zero', which approximates the sparsest possible flux distribution 
% with an maximal ATP yield.
%% Carbon source: Glucose (VMH ID: <http://vmh.life/#metabolite/glc_D glc_D>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_glc_D[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_glc_D[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
% build table
Table_csources{2, 1} = strcat(modelName, ': ATP yield');
Table_csources{3, 1} = strcat(modelName, ': ATPS4m yield');
Table_csources{4, 1} = 'Theoretical';
% fill in results
k = 2;
Table_csources{1, k} = 'glc - aerobic';

Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '31';

%% 
% For this carbon source (glucose), we will also print all reactions that are 
% non-zero in the sparse flux distribution and thus contribute to the maximale 
% ATP yield.

ReactionsInSparseSolution = modelClosed.rxns(find(FBA.x));
%% 
% We now initiate the next test and delete the variable 'FBA'.

k = k+1; clear FBA
%% Carbon source: Glucose (VMH ID: <http://vmh.life/#metabolite/glc_D glc_D>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns,'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns,'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns,'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns,'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns,'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns,'EX_glc_D[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns,'EX_glc_D[e]'))) = -1;

FBA = optimizeCbModel(modelClosed,'max');
% fill in results
Table_csources{1, k} = 'glc - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x)>=0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns,'ATPS4m'))));
end
Table_csources{4, k} = '2';
k = k+1; clear FBA
%% Carbon source: Glutamine (VMH ID: <http://vmh.life/#metabolite/gln_L gln_L>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_gln_L[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_gln_L[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
% fill in results
Table_csources{1, k} = 'gln_L - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) >= 0
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = 'NA';
k = k+1; clear FBA
%% Carbon source: Glutamine (VMH ID: <http://vmh.life/#metabolite/gln_L gln_L>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_gln_L[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_gln_L[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
% fill in results
Table_csources{1, k} = 'gln_L - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) >= 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = 'NA';
k = k+1; clear FBA

%% Carbon source: Fructose (VMH ID: <http://vmh.life/#metabolite/fru fru>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_fru[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_fru[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
% fill in results
Table_csources{1, k} = 'fru - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x)>=0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3 ,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '31';
k = k+1; clear FBA
%% Carbon source: Fructose (VMH ID: <http://vmh.life/#metabolite/fru fru>), Oxygen: No

modelClosed = changeObjective(modelClosed, 'DM_atp_c_');
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_fru[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_fru[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
% fill in results
Table_csources{1, k} = 'fru - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x)>=0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '2';
k = k+1; clear FBA
%% Carbon source: Butyrate (VMH ID: <http://vmh.life/#metabolite/but but>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_but[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_but[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
% fill in results
Table_csources{1, k} = 'but - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) >= 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '21.5';
k = k+1; clear FBA
%% Carbon source: Butyrate (VMH ID: <http://vmh.life/#metabolite/but but>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_but[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_but[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'but - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Caproic acid (VMH ID: <http://vmh.life/#metabolite/caproic caproic>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_caproic[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_caproic[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'caproic - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '35.25';
k = k+1; clear FBA
%% Carbon source: Caproic acid (VMH ID: <http://vmh.life/#metabolite/caproic caproic>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_caproic[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_caproic[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'caproic - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Octanoate (VMH ID: <http://vmh.life/#metabolite/octa octa>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_octa[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_octa[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'octa - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '49';
k = k+1; clear FBA

%% Carbon source: Octanoate (VMH ID: <http://vmh.life/#metabolite/octa octa>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, modelClosed.rxns(modelexchanges)))) = 0;
modelClosed.c = zeros(length(modelClosed.rxns), 1);
modelClosed = changeObjective(modelClosed, 'DM_atp_c_');
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_octa[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_octa[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'octa - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Decanoate (VMH ID: <http://vmh.life/#metabolite/dca dca>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, modelClosed.rxns(modelexchanges))))=0;
modelClosed.c = zeros(length(modelClosed.rxns),1);
modelClosed = changeObjective(modelClosed, 'DM_atp_c_');
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_dca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_dca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'dca - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '62.75';
k = k+1; clear FBA
%% Carbon source: Decanoate (VMH ID: <http://vmh.life/#metabolite/dca dca>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_dca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_dca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');

Table_csources{1, k} = 'dca - anaerobic';
% fill in only when the LP problem was feasible
Table_csources(2, k) = num2cell(FBA.f);
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA

%% Carbon source: Laureate (VMH ID: <http://vmh.life/#metabolite/ddca ddca>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.c = zeros(length(modelClosed.rxns), 1);
modelClosed = changeObjective(modelClosed, 'DM_atp_c_');
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_ddca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_ddca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'ddca - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '76.5';
k = k+1; clear FBA
%% Carbon source: Laureate (VMH ID: <http://vmh.life/#metabolite/ddca ddca>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_ddca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_ddca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'ddca - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x)>0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns,'ATPS4m'))));
end
Table_csources{4,k} = '0';
k = k+1; clear FBA
%% Carbon source: Tetradecanoate (VMH ID: <http://vmh.life/#metabolite/ttdca ttdca>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_ttdca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_ttdca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'ttdca - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '90.25';
k = k+1; clear FBA
%% Carbon source: Tetradecanoate (VMH ID: <http://vmh.life/#metabolite/ttdca ttdca>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_ttdca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_ttdca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'ttdca - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x)>0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns,'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Hexadecanoate (VMH ID: <http://vmh.life/#metabolite/hdca hdca>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_hdca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_hdca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'hdca - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '104';
k = k+1; clear FBA
%% Carbon source: Hexadecanoate (VMH ID: <http://vmh.life/#metabolite/hdca hdca>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_hdca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_hdca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'hdca - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Octadecanoate (VMH ID: <http://vmh.life/#metabolite/ocdca ocdca>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_ocdca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_ocdca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'ocdca - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '117.75';
k = k+1; clear FBA
%% Carbon source: Octadecanoate (VMH ID: <http://vmh.life/#metabolite/ocdca ocdca>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_ocdca[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_ocdca[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'ocdca - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Arachidate (VMH ID: <http://vmh.life/#metabolite/arach arach>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_arach[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_arach[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'arach - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '131.5';
k = k+1; clear FBA
%% Carbon source: Arachidate (VMH ID: <http://vmh.life/#metabolite/arach arach>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_arach[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_arach[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'arach - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end

Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Behenic acid (VMH ID: <http://vmh.life/#metabolite/docosac docosac>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_docosac[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_docosac[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'docosac - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '145.25';
k = k+1; clear FBA
%% Carbon source: Behenic acid (VMH ID: <http://vmh.life/#metabolite/docosac docosac>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_docosac[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_docosac[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'docosac - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Lignocerate (VMH ID: <http://vmh.life/#metabolite/lgnc lgnc>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_lgnc[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_lgnc[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'lgnc - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3 ,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '159';
k = k+1; clear FBA
%% Carbon source: Lignocerate (VMH ID: <http://vmh.life/#metabolite/lgnc lgnc>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_lgnc[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_lgnc[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'lgnc - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA
%% Carbon source: Cerotate (VMH ID: <http://vmh.life/#metabolite/hexc hexc>), Oxygen: Yes

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = -1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_hexc[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_hexc[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'hexc - aerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3, k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '172.75';
k = k+1; clear FBA
%% Carbon source: Cerotate (VMH ID: <http://vmh.life/#metabolite/hexc hexc>), Oxygen: No

modelClosed = modelClosedOri;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_o2[e]'))) = 0;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = -1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_h2o[e]'))) = 1000;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_co2[e]'))) = 1000;
modelClosed.lb(find(ismember(modelClosed.rxns, 'EX_hexc[e]'))) = -1;
modelClosed.ub(find(ismember(modelClosed.rxns, 'EX_hexc[e]'))) = -1;

FBA = optimizeCbModel(modelClosed, 'max');
Table_csources{1, k} = 'hexc - anaerobic';
Table_csources(2, k) = num2cell(FBA.f);
% fill in only when the LP problem was feasible
if length(FBA.x) > 0
    % set all flux values less than tol to 0
    FBA.x(find(abs(FBA.x)<=tol)) = 0;
    Table_csources(3 ,k) = num2cell(FBA.x(find(ismember(modelClosed.rxns, 'ATPS4m'))));
end
Table_csources{4, k} = '0';
k = k+1; clear FBA

%% The table contains all computed ATP yields.

Table_csources = Table_csources'
%% TIMING
% This tutorial takes only a few minutes.
%% REFERENCES
% [1] Brunk, E. et al. Recon 3D: A Three-Dimensional View of Human Metabolism 
% and Disease. Submited
% 
%
##### SOURCE END #####
-->
</div></body></html>