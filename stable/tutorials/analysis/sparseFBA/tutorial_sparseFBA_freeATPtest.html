<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { min-height: 0px; font-family: monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S6 { text-align: center; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S7 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { text-decoration: underline; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S11 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S12 { line-height: 15.5926666259766px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S13 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S14 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S15 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S16 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S17 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S18 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S19 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S20 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }

.LineNodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis</span></h1><h2 class = "S3"><span class = "S2">Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">Reviewer: Francisco J. Planes, TECNUN, University of Navarra, Laurent Heirendt, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">INTRODUCTION</span></h2><div class = "S4"><span class = "S2">We consider a biochemical network of </span><span class = "S2"> </span><span class = "S5">m </span><span class = "S2">molecular species and </span><span class = "S2"> </span><span class = "S5">n</span><span class = "S2"> </span><span class = "S2"> biochemical reactions. The biochemical network is mathematically represented by a stoichiometric matrix </span><span style="vertical-align:-5px"><img src="data:image/png;base64,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" width="61.5" height="27" /></span><span class = "S2">. In standard notation, flux balance analysis (FBA) is the linear optimisation problem</span></div><div class = "S6"><span style="vertical-align:-32px"><img src="data:image/png;base64,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" width="108" height="74" /></span></div><div class = "S4"><span class = "S2">where </span><span style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAAAoCAYAAABzXJ2PAAAFP0lEQVRoQ+2Zd8h+YxjHPz9bQpQif6DIKjKyM0Mokr2zZWTL3luIzJDskT1CRmaRzAj5QzIysresPrruX/dzOs/7nvsZ56X33PX0juc+93XO9/7e3+t7XWcG3WgVgRmtRuuC0QHeMgk6wDvAW0ag5XAdwzvAW0ag5XAdwzvAW0ag5XAdwzvAW0ag5XAdwzvAW0Zg+HB7AScDnwC7AAsDJwBrAZcAFwC/pDDTieFzAhsAArQRsCDwGnAzcB3wXQX7WYD1gAOBe4G7gd/67M9JwOLAs8APwAPAAcA+wA7Ae9MN8HmDhW8EeD8DSwBnAjsB9wP7A58DaWMOAzbNAL4JOAb4rAL6HMC5wPrAOcBdwN/B9qOnI+CzAYcGm5+qgLUoIJAy/zTgg2D6c8DXwFzANrExiwE3AocA32frLBBrfAocDvwU3x0HrBwsn3l6plpSZNO6wM7AMsAaE0jqrsAtA0ju8sCpccS/qlw/K3AGIDgPhdx8WTNHZp8dcrEZ8EI2Z4Vg9VEhJX7liboc+BhQbv78L0iKAJtUNmkI4qCA7x4sc1MFoDpk5UWActOjt9lESfFM/L0jcEf23ZZxArYH3o3/expuBc7LNuHfr6aK4csC1wPLATcA1wDv59m84SY0mSZ7Zaebq3tIRz5dq7MwcTrWqbA3zVkbeB54B9gOeDu+EL9TgFWB3YBv4v8bAxcC+SY0BjwlkT2B1QF3z0z8OvAocCnwY5MnjzlzAxdHkjo2buyPgutLp8rO24FFQmuriW8ywAXVU6As+XHjkkTMD1wbZEnS4Xw3VofjqeqRqMkY7rHXR+op/elR+isW3Be4AjgS+LUAhdWA+4CXAdf4ouDaQaaaNL1HnYRDi6cjSUBMBrjAXR0OxBySk2PpwERJMqE6kn7L+DuBg3PQJwI8HXuN/B6Zhrlo0rQjgq0lQCTN1BX40UKNe8wDnBVuxVg6j3siaD/A5wP2BtaMDftoFDfZD/CFYle3Dm1yZ3NgVgEejI14vOBGkmcV9EGTYEG4nqmCfnx8rAx1J44q4OYS720/QAYrnxYxt42CHP0Ad2fVJo+fv6dkMOjDputy/S5daxQblHz3ZX0YboWo3j8MONfEbt56KQokffpQow5wjbylruy2NPX3UY2pBtxnM2mquU00PBHP5x/FhtfawiQXOo9tgTdHhTaQAz6SByi4N2Nr0x6rlOcTJc1U1CwVrYEkQwVhe6fWMdxCQW/sscq95cBBsgtzDR8k4Y7iHqprJMDrCp/kQlYMc6CN/X2Ym6gDXD95eiRNk9vM1uIwgbJrtWRXjXH90ttMgD9R45tzwLWGQ+MxFYAnH/5tpWorBWpU8xPgdvp6+h7hUqw9ZPjYAE+lsF20g8IW5Q9n9vb/Vly2M0tHruMWTiaxarldumbJfGUtlwWf1w6gPRL72fnIGZ5byZJ4PXPrGG5zXjto0lTPnwz/aUN+w+hLWNarZ7YwBxmpqNJy2aWzin21sEVQGteN1k9b9NiufSWqQi3iW6HR1RZDKxpugXB+vOnwoV4MIMzU9lEskVOrsvSh8/lWcFfGcW2yzqCuRlIpCbZPlQ+HvlrLt2T8bRFny6I6Uq97i2hc6VLsn0hCC6Ti0a/wEXQ9uCX9SsCHgElFCZDddTdXHBywfN4c2CriyKh+Y1DAXc8XCbNHdSm7HfY+TgQmKtnFxzdCJnl7JP3e+jR+9smaV40X+p9MlEh2/J4GHmlInPTGyPeZtpH7vddsBMF0A7wRKOOc1AE+TnRr1u4A7wBvGYGWw3UM7wBvGYGWw/0Dw0koOJdR8r0AAAAASUVORK5CYII=" width="46" height="20" /></span><span class = "S2"> is a parameter vector that linearly combines one or more reaction fluxes to form what is termed the objective function,  and where a </span><span style="vertical-align:-7px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAoCAYAAABpYH0BAAAEu0lEQVRoQ+2ZW6hVVRSGv+MtNVRKRYook7AiRMFQwUqR7CUtLDXtpqKoGBkmVmJWJpYPXUitVPLBW94veEOLREMDwQsWVJIvvlSiGRmSSpH8NabMs/Y6e+215tri3qwJBw6seRv//McY/xi7gWIEIdAQtLpYTAFgIAkKAAsAAxEIXF4wsAAwEIHA5QUDqwjgQ8B+b//jwFPAicAz62p5EgM7AQuA0cBGYALwR10h8L8xzYC+wHjgYeAO4BiwHlgGnGnK5iQAWwHzgWnAbGAe8G+dAdjCs+8z4BPgIvAMMAv4HngBOBJndxKA7YCPgeeAx4FtdQaezBkFLAXWGpAXzEYB+xowF9hp3vdr1P4kAEXlzwEBORL4sc4AvAVYYe47DPgqYt99wAbgXgNQ7txoJAHoEkm9xr8ngE3APnPZnyP4+B640lz5T39OEoCTgMXAuxYD/7mOGNgGGAjcD7wH/JXybn58X2LuG7eHYv/bFgPl7icrBbA18D4wxYt/nYGXgGdtk1XAB8C5lJcPmS63GwdMtGxZzvhy59wEiFWPAnPsLy5BKpnITo0HgIOVAiiwFP8UB4cDLS2huEP62UbvAG8Cf4egkrBWAV0yQ6ApVsm1vgM+BVYD5zOcfZcljt7AG5Ys4rYZDHxhH0QcnXd1lHNhbbwdOGouPMNkzGGguZehqimw2wNDgMnAg4DizxbLmocCH+1uYB3QMwHA/sCBLACq6lBq32EXVzr/wQPfASyXKqF2Bka4JXpUsf55Cxc3A6dM0Mrl9H8eWtQHphwDMwEohgmwmQaeXNjR2Bnqv6C+K5uFjlstpurxNPYAH1mWTJskku5SVQA7AFLlAkal3CvApciN7rFSp0eODHSPohinx9sc6KblQPQ9KHcGOkO6WdCOCkxdzGnEnwzob5OevILv15KBWWLgI8CXlSQRl3l2Wxl3NsZ4pxGjcxS7Xg8AVTHwTmCqnV2tGKjHUkaVlvzQkuLlGDtdLvgFGBqtiZvKwmoeSN81tfGNwCJgrMVK6SiJbCdOu5vxv1fAunJTOlonSPJFoSLPLJxYZdjFHFFiq5U4ANta4FbrSvJBQjU6pP5V3mkoTkraVHOo6hgEvGpyRmeF6kDZLqKoWPgGeNoyvG+HX63EkikOQJ/aJcIRuMH04HQr79TuqqaI9g1S366XyRsnqLNWItq3D7AVkBR70pKWf57DQgknrtkQ+7uwKgxJFlE8ykAZoJdSz2wvIHqfthMVs142Ny6JFVWg5+3AGEAVk5iZReb4ZFDXRfa4sCNyyQvV6lK4khIpOSOOgUoCy81gqX2VaapGutiFdYheTQyMdmpVeMvVVD9GOxtVwPC/LVViygOyimvZtRAYAayxBrJIIcapgSwF8qJHlEZ2RAGUz6u2VdteID5mMW6ANQy0mVxGv5VE3dY1H3SAwFVXt1aGkqIaxmocS2BrqGkgLaxKLKqBr9qV1M5KA4BrPuyy7J1mbc3OzRNAp+zVM/u6ZhFJefE8AVTckywoaTqmvFNNTc8LQNd8uC2u7V1TiKS8bF4AuubDb2Va4ymvVhvT8wLQdWa6mkZ8q8aycObXygvAzBeo9YUFgIEvWABYABiIQODygoGBAF4BjscOOLsiC54AAAAASUVORK5CYII=" width="40" height="20" /></span><span class = "S2">, or  </span><span style="vertical-align:-7px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAoCAYAAABpYH0BAAAEnUlEQVRoQ+2ZW6hVVRSGv1OaYmgoiihiIeEV8cEooVAR80VMunjLKyhekow0w/uV0gct7EaFPmiWmmaWKZUomSUI3h+8oC+9qKkZFuKFtPhxzJhn7bXP2muvtTeszVpwXs6Za805/vmP8f9jnDryJxECdYnezl8mBzAhCXIAcwATIpDw9ZyBOYAJEUj4es7ACgLYF9jvff8EMAI4m3DPmno9ioGtgfeAUcA2YBJwvaYQuB/MA8BTwERgIPAocAz4ElgHXCkWcxSADwErgdeBhcBbwL81BmAjL761wEfALWA0MB84BUwHjoTFHQVgc+BDYCwwFPi2xsBTOCOBT4HNBuQNi1HAzgGWA7ss+y4F448CUFT+AhCQw4EzNQZgO2CDpe/zwN5AfD2ArUA3A1DpXO+JAtAJSa3WvxeAr4CfLGUvBPDxM/AzS+W//TVRAE4BPgZWWA28W2EGPg6MB7ZY7blXwf38+v6Jpe/NkP1U+5dZDVS6ny8VwKbAauAVr/61AV4DxthHNgLvANdSCrSLgdcL+AFYY+wICyzpli0BsWowsNR+wgRSYqI49TwD/FoqgAJL9U918CWgsQmK26SPfehtYDHwT9KIzE50t3oj4WoF/Aa8b8FeTmEP9wmxXcLRG1hkYhH2+WeBH+0PIs7npQKoD+8EjloKzzYbcxh40FOoShnsFlaXpgE9AdWer62kHAKSprfP9oYAfBr4pRwA1XXohr6zw0vOT3voO4ClZAXUTpEpshMyuZMBKaUK+wEDUmf7q8y9fGBSB1AME2BzDTylsKOxO69/g/q71KzST0cTGXUMKi2qvUsAicCdmJtXFMBHALlyAaNW7k3gduCAXa3VUXpVkoFhuEgA3gDmGXjqlOIKjZ9BqTPQsauTpU3QYCoo5xHPGdAnYzKgnOVBBkpgVlknEZeB5dTAQcCeUkTEKc/31sZdDYnWecTgmnHAghRBbagGfgO41ivuhbQ3Re0PvGuiGHYJTgsuAkOCPXExI62UkL8r9uGHgQ+ACVYr5aNksp057WzA/xk3Km99MRWWNzyeggpHdhl2FkeU0G4lDMBmZmA1uppqNSaIwxM23tLvVSdlbdJ4NFaqlg9U7CKKmoWDwMvmOf04/G4llExhAPrULjCOQBPzg7OsvdO4Kw0TrYNXsxPRfk8COwBZsReB7QEWOCwkOGHDhtD/C6vDkGURxYMMFEN0U5qZ7QNE799t0xnATEvjglpRIj2r2QvrSD4ZNHVRPK7siFzKQo26VK7kRAqUPoyBEoH1FrAcv9o0dSNtzYNpE92aGBic1KrxHlBkslEihlVfprjUKg4DNtkAWaQQ4zRAlgN51SNKvQMGAVTOq7fV2F4gPmc1rp+ZVn1MplX/KwmmrRs+aAOBq6luVh6JogbG6r9lsPVoaCAvrG4n6IH/jytqnBUHADd82G3qHefdzK5NE0Dn7DUz+zmziMQ8eJoAam4mW1AwdIx5pkwtTwtAN3zoEDb2zhQiMQ+bFoBu+PBHA6PxmEfLxvK0AHSTmcfMI2rElCUVLvu20gKw7ANk/cUcwIQ3mAOYA5gQgYSv5wxMCOB/LMwOOFpOzJYAAAAASUVORK5CYII=" width="40" height="20" /></span><span class = "S2">, represents some fixed output, or input, of the ith molecular species. A typical application of flux balance analysis is to predict an optimal non-equilibrium steady-state flux vector that optimises a linear objective function, such biomass production rate, subject to bounds on certain reaction rates. </span></div><div class = "S4"><span class = "S2">In this tutorial, we demonstrate how to predict the minimal number of active reactions that are still consistent with an optimal objective derived from the result of a standard flux balance analysis problem. In each case, the corresponding problem is a cardinality minimisation problem that we term </span><span class = "S7">sparse flux balance analysis</span></div><div class = "S6"><span style="vertical-align:-42px"><img src="data:image/png;base64,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" width="95.5" height="95" /></span></div><div class = "S4"><span class = "S2">where the last constraint is optional and represents the requirement to satisfy an optimal objective value </span><span style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAACh0lEQVRYR+3XS6jNURTH8c/1SIiSgTIgRZgokYRQEuVV8n6NCCmRgUckIW+iyIjkLY+8BkR5hAkDIqRImQnJwCOhVfvUv7//vde5zrlK91//zunsvdf67rXX+q19avzjp+Yf+9cE0BSBpgg0ReC/j0Af9MbJ2hS32hEYicFYh59FENUGmI++WIrPjQHQD9txD3cwAXEMu9ETQ1I0bpdgKh2BFhiGJRib23E43YJr+FotgJLdZpiKY+mHXViZdVxtgFbYitZ4nGBm4VU+Dyp9BCX7AzATq1PyLcMLnG0oQBfMwRgMxCdcxx7cxI+M4ZaYhEtpXgxFJKIkr+JLFqK+CERSzcMG3MU2PEmZvT59RokdqK3O67vy1QUQY9OxH0ewPLOjsDsC5/AGkxNYff5+G68LIOr3BL6lJHqeW90ZRzEc0+qS27qoagOILN6ISJ54o4zyUtoxAYxCZHjAlP3UBtANxxHJNw4PCix3TXU+qBoA43EepzEXHwsA4ohivEdSv1tlb5/C/wURlbXpXZOOoqiTTcSZVB0z8LpSAO2wF7NTM7lQYLikdIuT4gVoJGvZT1EOdE/Z3z4JyqMCq/1T+GMoROd+2Z7TgiKAoUndriQ5fZcz3jZVRQjUCuzA90oChLLtxMMkRE8zxkMZoyw341D6ngcsiyUfgdDsqPm4ybzE29TDQ4Y7YQEWYh/i3N+X5a1gch6gpG5xsxmNNinMIbuR5TdwEHG5yDagBnPkAcLxxdS3G1xa5dDkAaLlxtkexqJc8ynH7h/PzQI0R7TYuDqtwqY/tvIXE7MAHdLO49IRt9kiAfoLV8VLswC9cCpNm4JnFfdWTxWUGtDlJMMfGhugMfz95uMXkax3KTF/d1MAAAAASUVORK5CYII=" width="16" height="20" /></span><span class = "S2"> </span><span class = "S2"> </span><span class = "S2">derived from any solution to a flux balance analysis (FBA) problem. This approach is used to check for minimal sets of reactions that either should be active, or should not be active in a flux balance model that is representative of a biochemical network.</span></div><div class = "S4"><span class = "S2">In particular, we use sparse flux balance analysis test for a minimal stoichiometrically balanced cycle involving ATP hydrolysis, which should never appear in any flux balance analysis model where constraints arising from ATP demands are being implemented, since a stoichiometrically balanced cycle involving ATP hydrolysis might create artefactual energy metabolism predictions. In order to mimic the requirement for energy, for maintenance of cellular integrity, many flux balance models contain a cytoplasmic adenosine triphosphate (atp[c]) hydrolysis reaction where the products are adenosine diphosphate (adp[c]) and orthophosphate (pi[c]). In Recon 3D, the full corresponding reaction formula is </span></div><div class = "S4"><span class = "S2">                                                            h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]  </span><a href = "https://localhost:31516/toolbox/matlab/codetools/liveeditor/index.html?id=324010801&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Canalysis%5CsparseFBA%5Ctutorial_sparseFBA_freeATPtest.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3714693809187425378&amp;snc=HWWXTX#eq_ATPhydrolysis"><span class = "S9">(1)</span></a><span class = "S2"> </span></div><div class = "S4"><span class = "S2">In a flux balance model, a maintenance requirement for synthesis of adenosine triphosphate can be represented with a lower bound on reaction </span><a href = "https://localhost:31516/toolbox/matlab/codetools/liveeditor/index.html?id=324010801&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Canalysis%5CsparseFBA%5Ctutorial_sparseFBA_freeATPtest.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3714693809187425378&amp;snc=HWWXTX#eq_ATPhydrolysis"><span class = "S9">(1)</span></a><span class = "S2"> or inclusion of reaction </span><a href = "https://localhost:31516/toolbox/matlab/codetools/liveeditor/index.html?id=324010801&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Canalysis%5CsparseFBA%5Ctutorial_sparseFBA_freeATPtest.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3714693809187425378&amp;snc=HWWXTX#eq_ATPhydrolysis"><span class = "S9">(1)</span></a><span class = "S2"> within a composite biomass reaction, when cellular growth is being modelled [1]. In order for either of these approaches to result in a constraint on energy metabolism within the model, no stoichiometrically balanced set of internal reactions that include reaction </span><a href = "https://localhost:31516/toolbox/matlab/codetools/liveeditor/index.html?id=324010801&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Canalysis%5CsparseFBA%5Ctutorial_sparseFBA_freeATPtest.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3714693809187425378&amp;snc=HWWXTX#eq_ATPhydrolysis"><span class = "S9">(1)</span></a><span class = "S2"> should admit isolated hydrolysis of ATP, given the reaction bounds supplied with the model. If such a set exists, sparse flux balance analysis can be used to find one such minimal cardinality set [4, 5]. </span></div><h2 class = "S3"><span class = "S2">TIMING</span></h2><div class = "S4"><span class = "S2">A minimal solution to sparse flux balance analysis problem can be obtained in &lt; 10 seconds. The time consuming part is comparing the predictions with the biochemical literature to assess whether the predictions are consistent with biochemical network function or not, as such, the process of refining a model to increase its biochemical fidelity can take days or weeks.</span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">EQUIPMENT SETUP</span></h2><div class = "S4"><span class = "S2">Make sure to initialise the COBRA Toolbox.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">initCobraToolbox(false) </span><span class = "S14">% false, as we don't want to update</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">PROCEDURE</span></h2><h2 class = "S3"><span class = "S2">Setting the numerical tolerance</span></h2><div class = "S4"><span class = "S2">Implementation of sparse flux balance analysis with any numerical optimisation solver requires a tolerance to be set that distinguished between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver. Typically 1e-6 will suffice, except for multiscale models.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">feasTol = getCobraSolverParams(</span><span class = "S16">'LP'</span><span class = "S13">, </span><span class = "S16">'feasTol'</span><span class = "S17">);</span></div></div></div><h2 class = "S3"><span class = "S2">Loading and examining the properties of a model</span></h2><div class = "S4"><span class = "S2">We are going to focus here on testing the biochemical fidelity of Recon3.0model [3]. As an example, Recon 1.0 may also be used [6].</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">global </span><span class = "S17">CBTDIR</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">filename = </span><span class = "S16">'Recon1.0model.mat'</span><span class = "S13">; </span><span class = "S14">% amend fileName for Recon 3</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">model = readCbModel([CBTDIR filesep </span><span class = "S16">'test' </span><span class = "S13">filesep </span><span class = "S16">'models' </span><span class = "S17">filesep filename]);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">model.csense(1:size(model.S,1),1) = </span><span class = "S16">'E'</span><span class = "S17">;</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">Testing for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><div class = "S4"><span class = "S2">There are two options: A: sparse flux balance analysis using zero norm minimisation, and B: one norm minimisation.</span></div><h2 class = "S3"><span class = "S2">A: Sparse flux balance analysis test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><div class = "S4"><span class = "S2">Detect the ATP maintenance reaction and if there is none already, add one.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">atpMaintenanceBool=strcmp(model.rxns,</span><span class = "S16">'DM_atp_c_'</span><span class = "S13">) | strcmp(model.rxns,</span><span class = "S16">'DM_atp(c)'</span><span class = "S13">) | strcmp(model.rxns,</span><span class = "S16">'ATPM'</span><span class = "S17">);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">if </span><span class = "S17">~any(atpMaintenanceBool)</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    fprintf(</span><span class = "S16">'Could not find ATP maintenance reaction, adding one.'</span><span class = "S17">)</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S18">if </span><span class = "S13">~strcmp(filename,</span><span class = "S16">'HMR2.0'</span><span class = "S17">)</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">        model = addReaction(model, </span><span class = "S16">'ATPMnew'</span><span class = "S13">, </span><span class = "S16">'h2o[c] + atp[c] -&gt; h[c] + adp[c] + pi[c]'</span><span class = "S17">);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S19">else</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">        model = addReaction(model, </span><span class = "S16">'ATPMnew'</span><span class = "S13">, </span><span class = "S16">'m02040c + m01371c -&gt; m02039c + m01285c + m02751c'</span><span class = "S17">);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S19">end</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    atpMaintenanceBool=strcmp(model.rxns,</span><span class = "S16">'ATPMnew'</span><span class = "S17">);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    fprintf(</span><span class = "S16">'%s %s\n'</span><span class = "S13">,model.rxns{atpMaintenanceBool},</span><span class = "S16">' is the ATP maintenance reaction'</span><span class = "S17">)</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">else</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    fprintf(</span><span class = "S16">'%s %s\n'</span><span class = "S13">,model.rxns{atpMaintenanceBool},</span><span class = "S16">' is the ATP maintenance reaction:'</span><span class = "S17">)</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">end</span></div></div></div><div class = "S20"><span class = "S2">Display the size of the  model</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">[nMet,nRxn] = size(model.S);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">fprintf(</span><span class = "S16">'%6s\t%6s\n'</span><span class = "S13">,</span><span class = "S16">'#mets'</span><span class = "S13">,</span><span class = "S16">'#rxns'</span><span class = "S13">); fprintf(</span><span class = "S16">'%6u\t%6u\t%s%s\n'</span><span class = "S13">,nMet,nRxn,</span><span class = "S16">' totals in '</span><span class = "S17">, filename)</span></div></div></div><div class = "S20"><span class = "S2">Display the constraints</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">minInf = -1000;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">maxInf =  1000;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">printConstraints(model, minInf, maxInf);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = "S4"><span class = "S2">Identify the exchange reactions(s) heuristically</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">if </span><span class = "S13">~isfield(model,</span><span class = "S16">'SIntRxnBool'</span><span class = "S17">)</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">    model = findSExRxnInd(model,size(model.S,1),1);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">end</span></div></div></div><div class = "S20"><span class = "S2">Maximise the atp maintenance reaction</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">model.c(:) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">model.c(atpMaintenanceBool) = 1;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">osenseStr = </span><span class = "S16">'max'</span><span class = "S17">;</span></div></div></div><div class = "S20"><span class = "S2">Choose to minimize the zero norm of the optimal flux vector</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">minNorm = </span><span class = "S16">'zero'</span><span class = "S17">;</span></div></div></div><div class = "S20"><span class = "S2">Allow thermodynamically infeasible fluxes</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">allowLoops = 1;</span></div></div></div><div class = "S20"><span class = "S2">Select the approximate step functions when minimising the zero norm of the flux vector</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S14">% zeroNormApprox='cappedL1';% : Capped-L1 norm</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S14">% zeroNormApprox='exp';%Exponential function</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S14">% zeroNormApprox='log';%Logarithmic function</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S14">% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S14">% zeroNormApprox='lp-';%L_p norm with p&lt;0</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S14">% zeroNormApprox='lp+';%L_p norm with 0&lt;p&lt;1</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">zeroNormApprox=</span><span class = "S16">'all'</span><span class = "S13">;</span><span class = "S14">% test all approximations avialable and return the best one</span></div></div></div><div class = "S20"><span class = "S2">Close all external reactions</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">model.lb(~model.SIntRxnBool) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">model.ub(~model.SIntRxnBool) = 0;</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = "S4"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">tic</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">toc</span></div></div></div><div class = "S20"><span class = "S2">Check to see if there is a non-zero flux through the ATP maintenance reaction</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">fprintf(</span><span class = "S16">'%g%s\n'</span><span class = "S13">,sparseFBAsolutionBounded.v(atpMaintenanceBool),</span><span class = "S16">' flux through the ATP maintenance reaction'</span><span class = "S17">)</span></div></div></div><div class = "S20"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">cutoff=0.1;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">for </span><span class = "S17">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S18">if </span><span class = "S17">abs(sparseFBAsolutionBounded.v(n))&gt;cutoff</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">        fprintf(</span><span class = "S16">'%10g%15s\t%-60s\n'</span><span class = "S17">,sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S19">end</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">ANTICIPATED RESULTS</span></h2><div class = "S4"><span class = "S2">When all external reactions are blocked (bounds are set to zero), then the only net flux admissible is within a stoichiometrically balanced cycle, if and only if, the bounds on each reaction in the stoichiometrically balanced cycle simultaneously admit net flux in one direction around the cycle. Net flux around a stoichiometrically balanced cycle is thermodynamically infeasible [2], but steady state mass balance constraints do not enforce thermodynamic constraints. In lieu of such constraints, the bounds on reactions can be set based on the biochemical literature to eliminate net flux around a stoichiometrically balanced cycle. In Recon3.0, with all external reactions blocked, maximising reaction </span><a href = "https://localhost:31516/toolbox/matlab/codetools/liveeditor/index.html?id=324010801&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Canalysis%5CsparseFBA%5Ctutorial_sparseFBA_freeATPtest.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3714693809187425378&amp;snc=HWWXTX#eq_ATPhydrolysis"><span class = "S9">(1)</span></a><span class = "S2"> while minimising the cardinality of all internal reactions, using sparse flux balance analysis was used to find one such minimal cycle. The optimal solution involves reaction </span><a href = "https://localhost:31516/toolbox/matlab/codetools/liveeditor/index.html?id=324010801&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Canalysis%5CsparseFBA%5Ctutorial_sparseFBA_freeATPtest.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3714693809187425378&amp;snc=HWWXTX#eq_ATPhydrolysis"><span class = "S9">(1)</span></a><span class = "S2"> in a set of nine stoichiometrically balanced reactions, with bounds that admit an arbitrary amount of isolated ATP hydrolysis. Recon3.0model contains no set of reactions that admit an arbitrary amount of isolated ATP hydrolysis.</span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">TROUBLESHOOTING</span></h2><div class = "S4"><span class = "S2">By further constraining the bounds to convert one reversible reaction in each such stoichiometrically balanced cycle to an irreversible reaction, isolated ATP hydrolysis can be eliminated, e.g., though there are important exceptions, a reactions hydrolyses ATP does not generally operate in a reverse direction at biochemically realistic metabolite concentrations. </span></div><h2 class = "S3"><span class = "S2">B: One norm minimisation test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged</span></h2><div class = "S4"><span class = "S2">Run flux balance analysis on the same model and minimise the total sum of all reaction rates (minimum one norm)</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">minNorm = </span><span class = "S16">'one'</span><span class = "S17">;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">oneNormFBASolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></div></div></div><div class = "S20"><span class = "S2">Display the one norm flux balance analysis solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">for </span><span class = "S17">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S18">if </span><span class = "S17">abs(oneNormFBASolutionBounded.v(n))&gt;cutoff</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">        formula = printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">        fprintf(</span><span class = "S16">'%10g%15s\t%-60s\n'</span><span class = "S17">,oneNormFBASolutionBounded.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S19">end</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">ANTICIPATED RESULTS</span></h2><div class = "S4"><span class = "S2">Depending on the model, minimising the one norm may give as good an approximation of a minimal stoichiometrically balanced cycle as minimising the zero norm, but experience suggests this is less likely for large cycles or large models.</span></div><h2 class = "S3"><span class = "S2">Testing for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><div class = "S4"><span class = "S2">There are two options: A: sparse flux balance analysis using zero norm minimisation, and B: one norm minimisation.</span></div><h2 class = "S3"><span class = "S2">A: Sparse flux balance analysis test for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><div class = "S4"><span class = "S2">Fully open all internal reactions</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">model.lb(model.SIntRxnBool) = -1000;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">model.ub(model.SIntRxnBool) = 1000;</span></div></div></div><div class = "S20"><span class = "S2">Run sparse flux balance analysis on the model with all exchanges closed and all internal reactions reversible</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></div></div></div><div class = "S20"><span class = "S2">Check to see if there is a non-zero flux through the ATP maintenance reaction</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">fprintf(</span><span class = "S16">'%g%s\n'</span><span class = "S13">,sparseFBAsolutionUnBounded.v(atpMaintenanceBool),</span><span class = "S16">' flux through the ATP maintenance reaction'</span><span class = "S17">);</span></div></div></div><div class = "S20"><span class = "S2">Display the sparse flux solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">cutoff=0.1;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">for </span><span class = "S17">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S18">if </span><span class = "S17">abs(sparseFBAsolutionUnBounded.v(n))&gt;cutoff</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">        formula=printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">        fprintf(</span><span class = "S16">'%10g%15s\t%-60s\n'</span><span class = "S17">,sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S19">end</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">ANTICIPATED RESULTS</span></h2><div class = "S4"><span class = "S2">When all reactions are reversible, in a genome-scale model, it should be anticipated to find a stoichiometrically balanced cycle of reactions that admit an arbitrary amount of isolated ATP hydrolysis. It is important nevertheless to realise that these cycles are latent in the network and could become active with inadvertent relaxation of model bounds.</span></div><h2 class = "S3"><span class = "S2">B: One norm minimisation test for production of ATP with all external reactions blocked and all internal reactions reversible</span></h2><div class = "S4"><span class = "S2">Run flux balance analysis on the samemodel and minimise the sum total of all reaction rates (minimium one norm)</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">minNorm = </span><span class = "S16">'one'</span><span class = "S17">;</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">oneNormFBASolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);</span></div></div></div><div class = "S20"><span class = "S2">Display the one norm flux balance analysis solution, but only the non-zero fluxes, above a specified cutoff.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S18">for </span><span class = "S17">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S18">if </span><span class = "S17">abs(oneNormFBASolutionUnBounded.v(n))&gt;cutoff</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S17">        formula = printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">        fprintf(</span><span class = "S16">'%10g%15s\t%-60s\n'</span><span class = "S17">,oneNormFBASolutionUnBounded.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S13">    </span><span class = "S19">end</span></div></div><div class = 'inlineWrapper'><div class = "S12 lineNode"><span class = "S19">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S10"><span class = "S2">ANTICIPATED RESULTS</span></h2><div class = "S4"><span class = "S2">When all reactions are reversible, in a genome-scale model, it should be anticipated to find a stoichiometrically balanced cycle of reactions that admit an arbitrary amount of isolated ATP hydrolysis. It is important nevertheless to realise that these cycles are latent in the network and could become active with inadvertent relaxation of model bounds.</span></div><h2 class = "S3"><span class = "S2">REFERENCES</span></h2><div class = "S4"><span class = "S2">[1] Feist, Adam M, and Bernhard O Palsson. The Biomass Objective Function. </span><span class = "S7">Current Opinion in Microbiology</span><span class = "S2">, Ecology and industrial microbiology  Special section: Systems biology, 13, no. 3 (June 2010): 34449. doi:10.1016/j.mib.2010.03.003.</span></div><div class = "S4"><span class = "S2">[2] Fleming, R. M. T., C. M. Maes, M. A. Saunders, Y. Ye, and B. . Palsson. A Variational Principle for Computing Nonequilibrium Fluxes and Potentials in Genome-Scale Biochemical Networks. </span><span class = "S7">Journal of Theoretical Biology</span><span class = "S2"> 292 (January 7, 2012): 7177. doi:10.1016/j.jtbi.2011.09.029.</span></div><div class = "S4"><span class = "S2">[3] Brunk, Elizabeth, Swagatika Sahoo, Daniel C Zielinski, Ali Altunkaya, Maike Aurich, Nathan Mih, German Andres Preciat Gonzalez, et al. Recon 3D: A Resource Enabling a Three-Dimensional View of Gene Variation in Human Metabolism. </span><span class = "S7">(Submitted)</span><span class = "S2"> 1 (2017).</span></div><div class = "S4"><span class = "S2">[4] Fleming, R.M.T., et al., Cardinality optimisation in constraint-based modelling: illustration with Recon 3D (submitted), 2017.</span></div><div class = "S4"><span class = "S2">[5] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span class = "S2"> </span><span class = "S2">optimization</span><span class = "S2">. European Journal of Operational Research 244, 2646.</span></div><div class = "S4"><span class = "S2">[6] Duarte, N. C., S. A. Becker, N. Jamshidi, I. Thiele, M. L. Mo, T. D. Vo, R. Srivas, and B. . Palsson. Global Reconstruction of the Human Metabolic Network Based on Genomic and Bibliomic Data. </span><span class = "S7">Proceedings of the National Academy of Sciences of the United States of America</span><span class = "S2"> 104, no. 6 (2007): 177782. doi:10.1073/pnas.0610772104.</span></div><div class = "S4"><span class = "S2">  </span></div><div class = "S4"><span class = "S2"></span></div><div class = "S4"><span class = "S7"></span></div></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Sparse flux balance analysis test for a minimial stoichiometrically balanced cycle involving ATP hydrolysis
%% Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.
%% Reviewer: Francisco J. Planes, TECNUN, University of Navarra, Laurent Heirendt, University of Luxembourg.
%% INTRODUCTION
% We consider a biochemical network of  |m |molecular species and  |n|  biochemical 
% reactions. The biochemical network is mathematically represented by a stoichiometric 
% matrix $S\in\mathcal{Z}^{m\times n}$. In standard notation, flux balance analysis 
% (FBA) is the linear optimisation problem
% 
% $$\begin{array}{ll}\min\limits _{v} & \rho(v)\equiv c^{T}v\\\text{s.t.} 
% & Sv=b,\\ & l\leq v\leq u,\end{array}$$
% 
% where $$c\in\Re^{n}$$ is a parameter vector that linearly combines one 
% or more reaction fluxes to form what is termed the objective function,  and 
% where a $$b_{i}<0$$, or  $$b_{i}>0$$, represents some fixed output, or input, 
% of the ith molecular species. A typical application of flux balance analysis 
% is to predict an optimal non-equilibrium steady-state flux vector that optimises 
% a linear objective function, such biomass production rate, subject to bounds 
% on certain reaction rates. 
% 
% In this tutorial, we demonstrate how to predict the minimal number of active 
% reactions that are still consistent with an optimal objective derived from the 
% result of a standard flux balance analysis problem. In each case, the corresponding 
% problem is a cardinality minimisation problem that we term _sparse flux balance 
% analysis_
% 
% $$\begin{array}{ll}\min\limits _{v} & \Vert v\Vert_{0}\\\text{s.t.} & Sv=b\\ 
% & l\leq v\leq u\\ & c^{T}v=\rho^{\star}\end{array}$$
% 
% where the last constraint is optional and represents the requirement to 
% satisfy an optimal objective value $\rho^{\star}$  derived from any solution 
% to a flux balance analysis (FBA) problem. This approach is used to check for 
% minimal sets of reactions that either should be active, or should not be active 
% in a flux balance model that is representative of a biochemical network.
% 
% In particular, we use sparse flux balance analysis test for a minimal stoichiometrically 
% balanced cycle involving ATP hydrolysis, which should never appear in any flux 
% balance analysis model where constraints arising from ATP demands are being 
% implemented, since a stoichiometrically balanced cycle involving ATP hydrolysis 
% might create artefactual energy metabolism predictions. In order to mimic the 
% requirement for energy, for maintenance of cellular integrity, many flux balance 
% models contain a cytoplasmic adenosine triphosphate (atp[c]) hydrolysis reaction 
% where the products are adenosine diphosphate (adp[c]) and orthophosphate (pi[c]). 
% In Recon 3D, the full corresponding reaction formula is 
% 
%                                                             h2o[c] + atp[c] 
% -> h[c] + adp[c] + pi[c]  <#eq_ATPhydrolysis (1)> 
% 
% In a flux balance model, a maintenance requirement for synthesis of adenosine 
% triphosphate can be represented with a lower bound on reaction <#eq_ATPhydrolysis 
% (1)> or inclusion of reaction <#eq_ATPhydrolysis (1)> within a composite biomass 
% reaction, when cellular growth is being modelled [1]. In order for either of 
% these approaches to result in a constraint on energy metabolism within the model, 
% no stoichiometrically balanced set of internal reactions that include reaction 
% <#eq_ATPhydrolysis (1)> should admit isolated hydrolysis of ATP, given the reaction 
% bounds supplied with the model. If such a set exists, sparse flux balance analysis 
% can be used to find one such minimal cardinality set [4, 5]. 
%% TIMING
% A minimal solution to sparse flux balance analysis problem can be obtained 
% in < 10 seconds. The time consuming part is comparing the predictions with the 
% biochemical literature to assess whether the predictions are consistent with 
% biochemical network function or not, as such, the process of refining a model 
% to increase its biochemical fidelity can take days or weeks.
%% EQUIPMENT SETUP
% Make sure to initialise the COBRA Toolbox.
%%
initCobraToolbox(false) % false, as we don't want to update
%% PROCEDURE
%% Setting the numerical tolerance
% Implementation of sparse flux balance analysis with any numerical optimisation 
% solver requires a tolerance to be set that distinguished between zero and non-zero 
% flux, based on the numerical tolerance of the currently installed optimisation 
% solver. Typically 1e-6 will suffice, except for multiscale models.
%%
feasTol = getCobraSolverParams('LP', 'feasTol');
%% Loading and examining the properties of a model
% We are going to focus here on testing the biochemical fidelity of Recon3.0model 
% [3]. As an example, Recon 1.0 may also be used [6].

global CBTDIR
filename = 'Recon1.0model.mat'; % amend fileName for Recon 3
model = readCbModel([CBTDIR filesep 'test' filesep 'models' filesep filename]);
model.csense(1:size(model.S,1),1) = 'E';
%% Testing for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% There are two options: A: sparse flux balance analysis using zero norm minimisation, 
% and B: one norm minimisation.
%% A: Sparse flux balance analysis test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% Detect the ATP maintenance reaction and if there is none already, add one.
%%
atpMaintenanceBool=strcmp(model.rxns,'DM_atp_c_') | strcmp(model.rxns,'DM_atp(c)') | strcmp(model.rxns,'ATPM');
if ~any(atpMaintenanceBool)
    fprintf('Could not find ATP maintenance reaction, adding one.')
    if ~strcmp(filename,'HMR2.0')
        model = addReaction(model, 'ATPMnew', 'h2o[c] + atp[c] -> h[c] + adp[c] + pi[c]');
    else
        model = addReaction(model, 'ATPMnew', 'm02040c + m01371c -> m02039c + m01285c + m02751c');
    end
    atpMaintenanceBool=strcmp(model.rxns,'ATPMnew');
    fprintf('%s %s\n',model.rxns{atpMaintenanceBool},' is the ATP maintenance reaction')
else
    fprintf('%s %s\n',model.rxns{atpMaintenanceBool},' is the ATP maintenance reaction:')
end
%% 
% Display the size of the  model

[nMet,nRxn] = size(model.S);
fprintf('%6s\t%6s\n','#mets','#rxns'); fprintf('%6u\t%6u\t%s%s\n',nMet,nRxn,' totals in ', filename)
%% 
% Display the constraints

minInf = -1000;
maxInf =  1000;
printConstraints(model, minInf, maxInf);
%% 
% Identify the exchange reactions(s) heuristically
%%
if ~isfield(model,'SIntRxnBool')
    model = findSExRxnInd(model,size(model.S,1),1);
end
%% 
% Maximise the atp maintenance reaction

model.c(:) = 0;
model.c(atpMaintenanceBool) = 1;
osenseStr = 'max';
%% 
% Choose to minimize the zero norm of the optimal flux vector

minNorm = 'zero';
%% 
% Allow thermodynamically infeasible fluxes

allowLoops = 1;
%% 
% Select the approximate step functions when minimising the zero norm of 
% the flux vector

% zeroNormApprox='cappedL1';% : Capped-L1 norm
% zeroNormApprox='exp';%Exponential function
% zeroNormApprox='log';%Logarithmic function
% zeroNormApprox='SCAD';%Smoothly clipped absolute deviation function
% zeroNormApprox='lp-';%L_p norm with p<0
% zeroNormApprox='lp+';%L_p norm with 0<p<1
zeroNormApprox='all';% test all approximations avialable and return the best one
%% 
% Close all external reactions

model.lb(~model.SIntRxnBool) = 0;
model.ub(~model.SIntRxnBool) = 0;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed
%%
tic
sparseFBAsolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
toc
%% 
% Check to see if there is a non-zero flux through the ATP maintenance reaction

fprintf('%g%s\n',sparseFBAsolutionBounded.v(atpMaintenanceBool),' flux through the ATP maintenance reaction')
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=0.1;
for n=1:nRxn
    if abs(sparseFBAsolutionBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all external reactions are blocked (bounds are set to zero), then the 
% only net flux admissible is within a stoichiometrically balanced cycle, if and 
% only if, the bounds on each reaction in the stoichiometrically balanced cycle 
% simultaneously admit net flux in one direction around the cycle. Net flux around 
% a stoichiometrically balanced cycle is thermodynamically infeasible [2], but 
% steady state mass balance constraints do not enforce thermodynamic constraints. 
% In lieu of such constraints, the bounds on reactions can be set based on the 
% biochemical literature to eliminate net flux around a stoichiometrically balanced 
% cycle. In Recon3.0, with all external reactions blocked, maximising reaction 
% <#eq_ATPhydrolysis (1)> while minimising the cardinality of all internal reactions, 
% using sparse flux balance analysis was used to find one such minimal cycle. 
% The optimal solution involves reaction <#eq_ATPhydrolysis (1)> in a set of nine 
% stoichiometrically balanced reactions, with bounds that admit an arbitrary amount 
% of isolated ATP hydrolysis. Recon3.0model contains no set of reactions that 
% admit an arbitrary amount of isolated ATP hydrolysis.
%% TROUBLESHOOTING
% By further constraining the bounds to convert one reversible reaction in each 
% such stoichiometrically balanced cycle to an irreversible reaction, isolated 
% ATP hydrolysis can be eliminated, e.g., though there are important exceptions, 
% a reactions hydrolyses ATP does not generally operate in a reverse direction 
% at biochemically realistic metabolite concentrations. 
%% B: One norm minimisation test for production of ATP with all external reactions blocked, but all internal reaction bounds unchanged
% Run flux balance analysis on the same model and minimise the total sum of 
% all reaction rates (minimum one norm)
%%
minNorm = 'one';
oneNormFBASolutionBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Display the one norm flux balance analysis solution, but only the non-zero 
% fluxes, above a specified cutoff.

for n=1:nRxn
    if abs(oneNormFBASolutionBounded.v(n))>cutoff
        formula = printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',oneNormFBASolutionBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% Depending on the model, minimising the one norm may give as good an approximation 
% of a minimal stoichiometrically balanced cycle as minimising the zero norm, 
% but experience suggests this is less likely for large cycles or large models.
%% Testing for production of ATP with all external reactions blocked and all internal reactions reversible
% There are two options: A: sparse flux balance analysis using zero norm minimisation, 
% and B: one norm minimisation.
%% A: Sparse flux balance analysis test for production of ATP with all external reactions blocked and all internal reactions reversible
% Fully open all internal reactions
%%
model.lb(model.SIntRxnBool) = -1000;
model.ub(model.SIntRxnBool) = 1000;
%% 
% Run sparse flux balance analysis on the model with all exchanges closed 
% and all internal reactions reversible

sparseFBAsolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Check to see if there is a non-zero flux through the ATP maintenance reaction

fprintf('%g%s\n',sparseFBAsolutionUnBounded.v(atpMaintenanceBool),' flux through the ATP maintenance reaction');
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified cutoff.

cutoff=0.1;
for n=1:nRxn
    if abs(sparseFBAsolutionUnBounded.v(n))>cutoff
        formula=printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',sparseFBAsolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all reactions are reversible, in a genome-scale model, it should be anticipated 
% to find a stoichiometrically balanced cycle of reactions that admit an arbitrary 
% amount of isolated ATP hydrolysis. It is important nevertheless to realise that 
% these cycles are latent in the network and could become active with inadvertent 
% relaxation of model bounds.
%% B: One norm minimisation test for production of ATP with all external reactions blocked and all internal reactions reversible
% Run flux balance analysis on the samemodel and minimise the sum total of all 
% reaction rates (minimium one norm)
%%
minNorm = 'one';
oneNormFBASolutionUnBounded = optimizeCbModel(model, osenseStr, minNorm, allowLoops, zeroNormApprox);
%% 
% Display the one norm flux balance analysis solution, but only the non-zero 
% fluxes, above a specified cutoff.

for n=1:nRxn
    if abs(oneNormFBASolutionUnBounded.v(n))>cutoff
        formula = printRxnFormula(model, model.rxns{n}, 0);
        fprintf('%10g%15s\t%-60s\n',oneNormFBASolutionUnBounded.v(n),model.rxns{n}, formula{1});
    end
end
%% ANTICIPATED RESULTS
% When all reactions are reversible, in a genome-scale model, it should be anticipated 
% to find a stoichiometrically balanced cycle of reactions that admit an arbitrary 
% amount of isolated ATP hydrolysis. It is important nevertheless to realise that 
% these cycles are latent in the network and could become active with inadvertent 
% relaxation of model bounds.
%% REFERENCES
% [1] Feist, Adam M, and Bernhard O Palsson. The Biomass Objective Function. 
% _Current Opinion in Microbiology_, Ecology and industrial microbiology  Special 
% section: Systems biology, 13, no. 3 (June 2010): 34449. doi:10.1016/j.mib.2010.03.003.
% 
% [2] Fleming, R. M. T., C. M. Maes, M. A. Saunders, Y. Ye, and B. . Palsson. 
% A Variational Principle for Computing Nonequilibrium Fluxes and Potentials 
% in Genome-Scale Biochemical Networks. _Journal of Theoretical Biology_ 292 
% (January 7, 2012): 7177. doi:10.1016/j.jtbi.2011.09.029.
% 
% [3] Brunk, Elizabeth, Swagatika Sahoo, Daniel C Zielinski, Ali Altunkaya, 
% Maike Aurich, Nathan Mih, German Andres Preciat Gonzalez, et al. Recon 3D: 
% A Resource Enabling a Three-Dimensional View of Gene Variation in Human Metabolism. 
% _(Submitted)_ 1 (2017).
% 
% [4] Fleming, R.M.T., et al., Cardinality optimisation in constraint-based 
% modelling: illustration with Recon 3D (submitted), 2017.
% 
% [5] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation 
% approaches for sparse optimization. European Journal of Operational Research 
% 244, 2646.
% 
% [6] Duarte, N. C., S. A. Becker, N. Jamshidi, I. Thiele, M. L. Mo, T. D. 
% Vo, R. Srivas, and B. . Palsson. Global Reconstruction of the Human Metabolic 
% Network Based on Genomic and Bibliomic Data. _Proceedings of the National Academy 
% of Sciences of the United States of America_ 104, no. 6 (2007): 177782. doi:10.1073/pnas.0610772104.
% 
%   
% 
% 
% 
% __
##### SOURCE END #####
--></body></html>