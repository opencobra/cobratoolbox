

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Metabotools &mdash; The COBRA Toolbox</title>
  

  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="../../../_static/img/apple-touch-icon.png">
  
  
    <link rel="icon" type="image/png" sizes="32x32" href="../../../_static/img/favicon-32x32.png">
  
  
    <link rel="icon" type="image/png" sizes="16x16" href="../../../_static/img/favicon-16x16.png">
  
  
    <link rel="mask-icon" href="../../../_static/img/safari-pinned-tab.svg" color="#5bbad5">
  
  
    <link rel="manifest" href="../../../_static/json/manifest.json">
  
  
    <meta name="msapplication-config" content="../../../_static/browserconfig.xml">
  
  <meta name="theme-color" content="#ffffff">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="../../../_static/js/jquery.easy-autocomplete.min.js" type="text/javascript" ></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href="../../../_static/css/easy-autocomplete.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/cobra.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="The COBRA Toolbox" href="../../../index.html"/>
        <link rel="up" title="Data integration" href="../index.html"/>
        <link rel="next" title="Transcriptomics" href="../transcriptomics/index.html"/>
        <link rel="prev" title="c13solver" href="../fluxomics/c13solver/index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html">
          

          
            
            <img src="https://prince.lcsb.uni.lu/img/logos/logo.png" class="logo" alt="logo"/>
          
          </a>
          <h1>The COBRA Toolbox</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" id="simple"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <script>
    	var options = {

		url: "../../../_static/json/functions.json",

		getValue: "name",

		list: {
            onKeyEnterEvent: function(item) {
                    return "_static/../" + item.website_url
            },
            maxNumberOfElements: 25,
			match: {
					enabled: true,
			},
            sort: {
			    enabled: true
		    }
		},

    	template: {
	    	type: "custom",
		    method: function(value, item) {
                return "<span><a href='../../../search.html?q=" + item.name + "&check_keywords=yes&area=default'>" + value + "</a>" + "<a href='../../../_static/../" + item.website_url + "' ><img src='../../../_static/link.svg'/></a></span>";
		    }
	    },

		theme: "square"

	};

	$("#simple").easyAutocomplete(options);


    </script>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
              </ul>
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Functions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../analysis/index.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../base/index.html">Base</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Data integration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../chemoInformatics/index.html">ChemoInformatics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fluxomics/index.html">Fluxomics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Metabotools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../transcriptomics/index.html">Transcriptomics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../design/index.html">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reconstruction/index.html">Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/index.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../funding.html">Funding</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The COBRA Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Functions</a> &raquo;</li>
        
          <li><a href="../index.html">Data integration</a> &raquo;</li>
        
      <li>Metabotools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="https://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metabotools">
<span id="id1"></span><h1>Metabotools<a class="headerlink" href="#metabotools" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-src.dataIntegration.metabotools"></span><dl class="function">
<dt id="src.dataIntegration.metabotools.analyzeSingleGeneDeletion">
<code class="descname">analyzeSingleGeneDeletion</code><span class="sig-paren">(</span><em>ResultsAllCellLines</em>, <em>path</em>, <em>samples</em>, <em>cutoff</em>, <em>OverViewResults</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/analyzeSingleGeneDeletion.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.analyzeSingleGeneDeletion" title="Permalink to this definition">¶</a></dt>
<dd><p>This function conducts a single gene deletion analysis and provides
statistcs about the frequency of essential genes, and partial effects and
no effects across the unique set of genes and across the models in
ResultsAllCellLines defined by samples.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[genes, ResultsAllCellLines, OverViewResults] = analyzeSingleGeneDeletion(ResultsAllCellLines, path, samples, cutoff, OverViewResults)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
Structure containing the models (the two models can be the same or pruned and starting model) of the format<ul>
<li>ResultsAllCellLines.samples.modelMin</li>
<li>ResultsAllCellLines.samples.modelPruned</li>
</ul>
</li>
<li><strong>path</strong> &#8211;
Path where picture of heatmap is to be saved</li>
<li><strong>samples</strong> &#8211;
Name of samples</li>
<li><strong>cutoff</strong> &#8211;
Tolerance for small deviation from the optimal value whic his used to distinguish partial effects</li>
</ul>
</div></blockquote>
<p><strong>Optional input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>OverViewResults</strong> &#8211;
Overview of results of the model building and analysis (generated by the function setQuantConstraints)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>genes</strong> &#8211;
Table that lists unique gene, category, number
of &#8216;no effect&#8217;, number of &#8216;KO&#8217;, number of &#8216;partial effect&#8217;, and
number of models where the gene is absent &#8216;gene absent&#8217;</li>
<li><strong>ResultsAllCellLines</strong> &#8211;
Updated structure ResultsAllCellLines.sample.singleGeneDeletion</li>
</ul>
</div></blockquote>
<p><strong>Optional output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>OverViewResults</strong> &#8211;
Updated overview</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.calculateLODs">
<code class="descname">calculateLODs</code><span class="sig-paren">(</span><em>theo_mass</em>, <em>lod_ngmL</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/calculateLODs.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.calculateLODs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function converts detection limits of the unit ng/mL to mM using the
theoretical mass (g/mol) for the metabolites</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[lod_mM] = calculateLODs(theo_mass, lod_ngmL)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>theo_mass</strong> &#8211;
Vector that specifies the theoretical mass (g/mol) of each metabolite</li>
<li><strong>lod_ngmL</strong> &#8211;
Instrumental limit of detection (ng/mL)</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>lod_mM</strong> &#8211;
Detection limits in mM</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.calculateQuantitativeDiffs">
<code class="descname">calculateQuantitativeDiffs</code><span class="sig-paren">(</span><em>data_RXNS</em>, <em>slope_Ratio</em>, <em>ex_RXNS</em>, <em>lod_mM</em>, <em>cond1_uptake</em>, <em>cond2_uptake</em>, <em>cond1_secretion</em>, <em>cond2_secretion</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/calculateQuantitativeDiffs.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.calculateQuantitativeDiffs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function provides sets of exchange reactions with higher uptake and
secretion in condition 1 and condition 2.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[cond1_upt_higher, cond2_upt_higher, cond2_secr_higher, cond1_secr_higher, cond1_uptake_LODs, cond2_uptake_LODs, cond1_secretion_LODs, cond2_secretion_LODs] = calculateQuantitativeDiffs(data_RXNS, slope_Ratio, ex_RXNS, lod_mM, cond1_uptake, cond2_uptake, cond1_secretion, cond2_secretion);</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>data_RXNS</strong> &#8211;
Exchange reactions same order as Input_A and Input_B</li>
<li><strong>slope_Ratio</strong> &#8211;
For length of inputA/B, relative difference</li>
<li><strong>ex_RXNS</strong> &#8211;
Exchange reactions in the same order as LODs(lod_mM)</li>
<li><strong>lod_mM</strong> &#8211;
Detection limits in mM</li>
<li><strong>cond1_uptake</strong> &#8211;
List of exchanges that specify consumed metabolites in condition 1</li>
<li><strong>cond2_uptake</strong> &#8211;
List of exchanges that specify consumed metabolites in condition 2</li>
<li><strong>cond1_secretion</strong> &#8211;
List of exchanges that specify released metabolites in condition 1</li>
<li><strong>cond2_secretion</strong> &#8211;
List of exchanges that specify released metabolites in condition 2</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>cond1_upt_higher</strong> &#8211;
Exchange reactions and relative differences with higher uptake in condition 1 compared to condition 2</li>
<li><strong>cond2_upt_higher</strong> &#8211;
Exchange reactions and relative differences with higher uptake in condition 2 compared to condition 1</li>
<li><strong>cond2_secr_higher</strong> &#8211;
Exchange reactions and relative differences with higher secretion in condition 2 compared to condition 1</li>
<li><strong>cond1_secr_higher</strong> &#8211;
Exchange reactions and relative differences with higher secretion in condition 1 compared to condition 2</li>
<li><strong>cond1_uptake_LODs</strong> &#8211;
Detection limits for metabolites with higher uptake in condition 1</li>
<li><strong>cond2_uptake_LODs</strong> &#8211;
Detection limits for metabolites with higher uptake in condition 2</li>
<li><strong>cond1_secretion_LODs</strong> &#8211;
Detection limits for metabolites with higher secretion in condition 1</li>
<li><strong>cond2_secretion_LODs</strong> &#8211;
Detection limits for metabolites with higher secretion in condition 2</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.checkEffectRxnKO">
<code class="descname">checkEffectRxnKO</code><span class="sig-paren">(</span><em>samples_to_test</em>, <em>fill</em>, <em>Genes_to_test</em>, <em>samples</em>, <em>ResultsAllCellLines</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/checkEffectRxnKO.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.checkEffectRxnKO" title="Permalink to this definition">¶</a></dt>
<dd><p>This function checks the effect of constraining reactions associated
with a single or set of genes on the ability of the model to satisfy
an objective.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[FBA_Rxns_KO, ListResults] = checkEffectRxnKO(samples_to_test, fill, Genes_to_test, samples, ResultsAllCellLines)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
uses <cite>modelMin</cite></li>
<li><strong>samples</strong> &#8211;
Name of samples</li>
<li><strong>samples_to_test</strong> &#8211;
Name of samples that should be tested (can be samples if all should be tested)</li>
<li><strong>fill</strong> &#8211;
Identifier if the <cite>rxns</cite> is not in the model (e.g.,100, num(&#8216;NAN&#8217;))</li>
<li><strong>Genes_to_test</strong> &#8211;
Set of genes to be tested</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>FBA_Rxns_KO</strong> &#8211;
FBA results for constraining one reaction at a time to zero.</li>
<li><strong>ListResults</strong> &#8211;
Reactions associated with <cite>Genes_to_test</cite>, same order as <cite>FBA_Rxns_KO</cite>.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.checkExchangeProfiles">
<code class="descname">checkExchangeProfiles</code><span class="sig-paren">(</span><em>samples</em>, <em>path</em>, <em>nmets</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/checkExchangeProfiles.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.checkExchangeProfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The Function generates a summary of the number of uptake exchanges
and secretion exchanges per samples.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[mapped_exchanges, minMax, mapped_uptake, mapped_secretion] = checkExchangeProfiles(samples, path, nmets)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>samples</strong></li>
<li><strong>path</strong> &#8211;
path to output of make exchangeprofiles</li>
<li><strong>nmets</strong> &#8211;
number of metabolites in data set (max number of uptake or secreted metabolites)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>mapped_exchanges</strong> &#8211;
table listing for each sample the number of uptake and secretion that were mapped to the model</li>
<li><strong>minMax</strong> &#8211;
lists minimal and maximal number of uptakes, secretions, and total number of exchanges</li>
<li><strong>mapped_uptake</strong> &#8211;
table summarizing for each sample the uptake exchange reactions</li>
<li><strong>mapped_secretion</strong> &#8211;
table summarizing for each sample the secretion exchange reactions</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.computeFluxSplits">
<code class="descname">computeFluxSplits</code><span class="sig-paren">(</span><em>model</em>, <em>mets</em>, <em>V</em>, <em>coeffSign</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/computeFluxSplits.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.computeFluxSplits" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute relative contributions of fluxes (<cite>V</cite>) to the net production (<cite>P</cite>)
and consumption (<cite>C</cite>) of a set of metabolites (<cite>mets</cite>)</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[P, C, vP, vC, s] = computeFluxSplits(model, mets, V, 0);</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
a COBRA model structure with required fields<ul>
<li>.S:        the <cite>m</cite> x <cite>n</cite> stoichiometric matrix</li>
<li>.mets:     an <cite>m</cite> x <cite>1</cite> cell array of metabolite identifiers</li>
</ul>
</li>
<li><strong>mets</strong> &#8211;
a list of metabolite identifiers from model.mets</li>
<li><strong>V</strong> &#8211;
an <cite>n</cite> x <cite>k</cite> matrix of <cite>k</cite> flux distributions</li>
</ul>
</div></blockquote>
<p><strong>Optional input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>coeffSign</strong> &#8211;
only use the sign of the stoichiometric coefficient
(i.e. +1 or -1, Default = false)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>P</strong> &#8211;
an <cite>n</cite> x <cite>k</cite> matrix of relative contributions to the production of mets</li>
<li><strong>C</strong> &#8211;
an <cite>n</cite> x <cite>k</cite> matrix of relative contributions to the consumption of mets</li>
<li><strong>vP</strong> &#8211;
an <cite>n</cite> x <cite>k</cite> matrix of net producing fluxes</li>
<li><strong>vC</strong> &#8211;
an <cite>n</cite> x <cite>k</cite> matrix of net consuming fluxes</li>
<li><strong>s</strong> &#8211;
net stoichiometry of reactions containing metabolites</li>
</ul>
</div></blockquote>
<p>Example: [P,C,vP,vC,s] = computeFluxSplits(model,mets,V,1);</p>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.conc2Rate">
<code class="descname">conc2Rate</code><span class="sig-paren">(</span><em>metConc</em>, <em>cellConc</em>, <em>t</em>, <em>cellWeight</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/conc2Rate.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.conc2Rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts metabolite concentration and (viable) cell concentration into
uptake rate.
CellConc consumed MetConc in t.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[flux] = conc2Rate(metConc, cellConc, t, cellWeight)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>metConc</strong> &#8211;
Change in metabolite concentration (mM)</li>
<li><strong>cellConc</strong> &#8211;
Cell concentration (cells per 1 ml)</li>
<li><strong>t</strong> &#8211;
Time in hours</li>
<li><strong>cellWeight</strong> &#8211;
gDW per cell</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>flux</strong> &#8211;
mmol/gDW/hr</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.defineUptakeSecretionProfiles">
<code class="descname">defineUptakeSecretionProfiles</code><span class="sig-paren">(</span><em>input_A</em>, <em>input_B</em>, <em>data_RXNS</em>, <em>tol</em>, <em>essAA_excl</em>, <em>exclude_upt</em>, <em>exclude_secr</em>, <em>add_secr</em>, <em>add_upt</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/defineUptakeSecretionProfiles.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.defineUptakeSecretionProfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculated the slope ratios and gives out uptake&amp;secretion profiles for condition 1 and condition 2</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[cond1_uptake, cond2_uptake, cond1_secretion, cond2_secretion, slope_Ratio] = defineUptakeSecretionProfiles(input_A, input_B, data_RXNS, tol, essAA_excl, exclude_upt, exclude_secr, add_secr, add_upt)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>input_A</strong> &#8211;
Matrix, 4 columns<ol class="arabic">
<li>Control TP1,</li>
<li>Control TP2,</li>
<li>Condition 1 TP1,</li>
<li>Condition 1 TP 2</li>
</ol>
</li>
<li><strong>input_B</strong> &#8211;
Matrix, 4 columns<ol class="arabic">
<li>Control2 TP1,</li>
<li>Control2 TP2,</li>
<li>Condition 2 TP1,</li>
<li>Condition 2 TP 2</li>
</ol>
</li>
<li><strong>data_RXNS</strong> &#8211;
Exchange reactions same order as <cite>input_A</cite> and <cite>input_B</cite></li>
<li><strong>tol</strong> &#8211;
minimal threshold to call uptake or secretion (Default 0.05)=5%</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>essAA_excl</strong> &#8211;
If essential amino acids should be excluded from the secretion profile 1(yes), or 0(no) (Default = 0);
<cite>essAAs</cite> = {<cite>EX_his_L(e)</cite>; <cite>EX_ile_L(e)</cite>; <cite>EX_leu_L(e)</cite>; <cite>EX_lys_L(e)</cite>; <cite>EX_met_L(e)</cite>; <cite>EX_phe_L(e)</cite>; <cite>EX_thr_L(e)</cite>; <cite>EX_trp_L(e)</cite>; <cite>EX_val_L(e)</cite>}</li>
<li><strong>exclude_upt</strong> &#8211;
Exclude uncertain metabolites from uptake (e.g., metabolites from GlutaMax, e.g., <cite>EX_gln_L(e)</cite>, <cite>EX_cys_L(e)</cite>, <cite>EX_ala_L(e)</cite>)</li>
<li><strong>exclude_secr</strong> &#8211;
Exclude uncertain metabolites from secretion (e.g., metabolites from GlutaMax, e.g., <cite>EX_gln_L(e)</cite>, <cite>EX_cys_L(e)</cite>, <cite>EX_ala_L(e)</cite>)</li>
<li><strong>add_secr</strong> &#8211;
Due to mising data points automatic analysis might do wrong assignment of metabolites to secretion</li>
<li><strong>add_upt</strong> &#8211;
Due to mising data points automatic analysis might do wrong assignment of metabolites to uptake</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>cond1_uptake</strong> &#8211;
List of exchanges that specify consumed metabolites in condition 1</li>
<li><strong>cond2_uptake</strong> &#8211;
List of exchanges that specify consumed metabolites in condition 2</li>
<li><strong>cond1_secretion</strong> &#8211;
List of exchanges that specify released metabolites in condition 1</li>
<li><strong>cond2_secretion</strong> &#8211;
List of exchanges that specify released metabolites in condition 2</li>
<li><strong>slope_Ratio</strong> &#8211;
For length of inputA/B, relative difference</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.extractConditionSpecificModel">
<code class="descname">extractConditionSpecificModel</code><span class="sig-paren">(</span><em>model</em>, <em>theshold</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/extractConditionSpecificModel.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.extractConditionSpecificModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The function prunes a subnetwork based on a user-defined threshold. The subnetwork does not contain blocked reactions. Please note that Recon has blocked reactions which will always be removed. Thus, not all reactions are removed as a consequence of the data integration.
Depends on fastFVA, fluxVariability analysis</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelPruned] = extractConditionSpecificModel(model, theshold)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Global metabolic model (Recon) - constrained</li>
<li><strong>theshold</strong> &#8211;
Fluxes below the threshold will be considered zero and respective reactions as blocked, e.g., 10e-6.</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelPruned</strong> &#8211;
submodel without blocked reactions</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.findMinCardModel">
<code class="descname">findMinCardModel</code><span class="sig-paren">(</span><em>model</em>, <em>Ex_Rxns</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/findMinCardModel.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.findMinCardModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to find the minimal cardinality model.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelMin, AddedExchange] = findMinCardModel(model, Ex_Rxns)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Metabolic model</li>
<li><strong>Ex_Rxns</strong> &#8211;
Vector of exchange reactions for FVA</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelMin</strong> &#8211;
Updated model with new reaction bounds</li>
<li><strong>AddedExchange</strong> &#8211;
Vector of exchanged reactions</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.findOptExchRxns">
<code class="descname">findOptExchRxns</code><span class="sig-paren">(</span><em>model</em>, <em>Ex_Rxns</em>, <em>parFVA</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/findOptExchRxns.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.findOptExchRxns" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Usage</strong></p>
<blockquote>
<div>[OptExchRxns] = findOptExchRxns(model, Ex_Rxns, parFVA)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Metabolic model</li>
<li><strong>Ex_Rxns</strong> &#8211;
Vector of exchange reactions for FVA</li>
<li><strong>fastFVA</strong> &#8211;
use FastFVA (default=0)</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>OptExchRxns</strong></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.generateCompactExchModel">
<code class="descname">generateCompactExchModel</code><span class="sig-paren">(</span><em>model</em>, <em>minGrowth</em>, <em>biomassRxn</em>, <em>prune</em>, <em>fastFVA</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/generateCompactExchModel.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.generateCompactExchModel" title="Permalink to this definition">¶</a></dt>
<dd><p>This function identifies a subnetwork with the least number of possible exchange
reactions given the model and the applied constraints. It returns the resulting pruned model.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelMin, modelPruned, Ex_Rxns] = generateCompactExchModel(model, minGrowth, biomassRxn, prune, fastFVA)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
model structure</li>
<li><strong>minGrowth</strong> &#8211;
minimal Growth rate to be set on biomass reaction</li>
<li><strong>biomassRxn</strong> &#8211;
biomass reaction name (default: &#8216;biomass_reaction2&#8217;)</li>
<li><strong>prune</strong> &#8211;
optional: to prune the model based on exchange reactions
(default: 1)</li>
<li><strong>fastFVA</strong> &#8211;
optional: to use fastFVA instead of fluxvariability for
computing FVA results (default: 0)</li>
<li><strong>medium</strong> &#8211;
(default: {})</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelUpdated</strong> &#8211;
same as input model but constraints on blocked reactions
are set to be 0</li>
<li><strong>modelPruned</strong> &#8211;
pruned model, where all blocked reactions are removed
(attention this seems to cause issues with GPRs)</li>
<li><strong>Ex_Rxns</strong> &#8211;
List of exchange reactions in pruned model</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.illustrate_ppp">
<code class="descname">illustrate_ppp</code><span class="sig-paren">(</span><em>ResultsAllCellLines</em>, <em>mets</em>, <em>path</em>, <em>samples</em>, <em>label</em>, <em>fonts</em>, <em>tol</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/illustrate_ppp.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.illustrate_ppp" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates and saves heatmaps for the results of the function
performPPP for all sample models.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>illustrate_ppp(ResultsAllCellLines, mets, path, samples, label, fonts, tol)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
Result structure</li>
<li><strong>mets</strong> &#8211;
Metabolites that were tested in the phase plane analysis</li>
<li><strong>step_size</strong> &#8211;
Step size of each metabololite tested</li>
<li><strong>path</strong> &#8211;
Path where output is saved</li>
<li><strong>samples</strong> &#8211;
Names of conditions</li>
<li><strong>label</strong> &#8211;
Defining label of X-axis, y-axis and z-axis, e.g., {<cite>Glucose uptake (fmol/cell/hr)</cite>; <cite>Oxygen uptake
(fmol/cell/hr)</cite>; <cite>Growth rate (hr-1)</cite>} The z-axis is the growth rate which is color coded</li>
<li><strong>fonts</strong> &#8211;
Font size for labels on heatmap</li>
<li><strong>tol</strong> &#8211;
Fluxes are considered zero if they are below the tol</li>
</ul>
</div></blockquote>
<p>Individual pdf files showing the result of the PPP are being saved automatically for each condition.</p>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.integrateGeneExpressionData">
<code class="descname">integrateGeneExpressionData</code><span class="sig-paren">(</span><em>model</em>, <em>dataGenes</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/integrateGeneExpressionData.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.integrateGeneExpressionData" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sets constrains based on sets of absent genes. It does not test for the functionality of the model, to maintain full control over
the model generation process. Alternatively, the COBRA function <cite>createTissueSpecificModel</cite> can be used, and which can produce a functional model.
See the supplemental tutorial of <em>DOI:10.1371/journal.pone.0049978 (Aurich and Thiele, PloS One, 2012)</em> for description on potentially necessary curation when using this crude method of data integration.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelGE] = integrateGeneExpressionData(model, dataGenes)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Metabolic model (e.g., Recon)</li>
<li><strong>dataGenes</strong> &#8211;
Vector of absent genes. Follow the supplemental tutorial of <em>DOI: 10.1371/journal.pone.0049978 (Aurich and Thiele, PloS One, 2012)</em> for the generation of P/A calls, e.g., <cite>Absent_genes</cite> = [535;1548];</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelGE</strong> &#8211;
Model, where all genes in <cite>DataGenes</cite> have been constrained to zero. Follow the supplemental tutorial of
<em>DOI:10.1371/journal.pone.0049978 (Aurich and Thiele, PloS One, 2012)</em> for description of potentially necessary curation.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.make3Dplot">
<code class="descname">make3Dplot</code><span class="sig-paren">(</span><em>PHs</em>, <em>maximum_contributing_flux</em>, <em>fonts</em>, <em>path</em>, <em>diff_view</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/make3Dplot.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.make3Dplot" title="Permalink to this definition">¶</a></dt>
<dd><p>The function allows illustration on different phenotypes predicted in
MetTB onto the 3D illustration plot. The phenotypes are defined as
colors, the location of the points is based on the ATP flux predicted by the
function <cite>predictFluxSplits</cite>.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>make3Dplot(PHs, maximum_contributing_flux, fonts, path, diff_view)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>PHs</strong> &#8211;
Phenotypes = [samples PHENOTYPE], is generated from different functions (<cite>predictFluxSplits</cite>,...)</li>
<li><strong>maximum_contributing_flux</strong> &#8211;
Output of the function <cite>predictFluxSplits</cite>, option ATP.</li>
<li><strong>fonts</strong> &#8211;
Font size</li>
<li><strong>path</strong> &#8211;
Path to save output</li>
<li><strong>diff_view</strong> &#8211;
Next to the standard view, print graphic from 3 different(2D) viewpoints (default = 0/off)</li>
</ul>
</div></blockquote>
<p>PDFs are automatically saved to the user-defined path</p>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.makeSummaryModels">
<code class="descname">makeSummaryModels</code><span class="sig-paren">(</span><em>ResultsAllCellLines</em>, <em>samples</em>, <em>model</em>, <em>mk_union</em>, <em>mk_intersect</em>, <em>mk_reactionDiff</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/makeSummaryModels.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.makeSummaryModels" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates the union and the intersect model from the <cite>modelPruned</cite> in the <cite>ResultsAllCellLines</cite> structure.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[unionModel, intersectModel, diffRxns, diffExRxns] = makeSummaryModels(ResultsAllCellLines, samples, model, mk_union, mk_intersect, mk_reactionDiff)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
structure containing samples and models for the samples, e.g.,  <cite>ResultsAllCellLines.UACC_257.modelPruned</cite></li>
<li><strong>samples</strong> &#8211;
conditions or cell lines, e.g., UACC_257</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>mk_union</strong> &#8211;
make union model, yes=1, no=0 (Default = 1)</li>
<li><strong>mk_intersect</strong> &#8211;
make intersect model, yes=1, no=0 (Default = 1)</li>
<li><strong>mk_reactionDiff</strong> &#8211;
make reactionDiff, yes=1, no=0 (can only be 1 if union and intersect are 1 or []) (Default = 1).</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>unionModel</strong> &#8211;
model containing all reactions appearing at least once in the models in the <cite>ResultsAllCellLines.sample.modelPruned</cite></li>
<li><strong>intersectModel</strong> &#8211;
model containing all reactions shared by all models in the <cite>ResultsAllCellLines.sample.modelPruned</cite></li>
<li><strong>diffRxns</strong> &#8211;
all differential reactions that distinguish <cite>unionModel</cite> and <cite>intersectModel</cite></li>
<li><strong>diffExRxns</strong> &#8211;
all differential exchange reactions that distinguish <cite>unionModel</cite> and <cite>intersectModel</cite></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.mkTableOfAddedExchanges">
<code class="descname">mkTableOfAddedExchanges</code><span class="sig-paren">(</span><em>ResultsAllCellLines</em>, <em>samples</em>, <em>Ex_added_all_unique</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/mkTableOfAddedExchanges.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.mkTableOfAddedExchanges" title="Permalink to this definition">¶</a></dt>
<dd><p>The function generates a table of the added exchanges defined by the
function <cite>generateCompactExchModel</cite> called by the function <cite>setQuantConstraints</cite>.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[Added_all] = mkTableOfAddedExchanges(ResultsAllCellLines, samples, Ex_added_all_unique)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong></li>
<li><strong>samples</strong></li>
<li><strong>Ex_added_all_unique</strong> &#8211;
Output of the function <cite>statisticsAddedExchanges</cite></li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>Added_all</strong> &#8211;
Table overview of all added Exchanges for each sample</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.networkTopology">
<code class="descname">networkTopology</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/networkTopology.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.networkTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Analysis of the metabolite connectivity of a metabolic model</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[MetConn, RxnLength] = NetworkTopology(model)</div></blockquote>
<p><strong>Input</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Model structure</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>MetConn</strong> &#8211;
Vector of metabolite connectivity (how many reactions a metabolite participates in (in same order as model.mets)</li>
<li><strong>RxnLength</strong> &#8211;
Vector of reaction participation, i.e., how many metabolites per reaction (in same order as <cite>mode.rxns</cite>)</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.performPPP">
<code class="descname">performPPP</code><span class="sig-paren">(</span><em>ResultsAllCellLines</em>, <em>mets</em>, <em>step_size</em>, <em>samples</em>, <em>step_num</em>, <em>direct</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/performPPP.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.performPPP" title="Permalink to this definition">¶</a></dt>
<dd><p>This function performs the a phase plane analysis. The analysis starts from zero and proceed <cite>step_num*step_size</cite> in the specified direction and for two exchanges.
the results of the analysis will be saved into <cite>ResultsAllCellLines</cite>.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[ResultsAllCellLines] = performPPP(ResultsAllCellLines, mets, step_size, samples, step_num, direct)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong></li>
<li><strong>samples</strong> &#8211;
Conditions</li>
<li><strong>mets</strong> &#8211;
Set of two metabolites to test e.g.  mets ={<cite>EX_glc(e)</cite>, <cite>EX_gln(e)</cite>; <cite>EX_o2(e)</cite>, <cite>EX_o2(e)</cite>}</li>
<li><strong>step_size</strong> &#8211;
Step size for metabolites specified in mets e.g., <cite>step_size</cite> = 100</li>
<li><strong>direct</strong> &#8211;
Direction for metabolites specified in mets: uptake (-1) or secretion (1), e.g., direct = [-1,-1,-1,-1];</li>
<li><strong>step_num</strong> &#8211;
Number of steps (1000/20 = 50), step_num = [5,5;5,5]</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
The matrix of growth rates are added to the <cite>ResultsAllCellLines</cite> structure alond with the values or the bounds using the same of the manipulated exchanges</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.performSampling">
<code class="descname">performSampling</code><span class="sig-paren">(</span><em>model</em>, <em>warmupn</em>, <em>fileName</em>, <em>nFiles</em>, <em>pointsPerFile</em>, <em>stepsPerPoint</em>, <em>fileBaseNo</em>, <em>maxTime</em>, <em>path</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/performSampling.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.performSampling" title="Permalink to this definition">¶</a></dt>
<dd><p>The function performs the sampling analysis for one model, combines
multiple COBRA toolbox functions</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>performSampling(model, warmupn, fileName, nFiles, pointsPerFile, stepsPerPoint, fileBaseNo, maxTime, path)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Model to be sampled</li>
<li><strong>warmupn</strong> &#8211;
Number of warm-up points</li>
<li><strong>fileName</strong> &#8211;
Name for output files</li>
<li><strong>nFiles</strong> &#8211;
Number of files saved</li>
<li><strong>pointsPerFilePoints</strong> &#8211;
Points saved per file</li>
<li><strong>stepsPerPoint</strong> &#8211;
Steps skipped between two saved points, in order to increase mixing</li>
<li><strong>fileBaseNo</strong> &#8211;
Counter for the numbering of the output files, e.g., 0 to start with 1;</li>
<li><strong>maxTime</strong> &#8211;
Maximal running time after which the analysis should be terminated, e.g., 3600000;</li>
<li><strong>path</strong> &#8211;
Path to file</li>
</ul>
</div></blockquote>
<p>Automatically saved to path using specified file name</p>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.predictFluxSplits">
<code class="descname">predictFluxSplits</code><span class="sig-paren">(</span><em>model</em>, <em>obj</em>, <em>met2test</em>, <em>samples</em>, <em>ResultsAllCellLines</em>, <em>dir</em>, <em>transportRxns</em>, <em>ATPprod</em>, <em>carbon_source</em>, <em>eucNorm</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/predictFluxSplits.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.predictFluxSplits" title="Permalink to this definition">¶</a></dt>
<dd><p>This function performs the flux splits analysis for the metabolites of
interest, meaning it predicts the fraction of metabolite produced (or
consumed) based all reactions producing (or consuming) the metabolite</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[BMall, ResultsAllCellLines, metRsall, maximum_contributing_rxn, maximum_contributing_flux, ATPyield] = predictFluxSplits(model, obj, met2test, samples, ResultsAllCellLines, dir, transportRxns, ATPprod, carbon_source, eucNorm)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Generic model, e.g., <cite>modelMedium</cite></li>
<li><strong>obj</strong> &#8211;
objective function, e.g., biomass or ATPM</li>
<li><strong>met2test</strong> &#8211;
e.g., <cite>atp[c]</cite>. Mind that the metabolites are produced in multiple compartments.</li>
<li><strong>samples</strong> &#8211;
Name of conditions as in <cite>ResultsAllCellLines</cite></li>
<li><strong>ResultsAllCellLines</strong> &#8211;
Structure containing the pruned submodels of the samples</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>dir</strong> &#8211;
Production = 1 (default = production), else consumption = 0</li>
<li><strong>eucNorm</strong> &#8211;
Default: 1e-6</li>
<li><strong>transportRxns</strong> &#8211;
Vector of reactions that do not really produce or consume the metabolite, e.g., reactions that transport ATP from one compartment to the other. This input is optional only to allow the initial prediction of all producing reactions to define the exclude reaction set.</li>
<li><strong>carbon_source</strong> &#8211;
Reference uptake for calculation of ATP yield, e.g.,{<cite>EX_glc(e)</cite>}.</li>
<li><strong>ATPprod</strong></li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>BMall</strong> &#8211;
Matrix of flux vectors used for calculations</li>
<li><strong>ResultsAllCellLines</strong> &#8211;
Structure containing results of run analysis</li>
<li><strong>metRsall</strong> &#8211;
Matrix of flux (producing or consuming) a defined metabolite</li>
<li><strong>maximum_contributing_rxn</strong> &#8211;
Reactions with highest flux (producing or
consuming) a defined metabolite across analyzed samples (not
necessarily &gt;50%), if multiple reactions have the same contribution, all will be reported seperated by a back slash.</li>
<li><strong>maximum_contributing_flux</strong> &#8211;
Matrix containing:<ul>
<li>highest flux (column 1),</li>
<li>sum of flux (producing or consuming) a defined metabolite (column 2),</li>
<li>percentage (column 3),</li>
<li>contribution of glycolysis (column 4),</li>
<li>contribution of ETC (column 5),</li>
<li>combined contribution of glycolysis and ETC (column 6),</li>
<li>contribution of TCA (column 7),</li>
<li>combined contribution of glycolysis, ETC, and TCA (column 8).</li>
</ul>
</li>
<li><strong>ATPyield</strong> &#8211;
ATP yield calculated from the sum of ATP production divided by the predicted uptake flux of the metabolite specified as carbon_source.
No extra constraints are applied, thus not only production  flux from the specified carbon source is considered.</li>
</ul>
</div></blockquote>
<p><strong>Example</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="k">if</span> <span class="n">met2test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">atp</span> <span class="n">to</span> <span class="n">reduce</span> <span class="n">number</span> <span class="n">of</span> <span class="n">useless</span> <span class="n">outputs</span>
<span class="p">[</span><span class="n">BMall</span><span class="p">,</span> <span class="n">ResultsAllCellLines</span><span class="p">,</span> <span class="n">metRsall</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictFluxSplits</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">met2test</span><span class="p">,</span><span class="n">samples</span><span class="p">,</span><span class="n">ResultsAllCellLines</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">eucNorm</span><span class="p">,</span> <span class="n">transportRxns</span><span class="p">,</span> <span class="n">ATPprod</span><span class="p">,</span> <span class="n">carbon_source</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.prepIntegrationQuant">
<code class="descname">prepIntegrationQuant</code><span class="sig-paren">(</span><em>model</em>, <em>metData</em>, <em>exchanges</em>, <em>samples</em>, <em>test_max</em>, <em>test_min</em>, <em>outputPath</em>, <em>tol</em>, <em>variation</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/prepIntegrationQuant.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.prepIntegrationQuant" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates individual uptake and secretion profiles from a
data matrix (fluxes) with samples as columns and metabolites as rows.
Negative values are interpreted as uptake and positive values are
interpreted as secretion. The function tests based on the input model if
uptake and secretion of all &#8216;Exchanges&#8217; is possible. Subsequently, it
removes from each sample the metabolite uptakes or secretions that cannot
be realized by the model due to missing production or degradation
pathways, or blocked reactions. If only secretion is not possible, only
secretion is eliminated from the sample profile whereas uptake will still
be mapped.
The individual uptake and secretion profile for each sample is saved to
the location specified in outputPath using the unique sample name.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>prepIntegrationQuant(model, metData, exchanges, samples, test_max, test_min, outputPath, tol, variation)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Prepared global model (e.g., <cite>model_for_CORE</cite> from <cite>prepModel</cite>)</li>
<li><strong>exchanges</strong> &#8211;
Vector containing exchange reactions</li>
<li><strong>metData</strong> &#8211;
Fluxes of uptake (negative) and secretion(positive) flux values. The columns are the samples and the rows are the metabolites (Unit matching remaining model constraints!).</li>
<li><strong>samples</strong> &#8211;
Vector of sample names (no dublicate names)</li>
<li><strong>test_max</strong> &#8211;
Maximal uptake/secretion set while testing if model can perform uptake and secretion of a metabolite (e.g., 500)</li>
<li><strong>test_min</strong> &#8211;
Minimal uptake/secretion set while testing if model can perform uptake and secretion of a metabolite (e.g., 0.00001)</li>
<li><strong>outputPath</strong> &#8211;
Path where output files should be saved (e.g. &#8216;Y:StudiesData_integrationCOREusingRecon1models&#8217;)</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>tol</strong> &#8211;
All fluxes below this value are considered to be zero, (e.g., 1e-6)</li>
<li><strong>variation</strong> &#8211;
Lower and upper bound are established with this value as error range in % (e.g.,20)</li>
</ul>
</div></blockquote>
<p>For every sample a file is automatically saved and contains the following variables:</p>
<blockquote>
<div><ul class="simple">
<li>Secretion_not_possible:  Vector of metabolite (exchange reactions) that cannot be secreted by the model</li>
<li>Uptake_not_possible:     Vector of metabolite (exchange reactions) that cannot be uptaken by the model</li>
<li>FBA_all_secreted:        FBA results of test metabolite secretion</li>
<li>FBA_all_secreted_names:  Name of exchange test metabolite secretion</li>
<li>FBA_all_uptake:          FBA results of test metabolite uptake</li>
<li>FBA_all_uptake_names:    Name of exchange test metabolite uptake</li>
<li>uptake:                  Vector of exchange reactions that are associated with uptake in the cell line (no additional exchanges, since these reactions will not be closed)</li>
<li>uptake_value:            Matrix of flux values, constitute the lower (column 2) and upper (column 3) limits for the model uptake</li>
<li>secretion:               Vector of exchange reactions that are associated with secretion in the cell line (no additional exchanges, since these reactions will not be closed)</li>
<li>secr_value:              Matrix of flux values, constitute the lower (column 2) and upper (column 3) limits for the model secretion</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.pruneModel">
<code class="descname">pruneModel</code><span class="sig-paren">(</span><em>model</em>, <em>minGrowth</em>, <em>biomassRxn</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/pruneModel.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.pruneModel" title="Permalink to this definition">¶</a></dt>
<dd><p>This function prunes a model to its most compact subnetwork given some model
constraints and a minimal growth rate by identifying and removing all blocked reactions.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelUpdated, modelPruned, Ex_Rxns] = pruneModel(model, minGrowth, biomassRxn)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
model structure</li>
<li><strong>minGrowth</strong> &#8211;
minimal Growth rate to be set on biomass reaction</li>
<li><strong>biomassRxn</strong> &#8211;
biomass reaction name (default: &#8216;biomass_reaction2&#8217;)</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelUpdated</strong> &#8211;
same as input model but constraints on blocked reactions
are set to be 0</li>
<li><strong>modelPruned</strong> &#8211;
pruned model, where all blocked reactions are removed
(attention this seems to cause issues with GPRs)</li>
<li><strong>Ex_Rxns</strong> &#8211;
List of exchange reactions in pruned model</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.setConstraintsOnBiomassReaction">
<code class="descname">setConstraintsOnBiomassReaction</code><span class="sig-paren">(</span><em>model</em>, <em>of</em>, <em>dT</em>, <em>tolerance</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/setConstraintsOnBiomassReaction.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.setConstraintsOnBiomassReaction" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sets constrains biomass objective function in the model accoring to the condition specific doubling time.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelBM] = setConstraintsOnBiomassReaction(model, of, dT, tolerance)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Metabolic model (e.g., Recon)</li>
<li><strong>of</strong> &#8211;
Objective funtion, e.g., <cite>biomass_reaction</cite></li>
<li><strong>dT</strong> &#8211;
Doubling time</li>
<li><strong>tolerance</strong> &#8211;
Upper and lower limit of the growth rate are adjusted according to this tolerance value, e.g., 20 (%).</li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelBM</strong> &#8211;
Model constrained with condition-specific growth rates</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.setMediumConstraints">
<code class="descname">setMediumConstraints</code><span class="sig-paren">(</span><em>model</em>, <em>set_inf</em>, <em>current_inf</em>, <em>medium_composition</em>, <em>met_Conc_mM</em>, <em>cellConc</em>, <em>t</em>, <em>cellWeight</em>, <em>mediumCompounds</em>, <em>mediumCompounds_lb</em>, <em>customizedConstraints</em>, <em>customizedConstraints_ub</em>, <em>customizedConstraints_lb</em>, <em>close_exchanges</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/setMediumConstraints.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.setMediumConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates and sets constraints according to fresh medium composition in mM. Is based on the function <cite>Conc2Rate</cite>. Returns a model with constraints.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelMedium, basisMedium] = setMediumConstraints(model, set_inf, current_inf, medium_composition, met_Conc_mM, cellConc, t, cellWeight, mediumCompounds, mediumCompounds_lb, customizedConstraints, customizedConstraints_ub, customizedConstraints_lb, close_exchanges)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Metabolic model (Recon)</li>
<li><strong>current_inf</strong> &#8211;
Models can have differently defined infinite constraints, e.g., 500</li>
<li><strong>set_inf</strong> &#8211;
New value for infinite constraints, e.g., 1000</li>
<li><strong>medium_composition</strong> &#8211;
Vector of exchange reactions of metabolites in the cell medium, e.g., RPMI medium</li>
<li><strong>met_Conc_mM</strong> &#8211;
Vector of the same length of &#8216;Exchanges&#8217;, providing the concentration (in mM) of each metabolite in the respective row</li>
<li><strong>cellConc</strong> &#8211;
Cell concentration (cells per 1 ml)</li>
<li><strong>t</strong> &#8211;
Time in hours</li>
<li><strong>cellWeight</strong> &#8211;
Cellular dry weight</li>
<li><strong>mediumCompounds</strong> &#8211;
Composition of basic medium, which are usually not defined in the composition of the medium and need to be defined in addition.</li>
<li><strong>mediumCompounds_lb</strong> &#8211;
Lower bound applied for all mediumCompounds (the same for all)</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>customizedConstraints</strong> &#8211;
If additional constraints should be set apart from the basic medium and medium composition, e.g. <cite>EX_o2(e)</cite></li>
<li><strong>customizedConstraints_lb</strong> &#8211;
Vecor of lower bounds to be set (mmol/gDW/hr), must be of same length as customizedConstraints</li>
<li><strong>customizedConstraints_ub</strong> &#8211;
Vecor of upper bounds to be set (mmol/gDW/hr), must be of same length as customizedConstraints</li>
<li><strong>close_exchanges</strong> &#8211;
If exchange reactions except those specified should be closed (Default = 1) 1= close exchanges, 0=no</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelMedium</strong> &#8211;
Model with set constraints, all exchanges not specified in  mediumCompounds, ions or customizedConstraints are set to secretion only</li>
<li><strong>basisMedium</strong> &#8211;
Vector of adjusted constraints, for reference such that these constraints are not overwritten at a later stage</li>
</ul>
</div></blockquote>
<p>Please note that if metabolites of <cite>medium_composition</cite> and <cite>mediumCompounds</cite> overlap, the constraints of the <cite>Medium_composition</cite> will
be set to 0 in the output model. The function depends on the functions <cite>conc2Rate</cite>, <cite>changeRxnBounds</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.setQualitativeConstraints">
<code class="descname">setQualitativeConstraints</code><span class="sig-paren">(</span><em>model</em>, <em>cond_uptake</em>, <em>cond_uptake_LODs</em>, <em>cond_secretion</em>, <em>cond_secretion_LODs</em>, <em>cellConc</em>, <em>t</em>, <em>cellWeight</em>, <em>ambiguous_metabolites</em>, <em>basisMedium</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/setQualitativeConstraints.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.setQualitativeConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sets qualitative constraints (by enforcing minimal uptake or secretion based on individual detection limits), e.g., based on the uptake and secretion
profile of metabolites measured through mass-spectrometry. Uptake is only possible if the lower bound has been set to a value &gt;0 using <cite>setMediumConstraints</cite>
The minimal allowable uptake and secretion flux is defined by enforcing uptake at or above the limit of detection (mass-spectrometry). If these values are not available, a very small value, e.g., 1.0E-06 can be used. Note that this
value has to be below the concentrations defined in the medium. Otherwise the model will be infeasible. Alternatively to the LODs a small value can
be used (e.g., 0.00001). Note that the value has to be above the threshold later called zero.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelLOD] = setQualitativeConstraints(model, cond_uptake, cond_uptake_LODs, cond_secretion, cond_secretion_LODs, cellConc, t, cellWeight, ambiguous_metabolites, basisMedium)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Metabolic model (Recon), with set constraints (output of <cite>setMediumConstraints</cite>)</li>
<li><strong>cond_uptake</strong> &#8211;
Vector of exchanges of metabolites consumed by the cells in the experiment</li>
<li><strong>cond_uptake_LODs</strong> &#8211;
Vector of detection limits (LOD in Mm) for the compounds and in the experiment</li>
<li><strong>cond_secretion</strong> &#8211;
Vector of metabolite exchanges consumed by the cells in the experiment</li>
<li><strong>cond_secretion_LODs</strong> &#8211;
Vector of detection limits (LOD in Mm) for the compounds and in the experiment</li>
<li><strong>cellConc</strong> &#8211;
Cell concentration (cells per 1 ml)</li>
<li><strong>t</strong> &#8211;
Time in hours</li>
<li><strong>cellWeight</strong> &#8211;
gDW per cell</li>
<li><strong>ambiguous_metabolites</strong> &#8211;
Since all exchanges, except the ones specified in <cite>uptake</cite> and <cite>secretion</cite> are closed in <cite>modelLOD</cite>, this input
variable allows to specify metabolite exchanges that should remain open.
Thus, if these exchanges are open in the starting model they can be uptaken
or secreted by the <cite>modelLOD</cite>, e.g., <cite>ambiguous_metabolites</cite>
This can for example be the case if it is suspected that an uptake or secretion might have taken place in concentrations below the
detection limit.</li>
<li><strong>basisMedium</strong> &#8211;
Vector defining the metabolite exchanges of the basic medium, i.e., <cite>ions</cite>, <cite>mediumCompounds</cite></li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelLOD</strong> &#8211;
Model that is constrained qualitatively to the condition-specific uptake and secretion profile</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.setQuantConstraints">
<code class="descname">setQuantConstraints</code><span class="sig-paren">(</span><em>model</em>, <em>samples</em>, <em>tol</em>, <em>minGrowth</em>, <em>obj</em>, <em>no_secretion</em>, <em>no_uptake</em>, <em>medium</em>, <em>addExtraExch</em>, <em>addExtraExch_value</em>, <em>path</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/setQuantConstraints.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.setQuantConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes a model and quantitative extracellular metabolomic data and returns a model in which the data is integrated as constraints described
in &#8220;MetaboTools: A Comprehensive Toolbox for Analysis of Genome-Scale Metabolic Models&#8221;, 2016, Front. Physiol., and the supplemental data &#8220;Tutorial II: Workflow for the integration
of quantitative extracellular metabolomic data into the network context.&#8221; (Data Sheet 3.pdf)</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[ResultsAllCellLines, OverViewResults] = setQuantConstraints(model, samples, tol, minGrowth, obj, no_secretion, no_uptake, medium, addExtraExch, addExtraExch_value, path, epsilon)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>model</strong> &#8211;
Global metabolic model (Recon)</li>
<li><strong>samples</strong> &#8211;
Vector specifying the samples used (there must be an output file of function .... for each sample)</li>
<li><strong>tol</strong> &#8211;
Cutoff value for small numbers (e.g., -1e-8). All number smaller than tol will be treated as zero</li>
<li><strong>minGrowth</strong> &#8211;
Will be the lower bound of the objective function (e.g., 0.008). Forces the output model(s) to be able to produce a minimal objective value</li>
<li><strong>obj</strong> &#8211;
Objective function, e.g. <cite>biomass_reaction2</cite></li>
<li><strong>no_secretion</strong> &#8211;
Define metabolites that should not be secreted (e.g., {<cite>EX_o2(e)</cite>})</li>
<li><strong>no_uptake</strong> &#8211;
Define metabolites that should not be consumed (e.g., {<cite>EX_o2s(e)</cite>, <cite>EX_h2o2(e)</cite>})</li>
<li><strong>medium</strong> &#8211;
Define if certain exchanges should be excluded from minimization of exchanges (e.g., {}, if no medium except the exometabolomic data has been defined)</li>
<li><strong>addExtraExch</strong> &#8211;
After adding secretions, models are still not growing, this variable allows one to recover exchanges with a defined small value</li>
<li><strong>addExtraExch_value</strong> &#8211;
e.g. 1 as arbitrary small flux value / the resulting ub = 1, lb = -1.</li>
<li><strong>path</strong> &#8211;
Location of the .mat files for samples.</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
Structure that contains pruned and unpruned model, Vector of the Exchange_reactions, the exchange reactions added by <cite>minExCard</cite>, <cite>minFLux</cite> and <cite>maxFlux</cite> of the added reactions, maximal objective value, and the results of the gene deletion</li>
<li><strong>OverViewResults</strong> &#8211;
Overview of model statistics, e.g., number of reactions, metabolites, genes, number of essential genes, min and max objective values for easy comparison between sets of models</li>
</ul>
</div></blockquote>
<p>Depends on <cite>changeRxnBounds</cite>, <cite>fluxVariability</cite>, <cite>optimizeCbModel</cite>, <cite>generateCompactExchModel</cite> as well its dependent functions <cite>pruneModel</cite>, <cite>findMinCardModel</cite>, <cite>findOptExchRxns</cite></p>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.setSemiQuantConstraints">
<code class="descname">setSemiQuantConstraints</code><span class="sig-paren">(</span><em>modelA</em>, <em>modelB</em>, <em>cond1_upt_higher</em>, <em>cond2_upt_higher</em>, <em>cond2_secr_higher</em>, <em>cond1_secr_higher</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/setSemiQuantConstraints.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.setSemiQuantConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>This function establishes constraints for two models (<cite>modelA</cite> and <cite>modelB</cite>) based on the relative
difference of signal intensities obtained from two samples. The prerequisite for the adjustment is that constraints have been applied on which the relative differences can be applied:</p>
<ul class="simple">
<li><ol class="first upperalpha">
<li>The uptake rates have been established based on the medium composition and concentrations (i.e., <cite>setMediumConstraints</cite>), and</li>
</ol>
</li>
<li><ol class="first upperalpha" start="2">
<li>qualitative constraints have been applied based on know detection limits or small values (i.e., <cite>setQualitativeConstraints</cite>).</li>
</ol>
</li>
</ul>
<p><strong>Usage</strong></p>
<blockquote>
<div>[modelA_QUANT, modelB_QUANT] = setSemiQuantConstraints(modelA, modelB, cond1_upt_higher, cond2_upt_higher, cond2_secr_higher, cond1_secr_higher)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelA</strong> &#8211;
model constrained according to condition 1</li>
<li><strong>modelB</strong> &#8211;
model constrained according to condition 2</li>
<li><strong>cond1_upt_higher</strong> &#8211;
Exchange reactions and relative differences with higher uptake in condition 1 compared to condition 2</li>
<li><strong>cond2_upt_higher</strong> &#8211;
Exchange reactions and relative differences with higher uptake in condition 2 compared to condition 1</li>
<li><strong>cond2_secr_higher</strong> &#8211;
Exchange reactions and relative differences with higher secretion in condition 2 compared to condition 1</li>
<li><strong>cond1_secr_higher</strong> &#8211;
Exchange reactions and relative differences with higher secretion in condition 1 compared to condition 2</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelA_QUANT</strong> &#8211;
model constrained according to condition 1</li>
<li><strong>modelB_QUANT</strong> &#8211;
model constrained according to condition 2</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.statisticsAddedExchanges">
<code class="descname">statisticsAddedExchanges</code><span class="sig-paren">(</span><em>ResultsAllCellLines</em>, <em>samples</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/statisticsAddedExchanges.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.statisticsAddedExchanges" title="Permalink to this definition">¶</a></dt>
<dd><p>This function performs statistics on the added exchange reactions using
the structure <cite>ResultsAllCellLines</cite> generated by the function
<cite>setQuantConstraints</cite> and across all samples.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[Ex_added_all_unique] = statisticsAddedExchanges(ResultsAllCellLines, samples)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>ResultsAllCellLines</strong> &#8211;
Last output <cite>ResultsAllCellLines</cite> that contains
results of all samples (last in <cite>sampleResult.mat</cite>) e.g. in
&#8216;Y:StudiesData_integrationTutorial_paperToolboxUACC_257_2Result.mat&#8217;</li>
<li><strong>samples</strong></li>
</ul>
</div></blockquote>
<p><strong>Output</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>Ex_added_all_unique</strong> &#8211;
a table of exchange reactions which the models contain in addition to the
mapped(metabolomics-based)-exchanges, ordered by the
frequency of appearance.<ul>
<li>Column 1 = exchange reactions,</li>
<li>Column 2 = frequency of use,</li>
<li>Column 3 = secretion,</li>
<li>Column 4 = uptake.</li>
</ul>
</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="src.dataIntegration.metabotools.summarizeSamplingResults">
<code class="descname">summarizeSamplingResults</code><span class="sig-paren">(</span><em>modelA</em>, <em>modelB</em>, <em>path</em>, <em>nFiles</em>, <em>pointsPerFile</em>, <em>starting_model</em>, <em>dataGenes</em>, <em>show_rxns</em>, <em>fonts</em>, <em>hist_per_page</em>, <em>bin</em>, <em>fileNameA</em>, <em>fileNameB</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/opencobra/cobratoolbox/blob/f0b7a8f4d1ebc3106775c65bbf22d757593d50b8/src/dataIntegration/metabotools/summarizeSamplingResults.m"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#src.dataIntegration.metabotools.summarizeSamplingResults" title="Permalink to this definition">¶</a></dt>
<dd><p>The function summarizes the sampling results of the two models <cite>modelA</cite> and
<cite>modelB</cite>. Subsequently, it returnes medians from the two models&#8217; sampling,
FVA results for the respective reaction, simple test results (<cite>stats</cite>).
Finally, histograms are produced, one for each reactions containing the
distributions of the two models. The set of analyzed reactions can be
limited (<cite>show_rxns</cite>). Reactions associated with genes of special interest,
e.g. differentially expressed genes, can be marked to facilitate the
analysis, and simplify the identification of interesting histograms.</p>
<p><strong>Usage</strong></p>
<blockquote>
<div>[stats, statsR] = summarizeSamplingResults(modelA, modelB, path, nFiles, pointsPerFile, starting_model, dataGenes, show_rxns, fonts, hist_per_page, bin, fileNameA, fileNameB)</div></blockquote>
<p><strong>Inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>modelA</strong> &#8211;
Sampled modelA (condition 1)</li>
<li><strong>modelB</strong> &#8211;
Sampled modelB (condition 2)</li>
<li><strong>path</strong> &#8211;
Path to sampling output files</li>
<li><strong>nFiles</strong> &#8211;
Number of files saved, e.g., 20;</li>
<li><strong>pointsPerFilePoints</strong> &#8211;
Points saved per file, e.g., 5000;</li>
<li><strong>starting_model</strong> &#8211;
Original metabolic model (Recon)</li>
<li><strong>dataGenes</strong> &#8211;
Gene set, whose associated reactions should be emphasized by color, e.g., alternatively spliced or differentially expressed genes</li>
</ul>
</div></blockquote>
<p><strong>Optional inputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>show_rxns</strong> &#8211;
Vector of reactions that should be displayed, e.g., certain pathways or non-loop reactions</li>
<li><strong>fonts</strong> &#8211;
Font size (default = 9)</li>
<li><strong>hist_per_page</strong> &#8211;
Defines the number of histogramms that are printed per page, e.g., 4, 9, or 25 (default = 9)</li>
<li><strong>bin</strong> &#8211;
Binning for histogramm (default = 30)</li>
<li><strong>fileNameA</strong> &#8211;
Name of files the sampling points are stored in</li>
<li><strong>fileNameB</strong> &#8211;
Name of files the sampling points are stored in</li>
</ul>
</div></blockquote>
<p><strong>Outputs</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>stats</strong> &#8211;
Statistics from the sampling (Columns: Median modelA, Median modelB, minFlux_A, maxFlux_A, minFlux_B, maxFlux_B )</li>
<li><strong>statsR</strong> &#8211;
Reaction vector for stats output</li>
</ul>
</div></blockquote>
<p>Depends on COBRA functions: <cite>loadsamples</cite>, <cite>findRxnsFromGenes</cite>, flux
variability analysis / <cite>fastFVA</cite></p>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../transcriptomics/index.html" class="btn btn-default float-right" title="Transcriptomics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../fluxomics/c13solver/index.html" class="btn btn-default" title="c13solver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, The COBRA Toolbox developers.

    </p>
  </div>
  Built with Sphinx using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  


  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>