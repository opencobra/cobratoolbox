<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><script type="text/javascript" src="../js/iframeResizer.contentWindow.min.js"></script><script type="text/javascript" src="../js/iframeResizer.contentWindow.min.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Sparse Linear Optimisation</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.4px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { text-align: center; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { font-family: Helvetica, Arial, sans-serif; margin-left: 0px; margin-top: 10px; margin-bottom: 20px; margin-right: 0px;  }
.S7 { text-align: left; line-height: 21px; white-space: pre-wrap; white-space: pre-wrap; margin-left: 56px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { line-height: 20.576px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S9 { min-height: 0px; font-family: monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S11 { line-height: 15.5927px; min-height: 18px; white-space: nowrap; font-size: 12.6667px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S13 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S14 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S15 { min-height: 0px; white-space: pre; color: rgb(0, 0, 255); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S16 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S17 { min-height: 0px; white-space: pre; color: rgb(34, 139, 34); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S18 { min-height: 0px; white-space: pre; color: rgb(160, 32, 240); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S19 { min-height: 0px; white-space: pre; color: rgb(0, 0, 255); white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S20 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S21 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S22 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; background-color: #F7F7F7; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Sparse Linear Optimisation</span></h1><h2 class = "S3"><span class = "S2">Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S2">INTRODUCTION</span></h2><p class = "S4"><span class = "S2">In this tutorial, we will show how to use the sparse LP solver. This solver aims to solve the following optimisation problem</span></p><p class = "S5"><span style="vertical-align:-38"><img src="data:image/png;base64,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" width="102.5" height="91" /></span></p><p class = "S4"><span class = "S2">It has been proved that zero-norm is a non-convex function and the minimisation of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively developed. For a complete study of non-convex approximations of zero-norm, the reader is referred to Le Thie et al. (2015)</span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAoCAYAAAD32nqhAAAAjUlEQVRIS+3VIQ7CUBBF0VN2gGAPCGxXUQUGj0UhWQK2ZSWoqi6EJYAAiSQkJUFAmvLln/FzJ7l5eVNInCJxXwaAKbY44v7N1y8HM+ywxwVz3MYAljjjgPIfwPtYjXUAwkFKDiY49Ulc4DomyitsUPVLHVo0eHyCMiiUwc4NB3J4LJGDQQORg5ei5D54At1+ICnPQ6rOAAAAAElFTkSuQmCC" width="8" height="20" /></span><span class = "S2">.</span></p><p class = "S4"><span class = "S2">The method is described in Le Thie et al. (2015)</span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAoCAYAAAD32nqhAAAAjUlEQVRIS+3VIQ7CUBBF0VN2gGAPCGxXUQUGj0UhWQK2ZSWoqi6EJYAAiSQkJUFAmvLln/FzJ7l5eVNInCJxXwaAKbY44v7N1y8HM+ywxwVz3MYAljjjgPIfwPtYjXUAwkFKDiY49Ulc4DomyitsUPVLHVo0eHyCMiiUwc4NB3J4LJGDQQORg5ei5D54At1+ICnPQ6rOAAAAAElFTkSuQmCC" width="8" height="20" /></span><span class = "S2">. The sparse LP solver contains one convex (one-norm) and 6 non-convex approximation of zero-norms</span></p><ul class = "S6"><li class = "S7"><span class = "S0">Capped-L1 norm</span></li><li class = "S7"><span class = "S0">Exponential function</span></li><li class = "S7"><span class = "S0">Logarithmic function</span></li><li class = "S7"><span class = "S0">SCAD (Smoothly Clipped Absolute Deviation) function</span></li><li class = "S7"><span class = "S0">p norm with </span><span class = "S0"> </span><span class = "S0">  </span><span class = "S0">p</span><span class = "S0">&lt;</span><span class = "S0">0</span><span class = "S0">  </span><span class = "S0"> </span><span class = "S0"> </span></li><li class = "S7"><span class = "S0">p norm with </span><span class = "S0"> </span><span class = "S0">  </span><span class = "S0">0</span><span class = "S0">&lt;</span><span class = "S0">p</span><span class = "S0">&lt;</span><span class = "S0">1</span><span class = "S0">  </span><span class = "S0"> </span></li></ul><p class = "S4"><span class = "S2">The tutorial consist of two parts. Part 1 shows a basic usage of the solver. In part 2 provides an application of the code for finding the minimal set of reactions subject to a LP objective. Ready-made scripts are provided for both parts.</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">EQUIPMENT SETUP</span></h2><h2 class = "S3"><span class = "S2">Initialize the COBRA Toolbox.</span></h2><p class = "S4"><span class = "S2">If necessary, initialize The Cobra Toolbox using the </span><span class = "S9">initCobraToolbox</span><span class = "S2"> function.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">initCobraToolbox</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">COBRA model. </span></h2><p class = "S4"><span class = "S2">In thi</span><span class = "S2">s tutorial, the model used</span><span class = "S2"> is the generic reconstruction of human metabolism, the Recon 2.04</span><span style="vertical-align:-3"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAoCAYAAAD32nqhAAABGklEQVRIS+3UvytFcRjH8dfFZGDyDxhEKBaLYlDkf2AxUbesNqVsJsVEyUIpo7LIj52yGOwGdhakU1+6nc73e8/tDup2nvou3/N93ud5Ps+np6bNqLWZr4MBA1jCFLpwhnN85zUr0mAS9wXingboV+O3PCD72y2OwvnEPC5D0hyuUoARrGI9V8Ea9lHHXgowgVe85ADDeCoDiPlqEReYwV2qghhgFwsYRabLX5Rx4jgeMYTnMmNsfNOHB6zgpqi8VAU9uA6qn8R6iwGy+4Og/E4uuRfvv3cxwAa6sZ1LnkY20sMUYBnHwXEfyFrJoh+DGMNbDDAb+o61vIXNVseYXFplfFABkgro5LXepPPWFkplpMpITQ31/xvpBzY+JylMcpDRAAAAAElFTkSuQmCC" width="8" height="20" /></span><span class = "S2">, which is provided in the COBRA Toolbox. The Recon 2.04 model can also be downloaded from the </span><a href = 'https://vmh.uni.lu/#downloadview'><span class = "S0">Virtual Metabolic Human</span></a><span class = "S2"> webpage. You can also select your own model to work with. Before proceeding with the simulations, the path for the model needs to be set up:      </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">if </span><span class = "S12">0</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S17">% Using own model, change "if 0" to "if 1" and change the filename and directory</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    filename = </span><span class = "S18">'Recon3.0model'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    directory = </span><span class = "S18">'~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels'</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    model = loadIdentifiedModel(filename, directory);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S17">% model = convertOldStyleModel(model);%convert to new COBRA format style if needed.</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S19">else</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S17">% Default use of Recon 2.04</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S15">global </span><span class = "S12">CBTDIR            </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    load([CBTDIR filesep </span><span class = "S18">'test' </span><span class = "S16">filesep </span><span class = "S18">'models' </span><span class = "S16">filesep </span><span class = "S18">'Recon2.v04.mat'</span><span class = "S12">]);            </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    model = modelR204;            </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    clear </span><span class = "S18">modelR204</span><span class = "S12">;</span></p></div></div><p class = "S20"><span class = "S2">Recon 2.04 is written in the "old style" COBRA format, and we thus use the function </span><span class = "S9">convertOldStyleModel</span><span class = "S2"> to convert it to the new COBRA Toolbox format.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    model = convertOldStyleModel(model);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S19">end</span></p></div></div><p class = "S20"><span class = "S21">NOTE: The following text, code, and results are shown for the Recon 2.04 model</span></p></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">PROCEDURE</span></h2><h2 class = "S3"><span class = "S2">Example of using sparseLP solver on randomly generated data</span></h2><p class = "S4"><span class = "S2">One randomly generates a matrix </span><span style="vertical-align:-3"><img src="data:image/png;base64,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" width="67.5" height="30" /></span><span class = "S2"> </span><span class = "S2">  and a vector </span><span style="vertical-align:-5"><img src="data:image/png;base64,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" width="52" height="30" /></span><span class = "S2"> </span><span class = "S2">. The right hand side vector</span><span class = "S2"> </span><span style="vertical-align:-5"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH0AAAAoCAYAAADTw/VhAAAGJ0lEQVR4Xu2aV6gsRRCGv2vCgIqgvhgw54yKmCPmHDEHFHNAMKBgeDFhjqBXVDCLCmbMipgxYM4ooqgYMGf5oFr6zpndndmzy9k7Z/rpnJnp7qr6u6r+qt4ptGPSWWDKpNO4VZgW9El4CFrQW9AnoQUmocp1PH0O4OdJaKPGqdwN9HWBZYFFgD2AxYAVgDcbZ4WxCmmX/YCHgc+bpm830A8CNgb2DKU/CtB/bZoRSvTZNABfG3i2afr2Cu8zAy8BKwGXAscA/zbNCAV9ZgdeBJYDDgauaZq+vUBfFNDDHTsDdzbNACX6HAZcEc/PA05s2kHvBfouwO1hgMWzA9BU7BcEPsuUuw/YHvi7SQp3A913lwGHA+9FPv+zScoXdMn1Ta++ApYBvmuS3t1At0R7IXLbOcBJTVK8RJc1geeB46NaWSO+EfR3m6R7N9BXBF4PZbcAHgKWCja/dNTstwCPNMAgEtbHgfkiop0PHBV6rQ88PQE6zhSyaHvL5x+DWP4UsswDnABsAlwM3FhVxm6gHwpcCRjiVgG26sBk9YwLqm44ot/tBtwKJIBzMndERuzqij8jMD/wNfBXjcmzAi9HlM2nJTLt4Xwueie+91BuVJV7dALd53cFiZHIGeZlshrHDTYHrsukmZ5Jnh7zTkSsfYB/Qu+7Q79+S9W5wlaWuzrOysCXNYC3dPwF0LYfZNWEafZR4HfgDmBf4CbgqqprdwJ93ui8eUodhpa1gLeyhc+OcsZH5j/r+apjJ2CBmqWQp18lP6m6ScXvTgNOj9T1fpbH346/HwC2q+mpTpULpDX8366m0aTumCFA3jBS7FPRLfQQ/VZ3Mb/vBPoGwBPZguaNxwobWMokb6gL+lTgwD4ElmzZOBnUSMAcB1yULaqXvhLhs18GvwSQDpFLa1MB62ccC1yYTbQl/nE/C3UD3RByVixq2XZ0iVfanUuGMue/VkMIo4SlYG6UXtNXC25RZ59ua+YpbFfgQ2AWwLJU0CV2afR756B328a+H7i6as4tETp3Qu0m1+p7lHm6rFEvXydWLcvXzjPXSyz69YS+hR7QxNRfr7JcWaSrMm9Q3+TptlNn1HuS/YElgSeBc4FvywQoA91btRQ6JDF6eXF4+5byu8TODeuwUz3A8CcZqTrmBG7ISE3VeWXfpR6ETZfdw7tzWyjXAVlVMh4GPx4509zc3pfEHUi+7hmAKcq8Ly6nxAFYFfimKEAZ6L1ydbFzVTe0K0O/Ob0ud+hk8FSS6e0y4bKRt6CV95Bg9oMAsc4aEli5QGoW2R3NSVwK/ZJjKy5HuijzAOxdTCtloHuSbEx40eIJ+6MgodeNz8SzMwHZb90hW7buLw0/HRZbHtg6axjV3TN9vxDwaZRT3SJUzr7VVy+qE836la84T/tuFpddNo2spOQY6pDS7HrxzH5AGon8jeEjRdDza8Wypou5xVal7FFDKMz0dL+uvtcD1uO92HQ6HBpxonhL8uKFAUu3VK6mDqk9AHsoevhehUi0ZRDIMampCHreej0SuDw7OTJaW66GGWtXGzWpJTioUz3sdXYIA1XhIRrZsk3DOgaVWrrp6FW2YOlQerQVxTaAt32GeR1OeWzGGI0l3GJ2D6BuNpbSSCXjmHdF0C1dbotZ+SXL6tFY0MN9fuoEhbp+D4XtUPP3g7GARpUFS3LKrk3nju9tBqWhXQyZX/QrRIV5Nm90pjSK6TOl3vT+3jgU4wLdQyCbvblEQJW2dn+1gvCj9klOTnPZLHEM9/koNlWKuvRDXKvaw0rJyxOHbe+TC4cy3QT6Xjw8FG9U8PQd83U6deT0DH9QMFt4tB7xfVXJ2+/GZQH7IkafTu1muYb4+L5jCM/eXRu3c/+H/l6/nBmX9O3koVsgVRhecReJXOJnPYnc0KVsNxioBVIN78VLsfxM/GxMB6/19IFiMCGLpd89FLmGbVgBt06fpqxuQZ8QnAa6qb0VSzd7CZZtNpBSaPdKWGY/zWhBH6j9J2wxeyjevG0bLW5LSxl7uvpuQZ8waIa/seDbd/+hWx+l9fThAzFyO7SgjxwkwxeoBX34Nh65HVrQRw6S4QvUgj58G4/cDi3oIwfJ8AX6D8XTRjidbzqTAAAAAElFTkSuQmCC" width="62.5" height="20" /></span><span class = "S2">. There are three optional inputs for the method.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">n = 100; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">m = 50; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">x0 = rand(n,1); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.A = rand(m,n); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.b = constraint.A*x0; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.lb = -1000*ones(n,1); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.ub = 1000*ones(n,1); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">constraint.csense = repmat(</span><span class = "S18">'E'</span><span class = "S12">, m, 1); </span></p></div></div><p class = "S20"><span class = "S2">The two first: maximum number of iterations (</span><span class = "S22">nbMaxIteration</span><span class = "S2">) and threshold (</span><span class = "S22">epsilon</span><span class = "S2">) are stopping criterion conditions. </span><span class = "S22">theta</span><span class = "S2"> is the parameter of zero-norm approximation. The greater the value of </span><span class = "S22">theta</span><span class = "S2">, the better the approximation of the zero-norm. However, the greater the value of </span><span class = "S22">theta</span><span class = "S2">, the more local solutions the problem has. If the value of </span><span class = "S22">theta </span><span class = "S2">is not given then the algorithm will use a default value and update it gradually.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">params.nbMaxIteration = 100;    </span><span class = "S17">% stopping criteria</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">params.epsilon = 1e-6; 		</span><span class = "S17">% stopping criteria</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">params.theta   = 2;    		 </span><span class = "S17">% parameter of l0 approximation </span></p></div></div><p class = "S20"><span class = "S2">Call the solver with a chosen approximation</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">solution = sparseLP(</span><span class = "S18">'cappedL1'</span><span class = "S12">,constraint,params); </span></p></div></div><p class = "S20"><span class = "S2">or with default parameter</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">%solution = sparseLP('cappedL1',constraint);</span></p></div></div><h2 class = "S3"><span class = "S2">Finding the minimal set of reactions subject to a LP objective</span></h2><p class = "S4"><span class = "S2">Set the tolerance to distinguish between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">feasTol = getCobraSolverParams(</span><span class = "S18">'LP'</span><span class = "S16">, </span><span class = "S18">'feasTol'</span><span class = "S12">);</span></p></div></div><p class = "S20"><span class = "S2">Select the biomass reaction to optimise</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">model.biomassBool=strcmp(model.rxns,</span><span class = "S18">'biomass_reaction'</span><span class = "S12">);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">model.c(model.biomassBool)=1;</span></p></div></div><p class = "S20"><span class = "S2">We will firstly find the optimal value subject to a LP objective</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">%% Solve FBA  </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">% max c'v </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">% s.t   Sv = b </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">%       l &lt;= v &lt;= u</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">% Define the LP structure </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">[m,n] = size(S); </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">LPproblem = struct(</span><span class = "S18">'c'</span><span class = "S16">,-c,</span><span class = "S18">'osense'</span><span class = "S16">,1,</span><span class = "S18">'A'</span><span class = "S16">,S,</span><span class = "S18">'csense'</span><span class = "S16">,csense,</span><span class = "S18">'b'</span><span class = "S16">,b,</span><span class = "S18">'lb'</span><span class = "S16">,lb,</span><span class = "S18">'ub'</span><span class = "S12">,ub);  </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">% Call solveCobraLP to solve the LP </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">LPsolution = solveCobraLP(LPproblem);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">vFBA = LPsolution.full;</span></p></div></div><p class = "S20"><span class = "S2">We will now find the minimum number of reactions needed to achieve the same max objective found previously. Then one will add one more constraint: </span><span style="vertical-align:-5"><img src="data:image/png;base64,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" width="122.5" height="22" /></span><span class = "S2">.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.A = [S ; c']; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.b = [b ; c'*vFBA]; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">constraint.csense = [csense;</span><span class = "S18">'E'</span><span class = "S12">];</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.lb = lb; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">constraint.ub = ub;</span></p></div></div><p class = "S20"><span class = "S2">Call the sparseLP solver to solve the problem</span></p><p class = "S5"><span style="vertical-align:-38"><img src="data:image/png;base64,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" width="98" height="90" /></span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S17">% Try all non-convex approximations of zero norm and take the best result </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">approximations = {</span><span class = "S18">'cappedL1'</span><span class = "S16">,</span><span class = "S18">'exp'</span><span class = "S16">,</span><span class = "S18">'log'</span><span class = "S16">,</span><span class = "S18">'SCAD'</span><span class = "S16">,</span><span class = "S18">'lp-'</span><span class = "S16">,</span><span class = "S18">'lp+'</span><span class = "S12">}; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">bestResult = n; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">bestAprox = </span><span class = "S18">''</span><span class = "S12">; </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">for </span><span class = "S12">i=1:length(approximations)     </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">	solution = sparseLP(char(approximations(i)),constraint);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">	</span><span class = "S15">if </span><span class = "S12">solution.stat == 1         </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">		</span><span class = "S15">if </span><span class = "S12">bestResult &gt; length(find(abs(solution.x)&gt;eps))             </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">			bestResult=length(find(abs(solution.x)&gt;eps));             </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">			bestAprox = char(approximations(i));             </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">			solutionL0 = solution;         </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">		</span><span class = "S15">end</span><span class = "S12">     </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">	</span><span class = "S19">end </span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S19">end </span></p></div></div><p class = "S20"><span class = "S2">Now we call the sparse linear step function approximations  </span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">bestResult = n;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">bestAprox = </span><span class = "S18">''</span><span class = "S12">;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">for </span><span class = "S12">i=1:length(approximations)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    solution = sparseLP(char(approximations(i)),constraint);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S15">if </span><span class = "S12">solution.stat == 1</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">        nnzSol=nnz(abs(solution.x)&gt;feasTol);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">        fprintf(</span><span class = "S18">'%u%s%s'</span><span class = "S16">,nnzSol,</span><span class = "S18">' active reactions in the sparseFBA solution with '</span><span class = "S12">, char(approximations(i)))</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">        </span><span class = "S15">if </span><span class = "S12">bestResult &gt; nnzSol</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">            bestResult=nnzSol;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">            bestAprox = char(approximations(i));</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">            solutionL0 = solution;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">        </span><span class = "S19">end</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    </span><span class = "S19">end</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S19">end</span></p></div></div><p class = "S20"><span class = "S2">Select the most sparse flux vector, unless there is a numerical problem.</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">if </span><span class = "S16">~isequal(bestAprox,</span><span class = "S18">''</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    vBest = solutionL0.x;</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S19">else</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    vBest = [];</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    error(</span><span class = "S18">'Min L0 problem error !!!!'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S19">end</span></p></div></div><p class = "S20"><span class = "S2">Report the best approximation</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">display(strcat(</span><span class = "S18">'Best step function approximation: '</span><span class = "S12">,bestAprox))</span></p></div></div><p class = "S20"><span class = "S2">Report the number of active reactions in the most sparse flux vector</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">fprintf(</span><span class = "S18">'%u%s'</span><span class = "S16">,nnz(abs(vBest)&gt;feasTol),</span><span class = "S18">' active reactions in the best sparse flux balance analysis solution.'</span><span class = "S12">)</span></p></div></div><p class = "S20"><span class = "S2">Warn if there might be a numerical issue with the solution</span></p><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">feasError=norm(constraint.A * solutionL0.x - constraint.b,2);</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S15">if </span><span class = "S12">feasError&gt;feasTol</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S16">    fprintf(</span><span class = "S18">'%g\t%s\n'</span><span class = "S16">,feasError, </span><span class = "S18">' feasibily error.'</span><span class = "S12">)</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">    warning('Numerical issue with the sparseLP solution')</span></p></div><div class = 'inlineWrapper'><p class = "S11 lineNode"><span class = "S12">end</span></p></div></div></div><p class = "S0"></p><div class = 'SectionBlock containment'><h2 class = "S8"><span class = "S2">REFERENCES</span></h2><p class = "S4"><span class = "S22"> </span><span class = "S2">[1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span class = "S2"> </span><span class = "S2">optimization</span><span class = "S2">. European Journal of Operational Research 244, 2646.</span></p><p class = "S4"><span class = "S2">[2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). A community-driven global reconstruction of human metabolism. Nat Biotechnol 31, 419-425.</span></p></div></div>
<!-- 
##### SOURCE BEGIN #####
%% Sparse Linear Optimisation
%% Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.
%% Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.
%% INTRODUCTION
% In this tutorial, we will show how to use the sparse LP solver. This solver 
% aims to solve the following optimisation problem
% 
% $$\begin{array}{ll}\min & \Vert x\Vert_{0}\\s.t & A_{eq}x=b_{eq}\\ & A_{ieq}x\leq 
% b_{ieq}\\ & l\leq x\leq u\end{array}$$
% 
% It has been proved that zero-norm is a non-convex function and the minimisation 
% of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively 
% developed. For a complete study of non-convex approximations of zero-norm, the 
% reader is referred to Le Thie et al. (2015)$^1$.
% 
% The method is described in Le Thie et al. (2015)$^1$. The sparse LP solver 
% contains one convex (one-norm) and 6 non-convex approximation of zero-norms
% 
% * Capped-L1 norm
% * Exponential function
% * Logarithmic function
% * SCAD (Smoothly Clipped Absolute Deviation) function
% * p norm with    p<0    
% * p norm with    0<p<1   
% 
% The tutorial consist of two parts. Part 1 shows a basic usage of the solver. 
% In part 2 provides an application of the code for finding the minimal set of 
% reactions subject to a LP objective. Ready-made scripts are provided for both 
% parts.
%% EQUIPMENT SETUP
%% *Initialize the COBRA Toolbox.*
% If necessary, initialize The Cobra Toolbox using the |initCobraToolbox| function.

initCobraToolbox
%% COBRA model. 
% In this tutorial, the model used is the generic reconstruction of human metabolism, 
% the Recon 2.04$^2$, which is provided in the COBRA Toolbox. The Recon 2.04 model 
% can also be downloaded from the <https://vmh.uni.lu/#downloadview Virtual Metabolic 
% Human> webpage. You can also select your own model to work with. Before proceeding 
% with the simulations, the path for the model needs to be set up:      

if 0
    % Using own model, change "if 0" to "if 1" and change the filename and directory
    filename = 'Recon3.0model';
    directory = '~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels';
    model = loadIdentifiedModel(filename, directory);
    % model = convertOldStyleModel(model);%convert to new COBRA format style if needed.
else
    % Default use of Recon 2.04
    global CBTDIR            
    load([CBTDIR filesep 'test' filesep 'models' filesep 'Recon2.v04.mat']);            
    model = modelR204;            
    clear modelR204;
%% 
% Recon 2.04 is written in the "old style" COBRA format, and we thus use 
% the function |convertOldStyleModel| to convert it to the new COBRA Toolbox format.

    model = convertOldStyleModel(model);
end
%% 
% *NOTE: The following text, code, and results are shown for the Recon 2.04 
% model*
%% PROCEDURE
%% Example of using sparseLP solver on randomly generated data
% One randomly generates a matrix $A\in\mathcal{R}^{^{m\times n}}$   and a vector 
% $x_{0}\in\mathcal{R}^{^{n}}$ . The right hand side vector $b=A\cdot x_{0}$. 
% There are three optional inputs for the method.

n = 100; 
m = 50; 
x0 = rand(n,1); 
constraint.A = rand(m,n); 
constraint.b = constraint.A*x0; 
constraint.lb = -1000*ones(n,1); 
constraint.ub = 1000*ones(n,1); 
constraint.csense = repmat('E', m, 1); 
%% 
% The two first: maximum number of iterations (_nbMaxIteration_) and threshold 
% (_epsilon_) are stopping criterion conditions. _theta_ is the parameter of zero-norm 
% approximation. The greater the value of _theta_, the better the approximation 
% of the zero-norm. However, the greater the value of _theta_, the more local 
% solutions the problem has. If the value of _theta _is not given then the algorithm 
% will use a default value and update it gradually.

params.nbMaxIteration = 100;    % stopping criteria
params.epsilon = 1e-6; 		% stopping criteria
params.theta   = 2;    		 % parameter of l0 approximation 
%% 
% Call the solver with a chosen approximation

solution = sparseLP('cappedL1',constraint,params); 
%% 
% or with default parameter

%solution = sparseLP('cappedL1',constraint);
%% Finding the minimal set of reactions subject to a LP objective
% Set the tolerance to distinguish between zero and non-zero flux, based on 
% the numerical tolerance of the currently installed optimisation solver.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% 
% Select the biomass reaction to optimise

model.biomassBool=strcmp(model.rxns,'biomass_reaction');
model.c(model.biomassBool)=1;
%% 
% We will firstly find the optimal value subject to a LP objective

%% Solve FBA  
% max c'v 
% s.t   Sv = b 
%       l <= v <= u
% Define the LP structure 
[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); 
[m,n] = size(S); 
LPproblem = struct('c',-c,'osense',1,'A',S,'csense',csense,'b',b,'lb',lb,'ub',ub);  
% Call solveCobraLP to solve the LP 
LPsolution = solveCobraLP(LPproblem);
vFBA = LPsolution.full;
%% 
% We will now find the minimum number of reactions needed to achieve the 
% same max objective found previously. Then one will add one more constraint: 
% $$c^{T}v=c^{T}v_{FBA}=:f_{FBA}$$.

constraint.A = [S ; c']; 
constraint.b = [b ; c'*vFBA]; 
constraint.csense = [csense;'E'];
constraint.lb = lb; 
constraint.ub = ub;
%% 
% Call the sparseLP solver to solve the problem
% 
% $$\begin{array}{ll}\min & \Vert v\Vert_{0}\\s.t & Sv=b\\ & c^{T}v=f_{FBA}\\ 
% & l\leq v\leq u\end{array}$$

% Try all non-convex approximations of zero norm and take the best result 
approximations = {'cappedL1','exp','log','SCAD','lp-','lp+'}; 
bestResult = n; 
bestAprox = ''; 
for i=1:length(approximations)     
	solution = sparseLP(char(approximations(i)),constraint);
	if solution.stat == 1         
		if bestResult > length(find(abs(solution.x)>eps))             
			bestResult=length(find(abs(solution.x)>eps));             
			bestAprox = char(approximations(i));             
			solutionL0 = solution;         
		end     
	end 
end 
%% 
% Now we call the sparse linear step function approximations  

bestResult = n;
bestAprox = '';
for i=1:length(approximations)
    solution = sparseLP(char(approximations(i)),constraint);
    if solution.stat == 1
        nnzSol=nnz(abs(solution.x)>feasTol);
        fprintf('%u%s%s',nnzSol,' active reactions in the sparseFBA solution with ', char(approximations(i)))
        if bestResult > nnzSol
            bestResult=nnzSol;
            bestAprox = char(approximations(i));
            solutionL0 = solution;
        end
    end
end
%% 
% Select the most sparse flux vector, unless there is a numerical problem.

if ~isequal(bestAprox,'')
    vBest = solutionL0.x;
else
    vBest = [];
    error('Min L0 problem error !!!!')
end
%% 
% Report the best approximation

display(strcat('Best step function approximation: ',bestAprox))
%% 
% Report the number of active reactions in the most sparse flux vector

fprintf('%u%s',nnz(abs(vBest)>feasTol),' active reactions in the best sparse flux balance analysis solution.')
%% 
% Warn if there might be a numerical issue with the solution

feasError=norm(constraint.A * solutionL0.x - constraint.b,2);
if feasError>feasTol
    fprintf('%g\t%s\n',feasError, ' feasibily error.')
    warning('Numerical issue with the sparseLP solution')
end
%% REFERENCES
% _ _[1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation 
% approaches for sparse optimization. European Journal of Operational Research 
% 244, 2646.
% 
% [2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, 
% M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). 
% A community-driven global reconstruction of human metabolism. Nat Biotechnol 
% 31, 419-425.
##### SOURCE END #####
--></body></html>
